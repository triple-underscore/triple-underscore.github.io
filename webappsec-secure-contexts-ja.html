<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Secure Contexts （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-w3c.css" type="text/css">

<style>
@namespace svg url(http://www.w3.org/2000/svg);

svg|*.secure {
  fill: var(--G-bg);
}

svg|*.non-secure {
  fill: var(--R-bg);
  stroke-dasharray: 5,5;
}

svg|rect, svg|circle {
  stroke-width: 2;
  stroke: var(--K-color);
  fill-opacity: 0.75;
}
svg|text {
  fill: var(--K-color);
	stroke: none;
  font-family: monospace;
}
svg|text.rejection {
  fill: var(--R-color);
  font-weight: 700;
  font-size: 2em;
}
svg|path {
  stroke-width: 2px;
  stroke: var(--dim-color);
  fill-opacity: 0;
  stroke-dasharray: 5px, 5px;
}

</style>

<style>
samp {
	white-space: nowrap;
	background: var(--bg-color-1);
	margin-left: 0.5em;
	margin-right: 0.5em;
}

</style>

<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		toc_main: 'MAIN0',
		generate: expand
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~一-鿆]+|`(.*?)([$@^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){

if(!indicator) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('＠');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r': // 文献
	text = `[${key}]`;
	href = `#biblio-${key.toLowerCase()}`;
	break;
case 'sc': //url scheme
	text = key + ':';
	break;
case 'l': //literal
	return `"<code class="literal">${key}</code>"`;
	break;
case 'en': // english words
	return `<span lang="en">${key}</span>`;
	break;
case 'dgm':
	return `<a id="_dgm-${key}">＊</a>`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;

	}
}
</script>


<script type="text/plain" id="_source_data">


●●options

spec_date:2023-11-10
trans_update:2021-05-19
source_checked:210112
page_state_key:WEBAPPSEC
original_url:https://w3c.github.io/webappsec-secure-contexts/
	abbr_url:SECURE-CONTEXT
spec_status:ED
ref_id_prefix:biblio-
ref_id_lowercase:true
	conformance:w3c
copyright:2023,permissive
trans_1st_pub:2016-06-04


●●class_map
e:element
a:attr
sc:scheme
et:event-type
v:value
E:error

●●tag_map
e:code
a:code
et:code
I:code
sc:code
E:code
v:code
c:code
s:samp
i:i
em:em

●●words_table


	●仕様（動詞）
	制約-法:restricting
公告-:announce:~

稼働時:runtime::~
欠く:lackする:~
	assumption
警告-:warn:~
移行-:migrate:~
従事:engage:~
合意:agreement:~
	抑制するのみ:strict reduction


	●仕様
critical:
team::::チーム
仕様化-:specify:~
前提条件:precondition:~
原則的:principle:~
公共:public:~
早急:quick:~
早期の:early:~
明白:obvious:~
最小限:minimum:~
最近の:recentな:~
段差舗装:speed-bump:~
独特:distinct:~
網羅的:exhaustive:~
非推奨化:deprecation:~

観点:perspective:~
計画:plan:~
試験用:staging:~
感触:feel:~
感覚:sense:~
不確かさ:uncertainty:~
広範:wide:~
協力的な:cooperativeな:協力しあう
理解:understanding:~
親切さ:friendlyness:~
伝える:informする:~
関心:interest:~

	何ら効果がなかった。completely ineffective
	interesting
	後述の:follow
	所から始める:approach
	善悪は別に，:better or worse
	間違いなく:certainly
	相応に:fairly
	移行過程:path forward
	作り込み:niceties
	短い答え:short answer
	どうにかして:somehow
	ますます:increasingly
	見え難い部分を次第に拡げていく:increasingly esoteric
	されるべき:ought
	格好／良い:good
	を問わず:no matter
	さしあたり:meantime
	忘れる:forget
	書くこと:writing
	特に挙げられる:particularly-noteworthy
	少しばかり:little more than
	~~実際に:do
	capable
	clear
	Leading up to the flag day
	please
	informative
	fall
	類する:falling
	特に，:great
	meet
	met
	標準:Standard

	●保安
私的:private::~::プライベート
敵対者:adversary:~
	denied
善意:benevolent:~
堅牢:robust::~

弱体化-:compromise::~
持続化-:persist::~
持続的:persistent::~
暗号化-:encrypt::~

未認証の:unauthenticated:~
機密性:confidentiality::~
機密的:confidential::~
混在:mixed::~
濫用-:abuse:~
認証:authentication::~
認証-:authenticate::~
	認証-済み:authenticated
認証性:authenticity::~
再現-:replay::~
迂回-:bypass::~
迂回:bypass::~
防御-:defend::~
防護-:guard::~

無法:nefarious:~
危険:dangerous:~
受動的:passive::~::パッシブ
能動的:active::~::アクティブ
脅威:threat::~
行為者:actor::~
調査:surveillance:~

	信用に価し得る:potentially trustworthy
	信用に価しな:untrustworthy
	信用に価する:trustworthy
	esoteric
	exfiltration
	~secureでない:non-secure
	もたらす:pose

	●保安文脈
package::::パッケージ
	packaged
添付-:attach::~
成分組:tuple::~::タプル
開いた:openした::~
開かれ:openされた::~
堅固:solid:~
先天的:a priori:~

	信用-済み:trusted
	価する
	価しない

	●network
disk::::ディスク
loopback::::ループバック
localhost:
解決器:resolver::~
運ぶ:carryする:~
通過-:transit::~
無線:wireless:~

	●IDL／型／構造
blob:
作成元:creator::~

	先祖による:ancestral
	設定し直:reset

	●処理
優先-:prioritize:~
指図-:direct::~
一時的:temporary:~
	~errorにする:err
	失敗

	●未分類
	GPS
	Internet
	Netflix
	Promise:
	ISP:Internet Service Provider:
	Service Worker
	Shared Worker
	Dedicated Worker
	worker:Worker
critical:

camera::::カメラ
microphone::::マイクロフォン
sensor::::センサー
金銭的利益:financial gain:~
shim:

巡回-:walk through:~

粗く:coarsen:~
加速度計:accelerometer:~
完璧:perfect:完全
実体:entities:~
遮る:obscureする:~

	locking
	long::::
	期日:schedule
	operator
	地番~levelでなく府県~level:city-level data rather than high-accuracy
	対外支払い法:payment instruments
	simply
	html
	Chrome
	high-accuracy
	across:
	entire
	frame内の:framed
	go
	hand
	-:help
	lay
	住まう:live
	made
	mailing
	making
	meant
	most
	neither
	past
	期間後:period
	個々の利用者／組織／団体／あらゆる人々:individual users, organizations or even entire populations
	potential
	現に居:presence
	put
	remain
	time
	vendor-specific
	そっくり機能停止:stops working altogether
	~~実在:indeed 〜 present
	ないがしろに:subvert
	pose
	断ち切れる:broken
	始-:begin
	抗して:against
	数:number
	現れ:appear
	見る:look at
	遅くする:slow down
	ことにする／:choose
	それ自体:on its own merits
	その日が来る前に:Leading up to the flag day,
	道連れ:altogether

	●指示語
	側:side
	多数:large number
	大きく:largely
	こと:thing
	その逆:vice-versa
	まったく
	一つ:one
	他では:otherwise〜


●●original_id_map

●●words_table1

●●link_map



	●IDL
SecureContext:~WEBIDLjs#SecureContext

E.SecurityError:~WEBIDL#securityerror

I.BroadcastChannel:~HTMLcomms#broadcastchannel
I.WindowOrWorkerGlobalScope:~HTMLGAPI#windoworworkerglobalscope
I.SharedWorker:~WORKERS#sharedworker


e.iframe:~HEembed#the-iframe-element

et.storage:~WEBSTORAGE#the-storage-event

	~secureな文脈:#is-settings-object-contextually-secure

生成元は信用に価し得るか？:#is-origin-trustworthy
~URLは信用に価し得るか？:#is-url-trustworthy
	§:#threat-models
	§:#ancestors
	§:#isolation
	§:#implementation-considerations
	§:#packaged-applications
	§:#development-environments
	§:#new
v.noopener:~HTMLlinks#link-type-noopener

信用に価し得る生成元:#potentially-trustworthy-origin
信用に価し得る~URL:#potentially-trustworthy-url


~URL~record:~URL1#concept-url
url.~scheme:~URL1#concept-url-scheme
	url.~host:~URL1#concept-url-host
url.生成元:~URL1#concept-url-origin

~top-level閲覧~文脈:~HTMLds#top-level-browsing-context

生成元:~ORIGIN#concept-origin
	https://www.w3.org/TR/html#concept-cross-origin
不透明な生成元:~ORIGIN#concept-origin-opaque
成分組~生成元:~ORIGIN#concept-origin-tuple
~scheme:~ORIGIN#concept-origin-scheme
~host:~ORIGIN#concept-origin-host
~domain:~ORIGIN#concept-origin-domain
~port:~ORIGIN#concept-origin-port
~sandbox法~指令を構文解析する:~ORIGIN#parse-a-sandboxing-directive

環境:~WAPI#environment
現在の設定群~obj:~WAPI#current-settings-object
大域~obj:~WAPI#global-object
関連な設定群~obj:~WAPI#relevant-settings-object
	廃）enV.~HTTPS状態:~WAPI#https-state
enV.~secureな文脈:~WAPI#secure-context

先天的に認証-済み~URL:~MIXED-CONTENT#a-priori-authenticated-url
公開され:~WEBIDLjs#dfn-exposed

x.改変する:https://www.w3.org/2023/Process-20231103/#revising-rec

専用~worker:~WORKERS#infrastructure-2
共用~worker:~WORKERS#infrastructure-2


●●ref_normative

[HTML]
    Anne van Kesteren; et al. ＜HTML Standard＞. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[LET-LOCALHOST-BE-LOCALHOST]
    Mike West. ＜Let 'localhost' be localhost.＞. URL: https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost
[RFC4632]
    V. Fuller; T. Li. ＜Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan＞. August 2006. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc4632
[URL]
    Anne van Kesteren. ＜URL Standard＞. Living Standard. URL: https://url.spec.whatwg.org/
[W3C-PROCESS]
    Elika J. Etemad (fantasai); Florian Rivoal. ＜W3C Process Document＞. 2 November 2021. URL: https://www.w3.org/Consortium/Process/
[WEBIDL]
    Edgar Chen; Timothy Gu. ＜Web IDL Standard＞. Living Standard. URL: https://webidl.spec.whatwg.org/

●●ref_informative

[COMCAST]
    David Kravets. ＜Comcast Wi-Fi serving self-promotional ads via JavaScript injection＞. URL: https://arstechnica.com/tech-policy/2014/09/why-comcasts-javascript-ad-injections-threaten-security-net-neutrality/
[CREDENTIAL-MANAGEMENT-1]
    Mike West. ＜Credential Management Level 1＞. URL: https://w3c.github.io/webappsec-credential-management/
[DISCOVERY-API]
    Rich Tibbett. ＜Network Service Discovery＞. URL: https://dvcs.w3.org/hg/dap/raw-file/tip/discovery-api/Overview.html
[ENCRYPTED-MEDIA]
    David Dorwin; et al. ＜Encrypted Media Extensions＞. URL: https://w3c.github.io/encrypted-media/
[FULLSCREEN]
    Philip Jägenstedt. ＜Fullscreen API Standard＞. Living Standard. URL: https://fullscreen.spec.whatwg.org/
[GEOLOCATION]
    Marcos Caceres; Reilly Grant. ＜Geolocation API＞. URL: https://w3c.github.io/geolocation-api/
[GEOLOCATION-API]
    Andrei Popescu. ＜Geolocation API Specification 2nd Edition＞. URL: https://w3c.github.io/geolocation-api/
[IndexedDB]
    Nikunj Mehta; et al. ＜Indexed Database API＞. URL: https://w3c.github.io/IndexedDB/
[MEDIACAPTURE-STREAMS]
    Cullen Jennings; et al. ＜Media Capture and Streams＞. URL: https://w3c.github.io/mediacapture-main/
[MIX]
    Emily Stark; Mike West; Carlos IbarraLopez. ＜Mixed Content＞. URL: https://w3c.github.io/webappsec-mixed-content/
[POWERFUL-NEW-FEATURES]
    Chrome Security Team. ＜Prefer Secure Origins For Powerful New Features＞. URL: https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features
[RFC6265]
    A. Barth. ＜HTTP State Management Mechanism＞. April 2011. Proposed Standard. URL: https://httpwg.org/specs/rfc6265.html
[RFC6761]
    S. Cheshire; M. Krochmal. ＜Special-Use Domain Names＞. February 2013. Proposed Standard. URL: https://www.rfc-editor.org/rfc/rfc6761
[RFC7258]
    S. Farrell; H. Tschofenig. ＜Pervasive Monitoring Is an Attack＞. May 2014. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc7258
[SECURING-WEB]
    Mark Nottingham. ＜Securing the Web＞. TAG Finding. URL: https://www.w3.org/2001/tag/doc/web-https
[SERVICE-WORKERS]
    Jake Archibald; Marijn Kruisselbrink. ＜Service Workers＞. URL: https://w3c.github.io/ServiceWorker/
[VERIZON]
    Mark Bergen; Alex Kantrowitz. ＜Verizon looks to target its mobile subscribers with ads＞. URL: http://adage.com/article/digital/verizon-target-mobile-subscribers-ads/293356/
[WEB-BLUETOOTH]
    Jeffrey Yasskin. ＜Web Bluetooth＞. URL: https://webbluetoothcg.github.io/web-bluetooth/
[WEBCRYPTOAPI]
    Mark Watson. ＜Web Cryptography API＞. URL: https://w3c.github.io/webcrypto/


●●trans_metadata
<p>
~THIS_PAGEは、~W3Cにより編集者草案として公開された
<a href="~SPEC_URL">Secure Contexts</a>
を日本語に翻訳したものです。
~PUB
</p>


●●spec_metadata

最新公表バージョン
	https://www.w3.org/TR/secure-contexts/
公表履歴
	https://www.w3.org/standards/history/secure-contexts/
編集者草案
	https://w3c.github.io/webappsec-secure-contexts/
commit 履歴
	https://github.com/w3c/webappsec-secure-contexts/commits/main/
フィードバック
	<span><a href="mailto:public-webappsec@w3.org?subject=%5Bsecure-contexts%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[secure-contexts] <i>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
	<a href="https://github.com/w3c/webappsec-secure-contexts/issues">GitHub</a>

実装報告
	https://wpt.fyi/results/secure-contexts
編集
	<a href="mailto:mkwst@google.com">Mike West</a> (Google Inc.)
前任編集者
	Yan Zhu (Brave)

Participate:
	<a href="https://github.com/w3c/webappsec-secure-contexts/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-secure-contexts/issues">open issues</a>)

公表者
	<a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>

</script>

</head>

<body>

<!--%resource pool -->
<template id="_persisted_parts">

<svg id="_dgm-fig-01" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://example.com/</text>
 </g>
</svg>

<svg id="_dgm-fig-02" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
 </g>
</svg>

<svg id="_dgm-fig-03" height="400" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://secure.example.com/</text>
 </g>
 <g transform="translate(10,210)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://another.example.com/</text>
 </g>
 <g>
  <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
 </g>
</svg>

<svg id="_dgm-fig-05" height="400" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
 </g>
 <g transform="translate(10,210)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://another.example.com/</text>
 </g>
 <g>
  <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
 </g>
</svg>


<svg id="_dgm-fig-06" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://sub.example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-07" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-08" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-09" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>


<svg id="_dgm-fig-10" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g transform="translate(400, 110)">
   <circle class="non-secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-11" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-12" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 -80"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-13" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
   <text class="rejection" transform="translate(405, 20)">X</text>
  </g>
 </g>
</svg>


<svg id="_dgm-fig-14" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g transform="translate(400, 110)">
   <circle class="non-secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
   <text class="rejection" transform="translate(405, 20)">X</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-15" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/service.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>

</template>

<header>
	<hgroup>
<h1>セキュアな文脈 — Secure Contexts</h1>
	</hgroup>
</header>

<div id="MAIN" hidden>
	<section id="abstract">
◎要約

<p>
この仕様は、
 “~secureな文脈” を定義する†。
それにより，［
一定の最小限な標準を成す［
認証と機密性
］が満たされるときに限り，ある種の特能を可能化する
］ことを［
~UAの実装者／仕様の策定者
］に許容する。
◎
This specification defines "secure contexts", thereby allowing user agent implementers and specification authors to enable certain features only when certain minimum standards of authentication and confidentiality are met.
</p>

<p class="trans-note">【†
定義していたが、
今や `HTML$r が`それを規範的に定義する＠#is-settings-object-contextually-secure$。
】</p>

	</section>
	<section id="sotd">
◎位置付け

<p>
これは、
編集者草案の公な複製です…
【以下、この節の内容は，~SOTD-W3Cに移譲。】
</p>

	</section>

<main id="MAIN0">

	<section id="intro">
<h2 title="Introduction">1. 序論</h2>

◎非規範的

<p>
~web~platformが拡張され，より有用かつ強力な応用が可能化されるに伴い、［
その種の応用を可能化する特能は、
最小限な~security~levelを満たす文脈に限り，可能化される
］ことを確保することが，ますます重要になっている。
この文書は
— `SECURING-WEB$r における TAG の推奨の拡張として —
~web上で特能を濫用する脅威~modelについて述べるとともに
（ `§ 脅威~model＠#threat-models$ を見よ）、
新たな特能を仕様化している文書に組入れるべき，規範的~要件について要旨する
（ `§ 実装にあたっての考慮点＠#implementation-considerations$ を見よ）。
◎
As the web platform is extended to enable more useful and powerful applications, it becomes increasingly important to ensure that the features which enable those applications are enabled only in contexts which meet a minimum security level. As an extension of the TAG’s recommendations in [SECURING-WEB], this document describes threat models for feature abuse on the web (see § 4.1 Threat Models) and outlines normative requirements which should be incorporated into documents specifying new features (see § 7 Implementation Considerations).
</p>

<p>
ここで論じられる要件のうち，最も明白なものは、
敏感あるいは私的な~dataへの~accessを伴う~app~codeが［
~data完全性を保証する認証-済み~channel越しに，機密的に送達される
］ことである。
~codeを~secureに送達することは、［
その~appが，利用者の~securityや~privacy要件を満たす
］ことを常に確保するわけではないが，必要yな前提条件である。
◎
The most obvious of the requirements discussed here is that application code with access to sensitive or private data be delivered confidentially over authenticated channels that guarantee data integrity. Delivering code securely cannot ensure that an application will always meet a user’s security and privacy requirements, but it is a necessary precondition.
</p>

<p>
もう少し明白でないことは、
~app~codeを認証-済みかつ機密的な~channel越しに送達するだけでは，［
強力な特能に対する ~secureでない文脈からの利用を制限するには，十分でない
］ことである。
`§ 先祖による~risk＠#ancestors$にて説明されるとおり、
協力的な~frameたちを濫用することにより，さもなければ堅固な［
特能に対する制約
］は迂回され得る。
以下に定義される各種~algoは、
これらの迂回を困難かつ利用者から可視にすることを確保する。
◎
Less obviously, application code delivered over an authenticated and confidential channel isn’t enough in and of itself to limit the use of powerful features by non-secure contexts. As § 4.2 Ancestral Risk explains, cooperative frames can be abused to bypass otherwise solid restrictions on a feature. The algorithms defined below ensure that these bypasses are difficult and user-visible.
</p>

<p>
以下に示す例に、
後述の規範的な~textを要約する：
◎
The following examples summarize the normative text which follows:
</p>

		<section id="examples-top-level">
<h3 title="Top-level Documents">1.1. ~top-level文書</h3>

<div class="example">
<p>
`~top-level閲覧~文脈$内に開いた
`http://example.com/^s
は、
認証-済みかつ暗号化された~channel越しに送達されてないので，`~secureな文脈$enVにならない。
◎
http://example.com/ opened in a top-level browsing context is not a secure context, as it was not delivered over an authenticated and encrypted channel.
</p>

`fig-01^dgm
</div>

<div class="example">
<p>
`~top-level閲覧~文脈$内に開いた
`https://example.com/^s
は、
認証-済みかつ暗号化された~channel越しに送達されたので，`~secureな文脈$enVになる。
◎
https://example.com/ opened in a top-level browsing context is a secure context, as it was delivered over an authenticated and encrypted channel.
</p>

`fig-02^dgm
</div>

<div class="example">
<p>
~secureな文脈が，新たな~window内に
`https://example.com/^s
を開いた場合、
その新たな~windowは，それ自体が~secureなので ~secureな文脈になる。
◎
If a secure context opens https://example.com/ in a new window, that new window will be a secure context, as it is secure on its own merits:
</p>

`fig-03^dgm
</div>

<div class="example">
<p>
同様に，
~secureでない文脈が新たな~window内に
`https://example.com/^s
を開いた場合、
その~windowは~secureになる
— それを開いた側が~secureでなかったとしても：
◎
Likewise, if a non-secure context opens https://example.com/ in a new window, that new window will be a secure context, even though its opener was non-secure:
</p>

`fig-05^dgm
</div>

		</section>
		<section id="examples-framed">
<h3 title="Framed Documents">1.2. ~frame内の文書</h3>

<p>
~frame内の文書は、
それが［
`信用に価し得る生成元$から送達されたものであって,
かつ`~secureな文脈$enV内に埋込まれている
］ならば，
`~secureな文脈$enVになれる。
すなわち：
◎
Framed documents can be secure contexts if they are delivered from potentially trustworthy origins, and if they’re embedded in a secure context. That is:
</p>

<div class="example">
<p>
`~top-level閲覧~文脈$内に開かれた
`https://example.com/^s
が，ある~frame内に
`https://sub.example.com/^s
を開いた場合、
両者とも，認証-済みかつ暗号化された~channel越しに送達されたので`~secureな文脈$enVになる。
◎
If https://example.com/ opened in a top-level browsing context opens https://sub.example.com/ in a frame, then both are secure contexts, as both were delivered over authenticated and encrypted channels. 
</p>

`fig-06^dgm
</div>

<div class="example">
<p>
`https://example.com/^s
が，どうにかして
`http://non-secure.example.com/^s
を~frame内に入れれた場合
（たぶん，利用者が混在~内容の検査-法を上書きしたがため？）、
~top-level~frameは~secureであり続けるが，~frame内の内容は~secureな文脈にならない。
◎
If https://example.com/ was somehow able to frame http://non-secure.example.com/ (perhaps the user has overridden mixed content checking?), the top-level frame would remain secure, but the framed content is not a secure context.
</p>

`fig-07^dgm
</div>

<div class="example">
<p>
一方で、
`http://non-secure.example.com/^s
の内側の~frame内に入れられた
`https://example.com/^s
は、
~secureな文脈に`ならない^em
— その先祖は、
認証-済みかつ暗号化された~channel越しに送達されてないので。
◎
If, on the other hand, https://example.com/ is framed inside of http://non-secure.example.com/, then it is not a secure context, as its ancestor is not delivered over an authenticated and encrypted channel.
</p>

`fig-08^dgm
</div>

		</section>
		<section id="examples-workers">
<h3 title="Web Workers">1.3. ~web~worker</h3>

<p>
`専用~worker$は、
その資質において~frame内の文書に類似する。
それは、［
`信用に価し得る生成元$から送達され, なおかつ
その所有者~自身も`~secureな文脈$enVである
］ときに限り，`~secureな文脈$enVになる：
◎
Dedicated Workers are similar in nature to framed documents. They’re secure contexts when they’re delivered from potentially trustworthy origins, only if their owner is itself a secure context:
</p>

<div class="example">
<p>
`~top-level閲覧~文脈$内の
`https://example.com/^s
が
`https://example.com/worker.js^s
を走らせた場合、
その文書, ~workerの両者とも`~secureな文脈$enVになる。
◎
If https://example.com/ in a top-level browsing context runs https://example.com/worker.js, then both the document and the worker are secure contexts.
</p>

`fig-09^dgm
</div>

<div class="example">
<p>
`~top-level閲覧~文脈$内の
`http://non-secure.example.com/^s
が
`https://example.com/^s
を~frame内に入れていて，後者が
`https://example.com/worker.js^s
を走らせた場合、
~frame内の文書, ~workerの両者とも，`~secureな文脈$enVにならない。
◎
If http://non-secure.example.com/ in a top-level browsing context frames https://example.com/, which runs https://example.com/worker.js, then neither the framed document nor the worker are secure contexts.
</p>

`fig-10^dgm
</div>

		</section>
		<section id="examples-shared-workers">
<h3 title="Shared Workers">1.4. 共用~worker</h3>

<div class="p">
<p>
`共用~worker$ %S は、
複数の文脈に添付され得る：
</p>

<ul>
	<li>
%S を作成したのが`~secureな文脈$enVならば、
%S は`~secureな文脈$enVになり，
%S が添付されてよい文脈は `~secureな文脈$enVに限られる。
</li>
	<li>
%S を作成したのが~secureでない文脈ならば、
%S は`~secureな文脈$enVには`ならず^em，
%S が添付されてよい文脈は ~secureでない文脈に限られる。
</li>
</ul>

◎
Multiple contexts may attach to a Shared Worker. If a secure context creates a Shared Worker, then it is a secure context, and may only be attached to by other secure contexts. If a non-secure context creates a Shared Worker, then it is not a secure context, and may only be attached to by other non-secure contexts.
</div>

<div class="example">
<p>
`~top-level閲覧~文脈$内の
`https://example.com/^s
が
`https://example.com/worker.js^s
を共用~workerとして走らせた場合、
その文書と~workerの両者とも，~secureな文脈と見なされる。
◎
If https://example.com/ in a top-level browsing context runs https://example.com/worker.js as a Shared Worker, then both the document and the worker are considered secure contexts.
</p>

`fig-11^dgm
</div>

<div class="example">
<p>
異なる`~top-level閲覧~文脈$内（例：新たな~window内）の
`https://example.com/^s
は，いずれも~secureな文脈になるので、
~secureな共用~workerに~accessできる：
◎
https://example.com/ in a different top-level browsing context (e.g. in a new window) is a secure context, so it may access the secure shared worker:
</p>

`fig-12^dgm
</div>

<div class="example">
<p>
`http://non-secure.example.com/^s
内に入子にされた
`https://example.com/^s
は、
~secureな文脈でないので，~secure~workerには接続できない：
◎
https://example.com/ nested in http://non-secure.example.com/ may not connect to the secure worker, as it is not a secure context.
</p>

`fig-13^dgm
</div>

<div class="example">
<p>
同様に、
`http://non-secure.example.com/^s
内に入子にされた
`https://example.com/^s
が，
`https://example.com/worker.js^s
を共用~workerとして走らせた場合、
その文書と~workerの両者とも~secureでないと見なされる。
◎
Likewise, if https://example.com/ nested in http://non-secure.example.com/ runs https://example.com/worker.js as a Shared Worker, then both the document and the worker are considered non-secure.
</p>

`fig-14^dgm
</div>

		</section>
		<section id="examples-service-workers">
<h3 title="Service Workers">1.5. ~sw</h3>

<p>
~swは、
常に`~secureな文脈$enVになる。
~swを登録できるのは，`~secureな文脈$enVに限られ、
~swの~clientもまた，`~secureな文脈$enVに限られる。
◎
Service Workers are always secure contexts. Only secure contexts may register them, and they may only have clients which are secure contexts.
</p>

<div class="example">
<p>
`~top-level閲覧~文脈$内の
`https://example.com/^s
が
`https://example.com/service.js^s
を登録した場合、
文書と~swの両者とも~secureな文脈と見なされる。
◎
If https://example.com/ in a top-level browsing context registers https://example.com/service.js, then both the document and the Service Worker are considered secure contexts.
</p>

`fig-15^dgm
</div>

		</section>
	</section>
	<section id="framework">
<h2 title="Framework">2. ~framework</h2>

◎非規範的

		<section id="integration-idl">
<h3 title="Integration with WebIDL">2.1. WebIDL との統合</h3>

<p>
［
~interface／~interface~member
］用には， [`SecureContext$] 拡張d属性が新たに可用にされている。
それは、
当の［
~interface／~member
］が，~secureな文脈に限り`公開され$ることを確保する。
次の例のように：
◎
A new [SecureContext] attribute is available for operators, which ensures that they will only be exposed into secure contexts. The following example should help:
</p>

<div class="example">
<pre class="idl">
interface ExampleFeature {
  /* <span class="comment">
この~callはすべての文脈で成功する。
◎
This call will succeed in all contexts.
</span> */
  Promise &lt;double&gt; calculateNotSoSecretResult();

  /* <span class="comment">
この演算は~secureでない文脈には公開されない。
◎
This operation will not be exposed to a non-secure context.
</span> */
  [`SecureContext$] Promise&lt;double&gt; calculateSecretResult();

  /* <span class="comment">
同様に次の演算も，~secureでない文脈には公開されない。
◎
The same applies here: the operation will not be exposed to a non-secure context.
</span> */
  [`SecureContext$] boolean getSecretBoolean();
};

[`SecureContext$] interface SecureFeature {
  /* <span class="comment">
この~interfaceは~secureでない文脈には公開されない。
◎
This interface will not be exposed to non-secure contexts.
</span> */
  Promise&lt;any&gt; doAmazingThing();
};

</pre>
</div>

<p>
仕様の策定者には、
新たな特能を定義するときは，この拡張d属性を利用することが奨励される。
◎
Specification authors are encouraged to use this attribute when defining new features.
</p>

		</section>
		<section id="monkey-patching-html">
<h3 title="Integrations with HTML">2.2. ~HTMLとの統合</h3>

			<section id="shared-workers">
<h4 title="Shared Workers">2.2.1. 共用~worker</h4>

<p>
`SharedWorker$I の構築子は、［
`~secureな文脈$enVが`~secureな文脈$enVでない~workerを添付しようと試みた
］とき, および［
~secureでない文脈が`~secureな文脈$enVである~workerを添付しようと試みた
］ときには、
`SecurityError$E 例外を投出することになる。
◎
The SharedWorker constructor will throw a "SecurityError" DOMException exception if a secure context attempts to attach to a Worker which is not a secure context, and if a non-secure context attempts to attach to a Worker which is a secure context.
</p>

			</section>
			<section id="monkey-patching-global-object">
<h4 title="Feature Detection">2.2.2. 特能の検出</h4>

<p>
~appは、
自身が`~secureな文脈$enV内で実行されているかどうかを，
`WindowOrWorkerGlobalScope$I に定義される
`isSecureContext＠~HTMLGAPI#dom-issecurecontext$c が返す真偽値を検査して決定できる。
◎
An application can determine whether it’s executing in a secure context by checking the isSecureContext boolean defined on WindowOrWorkerGlobalScope.
</p>

			</section>
			<section id="is-settings-object-contextually-secure">
<h4 title="Secure and non-secure contexts">2.2.3. ~secureな文脈と~secureでない文脈</h4>

<p id="secure-contexts">
所与の`環境$が`~secureな文脈$enVになるかどうかは、
~HTML標準 `HTML$r が定義する。
これは、
他の仕様から利用される首な仕組みである。
◎
The HTML Standard defines whether an environment is a secure context or a non-secure context. This is the primary mechanism used by other specifications.
</p>

<p>
各~仕様は、
所与の`大域~obj$に対し，それに`関連な設定群~obj$（それは`環境$でもある）が`~secureな文脈$enVかどうかを検査できる。
◎
Given a global object, specifications can check whether its relevant settings object (which is an environment) is a secure context.
</p>

			</section>
		</section>
	</section>
	<section id="algorithms">
<h2 title="Algorithms">3. 各種~algo</h2>

		<section id="is-origin-trustworthy">
<h3 title="Is origin potentially trustworthy?">3.1. 生成元は信用に価し得るか? </h3>

<p>
`信用に価し得る生成元@
（ `potentially trustworthy origin^en ）とは、
~dataは~secureに送達されているものと，~UAが一般に信用できるものである。
◎
A potentially trustworthy origin is one which a user agent can generally trust as delivering data securely.
</p>

<p>
この節に与える~algoは、
ある種の［
~host ／ ~scheme ／ 生成元
］
— 伝統的な感覚では［
認証され, かつ暗号化されるもの
］ではないかもしれないそれら —
に対しても，信用に価し得ると見なす。
特に，~UAは、
`file^sc ~URLを信用に価し得るものと扱うべきである。
原則的には、
~UAは，局所~fileを信用に価しないものと扱うこともできるが、
`~UAに可用な情報が稼働時に与えられている下では^em，資源は~diskから~UAに~secureに~transportされたように現れる。
加えて，公共に配備する前の~appを築いている開発者にとっては、
そのような資源を信用に価し得るものと扱えた方が，簡便になる。
◎
This algorithms considers certain hosts, scheme, and origins as potentially trustworthy, even though they might not be authenticated and encrypted in the traditional sense. In particular, the user agent SHOULD treat file URLs as potentially trustworthy. In principle the user agent could treat local files as untrustworthy, but, given the information that is available to the user agent at runtime, the resources appear to have been transported securely from disk to the user agent. Additionally, treating such resources as potentially trustworthy is convenient for developers building an application before deploying it to the public.
</p>

<p>
しかしながら、
この開発者への親切さに~riskがないわけではない。
そのような作り込みより~securityを優先する~UAは、
より厳密に，
`file^sc を除外する仕方で信用をアテガってもヨイ。
◎
This developer-friendlyness is not without risk, however. User agents which prioritize security over such niceties MAY choose to more strictly assign trust in a way which excludes file.
</p>

<p>
他方、
~UAは，この信用を，自身が`先天的に^em信用-済みであると決定できる他の~URL~scheme
— `app^sc や `chrome-extension^sc の様な~vendorに特有な~URL~scheme —
にまで拡張してもヨイ
（詳細は、
`§ ~package化~app＠#packaged-applications$ を見よ）。
◎
On the other hand, the user agent MAY choose to extend this trust to other, vendor-specific URL schemes like app: or chrome-extension: which it can determine a priori to be trusted (see § 7.1 Packaged Applications for detail).
</p>

<div class="algo">
<p>
次の~algoは、
所与の
( `生成元$ %生成元 )
に対し，信用に［
`価し得る^i ／ `価しない^i
］いずれか適切な方を返す：
◎
Given an origin (origin), the following algorithm returns "Potentially Trustworthy" or "Not Trustworthy" as appropriate.
</p>
<ol>
	<li>
~IF［
%生成元 は`不透明な生成元$である
］
⇒
~RET `価しない^i
◎
If origin is an opaque origin, return "Not Trustworthy".
</li>
	<li>
~Assert：
%生成元 は`成分組~生成元$である
◎
Assert: origin is a tuple origin.
</li>
	<li>
( %~scheme, %~host ) ~LET %生成元 の ( `~scheme$, `~host$ )
◎
↓</li>
	<li>
<p>
~IF［
~OR↓
］
⇒
~RET `価し得る^i：
◎
↓</p>
		<ul>
			<li>
<p>
%~scheme ~IN { `https^l, `wss^l }
◎
If origin’s scheme is either "https" or "wss", return "Potentially Trustworthy".
</p>

<p class="note">注記：
これは、
`MIX$r における`先天的に認証-済み~URL$の概念に相似するよう意味されている。
◎
Note: This is meant to be analog to the a priori authenticated URL concept in [MIX].
</p>
			</li>
			<li>
%~host は，
CIDR 記法による［
`127.0.0.0/8^c, `::1/128^c
］いずれかに合致する
`RFC4632$r
◎
If origin’s host matches one of the CIDR notations 127.0.0.0/8 or ::1/128 [RFC4632], return "Potentially Trustworthy".
</li>
			<li>
<p>
［
~UAは `let-localhost-be-localhost$r による名前~解決 規則に適合する
］~AND［
~OR↓
］
⇒＃
%~host ~IN { `localhost^l, `localhost.^l } ／
%~host は `.localhost^l または `.localhost.^l で終端する
◎
If the user agent conforms to the name resolution rules in [let-localhost-be-localhost] and one of the following is true:
• origin’s host is "localhost" or "localhost."
• origin’s host ends with ".localhost" or ".localhost."
then return "Potentially Trustworthy".
</p>

<p class="note">注記：
この要件の詳細は、
`§ ~localhost＠#localhost$ を見よ。
◎
Note: See § 5.2 localhost for details on the requirements here.
</p>
			</li>
			<li>
%~scheme ~EQ `file^l
◎
If origin’s scheme is "file", return "Potentially Trustworthy".
</li>
			<li>
<p>
%~scheme は ~UAが認証-済みと見なすものである
◎
If origin’s scheme component is one which the user agent considers to be authenticated, return "Potentially Trustworthy".
</p>

<p class="note">注記：
詳細は
`§ ~package化~app＠#packaged-applications$ を見よ。
◎
Note: See § 7.1 Packaged Applications for detail here.
</p>
			</li>
			<li>
<p>
%生成元 は 信用に価するものと環境設定されている
◎
If origin has been configured as a trustworthy origin, return "Potentially Trustworthy".
</p>

<p class="note">注記：
詳細は
`§ 開発~環境＠#development-environments$ を見よ。
◎
Note: See § 7.2 Development Environments for detail here.
</p>
			</li>
		</ul>
	</li>
	<li>
~RET `価しない^i
◎
Return "Not Trustworthy".
</li>
</ol>
</div>

<p class="note">注記：
%生成元 の［
`~domain$, `~port$
］は、
いずれも，`~secureな文脈$enVと見なされるかどうかには効果はない。
◎
Note: Neither origin’s domain nor port has any effect on whether or not it is considered to be a secure context.
</p>

		</section>
		<section id="is-url-trustworthy">
<h3 title="Is url potentially trustworthy? ">3.2. ~URLは信用に価し得るか？</h3>

<div class="algo">
<p>
`信用に価し得る~URL@
とは、
作成元から文脈を継承する（
`about:blank^l ／ `about:srcdoc^l ／ `data:…^l
）か，または［
その`生成元$urlは`信用に価し得る生成元$である
］~URLである。
所与の
( `~URL~record$ %~URL )
は、
次の~algoが［
`価し得る^i ／ `価しない^i
］を返すならば，`信用に価し得る~URL$［
である／でない
］とされる：
◎
A potentially trustworthy URL is one which either inherits context from its creator (about:blank, about:srcdoc, data) or one whose origin is a potentially trustworthy origin. Given a URL record (url), the following algorithm returns "Potentially Trustworthy" or "Not Trustworthy" as appropriate:
</p>
<ol>
	<li>
~IF［
%~URL ~IN { `about:blank^l, `about:srcdoc^l }
］
⇒
~RET `価し得る^i
◎
If url is "about:blank" or "about:srcdoc", return "Potentially Trustworthy".
</li>
	<li>
~IF［
%~URL の`~scheme$url ~EQ `data^l
］
⇒
~RET `価し得る^i
◎
If url’s scheme is "data", return "Potentially Trustworthy".
</li>
	<li>
<p>
~RET `生成元は信用に価し得るか？$( %~URL の`生成元$url )
◎
Return the result of executing § 3.1 Is origin potentially trustworthy? on url’s origin.
</p>

<p class="note">注記：
`blob^sc ~URLの生成元は、
それを作成した文脈の生成元になる。
したがって，信用に価する生成元~内で作成された~blobは、
それ自体も信用に価し得ることになる。
◎
Note: The origin of blob: URLs is the origin of the context in which they were created. Therefore, blobs created in a trustworthy origin will themselves be potentially trustworthy.
</p>
	</li>
</ol>
</div>

		</section>
	</section>
	<section id="threat-models-risks">
<h2 title="Threat models and risks ">4. 脅威~modelとその~risk</h2>

◎非規範的

		<section id="threat-models">
<h3 title="Threat Models">4.1. 脅威~model</h3>

<p>
未認証の生成元に対し許可を是認することは、
~network攻撃者が現に居れば，任意の生成元に対し許可を是認することに等価になる。
Internet においては、
そのような~network攻撃者は，現に居ると見做さなければナラナイ。
一般に，~network攻撃者は、
受動的, 能動的の 2 つに分類される。
◎
Granting permissions to unauthenticated origins is, in the presence of a network attacker, equivalent to granting the permissions to any origin. The state of the Internet is such that we must indeed assume that a network attacker is present. Generally, network attackers fall into 2 classes: passive and active.
</p>

			<section id="threat-passive">
<h4 title="Passive Network Attacker">4.1.1. 受動的~network攻撃者</h4>

<p>
“受動的~network攻撃者” は、
流通~flowを観測できるが，この仕様が懸念する層における流通を 改変する~~能を欠くか, 改変しないことにした者である。
◎
A "Passive Network Attacker" is a party who is able to observe traffic flows but who lacks the ability or chooses not to modify traffic at the layers which this specification is concerned with.
</p>

<p>
この方式による~networkの調査は、
“通信している当の主体の合意なしに，彼らの意図をないがしろにする”
ものであり，
“他の行為者による監視を許容している者は
— そのような監視を誰が どの程度 善意であると見なすかを問わず —
ほとんどの無法な行為者に抗して防御できない”
ことを指す。
`RFC7258$r
したがって，この文書に定義される~algoは、
単純に完全性のみならず，~app層における~dataの~privacyを供する仕組みも要求する。
◎
Surveillance of networks in this manner "subverts the intent of communicating parties without the agreement of these parties" and one "cannot defend against the most nefarious actors while allowing monitoring by other actors no matter how benevolent some might consider them to be." [RFC7258] Therefore, the algorithms defined in this document require mechanisms that provide for the privacy of data at the application layer, not simply integrity.
</p>

			</section>
			<section id="threat-active">
<h4 title="Active Network Attacker">4.1.2. 能動的~network攻撃者</h4>

<p>
“能動的~network攻撃者” は、
“受動的~network攻撃者” が有する能力に加え，~networkを通過している~dataを［
改変- ／ 阻止- ／ 再現-
］できる者である。
これらの能力は、
多くの~levelで敵対者に可用になる
— 公共~無線~network内で［
提供している ／ 単純に関与している
］ような弱体化された機器から，金銭的利益の流通を操作していながら ~securityや~privacyの脆弱性を間接的に導入している ISP
（最近の例として、 `VERIZON$r や `COMCAST$r が挙げられる）
まで、
果ては［
個々の利用者／組織／団体／あらゆる人々
］でさえ~targetにできるような，~securityや~privacyを弱体化する意図を指図する主体までにわたる。
◎
An "Active Network Attacker" has all the capabilities of a "Passive Network Attacker" and is additionally able to modify, block or replay any data transiting the network. These capabilities are available to potential adversaries at many levels of capability, from compromised devices offering or simply participating in public wireless networks, to Internet Service Providers indirectly introducing security and privacy vulnerabilities while manipulating traffic for financial gain ([VERIZON] and [COMCAST] are recent examples), to parties with direct intent to compromise security or privacy who are able to target individual users, organizations or even entire populations.
</p>

			</section>
		</section>
		<section id="ancestors">
<h3 title="Ancestral Risk">4.2. 先祖による~risk</h3>

<p>
`~secureな文脈$enVかどうか決定する~algoは、
それを決定する際に，当の文脈のすべての先祖を巡回する。
なぜ、
文書は `iframe$e 内に~secureに送達されたこと自体では，~secureと見なされないのか？
◎
The secure context algorithm walks through all the ancestors of a particular context in order to determine whether or not the context itself is secure. Why wouldn’t we consider a securely-delivered document in an iframe to be secure, in and of itself?
</p>

<p>
短く答えるなら、
その~modelでは濫用-が可能化されるからである。
Chrome による
`WEBCRYPTOAPI$r 実装による，~APIを~secureな文脈に~lockする早期の実験では、
文脈の先祖を巡回していなかった。
そこでは、
~APIを，自身が~secureに送達された資源に~lockすることで、
~secureな用法は十分に確保されると見做していた。
しかしながらその結果は、
~APIを~secureでない文脈に公開するような［
`iframe$e と `postMessage()＠~HTMLcomms#dom-window-postmessage$c
］に基づく~shimを築いた Netflix の様な実体であった。
その制約は、
~APIへの~secureでない~accessを段差舗装より少しばかり遅くするものであったが、
その種の~accessを防止するには，何ら効果がなかった。
◎
The short answer is that this model would enable abuse. Chrome’s implementation of [WEBCRYPTOAPI] was an early experiment in locking APIs to secure contexts, and it did not walk through a context’s ancestors. The assumption was that locking the API to a resource which was itself delivered securely would be enough to ensure secure usage. The result, however, was that entities like Netflix built iframe- and postMessage()-based shims that exposed the API to non-secure contexts. The restriction was little more than a speed-bump, slowing down non-secure access to the API, but completely ineffective in preventing such access.
</p>

<p>
この文書における~algoは，~secureでない文脈を`~secureな文脈$enVから完璧には隔離しないが
（ `§ 不完全な隔離＠#isolation$ を見よ）、
先祖の検査は，相応に堅牢な
— そのような文脈に供されるべき［
認証, 機密性, 完全性
］を保証するような —
保護を供する。
◎
While the algorithms in this document do not perfectly isolate non-secure contexts from secure contexts (as discussed in § 5.1 Incomplete Isolation), the ancestor checks provide a fairly robust protection for the guarantees of authentication, confidentiality, and integrity that such contexts ought to provide.
</p>

		</section>
		<section id="threat-risks">
<h3 title="Risks associated with non-secure contexts">4.3. ~secureでない文脈に結付けられる~risk</h3>

<p>
利用者の~securityや~privacyに独特な影響iを及ぼすような，ある種の~web~platform特能は、
上述の脅威に抗して防御するため，`~secureな文脈$enVに限って可用にされるべきである。
~secureでない文脈にて可用な特能は、
その能力を~network攻撃者に公開する~riskがある：
◎
Certain web platform features that have a distinct impact on a user’s security or privacy should be available for use only in secure contexts in order to defend against the threats above. Features available in non-secure contexts risk exposing these capabilities to network attackers:
</p>
<ol>
	<li>
敏感な~data（個人を特定する情報, 資格証, 対外支払い法, 等々）を読取る／改変する能
`CREDENTIAL-MANAGEMENT-1$r
は、
敏感な~dataを取扱う~APIの例である。
◎
The ability to read and modify sensitive data (personally-identifying information, credentials, payment instruments, and so on). [CREDENTIAL-MANAGEMENT-1] is an example of an API that handles sensitive data.
</li>
	<li>
利用者の機器~上の~sensorからの入力を［
読取る／改変する
］能（特に ~camera, ~microphone, GPS が挙げられるが、
そこまで危険に見えない加速度計の様な~sensorも，間違いなく含まれる）。
`GEOLOCATION-API$r, `MEDIACAPTURE-STREAMS$r
は、
~sensor入力を利用する特能の歴史的な例である。
◎
The ability to read and modify input from sensors on a user’s device (camera, microphone, and GPS being particularly noteworthy, but certainly including less obviously dangerous sensors like the accelerometer). [GEOLOCATION-API] and [MEDIACAPTURE-STREAMS] are historical examples of features that use sensor input.
</li>
	<li>
利用者が~accessを有する他の機器についての情報に~accessする能。
格好な例として，
`DISCOVERY-API$r, `WEB-BLUETOOTH$r
が挙げられる。
◎
The ability to access information about other devices to which a user has access. [DISCOVERY-API] and [WEB-BLUETOOTH] are good examples.
</li>
	<li>
利用者が一時的または持続的に利用している識別子を追跡する能
— 次に挙げるものが含まれる
⇒＃
ある期間後に自身を設定し直す識別子（例： `sessionStorage＠~WEBSTORAGE#the-sessionstorage-attribute$c ）／
利用者が手動で設定し直せる識別子（例： `ENCRYPTED-MEDIA$r, ~cookie `RFC6265$r, `IndexedDB$r ）／
利用者が容易に設定し直せない~hardware特能を識別するもの
◎
The ability to track users using temporary or persistent identifiers, including identifiers which reset themselves after some period of time (e.g. window.sessionStorage), identifiers the user can manually reset (e.g. [ENCRYPTED-MEDIA], Cookies [RFC6265], and [IndexedDB]), as well as identifying hardware features the user can’t easily reset.
</li>
	<li>
生成元に何らかの［
閲覧~sessionを超えて持続化する状態
］を導入する能。
特に， `SERVICE-WORKERS$r が挙げられる。
◎
The ability to introduce some state for an origin which persists across browsing sessions. [SERVICE-WORKERS] is a great example.
</li>
	<li>
~UAの~native~UIを何らかの仕方で操作する能
— それらの文脈に関連な詳細~に対する利用者の理解を［
除去する／遮る／操作する
］ような。
格好な例として， `FULLSCREEN$r が挙げられる。
◎
The ability to manipulate a user agent’s native UI in some way which removes, obscures, or manipulates details relevant to a user’s understanding of their context. [FULLSCREEN] is a good example.
</li>
	<li>
利用者に許可を要求するような何らかの機能性を導入する能。
◎
The ability to introduce some functionality for which user permission will be required.
</li>
</ol>

<p>
上の~listは網羅的ではないが、［
仕様を書いたり実装するときに考慮すべき~risk
］の型について，感触を与えるであろう。
◎
This list is non-exhaustive, but should give you a feel for the types of risks we should consider when writing or implementing specifications.
</p>

<p class="note">注記：
特能~自身を`~secureな文脈$enVに制約することが~criticalである一方で、
そのような情報を運ぶ便宜性
（~network~accessの新たな仕組み, その他，~network~dataへの~accessを伴う汎用な関数など）
も等しく敏感であることを，忘れるべきでない。
◎
Note: While restricting a feature itself to secure contexts is critical, we ought not forget that facilities that carry such information (such as new network access mechanisms, or other generic functions with access to network data) are equally sensitive.
</p>

		</section>
	</section>
	<section id="security-considerations">
<h2 title="Security Considerations">5. ~securityの考慮点</h2>

		<section id="isolation">
<h3 title="Incomplete Isolation">5.1. 不完全な隔離</h3>

<p>
この文書における~secureな文脈の定義は、
ある生成元~上の “~secureな” ~viewを
同じ生成元~上の “~secureでない” ~viewから完全には隔離しない。
`exfiltration^en 【外部への “裏口通信” 】 は、
依然として，見え難い部分を次第に拡げていくような仕組み
— `localStorage＠~WEBSTORAGE#the-localstorage-attribute$c や `sessionStorage＠~WEBSTORAGE#the-sessionstorage-attribute$c の内容,
`storage$et ~event,
`BroadcastChannel$I,
その他など —
を介してアリになる。
◎
The secure context definition in this document does not completely isolate a "secure" view on an origin from a "non-secure" view on the same origin. Exfiltration will still be possible via increasingly esoteric mechanisms such as the contents of localStorage/sessionStorage, storage events, BroadcastChannel, and others.
</p>

		</section>
		<section id="localhost">
<h3 title="localhost">5.2. ~localhost</h3>

<p>
`RFC6761$r の§ 6.3 では、
`localhost.^l や `.localhost.^l に類する名前の解決は特別であり、
局所~解決器は，それらを特別に［
扱うベキ／扱ってもヨイ
］ものと示唆している。
善悪は別として、
解決器は，いくつかの状況下で［
この示唆を無視して，~localhostを解決するために~networkへ送信する
］ことが多い。
◎
Section 6.3 of [RFC6761] lays out the resolution of localhost. and names falling within .localhost. as special, and suggests that local resolvers SHOULD/MAY treat them specially. For better or worse, resolvers often ignore these suggestions, and will send localhost to the network for resolution in a number of circumstances.
</p>

<p>
そのような不確かさをふまえ，~UAは、［
`let-localhost-be-localhost$r による~localhost名前~解決 規則
］を固守する場合
（それは、~localhostは，決して非~loopback~addressに解決されないことを確保する）,
その場合に限り，~localhost名を信用に価し得る生成元と扱ってもヨイ。
◎
Given that uncertainty, user agents MAY treat localhost names as having potentially trustworthy origins if and only if they also adhere to the localhost name resolution rules spelled out in [let-localhost-be-localhost] (which boil down to ensuring that localhost never resolves to a non-loopback address).
</p>

		</section>
	</section>
	<section id="privacy-considerations">
<h2 title="Privacy Considerations">6. ~privacyの考慮点</h2>

<p>
この文書における~secureな文脈の定義は、
それ自体には，~privacyへの影響iはない。
しかしながら，それは、［［［［
完全性, 認証性, 機密性
］に関して特定の保証を確保するような文脈
］の中へ，自身を~lockする
］ような，［
関心を引く~privacy上の含意
］が~~実際にある，他の特能
］を可能化する。
◎
The secure context definition in this document does not in itself have any privacy impact. It does, however, enable other features which do have interesting privacy implications to lock themselves into contexts which ensures that specific guarantees can be made regarding integrity, authenticity, and confidentiality.
</p>

<p>
~privacyの観点からは、
仕様の策定者には，［
自身が定義する特能に対し，~secureな文脈を要求する
］ことを考慮することが奨励される。
◎
From a privacy perspective, specification authors are encouraged to consider requiring secure contexts for the features they define.
</p>

	</section>
	<section id="implementation-considerations">
<h2 title="Implementation Considerations">7. 実装にあたっての考慮点</h2>

		<section id="packaged-applications">
<h3 title="Packaged Applications">7.1. ~package化~app</h3>

<p>
~package化された~appを~supportする~UAは、［
~UAにより認証-済みな内容を伴うような，特定の~URL~scheme
］を “~secure” と見なしてもヨイ。
例えば， FirefoxOS ~appの資源は、
`app^sc `~scheme$urlの~URLで指される。
同様に， Chrome の拡張／~appは、
`chrome-extension^sc ~schemeに住まう。
これらを信用-済みな生成元と見なすのが，適理なこともある。
◎
A user agent that support packaged applications MAY consider as "secure" specific URL schemes whose contents are authenticated by the user agent. For example, FirefoxOS application resources are referred to by a URL whose scheme component is app:. Likewise, Chrome’s extensions and apps live on chrome-extension: schemes. These could reasonably be considered trusted origins.
</p>

		</section>
		<section id="development-environments">
<h3 title="Development Environments">7.2. 開発~環境</h3>

<p>
~loopbackでない~host上で試験用~serverを走らす開発者を~supportするため、
~UAは，特定の［
生成元の集合
］を
— それらに対する `生成元は信用に価し得るか？$が，通常は `価しない^i を返すとしても —
信用に価するものと，利用者が環境設定できるようにしてもヨイ。
◎
In order to support developers who run staging servers on non-loopback hosts, the user agent MAY allow users to configure specific sets of origins as trustworthy, even though § 3.1 Is origin potentially trustworthy? would normally return "Not Trustworthy".
</p>

		</section>
		<section id="new">
<h3 title="Restricting New Features">7.3. 新たな特能の制約-法</h3>

◎非規範的

<p>
新たな特能~用の仕様を書く策定者／編集者には、［
~secureな文脈に対する検査により，敏感な~APIを防護する
］ことが推奨される。
例えば、
次の様に書く所から始めるのが良いであろう：
◎
When writing a specification for new features, we recommend that authors and editors guard sensitive APIs with checks against secure contexts. For example, something like the following might be a good approach:
</p>

<div class="example">
<ol>
	<li>
<p>
~IF［
`現在の設定群~obj$は`~secureな文脈$enVでない
］：
◎
If the current settings object is not a secure context, then:
</p>
		<ol>
			<li>
<p>
＜ここに何か適切なものを挿入する＞
— たぶん、
次に挙げるものなど：
</p>

<ul ><li>`Promise^I を `SecurityError^E で却下する,
</li><li>~error用の~callbackを~callする,
</li><li>何かの許可~要請を否認する, 等々。
</li></ul>

◎
[insert something appropriate here: perhaps a Promise could be rejected with a SecurityError, an error callback could be called, a permission request denied, etc.].
</li>
		</ol>
	</li>
</ol>
</div>

<p>
別法として，策定者は、
敏感な~APIを次のように [`SecureContext$] 拡張d属性で防護して，`~secureな文脈$enVに限り公開されるよう確保することもできる：
◎
Authors could alternatively ensure that sensitive APIs are only exposed to secure contexts by guarding them with the [SecureContext] attribute.
</p>

<div class="example">
<pre class="idl">
[`SecureContext$]
interface SensitiveFeature {
  Promise&lt;double&gt; getTheSecretDouble();
};

// <span class="comment">あるいは：</span>

interface AnotherSensitiveFeature {
  [`SecureContext$] undefined doThatPowerfulThing();
};

</pre>
</div>

		</section>
		<section id="legacy">
<h3 title="Restricting Legacy Features">7.4. 旧来の特能の制約-法</h3>

◎非規範的

<p>
上述の~listには、
明瞭に，現在は~secureでない~channel越しでも~webに可用な，既存の機能性も含まれている。
そのような旧来の機能性は、
適理にアリな限り，早急に`~secureな文脈$enVを要求し始めるよう改変する `W3C-PROCESS$r
ことが推奨される
— そのような特能が：
◎
The list above clearly includes some existing functionality that is currently available to the web over non-secure channels. We recommend that such legacy functionality be modified to begin requiring a secure context as quickly as is reasonably possible [W3C-PROCESS].
</p>

<dl class="switch">
	<dt>広範に実装されていない場合：</dt>
	<dd>
即時に、
`~secureな文脈$enVへの制約を含むよう，仕様を`改変する$xことが推奨される。
◎
If such a feature is not widely implemented, we recommend that the specification be immediately modified to include a restriction to secure contexts.
</dd>

	<dt>広範に実装されているが，まだ広範には利用されていない場合：</dt>
	<dd>
早急に、
`§ 新たな特能の制約-法＠#new$ に述べた検査を既存の実装に追加して，
`~secureな文脈$enVに制約した上で、
それに則って仕様も`改変する$xことが推奨される。
◎
If such a feature is widely implemented, but not yet in wide use, we recommend that it be quickly restricted to secure contexts by adding a check as described in § 7.3 Restricting New Features to existing implementations, and modifying the specification accordingly.
</dd>

	<dt>広範に利用されている場合：</dt>
	<dd>
非推奨にすることが推奨される。
すなわち，当の仕様を，この文書に要旨した制約に適合しないことを注記するように`改変する$xことに加えて、
特能の適合t~versionを提供して，既存の利用者をその新たな~versionに移行してもらう計画が開発されるべきである。
◎
If such a feature is in wide use, we recommend that the existing functionality be deprecated; the specification should be modified to note that it does not conform to the restrictions outlined in this document, and a plan should be developed to both offer a conformant version of the feature and to migrate existing users into that new version.
</dd>
</dl>

			<section id="legacy-example">
<h4 title="Example: Geolocation">7.4.1. 例： Geolocation</h4>

<p>
`GEOLOCATION-API$r
は、
そのような特能の格好な具象-例である。
それは、
広範に実装され，多数の~secureでない~siteで利用されている。
適理な移行過程は、
次の様になるであろう：
◎
The [GEOLOCATION-API] is a good concrete example of such a feature; it is widely implemented and used on a large number of non-secure sites. A reasonable path forward might look like this:
</p>
<ol>
	<li>
<p>
`~secureな文脈$enVに対する検査を含めるように，仕様~内の［
`getCurrentPosition()＠~GEOLOCATION#dom-geolocation-getcurrentposition$c ／
`watchPosition()＠~GEOLOCATION#dom-geolocation-watchposition$c
］~algoを実行する前の箇所に次を挿入するように`改変する$x：
◎
Modify the specification to include checks against secure context before executing the algorithms for getCurrentPosition() and watchPosition().
</p>

<div class="p">
		<ol>
			<li>
<p>
~UAは次を走らすべきである：
</p>
				<ol>
					<li>
<p>
~IF［
`現在の設定群~obj$は`~secureな文脈$enVでない
］：
</p>
						<ol>
							<li>
渡された %errorCallback を呼出す
— 次のようにされた新たな `PositionError^I ~objを渡して
⇒
`code^c 属性 ~SET `PERMISSION_DENIED^c
</li>
							<li>
~RET
</li>
						</ol>
					</li>
				</ol>
			</li>
		</ol>

◎
If the current settings object is not a secure context, then the algorithm should be aborted, and the errorCallback invoked with a code of PERMISSION_DENIED.
</div>
	</li>
	<li>
~UAは、［
~secureでない文脈に対しては、
~APIを特定の日付にて不能化すること
］の明瞭な意図nを公告した上で、
それに則って開発者にも（例えば ~console~messageを介して）警告するべきである。
◎
The user agent should announce clear intentions to disable the API for non-secure contexts on a specific date, and warn developers accordingly (via console messages, for example).
</li>
	<li>

<p>
~UAは、
その日が来る前に，非推奨化についての期日を公告して、［
~site作者に，~codeが道連れに機能停止する前に改変する必要を認識してもらう
］こと, および［
さしあたり，利用者を保護する
］ことを確保するべきである。
そのような計画は、
次のうちいくつかを含むであろう：
◎
Leading up to the flag day, the user agent should announce a deprecation schedule to ensure both that site authors recognize the need to modify their code before it simply stops working altogether, and to protect users in the meantime. Such a plan might include any or all of:
</p>

		<ul>
			<li>
~secureでない生成元を是認するような持続的な許可は、
許容しない。
◎
Disallowing persistent permission grants to non-secure origins
</li>
			<li>
~secureでない生成元に対しては、
~APIの正確度を粗くする
（たぶん，地番~levelでなく府県~levelの~dataを一貫して返すようにするなど）。
◎
Coarsening the accuracy of the API for non-secure origins (perhaps consistently returning city-level data rather than high-accuracy data)
</li>
			<li>
利用者や~site作者に~riskを伝えるような，~UIの改変。
◎
UI modifications to inform users and site authors of the risk
</li>
		</ul>
	</li>
</ol>

			</section>
		</section>
	</section>
	<section id="acknowledgements">
<h2 title="Acknowledgements">8. 謝辞</h2>

<p>
この文書は、
Chrome Security ~teamによる
`POWERFUL-NEW-FEATURES$r に対する作業に大きく基づいている。
特に，従事されていた
`Chris Palmer, Ryan Sleevi, David Dorwin^en
各氏に。
とりわけ参考になる~feedbackを寄せられた
`Anne van Kesteren, Jonathan Watt, Boris Zbarsky, Henri Sivonen^en
各氏にも。
◎
This document is largely based on the Chrome Security team’s work on [POWERFUL-NEW-FEATURES]. Chris Palmer, Ryan Sleevi, and David Dorwin have been particularly engaged. Anne van Kesteren, Jonathan Watt, Boris Zbarsky, and Henri Sivonen have also provided very helpful feedback.
</p>
	</section>
</main></div>
