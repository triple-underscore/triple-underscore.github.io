<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Screen Wake Lock APIï¼ˆæ—¥æœ¬èªè¨³ï¼‰</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-w3c.css" type="text/css">

<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		toc_main: 'MAIN0',
		generate: expand
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~ä¸€-é¿†ã‚-ã‚“]+|`(.+?)([$@\^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){

if(!key) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('ï¼ ');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r': // ref
	text = `[${key}]`;
	href = `#bib-${key.toLowerCase()}`;
	break;
case 'l': // literal
	text = `"<code class="literal">${text}</code>"`;
	break;
case 't': // typedef
	text = `&lt;${key}&gt;`;
	break;
case 'm':
	const n = text.indexOf('(');
	if(n > 0){
		key = text.slice(0, n);
		text = key + text.slice(n).replace(/\w+/g, '<var>$&</var>');
	}
	break;
case 'sl':
	text = `[[${text}]]`;
	break;
case 'wpt':
	href1 = `https://wpt.live/screen-wake-lock/${key}.html`;
	text = key.replace(/\..*/, '');
	if(/\.https\b/.test(key)){
		text += ' <span aria-label="ã‚»ã‚­ãƒ¥ã‚¢ãªæ¥ç¶šãŒè¦æ±‚ã•ã‚Œã‚‹ï¼requires a secure connection" title="ã“ã®ãƒ†ã‚¹ãƒˆã«ã¯ HTTPS ãŒè¦æ±‚ã•ã‚Œã‚‹ï¼Test requires HTTPS">ğŸ”’</span>';
	}
	if(/-manual\b/.test(key)){
		text += ' <span aria-label="ã“ã®ãƒ†ã‚¹ãƒˆã¯æ‰‹å‹•ã§èµ°ã‚‰ã™å¿…è¦ãŒã‚ã‚‹ï¼the test must be run manually" title="æ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼Manual test">ğŸ’ª</span>';
	}
	break;
case 'en':
	text = `<span lang="en">${key}</span>`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;


	}
}

</script>


<script type="text/plain" id="_source_data">


â—â—options

spec_title:Screen Wake Lock API
spec_date:2024-10-24
trans_update:2024-05-28
source_checked:231107
spec_status:ED
original_url:https://w3c.github.io/screen-wake-lock/
	abbr_url:SCREEEN-WAKELOCK
ref_id_prefix:bib-
ref_id_lowercase:true
site_nav:uievents
ref_id_lowercase:true
copyright:2024,permissive
trans_1st_pub:2023-11-20
conformance:w3c

â—â—class_map
E:error
a:attr
v:value
et:event-type
sl:js-slot
jv:js-value

â—â—tag_map
I:code
E:code
m:code
c:code
sl:span
et:code
a:code
v:code
jv:code
i:i
cite:cite

â—â—original_id_map

	auto-releasing-wake-locks:dfn-auto-releasing-wake-locks
	handling-document-loss-of-full-activity:dfn-handling-document-loss-of-full-activity
	handling-document-loss-of-visibility:dfn-handling-document-loss-of-visibility

â—â—mdn_urls
dom-navigator-wakelock:API/Navigator/wakeLock
dom-wakelock:API/WakeLock
dom-wakelock-request:API/WakeLock/request
dom-wakelocksentinel:API/WakeLockSentinel
dom-wakelocksentinel-released:API/WakeLockSentinel/released
dom-wakelocksentinel-type:API/WakeLockSentinel/type
dom-wakelocksentinel-release:API/WakeLockSentinel/release
dfn-release:API/WakeLockSentinel/release_event

â—â—link_map

	â—IDL
Exposed:~WEBIDLjs#Exposed
SameObject:~WEBIDLjs#SameObject
SecureContext:~WEBIDLjs#SecureContext
Promise:~WEBIDL#idl-promise
boolean:~WEBIDL#idl-boolean
undefined:~WEBIDL#idl-undefined

E.NotAllowedError:~WEBIDL#notallowederror

I.WakeLock:#dom-wakelock
I.WakeLockSentinel:#dom-wakelocksentinel
I.WakeLockType:#dom-wakelocktype
I.EventHandler:~WAPI#eventhandler
I.EventTarget:~DOM4#eventtarget
I.Window:~WINDOW#window
I.DOMException:~WEBIDL#idl-DOMException
I.Document:~DOM4#document
I.Navigator:~HTMLnavigator#navigator

m.wakeLock:#dom-navigator-wakelock
m.request:#dom-wakelock-request
m.released:#dom-wakelocksentinel-released
m.type:#dom-wakelocksentinel-type
m.release:#dom-wakelocksentinel-release
m.onrelease:#dom-wakelocksentinel-onrelease

l.screen:#dom-wakelocktype-screen
l.denied:~PERMISSIONS#dom-permissionstate-denied

	â—code ä»–

sl.ActiveLocks:#dfn-activelocks
sl.Released:#dfn-released

et.release:#dfn-release
a.allow:~HEembed#attr-iframe-allow

	â—ç”¨èª
~wake~lockç¨®åˆ¥:#dfn-wake-lock-type
~platform~wake~lock:#dfn-platform-wake-lock
i.~screen~wake~lock:#dfn-screen-wake-lock
~wake~lockã‚’å¦èª-:#dfn-deny-wake-lock
~screen~wake~lockè¨±å¯~revocation~algo:#dfn-screen-wake-lock-permission-revocation-algorithm
~screen~wake~lock~task~source:#dfn-screen-wake-lock-task-source
~wake~lockã‚’é©ç”¨ã™ã‚‹ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹:#dfn-acquire-wake-lock
~wake~lockã‚’ã‚‚ã¯ã‚„é©ç”¨ã—ãªã„ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹:#dfn-release-wake-lock
~wake~lockã‚’ç²å¾—ã™ã‚‹:#dfn-acquire-a-wake-lock
~wake~lockã‚’è§£æ”¾ã™ã‚‹:#dfn-release-a-wake-lock
é©ç”¨-å¯èƒ½:#dfn-applicable-wake-lock

	â—ç”¨èªï¼ˆå¤–éƒ¨
~UA:~INFRA#user-agent
	~UA:#dfn-user-agent
ä»˜åŠ ã™ã‚‹:~INFRA#list-append
é™¤å»ã™ã‚‹:~INFRA#list-remove
ç©º:~INFRA#list-is-empty
~list:~INFRA#list
æœ‰é †åº~map:~INFRA#ordered-map
	~EACH:~INFRA#list-iterate

ä¸¦åˆ—çš„:~HTMLINFRA#in-parallel

å†…éƒ¨~slot:~TC39#sec-object-internal-methods-and-internal-slots

	ã‚³ãƒ¬:~WEBIDL#this
æ–°ãŸãª~promise:~WEBIDLjs#a-new-promise
å´ä¸‹ã•ã‚Œã‚‹~promise:~WEBIDLjs#a-promise-rejected-with
è§£æ±ºã•ã‚Œã‚‹~promise:~WEBIDLjs#a-promise-resolved-with
~promiseã‚’å´ä¸‹ã™ã‚‹:~WEBIDLjs#reject
~promiseã‚’è§£æ±ºã™ã‚‹:~WEBIDLjs#resolve

~eventã‚’ç™ºç«ã™ã‚‹:~DOM4#concept-event-fire

åˆ©ç”¨ã¯è¨±å®¹ã•ã‚Œã¦:~HEembed#allowed-to-use
çµä»˜ã‘ã‚‰ã‚ŒãŸæ–‡æ›¸:~WINDOW#concept-document-window
å…¨éƒ¨çš„ã«ä½œå‹•ä¸­:~HTMLds#fully-active
~pageå¯è¦–æ€§~å¤‰åŒ–-æ™‚ã®æ‰‹ç¶šã:~HTMLinteraction#page-visibility-change-steps
doc.å¯è¦–æ€§~çŠ¶æ…‹:~HTMLinteraction#visibility-state

å¤§åŸŸ~taskã‚’~queueã™ã‚‹:~WAPI#queue-a-global-task
ç¾åœ¨ã®å¤§åŸŸ~obj:~WAPI#current-global-object
~event~handler~IDLå±æ€§:~WAPI#event-handler-idl-attributes
~event~handler~eventå‹:~WAPI#event-handler-event-type
~event~handler:~WAPI#event-handlers
é–¢é€£ãªå¤§åŸŸ~obj:~WAPI#concept-relevant-global
~task~source:~WAPI#task-source
~task:~WAPI#concept-task

æ—¢å®šã®è¨±å®¹list:~PERMISSIONS-POLICY#policy-controlled-feature-default-allowlist
æ–½ç­–ã«ã‚ˆã‚Šåˆ¶å¾¡ã•ã‚Œã‚‹ç‰¹èƒ½:~PERMISSIONS-POLICY#policy-controlled-feature
è¨±å¯~revocation~algo:~PERMISSIONS#dfn-permission-revocation-algorithm
å¼·åŠ›ãªç‰¹èƒ½:~PERMISSIONS#dfn-powerful-feature
åˆ©ç”¨ã™ã‚‹è¨±å¯ã‚’è¦è«‹ã™ã‚‹:~PERMISSIONS#dfn-request-permission-to-use


â—â—words_table1


â—â—words_table

	â—wake lock
wake:
ç²å¾—-:acquire::~
ç²å¾—:acquisition::~
è§£æ”¾-:release::~

	â—battery
battery::::ãƒãƒƒãƒ†ãƒªãƒ¼
æ”¾é›»-:discharge:~
å……é›»-:charge:~
	æ®‹é‡:charge
	æ®‹é‡:level
å……é›»:charge:~
ä¸€é:transient:~
ç¯€ç´„:saving:~
å¯¿å‘½:life:~
æ¶ˆè€—:depletion:~
æ¶ˆè€—-:deplete:~
å®¹é‡:capacity:~
é›»åŠ›:power:~
é›»æº:power source:~
å¼•å»¶ã°ã™:prolongeã™ã‚‹:å¼•ãå»¶ã°ã™
æ¸©å­˜:conservation:~
ã‚³ãƒ³ã‚»ãƒ³ãƒˆ:wall power:~
é‹ç”¨-:operate:~
ä¼‘çœ :deep power:~
åˆ©ç”¨åº¦:usage:~

	é›»åŠ›~ç¯€ç´„:power-saving
	æ¶ˆè²»é›»åŠ›:energy
	é€Ÿã:faster

	â—å‡¦ç†
	%~lock~list:lockList
	%æ–‡æ›¸
	%~lock
	%ç¨®åˆ¥
	%~promise
	%çŠ¶æ…‹
	%~obj
	%~handle


	â—ä¿å®‰
revocation::å–ã‚Šæ¶ˆã—
è¨±å®¹list:allowlist::è¨±å®¹ list:è¨±å®¹ãƒªã‚¹ãƒˆ

	â—ä»•æ§˜
é¸æŠçš„:selective:~
æ­£å¸¸:normal:~
	æ­£å¸¸ã§ãªã„:abnormal
ç¨®é¡:kind:~
ç©æ¥µçš„:aggressive:~
ç¾ä»£åŒ–:modernize:~
é‚ªé­”-:hinder:~
ä¸€æ§˜:uniform:~
æ§ãˆã‚:unobtrusive:~
ä¼ãˆã‚‹:informã™ã‚‹:~
æœ«ç«¯-:end:~
é‡è¤‡:duplicate:~
timer::::ã‚¿ã‚¤ãƒãƒ¼
mobile::::ãƒ¢ãƒã‚¤ãƒ«
æ´»å‹•:activity:~
ç„¡æ´»å‹•:inactivity:~

	é€†ã«:conversely
	èª²ã•ã‚Œ:impose
	ãªã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹:let ã€œ go into
	å‡¦ã™ã‚‹:deal with
	æ„Ÿè¬-:offer our sincere thank
	å‹§å‘Šå€™è£œ:CR
	åŠ©ã‘ã«ã‚‚ãªã‚Š:could help
	è‡³ã‚‰ã›:lead
	ä¸èƒ½ã«ãªã‚‹:can lead to inability
	çŸ¥ã‚‹:know
	æ›¸ãç›´:rewrite
	æƒ…å ±:info
	è¨±å®¹ã—ãªã„:disallow
	ç”³ã—åˆ†ãªã„:great
	ç´¢å¼•:Index

	â—è¨€ã„æ›ãˆ
	å…¨éƒ¨çš„ã«ä½œå‹•ä¸­ã§ãªããªã£ãŸ:loss of full activity
	å¯è¦–ã§ãªããªã£ãŸ:loss of visibility
	å¯è¦–ã§ãªããªã£ãŸ:hidden
	%~obj ã«`é–¢é€£ãªå¤§åŸŸ~obj$ï¼ˆ `Window$I ~objï¼‰:the Window object that the WakeLockSentinel object's constructor was invoked from
	ã§è­˜åˆ¥ã•ã‚Œã‚‹:named
	è¿‘ãã«:stationary ã€œ readily
	è¨±å¯~æ–½ç­–:Permissions Policy
	`PERMISSIONS-POLICY$r:Permissions Policy
	ã ã‘ã«çµã£ã¦:Convert the document to purely
	ä¸€å®šæ™‚é–“ç„¡ã„ã¨ã:shortly after the lack of
	å­˜åœ¨ã—ç¶šã‘ã‚‹é™ã‚Š:existence
	é©ç”¨-å¯èƒ½:Under the right conditions
	~screen~wake~lock~API^cite:Screen Wake Lock API
	è‡ªå‹•çš„ãªè§£æ”¾-æ³•:auto-releasing
	ã¾ãŸ:alternatively

	â—æœªåˆ†é¡
component::::ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
åˆ‡æ›¿ãˆã‚‰:switchã•:åˆ‡ã‚Šæ›¿ãˆã‚‰
æ˜ã‚‹ã•:brightness:~
on::::ã‚ªãƒ³
off::::ã‚ªãƒ•
	onã«:on ã« turn:::ã‚ªãƒ³ã«
	offã«:off ã« turn:::ã‚ªãƒ•ã«
	~onã«:turn on
	~offã«:turn off
	~off:blank
checkbox::::ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
check::::ãƒã‚§ãƒƒã‚¯
barcode::::ãƒãƒ¼ã‚³ãƒ¼ãƒ‰
è¶…é-:exceed:~
CPU:
èµ°æŸ»-:scan:~
é›»å­æœ¬:ebook:~
èª­ã‚“ã§:readã—ã¦:~
recipe::::ãƒ¬ã‚·ãƒ”
è¦–è´è€…:audience:~
é€€ã‘ã‚‹:dismissã™ã‚‹:~
handle::::ãƒãƒ³ãƒ‰ãƒ«
æœ«ç«¯-:end:~
é‡è¤‡:duplicate:~
ç¨®é¡:kind:~
display::::ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤
æ˜ã‚‹ã•:brightness:~
ç·Šæ€¥:emergency:~

	ã¨ãã‚‚ã‚ã‚‹:sometime
	æœ€çµ‚çš„:ultimately
	ç½®ã„ãŸ:has put
	ã‚ˆã‚Šé«˜ã„:higher
	ç›®ã§è¿½ã†:follow
	å°‘ã—å¾Œ:shortly after
	åˆ—æŒ™:enum
	ç¤ºã™:show
	ä¸è¶³ãªã:sufficient
	ã‚ˆã‚Šé•·ã„:longer
	æŒ‡ã™:refer
	ä¸‹ã’ã‚‹:lower
	å°‘ãªã„:low
	å±…ã‚‹ã‹ã©ã†ã‹:presence state
	æš—ã:dim
	ç›´å¾Œ:immediately after
	ã«ãªã‚‹:going
	ã„ã¤ã§ã‚‚:at any time
	~promptæ³•:prompting
	é€šè©±:make or receive calls

â—â—ref_normative

[dom]
    ï¼œDOM Standardï¼. Anne van Kesteren.  WHATWG. Living Standard. URL: https://dom.spec.whatwg.org/
[ECMASCRIPT]
    ï¼œECMAScript Language Specificationï¼.  Ecma International. URL: https://tc39.es/ecma262/multipage/
[html]
    ï¼œHTML Standardï¼. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip JÃ¤genstedt; Simon Pieters.  WHATWG. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[infra]
    ï¼œInfra Standardï¼. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: https://infra.spec.whatwg.org/
[PERMISSIONS]
    ï¼œPermissionsï¼. Marcos Caceres; Mike Taylor.  W3C. 13 June 2023. W3C Working Draft. URL: https://www.w3.org/TR/permissions/
[PERMISSIONS-POLICY]
    ï¼œPermissions Policyï¼. Ian Clelland.  W3C. 17 October 2023. W3C Working Draft. URL: https://www.w3.org/TR/permissions-policy-1/
[RFC2119]
    ï¼œKey words for use in RFCs to Indicate Requirement Levelsï¼. S. Bradner.  IETF. March 1997. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc2119
[RFC8174]
    ï¼œAmbiguity of Uppercase vs Lowercase in RFC 2119 Key Wordsï¼. B. Leiba.  IETF. May 2017. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc8174
[WEBIDL]
    ï¼œWeb IDL Standardï¼. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: https://webidl.spec.whatwg.org/


â—â—ref_informative

[wake-lock-use-cases]
    ï¼œWake Lock: Use casesï¼. Marcos Caceres; Natasha Rooney; Dominique HazaÃ«l-Massieux.  W3C. 14 August 2014. W3C Working Group Note. URL: https://www.w3.org/TR/wake-lock-use-cases/


â—â—trans_metadata
<p>
~THIS_PAGEã¯ã€~W3Cã«ã‚ˆã‚Š
ç·¨é›†è€…è‰æ¡ˆã¨ã—ã¦å…¬é–‹ã•ã‚ŒãŸ
<a href="~SPEC_URL">Screen Wake Lock API</a>
ã‚’æ—¥æœ¬èªã«ç¿»è¨³ã—ãŸã‚‚ã®ã§ã™ã€‚
~PUB

â—â—spec_metadata

æœ€æ–°å…¬è¡¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³
	https://www.w3.org/TR/screen-wake-lock/
ç·¨é›†è€…è‰æ¡ˆ
	https://w3c.github.io/screen-wake-lock/
å…¬è¡¨å±¥æ­´
	https://www.w3.org/standards/history/screen-wake-lock/
commitå±¥æ­´
	https://github.com/w3c/screen-wake-lock/commits/
ãƒ†ã‚¹ãƒˆä¸€å¼
	https://wpt.live/screen-wake-lock/
å®Ÿè£…å ±å‘Š
	https://www.w3.org/wiki/DAS/Implementations
ç·¨é›†
	Kenneth Rohde Christiansen (Intel Corporation)
	<a href="https://marcosc.com/">Marcos CÃ¡ceres</a> (Apple Inc.)
å‰ä»»ç·¨é›†è€…
	Raphael Kubo da Costa (Intel Corporation)
	<a href="mailto:bogdanovichiy@yandex-team.ru">Ilya Bogdanovich</a> (Yandex)
	<a href="mailto:alogvinov@yandex-team.ru">Andrey Logvinov</a> (Yandex)
ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
	<a href="https://github.com/w3c/screen-wake-lock/">GitHub w3c/screen-wake-lock</a> (<a href="https://github.com/w3c/screen-wake-lock/pulls/">pull requests</a>, <a href="https://github.com/w3c/screen-wake-lock/issues/new/choose">new issue</a>, <a href="https://github.com/w3c/screen-wake-lock/issues/">open issues</a>)
Quality Assurance Lead
	<a href="https://github.com/Honry">Wanming Lin (Intel)</a>
å…¬è¡¨è€…
	<a href="https://www.w3.org/groups/wg/das">Devices and Sensors WG</a>
	<a href="https://www.w3.org/groups/wg/webapps">Web Applications WG</a>

</script>

</head>
<body>

<header>
	<hgroup>
<h1>Screen Wake Lock API</h1>
	</hgroup>
</header>

<div id="MAIN" hidden>
	<section id="abstract">
â—è¦ç´„

<p>
ã“ã®æ–‡æ›¸ã¯ã€ï¼»
~web~appãŒ~screen~wake~lockã‚’è¦è«‹ã™ã‚‹
ï¼½ã“ã¨ã‚’è¨±å®¹ã™ã‚‹~APIã‚’æŒ‡å®šã™ã‚‹ã€‚
~screen~wake~lockã¯ã€
é©ç”¨-å¯èƒ½ã€ï¼Under the right conditionsã€‘ã‹ã¤è¨±å®¹ã•ã‚ŒãŸãªã‚‰ï¼»
~systemãŒæ©Ÿå™¨ã®~screenã‚’~offã«ã™ã‚‹
ï¼½ã“ã¨ã‚’é˜²æ­¢ã™ã‚‹ã€‚
â—
This document specifies an API that allows web applications to request a screen wake lock. Under the right conditions, and if allowed, the screen wake lock prevents the system from turning off a device's screen.
</p>

	</section>
	<section id="sotd">
â—ä½ç½®ä»˜ã‘

<p>
ã“ã®ç¯€ã§ã¯ã€
å…¬è¡¨~æ™‚ç‚¹ã«ãŠã‘ã‚‹â€¦
ã€ä»¥ä¸‹ã€ã“ã®ç¯€ã®ä»–ã®å†…å®¹ã¯ï¼Œ~SOTD-W3Cã«ç§»è­²ã€‚ã€‘
</p>

	</section>

<main id="MAIN0">

	<section id="introduction">
<h2 title="Introduction">1. åºè«–</h2>
â—éè¦ç¯„çš„

<p>
ç¾ä»£ã®~OSã¯ã€
ã‚ˆã‚Šé•·ã„~batteryå¯¿å‘½ã‚’é”æˆã™ã‚‹ãŸã‚ã«ï¼Œ
ç©æ¥µçš„ãªé›»åŠ›~ç®¡ç†ã‚’å®Ÿè£…ã™ã‚‹
â€” ãã‚Œã¯ã€
æ¬¡ã«ã‚ˆã‚Šï¼Œé›»åŠ›~åˆ©ç”¨åº¦ã‚’ã‚¢ãƒªãªé™ã‚Šåˆ¶é™ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹
â‡’
~hostæ©Ÿå™¨ã¯ã€
åˆ©ç”¨è€…-æ´»å‹•ãŒä¸€å®šæ™‚é–“ç„¡ã„ã¨ãã¯ï¼Œæ¬¡ã®ã„ãšã‚Œã‹ã‚’è¡Œã£ã¦ãƒ¨ã‚¤ã¨ã™ã‚‹
â‡’ï¼ƒ
~screenã®æ˜ã‚‹ã•ã‚’ä¸‹ã’ã‚‹ï¼
~screenã‚’~offã«ã™ã‚‹ï¼
~CPUã‚’ä¼‘çœ ~çŠ¶æ…‹ã«ãªã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
â—
Modern operating systems achieve longer battery life by implementing aggressive power management, meaning that shortly after the lack of user activity, a host device may lower the screen brightness, turn the screen off and even let the CPU go into a deep power state, limiting power usage as much as possible.
</p>

<p>
ã“ã‚Œã¯ï¼Œ~batteryå¯¿å‘½ã‚’å¼•å»¶ã°ã™ã“ã¨ã«é–¢ã—ã¦ã¯ç”³ã—åˆ†ãªã„ãŒã€
ä¸€éƒ¨ã®åˆ©ç”¨äº‹ä¾‹ã‚’é‚ªé­”ã™ã‚‹ã¨ãã‚‚ã‚ã‚‹
â€” ä¾‹ï¼š
~barcodeã‚’èµ°æŸ»ã—ã¦ã„ã‚‹,
é›»å­æœ¬ã‚’èª­ã‚“ã§ã„ã‚‹,
~recipeã‚’ç›®ã§è¿½ã£ã¦ã„ã‚‹,
è¦–è´è€…ã«å‘ˆç¤ºã—ã¦ã„ã‚‹,
ç­‰ã€…ã€‚
`~wake~lockï¼šåˆ©ç”¨äº‹ä¾‹ï¼ ~TR/wake-lock-use-cases/$cite
ã‚‚è¦‹ã‚ˆã€‚
â—
Though this is great for prolonged battery life, it can sometime hinder some use cases such as scanning a barcode, reading an ebook, following a recipe, presenting to an audience, and so on. See also Wake Lock: Use cases.
</p>

<p>
~wake~lockã¯ï¼Œä¸€èˆ¬ã«ä½•ã‹ãŒèµ·ã“ã‚‹ã“ã¨ã‚’é˜²æ­¢ã™ã‚‹ãŒã€
~UAï¼ˆãŠã‚ˆã³ä¸‹å±¤ã®~OSï¼‰ã¯ï¼Œ
æ‰€ä¸ã®~batteryçŠ¶æ…‹s
ï¼ˆä¾‹ï¼šï¼»
ã‚³ãƒ³ã‚»ãƒ³ãƒˆã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ï¼
æ”¾é›»-ä¸­ã«ã‚ã‚‹ï¼
~batteryæ®‹é‡ãŒå°‘ãªã„
ï¼½ã‹ã©ã†ã‹ï¼‰
ã®ä¸‹ã§~wake~lockã‚’æ™‚é–“~åˆ¶é™ã—ã¦ã‚‚ãƒ¨ã‚¤
â€” é›»åŠ›~ç¯€ç´„~modeãŒä½œå‹•åŒ–ã•ã‚ŒãŸäº‹ä¾‹ã§ã¯ã€
~wake~lockã‚’è¨±å®¹ã—ãªã„ã“ã¨ã«ã—ã¦ã‚‚ãƒ¨ã‚¤ã€‚
â—
A wake lock will generally prevent something from happening, but UAs (and the underlying OS) may time limit a wake lock given the battery status (wall power connected, discharging, low battery level), or even disallow wake locks in the case a power saving mode is activated.
</p>

	</section>
	<section id="wake-locks">
<h2 title="Wake Locks">2. ~wake~lock</h2>

<p>
ã“ã®ä»•æ§˜ã¯ã€
æ¬¡ã«æŒ™ã’ã‚‹
`~wake~lockç¨®åˆ¥@
ã‚’å®šç¾©ã™ã‚‹ï¼š
â—
This specification defines the following wake lock type:
</p>
<ul>
	<li>
<p>
`~screen~wake~lock@i
â‡’
~screenãŒ~offã«ã™ã‚‹ã“ã¨ã‚’é˜²æ­¢ã™ã‚‹ã€‚
~screen~wake~lockã‚’ç²å¾—ã—å¾—ã‚‹ã®ã¯ã€
å¯è¦–ãªæ–‡æ›¸ã«é™ã‚‰ã‚Œã‚‹ã€‚
</p>

<p class="trans-note">ã€
ã“ã‚Œã¯ã€
~dataã¨ã—ã¦ã¯ï¼Œãã‚Œã‚’è¡¨ç¾ã™ã‚‹æ–‡å­—åˆ— `screen$l ã¨åŒä¸€è¦–ã•ã‚Œã‚‹ã€‚
ã€‘</p>
â—
A screen wake lock prevents the screen from turning off. Only visible documents can acquire the screen wake lock.
</li>
</ul>

<p>
ã“ã®~APIã«ãŠã„ã¦ã¯ã€
`~wake~lockç¨®åˆ¥$ã¯ï¼Œ`WakeLockType$I åˆ—æŒ™~å€¤ã«ã‚ˆã‚Šè¡¨ç¾ã•ã‚Œã‚‹ã€‚
â—
In the API, the wake lock types are represented by the WakeLockType enum values.
</p>

<p class="note">æ³¨è¨˜ï¼š
ä»–ã®ä»•æ§˜ã¯ã€
ç•°ãªã‚‹~wake~lockç¨®åˆ¥ã‚’å®šç¾©ã—å¾—ã‚‹ã€‚
â—
Note

Other specifications might define different wake lock types.
</p>

	</section>
	<section id="policy-control">
<h2 title="Policy control">3. æ–½ç­–~åˆ¶å¾¡</h2>

<p>
`~screen~wake~lock~API^cite ã¯ã€
æ–‡å­—åˆ— `screen-wake-lock^l ã«ã‚ˆã‚Šè­˜åˆ¥ã•ã‚Œã‚‹`æ–½ç­–ã«ã‚ˆã‚Šåˆ¶å¾¡ã•ã‚Œã‚‹ç‰¹èƒ½$ã‚’å®šç¾©ã™ã‚‹ã€‚
ãã®`æ—¢å®šã®è¨±å®¹list$ã¯ `'self'^l ã¨ã™ã‚‹ã€‚
â—
The Screen Wake Lock API defines a policy-controlled feature identified by the string "screen-wake-lock". Its default allowlist is 'self'.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-supported-by-permissions-policy$wpt
<li>`wakelock-enabled-on-self-origin-by-permissions-policy.https.sub$wpt
<li>`wakelock-enabled-by-permissions-policy-attribute-redirect-on-load.https.sub$wpt
<li>`wakelock-enabled-by-permissions-policy-attribute.https.sub$wpt
<li>`wakelock-enabled-by-permissions-policy.https.sub$wpt
</ul>
</details>

<div class="note">
<p>æ³¨è¨˜ï¼š
`æ—¢å®šã®è¨±å®¹list$ `'self'^l ã¯ã€
å…¥å­ã«ã•ã‚ŒãŸåŒä¸€-ç”Ÿæˆå…ƒã«å±ã™ã‚‹~frameã«ãŠã‘ã‚‹~wake~lockç”¨æ³•ã‚’è¨±å®¹ã™ã‚‹ä¸€æ–¹ã§ï¼Œ
ç¬¬ä¸‰è€…-ä¸»ä½“ã«å±ã™ã‚‹å†…å®¹ãŒ~wake~lockã‚’åˆ©ç”¨ã™ã‚‹ã®ã¯é˜²æ­¢ã™ã‚‹ã€‚
â—
Note

The default allowlist of 'self' allows wake lock usage in same-origin nested frames but prevents third-party content from using wake locks.
</p>

<p>
ç¬¬ä¸‰è€…-ä¸»ä½“~ç”¨æ³•ã¯
å½“ã®`~frameå®¹å™¨~è¦ç´ ï¼ ~HTMLds#nav-container$ã® `allow$a å±æ€§ã« `screen-wake-lock^v ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œé¸æŠçš„ã«å¯èƒ½åŒ–ã§ãã‚‹ï¼š
â—
Third-party usage can be selectively enabled by adding allow="screen-wake-lock" attribute to the frame container element:
</p>

<div class="example" id="example-enabling-screen-wake-lock-on-remote-content">
<p>
~remoteå†…å®¹ã«å¯¾ã—~screen~wake~lockã‚’å¯èƒ½åŒ–ã™ã‚‹ä¾‹ï¼š
â—
Example: Enabling screen wake lock on remote content
</p>

<pre class="lang-html">
&lt;iframe src="https://third-party.com" allow="screen-wake-lock"&gt;&lt;/iframe&gt;
</pre>
</div>

<p>
ã¾ãŸã€
~HTTPå¿œç­”~headerå†…ã«è¨±å¯~æ–½ç­–ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œ
`~screen~wake~lock~API^cite ã‚’å®Œå…¨ã«ä¸èƒ½åŒ–ã§ãã‚‹ï¼š
â—
Alternatively, the Screen Wake Lock API can be disabled completely by specifying the permissions policy in a HTTP response header:
</p>

<div class="example" id="example-permissions-policy-header">
<p>
è¨±å¯~æ–½ç­–~headerã®ä¾‹ï¼š
â—
Example: Permissions Policy header
</p>

<pre class="lang-http">Permissions-Policy: screen-wake-lock=()
</pre>
</div>

<p>
ã‚ˆã‚Šè©³ç´°ã¯ã€
`è¨±å¯~æ–½ç­–^cite `PERMISSIONS-POLICY$r
ã‚’è¦‹ã‚ˆã€‚
â—
See Permissions Policy for more details.
</p>
</div>


	</section>
	<section id="permissions-and-user-prompts">
<h2 title="Permissions and user prompts">4. è¨±å¯ã¨åˆ©ç”¨è€…~prompt</h2>

<p>
`è¨±å¯~API^cite `PERMISSIONS$r ã¯ã€
~web~siteç”¨ã«ï¼»
åˆ©ç”¨è€…ã‹ã‚‰ã®è¨±å¯ã‚’è¦è«‹ã™ã‚‹
ï¼½ãŸã‚, ãŠã‚ˆã³ï¼»
å½“ã®~web~siteãŒ ã©ã®è¨±å¯ã‚’æœ‰ã™ã‚‹ã‹~queryã™ã‚‹
ï¼½ãŸã‚ã®ä¸€æ§˜ãªä»•æ–¹ã‚’ä¾›ã™ã‚‹ã€‚
â—
The [PERMISSIONS] API provides a uniform way for websites to request permissions from users and query which permissions they have.
</p>

<p>
`~UA$ã¯ã€
å®Ÿè£…ã«ç‰¹æœ‰ãªç†ç”±
â€” ~platformè¨­å®šã‚„åˆ©ç”¨è€…~é¸å¥½ãªã© â€”
ã«ã‚ˆã‚Šï¼Œ
ç‰¹å®š0ã® `Document$I ç”¨ã«ç‰¹å®š0ã®`~wake~lockç¨®åˆ¥$ã®
`~wake~lockã‚’å¦èª-@
ã§ãã‚‹ã€‚
â—
A user agent can deny a wake lock of a particular wake lock type for a particular Document by any implementation-specific reason, such as platform setting or user preference.
</p>

<p>
~UAã«ã¯ã€
æ¬¡ã‚’è¡Œã†ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ï¼š
â—
It is RECOMMENDED that a user agentï¼¼
</p>
<ul>
	<li>
ä½•ã‚‰ã‹ã®å½¢ã‚’æˆã™æ§ãˆã‚ãªé€šçŸ¥
â€” ~wake~lockãŒä½œå‹•ä¸­ã«ãªã£ãŸã¨ãï¼Œãã®ã“ã¨ã‚’åˆ©ç”¨è€…ã«ä¼ãˆã‚‹é€šçŸ¥ â€”
ã‚’ç¤ºã™ã€‚
â—
show some form of unobtrusive notification that informs the user when a wake lock is active,ï¼¼
</li>
	<li>
æ¬¡ã‚’è¡Œã†æ‰‹æ®µã‚’åˆ©ç”¨è€…ã«ä¾›ã™ã‚‹
â‡’
é€²è¡Œä¸­ãªæ¼”ç®—ã‚’`é˜»ã‚€ï¼ #dfn-screen-wake-lock-permission-revocation-algorithm$ã‹ï¼Œ
å˜ç´”ã«å½“ã®é€šçŸ¥ã‚’é€€ã‘ã‚‹
â—
as well as provides the user with the means to block the ongoing operation, or simply dismiss the notification.
</li>
</ul>

		<section id="the-screen-wake-lock-powerful-feature">
<h3 title="The &quot;screen-wake-lock&quot; powerful feature">4.1. å¼·åŠ›ãªç‰¹èƒ½ `screen-wake-lock^l</h3>

<p>
æ–‡å­—åˆ— `screen-wake-lock^l ã«ã‚ˆã‚Šè­˜åˆ¥ã•ã‚Œã‚‹`å¼·åŠ›ãªç‰¹èƒ½$ãŒã€
ã“ã®ä»•æ§˜ã«ã‚ˆã‚Šå®šç¾©ã•ã‚Œã‚‹èƒ½åŠ›ã‚’å¯èƒ½åŒ–ã™ã‚‹ã€‚
â—
The "screen-wake-lock" powerful feature enables the capability defined by this specification.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelockpermissiondescriptor.https$wpt
</ul>
</details>

		</section>
		<section id="permission-algorithms">
<h3 title="Permission algorithms">4.2. è¨±å¯~algo</h3>

<div class="algo">
<p>
`å¼·åŠ›ãªç‰¹èƒ½$ `screen-wake-lock^l ã¯ã€
`è¨±å¯~revocation~algo$ã¨ã—ã¦ï¼Œ
`~screen~wake~lockè¨±å¯~revocation~algo@
ã‚’å®šç¾©ã™ã‚‹
â€” ãã‚Œã¯ï¼š
â—
The "screen-wake-lock" powerful feature defines a permission revocation algorithm. To invoke the Screen Wake Lock permission revocation algorithm, run these steps:
</p>
<ol>
	<li>
%æ–‡æ›¸ ~LET `ç¾åœ¨ã®å¤§åŸŸ~obj$ã«`çµä»˜ã‘ã‚‰ã‚ŒãŸæ–‡æ›¸$
â—
Let document be the current global object's associated Document.
</li>
	<li>
%æ–‡æ›¸ . `ActiveLocks$sl[ `screen^l ] ã‚’æˆã™
~EACH( %~lock )
ã«å¯¾ã—
â‡’
`~wake~lockã‚’è§£æ”¾ã™ã‚‹$( %æ–‡æ›¸, %~lock, `screen$l )
â—
Let lockList be document.[[ActiveLocks]]["screen"].
â—
For each lock in lockList:
â€¢ Run release a wake lock with document, lock, and "screen".
</li>
</ol>
</div>

		</section>
	</section>
	<section id="concepts">
<h2 title="Concepts">5. å„ç¨®~æ¦‚å¿µ</h2>

<p>
ã“ã®ä»•æ§˜~å†…ã§è¨€åŠã•ã‚Œã‚‹`~task$ç”¨ã®`~task~source$ã¯ã€
`~screen~wake~lock~task~source@
ã§ã‚ã‚‹ã€‚
â—
The task source for the tasks mentioned in this specification is the screen wake lock task source.
</p>

<p>
ç”¨èª
`~platform~wake~lock@
ã¯ã€
~UAãŒï¼Œã‚ã‚‹~wake~lockï¼»
ã®çŠ¶æ…‹ã‚’~queryã™ã‚‹ï¼ã‚’ç²å¾—ã™ã‚‹ï¼ã‚’è§£æ”¾ã™ã‚‹
ï¼½ãŸã‚ã«ãƒ¤ãƒªãƒˆãƒªã™ã‚‹~platform~interfaceã‚’æŒ‡ã™ã€‚
â—
The term platform wake lock refers to platform interfaces with which the user agent interacts to query state and acquire and release a wake lock.
</p>

<p>
`~platform~wake~lock$ã¯ã€
ä¸‹å±¤ã®~platformã«ã‚ˆã‚Šå®šç¾©ã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Œã°
ï¼ˆä¾‹ï¼š~native~wake~lock~frameworkã«ãŠã„ã¦ï¼‰ï¼Œ
~UAã«ã‚ˆã‚Šå®šç¾©ã•ã‚Œã‚‹ã“ã¨ã‚‚
â€” ~UAãŒç›´ãª~hardwareåˆ¶å¾¡ã‚’æœ‰ã™ã‚‹å ´åˆã«ã¯ â€”
ã‚ã‚‹ã€‚
â—
A platform wake lock can be defined by the underlying platform (e.g. in a native wake lock framework) or by the user agent, if it has direct hardware control.
</p>

	</section>
	<section id="extensions-to-the-document-interface">
<h2 title="Extensions to the Document interface">6. `Document^I ~interfaceã«å¯¾ã™ã‚‹æ‹¡å¼µ</h2>

<p id="internal-slots">
å„ `Document$I ~instanceã¯ã€
æ¬¡ã«æŒ™ã’ã‚‹`å†…éƒ¨~slot$ã‚’ä¼´ã£ã¦ä½œæˆã•ã‚Œã‚‹ï¼š
â—
6.1. Internal slots
</p>

<div>
<dl>
	<dt>`ActiveLocks@sl</dt>
	<dd>
<p>
`æœ‰é †åº~map$
â€” å„~entryã®ï¼š
</p>
		<ul>
			<li>
~keyã¯ã€
ã‚ã‚‹`~wake~lockç¨®åˆ¥$ã€ã‚’è¡¨ç¾ã™ã‚‹æ–‡å­—åˆ—ã€‘ã‚’ä¸ãˆã‚‹ã€‚
</li>
			<li>
å€¤ã¯ã€ï¼»
ã“ã® `Document$I ã«çµä»˜ã‘ã‚‰ã‚ŒãŸ `WakeLockSentinel$I ~objãŸã¡ãŒæˆã™`~list$
ï¼½ã‚’ä¸ãˆã‚‹
â€” åˆæœŸ~æ™‚ã¯`ç©º$ã¨ã™ã‚‹ã€‚
</li>
		</ul>
	</dd>
</dl>

<p class="trans-note">ã€
ã“ã®ä»•æ§˜ã‚’å®Ÿè£…ã™ã‚‹~UAã«ã¯ã€
ã“ã®~mapã¯ï¼Œ~keyã¨ã—ã¦ï¼»
`~screen~wake~lock$i ã‚’è¡¨ç¾ã™ã‚‹æ–‡å­—åˆ— `screen^l
ï¼½ã‚’ä¼´ã†~entryã‚’æœ‰ã™ã‚‹ã“ã¨ãŒè¦æ±‚ã•ã‚Œã‚‹ã€‚
ã€‘</p>
â—
Internal slotï½œInitial valueï½œDescription
[[ActiveLocks]]ï½œAn ordered map mapping wake lock types to empty lists.ï½œAn ordered map of wake lock types to a list of WakeLockSentinel objects associated with this Document.
</div>

	</section>
	<section id="extensions-to-the-navigator-interface">
<h2 title="Extensions to the Navigator interface">7. `Navigator^I ~interfaceã«å¯¾ã™ã‚‹æ‹¡å¼µ</h2>

<pre class="idl">
[`SecureContext$]
partial interface `Navigator$I {
  [`SameObject$] readonly attribute `WakeLock$I `wakeLock@m;
};
</pre>

	</section>
	<section id="the-wakelock-interface">
<h2 title="The WakeLock interface">8. `WakeLock^I ~interface</h2>

<p>
`WakeLock$I ~interfaceã¯ã€ï¼»
æ–‡æ›¸ãŒ `~screen~wake~lock$i ã‚’ç²å¾—ã™ã‚‹
ï¼½ã“ã¨ã‚’è¨±å®¹ã™ã‚‹ã€‚
â—
The WakeLock interface allows a document to acquire a screen wake lock.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-insecure-context.any$wpt
</li>
</ul>
</details>

<pre class="idl">
[`SecureContext$, `Exposed$=(Window)]
interface `WakeLock@I {
  `Promise$&lt;`WakeLockSentinel$I&gt; `request$m(optional `WakeLockType$I %type = "screen");
};
</pre>

<div class="algo">
<p id="the-request-method">
`request(type)@m
~methodæ‰‹ç¶šãã¯ï¼š
â—
8.1. The request() method
â—
The request(type) method steps are:
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-type.https.any$wpt
</li>
</ul>
</details>

<ol>
	<li>
%æ–‡æ›¸ ~LET ã‚³ãƒ¬ã«`é–¢é€£ãªå¤§åŸŸ~obj$ã«`çµä»˜ã‘ã‚‰ã‚ŒãŸæ–‡æ›¸$
â—
Let document be this's relevant global object's associated Document.
</li>
	<li>
<p>
~IFï¼»
%æ–‡æ›¸ ã¯`å…¨éƒ¨çš„ã«ä½œå‹•ä¸­$ã§ãªã„
ï¼½
â‡’
~RET `å´ä¸‹ã•ã‚Œã‚‹~promise$( `NotAllowedError$E ä¾‹å¤– )
â—
If document is not fully active, return a promise rejected with with a "NotAllowedError" DOMException.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-active-document.https.window$wpt
</li>
</ul>
</details>
	</li>
	<li>
<p>
~IFï¼»
%æ–‡æ›¸ ã«ã¯ï¼»
`screen-wake-lock^l ã§è­˜åˆ¥ã•ã‚Œã‚‹`æ–½ç­–ã«ã‚ˆã‚Šåˆ¶å¾¡ã•ã‚Œã‚‹ç‰¹èƒ½$
ï¼½ã®`åˆ©ç”¨ã¯è¨±å®¹ã•ã‚Œã¦$ã„ãªã„
ï¼½
â‡’
~RET `å´ä¸‹ã•ã‚Œã‚‹~promise$( `NotAllowedError$E ä¾‹å¤– )
â—
If document is not allowed to use the policy-controlled feature named "screen-wake-lock", return a promise rejected with a "NotAllowedError" DOMException.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-disabled-by-permissions-policy.https.sub$wpt
</li>
</ul>
</details>
	</li>
	<li>
<p>
~IFï¼»
`~UA$ã¯ %æ–‡æ›¸ ç”¨ã«ã¯ï¼Œ`~wake~lockç¨®åˆ¥$ %type ã®`~wake~lockã‚’å¦èª-$ã™ã‚‹
ï¼½
â‡’
~RET `å´ä¸‹ã•ã‚Œã‚‹~promise$( `NotAllowedError$E ä¾‹å¤– )
â—
If the user agent denies the wake lock of this type for document, return a promise rejected with a "NotAllowedError" DOMException.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-screen-type-on-worker.https.worker$wpt
</li>
</ul>
</details>
	</li>
	<li>
<p>
~IFï¼»
%æ–‡æ›¸ ã®`å¯è¦–æ€§~çŠ¶æ…‹$doc ~EQ `hidden^l
ï¼½
â‡’
~RET `å´ä¸‹ã•ã‚Œã‚‹~promise$( `NotAllowedError$E ä¾‹å¤– )
â—
If document's visibility state is "hidden", return a promise rejected with "NotAllowedError" DOMException.
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-document-hidden-manual.https$wpt
</li>
</ul>
</details>
	</li>
	<li>
%~promise ~LET `æ–°ãŸãª~promise$
â—
Let promise be a new promise.
</li>
	<li class="algo">
<p>
ã“ã®æ®µã¯`ä¸¦åˆ—çš„$ã«èµ°ã‚‰ã™ï¼š
â—
Run the following steps in parallel:
</p>
		<ol>
			<li>
%çŠ¶æ…‹ ~LET `åˆ©ç”¨ã™ã‚‹è¨±å¯ã‚’è¦è«‹ã™ã‚‹$( `screen-wake-lock^l )
â—
Let state be the result of requesting permission to use "screen-wake-lock".
</li>
			<li>
<p>
~IFï¼»
%çŠ¶æ…‹ ~EQ `denied$l
ï¼½ï¼š
â—
If state is "denied", then:
</p>
				<ol>
					<li>
<p>
`å¤§åŸŸ~taskã‚’~queueã™ã‚‹$( `~screen~wake~lock~task~source$, %æ–‡æ›¸ ã«`é–¢é€£ãªå¤§åŸŸ~obj$, æ¬¡ã®æ‰‹ç¶šã )
</p>
<div class="algo">
æ‰‹ç¶šãã¯
â‡’
`~promiseã‚’å´ä¸‹ã™ã‚‹$( %~promise, `NotAllowedError$E ä¾‹å¤– )
</div>
â—
Queue a global task on the screen wake lock task source given document's relevant global object to reject promise with a "NotAllowedError" DOMException.
</li>
					<li>
~RET
â—
Abort these steps.
</li>
				</ol>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-request-denied.https$wpt
</li>
</ul>
</details>
			</li>
			<li>
<p>
`å¤§åŸŸ~taskã‚’~queueã™ã‚‹$( `~screen~wake~lock~task~source$, %æ–‡æ›¸ ã«`é–¢é€£ãªå¤§åŸŸ~obj$, æ¬¡ã®æ‰‹ç¶šã )
â—
Queue a global task on the screen wake lock task source given document's relevant global object toï¼¼
</p>

<div class="algo">
<p>
æ‰‹ç¶šãã¯ï¼š
â—
run these steps:
</p>
				<ol>
					<li>
<p>
~IFï¼»
%æ–‡æ›¸ ã¯`å…¨éƒ¨çš„ã«ä½œå‹•ä¸­$ã§ãªã„
ï¼½~ORï¼»
%æ–‡æ›¸ ã®`å¯è¦–æ€§~çŠ¶æ…‹$doc ~EQ `hidden^l
ï¼½ï¼š
â—
If document is not fully active, then:
â€¢ Reject promise with a "NotAllowedError" DOMException.
â€¢ Abort these steps.
â—
If document's visibility state is "hidden", then:
</p>
						<ol>
							<li>
`~promiseã‚’å´ä¸‹ã™ã‚‹$( %~promise, `NotAllowedError$E ä¾‹å¤– )
â—
Reject promise with a "NotAllowedError" DOMException.
</li>
							<li>
~RET
â—
Abort these steps.
</li>
						</ol>
					</li>
					<li>
<p>
~IFï¼»
%æ–‡æ›¸ . `ActiveLocks$sl[ `screen^l ] ã¯`ç©º$ã§ã‚ã‚‹
ï¼½ï¼š
â—
If document.[[ActiveLocks]]["screen"] is empty,ï¼¼
</p>
						<ol>
							<li class="algo">
<p>
ã“ã®æ®µã¯`ä¸¦åˆ—çš„$ã«èµ°ã‚‰ã™
â‡’
`~wake~lockã‚’ç²å¾—ã™ã‚‹$( `screen$l )
â—
then invoke the following steps in parallel:
â€¢ Invoke acquire a wake lock with "screen".
</p>

<p class="note">æ³¨è¨˜ï¼š
~wake~lockã‚’ç²å¾—ã™ã‚‹~algoã¯ï¼Œæœ€çµ‚çš„ã«ã¯~OSã‹ã‚‰~lockã‚’ç²å¾—-å¯èƒ½ã§ãªã„ã“ã¨ã‚‚ã‚ã‚‹ãŒã€
åˆ©ç”¨è€…ã«å¯¾ã™ã‚‹æŒ‡ç´‹åé›†ã‚’é¿ã‘ã‚‹ãŸã‚
ï¼ˆä¾‹ãˆã°ã€
~lockã‚’ç²å¾—ã™ã‚‹ã“ã¨ã®å¤±æ•—ã¯ï¼Œ~batteryæ®‹é‡ãŒå°‘ãªã„ã“ã¨ã‚’æŒ‡ç¤ºã—å¾—ã‚‹ï¼‰ï¼Œ
~lockã®æˆåŠŸè£¡ãªç²å¾—ã¨åˆ¤åˆ¥-ä¸èƒ½ã«ãªã‚‹ã€‚
â—
Note

The acquire a wake lock algorithm may ultimately be unable to acquire a lock from the operating system, but this is indistinguishable from a successful lock acquisition to avoid user fingerprinting (failure to acquire a lock can indicate low battery levels, for example).
</p>
							</li>
						</ol>
					</li>
					<li>
%~lock ~LET æ–°ãŸãª `WakeLockSentinel$I ~obj
â€” ãã®
â‡’ï¼ƒ
`type$m å±æ€§ ~SET %type
â—
Let lock be a new WakeLockSentinel object with its type attribute set to type.
</li>
					<li>
%æ–‡æ›¸ . `ActiveLocks$sl[ `screen^l ] ã« %~lock ã‚’`ä»˜åŠ ã™ã‚‹$
â—
Append lock to document.[[ActiveLocks]]["screen"].
</li>
					<li>
`~promiseã‚’è§£æ±ºã™ã‚‹$( %~promise, %~lock )
â—
Resolve promise with lock.
</li>
				</ol>
</div>
			</li>
		</ol>
	</li>
	<li>
~RET %~promise
â—
Return promise.
</li>
</ol>
</div>

		</section>
	
	<section id="the-wakelocksentinel-interface">
<h2 title="The WakeLockSentinel interface">9. `WakeLockSentinel^I ~interface</h2>

<pre class="idl">
[`SecureContext$, `Exposed$=(Window)]
interface `WakeLockSentinel@I : `EventTarget$I {
  readonly attribute `boolean$ `released$m;
  readonly attribute `WakeLockType$I `type$m;
  `Promise$&lt;`undefined$&gt; `release$m();
  attribute `EventHandler$I `onrelease$m;
};
</pre>

<p>
`WakeLockSentinel$I ~obj %~obj ã¯ã€
ãã® `type$m å±æ€§ãŒæŒ‡ç¤ºã™ã‚‹`~wake~lockç¨®åˆ¥$ %ç¨®åˆ¥ ç”¨ã®ä¸‹å±¤ã®`~platform~wake~lock$ %~lock ã¸ã®~handle %~handle ã‚’ä¾›ã™ã‚‹ï¼š
â—
A WakeLockSentinel object provides a handle to a platform wake lock,ï¼¼
</p>
<ul>
	<li>
%~handle ã¯ã€ï¼»
%~obj ãŒ `release()$m ã«ã‚ˆã‚Šæ‰‹å‹•ã§è§£æ”¾ã•ã‚Œã‚‹ã‹ %~lock ãŒè§£æ”¾ã•ã‚Œã‚‹
ï¼½ã¾ã§ %~obj ã«ä¿æŒã•ã‚Œã‚‹ã€‚
â—
and it holds on to it until it is either manually released or until the underlying platform wake lock is released.ï¼¼
</li>
	<li>
%~lock ã¯ã€
%~handle ãŒå­˜åœ¨ã—ç¶šã‘ã‚‹é™ã‚Šï¼Œä½œå‹•ä¸­ã«ä¿ãŸã‚Œã‚‹ã€‚
â—
Its existence keeps a platform wake lock for a given wake lock type active,ï¼¼
</li>
	<li>
%ç¨®åˆ¥ ç”¨ã® `WakeLockSentinel$I ~instanceã™ã¹ã¦ã‚’è§£æ”¾ã™ã‚‹ã¨ã€
%~lock ã¯ï¼Œè§£æ”¾ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
â—
and releasing all WakeLockSentinel instances of a given wake lock type will cause the underlying platform wake lock to be released.
</li>
</ul>

<p class="note">æ³¨è¨˜ï¼š
æ‰€ä¸ã®~wake~lockã‚’`~UA$ãŒ ã©ã®çŠ¶æ³ä¸‹ã§è§£æ”¾ã—å¾—ã‚‹ã‹ã«ã¤ã„ã¦ã¯ã€
æ¬¡ã«æŒ™ã’ã‚‹å„ç¯€ã‚’è¦‹ã‚ˆ
â‡’ï¼ƒ
`Â§ ~wake~lockã®è‡ªå‹•çš„ãªè§£æ”¾-æ³•ï¼ #auto-releasing-wake-locks$,
`Â§ å…¨éƒ¨çš„ã«ä½œå‹•ä¸­ã§ãªããªã£ãŸæ–‡æ›¸ã®å–æ‰±ã„ï¼ #handling-document-loss-of-full-activity$,
`Â§ å¯è¦–ã§ãªããªã£ãŸæ–‡æ›¸ã®å–æ‰±ã„ï¼ #handling-document-loss-of-visibility$
â—
Note

See auto-releasing wake locks, handling document loss of full activity and handling document loss of visibility for circumstances under which a given wake lock may be released by the user agent.
</p>

<p id="internal-slots-0">
å„ `WakeLockSentinel$I ~instanceã¯ã€
æ¬¡ã«æŒ™ã’ã‚‹`å†…éƒ¨~slot$ã‚’ä¼´ã£ã¦ä½œæˆã•ã‚Œã‚‹ï¼š
â—
9.1. Internal slots
â—
WakeLockSentinel instances are created with the following internal slots:
</p>

<div>
<dl>
	<dt>`Released@sl</dt>
	<dd>
çœŸå½å€¤
â€” åˆæœŸ~æ™‚ã¯ ~F ã¨ã™ã‚‹ã€‚
</dd>
	<dd class="note">æ³¨è¨˜ï¼š
ã“ã® `WakeLockSentinel$I ãŒè§£æ”¾ã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’æŒ‡ç¤ºã™ã‚‹ã€‚
</dd>
</dl>

â—
Internal slotï½œInitial valueï½œDescription (non-normative)
[[Released]]ï½œfalseï½œWhether the given WakeLockSentinel has been released.
</div>

<div class="algo">
<p id="the-released-attribute">
`released@m
å–å¾—å­~æ‰‹ç¶šãã¯
â‡’
~RET ã‚³ãƒ¬ . `Released$sl
â—
9.2. The released attribute
â—
The released getter steps are to return this.[[Released]].
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-released.https$wpt
</li>
</ul>
</details>

<p class="note">æ³¨è¨˜ï¼š
`WakeLockSentinel$I ãŒè§£æ”¾ã•ã‚ŒãŸãªã‚‰ã€
`released$m ã¯ ~T ã«ãªã‚Šï¼Œãã‚Œä»¥é™ã¯æ±ºã—ã¦å¤‰åŒ–ã—ãªã„ã€‚
â—
Note

Once a WakeLockSentinel is released, released becomes true, and the value never changes again.
</p>
</div>

<div class="algo">
<p id="the-type-attribute">
`type@m
å–å¾—å­~æ‰‹ç¶šãã¯
â‡’
~RET ã‚³ãƒ¬ã®`~wake~lockç¨®åˆ¥$
â—
9.3. The type attribute
â—
The type getter steps are to return this's wake lock type.
</p>
</div>

<div class="algo">
<p id="the-release-method">
`release()@m
~methodæ‰‹ç¶šãã¯ï¼š
â—
9.4. The release() method
â—
The release() method steps are:
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-onrelease.https$wpt
</li>
</ul>
</details>
<ol>
	<li>
~IFï¼»
ã‚³ãƒ¬ . `Released$sl ~EQ ~F
ï¼½
â‡’
`~wake~lockã‚’è§£æ”¾ã™ã‚‹$( ã€ã‚³ãƒ¬ã«`é–¢é€£ãªå¤§åŸŸ~obj$ã«`çµä»˜ã‘ã‚‰ã‚ŒãŸæ–‡æ›¸$ã€‘, ã‚³ãƒ¬, ã‚³ãƒ¬ã®`~wake~lockç¨®åˆ¥$ã€ï¼`type$m å±æ€§ ã®å€¤ã€‘ )
â—
If this's [[Released]] is false, then run release a wake lock with lock set to this and type set to the value of this's type attribute.
</li>
	<li>
~RET `è§£æ±ºã•ã‚Œã‚‹~promise$( `undefined^jv )
â—
Return a promise resolved with undefined.
</li>
</ol>
</div>

<p>
`onrelease@m
å±æ€§ã¯ã€
åå‰ `onrelease^l ã‚’ä¼´ã†`~event~handler$ç”¨ã®`~event~handler~IDLå±æ€§$ã§ã‚ã‚‹
â€” å¯¾å¿œã™ã‚‹`~event~handler~eventå‹$ã¯ã€
`release@et
ã§ã‚ã‚‹ã€‚
â—
9.5. The onrelease attribute
â—
The onrelease attribute is an event handler IDL attribute for the "onrelease" event handler, whose event handler event type is "release".
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-onrelease.https$wpt
</li>
</ul>
</details>

<p>
`onrelease$m ã¯ã€
æ¬¡ã‚’~scriptã«é€šçŸ¥ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã‚‹
â‡’
ã“ã® `WakeLockSentinel$I ~objã®~handleãŒï¼»
`release()$m ~methodãŒ~callã•ã‚ŒãŸï¼
å½“ã®~wake~lockãŒ`~UA$ã«ã‚ˆã‚Šè§£æ”¾ã•ã‚ŒãŸ
ï¼½ã“ã¨ã«å› ã‚Šè§£æ”¾ã•ã‚ŒãŸã€‚
â—
It is used to notify scripts that a given WakeLockSentinel object's handle has been released, either due to the release() method being called or because the wake lock was released by the user agent.
</p>

<p class="note">æ³¨è¨˜ï¼š
`WakeLockSentinel$I ~objã®~handleãŒè§£æ”¾ã•ã‚ŒãŸã¨ã—ã¦ã‚‚ã€
æ‰€ä¸ã®`~wake~lockç¨®åˆ¥$ç”¨ã®`~platform~wake~lock$ãŒè§£æ”¾ã•ã‚ŒãŸã“ã¨ã‚’æ„å‘³ã™ã‚‹ã¨ã¯é™ã‚‰ãªã„
ã€ã¾ã è§£æ”¾ã•ã‚Œã¦ãªã„ `WakeLockSentinel^I ~objãŒä»–ã«ã‚‚ã‚ã‚Šå¾—ã‚‹ã®ã§ã€‘ã€‚
ãã‚Œã¯ã€
`~platform~wake~lock$ã® `ActiveLocks$sl å†…éƒ¨~slotã«ä¾å­˜ã™ã‚‹ã€‚
`~wake~lockã‚’è§£æ”¾ã™ã‚‹$ã‚’è¦‹ã‚ˆã€‚
â—
Note

A WakeLockSentinel object's handle being released does not necessarily mean the platform wake lock for a given wake lock type was released. That depends on the platform wake lock's [[ActiveLocks]] internal slot. See release a wake lock.
</p>

<p class="note">æ³¨è¨˜ï¼š
`onrelease$m ~event~handlerã‚’`åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã®ä¾‹ï¼ #onrelease-example$ã‚‚è¦‹ã‚ˆã€‚
â—
Note

Example 2 contains an example of how to use the onrelease event handler.
</p>

		<section id="garbage-collection">
<h3 title="Garbage collection">9.6. ~garbageåé›†</h3>

<p>
`WakeLockSentinel$I ~obj %~obj ã«å¯¾ã—ã¦ã¯ã€
~ORâ†“ ãŒæº€ãŸã•ã‚Œã‚‹é–“ã¯ï¼Œ
%~obj ã«`é–¢é€£ãªå¤§åŸŸ~obj$ï¼ˆ `Window$I ~objï¼‰ã€ï¼the Window object that the WakeLockSentinel object's constructor was invoked fromã€‘ã‹ã‚‰ %~obj ã¸ã®å¼·ã„å‚ç…§ãŒåœ¨ã‚‹ãƒ¢ãƒãƒˆã‚¹ãƒ«ï¼š
â—
â†“</p>
<ul>
	<li>
ï¼»
`release$et ç”¨ã« 1 å€‹ä»¥ä¸Šã®~event~listenerãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹
ï¼½~ANDï¼»
%~obj ã¯ã¾ã è§£æ”¾ã•ã‚Œã¦ãªã„
ï¼½
â—
While a WakeLockSentinel object has one or more event listeners registered for "release", and the WakeLockSentinel object hasn't already been released, there MUST be a strong reference from the Window object that the WakeLockSentinel object's constructor was invoked from to the WakeLockSentinel object itself.
</li>
	<li>
`~screen~wake~lock~task~source$ã«å¯¾ã— %~obj ã«ã‚ˆã‚Š~queueã•ã‚ŒãŸ~taskãŒåœ¨ã‚‹
â—
While there is a task queued by an WakeLockSentinel object on the screen wake lock task source, there MUST be a strong reference from the Window object that the WakeLockSentinel object's constructor was invoked from to that WakeLockSentinel object.
</li>
</ul>

		</section>
	</section>
	<section id="the-wakelocktype-enum">
<h2 title="The WakeLockType enum">10. `WakeLockType^I åˆ—æŒ™</h2>

<p>
ã“ã®ä»•æ§˜ã¯ã€
å„`~wake~lockç¨®åˆ¥$ã‚’è¿°ã¹ã‚‹ç›®çš„ã§ï¼Œ
ãã‚Œã‚‰ã‚’è¡¨ç¾ã™ã‚‹æ¬¡ã®åˆ—æŒ™ã‚’å®šç¾©ã™ã‚‹ï¼š
â—
For the purpose of wake lock type description, this specification defines the following enumeration to represent wake lock types:
</p>

<pre class="idl">
enum `WakeLockType@I { `screen$l };
</pre>

<p>
`screen@l
ã¯ã€
ç¨®åˆ¥ `~screen~wake~lock$i ã‚’è¡¨ç¾ã™ã‚‹ã€‚
â—
screen
â€¢ Screen wake lock type.
</p>

	</section>
	<section id="managing-wake-locks">
<h2 title="Managing Wake Locks">11. ~wake~lockã®ç®¡ç†-æ³•</h2>

<p>
ã“ã®ç¯€ã¯ã€
å„`~wake~lockç¨®åˆ¥$ã«ç­‰ã—ãã‹ã¤ç‹¬ç«‹ã«é©ç”¨ã•ã‚Œã‚‹
â€” ç‰¹å®š0ã®`~wake~lockç¨®åˆ¥$ãŒæ˜ç¤ºçš„ã«è¨€åŠã•ã‚Œãªã„é™ã‚Šã€‚
â—
This section applies to each wake lock type equally and independently, unless a particular wake lock type is explicitly mentioned.
</p>

<p>
`~UA$ã¯ã€
æ‰€ä¸ã®`~wake~lockç¨®åˆ¥$ç”¨ã®
`~wake~lockã‚’é©ç”¨ã™ã‚‹ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹@
ã“ã¨ã«ã‚ˆã‚Šï¼Œå½“ã®~wake~lockã‚’ç²å¾—ã™ã‚‹ã€‚
`~UA$ã¯ã€
ãã®ã‚ˆã†ãªè¦è«‹ã®è¿”ã‚Šå€¤ã‚’æ¤œæŸ»ã—ãªã„
â€” è¨€ã„æ›ãˆã‚Œã°ã€
`~UA$ã¯ï¼Œ~wake~lockã®ç²å¾—ã‚’<strong>åŠ©è¨€çš„ã«é™ã‚‰ã‚Œã‚‹</strong>ã‚‚ã®ã¨ã—ã¦æ‰±ã†ãƒ¢ãƒãƒˆã‚¹ãƒ«ã€‚
â—
The user agent acquires the wake lock by requesting the underlying operating system to apply the lock. A possible return value of the request to the underlying operating system is not checked. In other words, user agents MUST treat wake lock acquisition as advisory-only.
</p>

<p>
é€†ã«ï¼Œ`~UA$ã¯ã€
æ‰€ä¸ã®`~wake~lockç¨®åˆ¥$ç”¨ã®
`~wake~lockã‚’ã‚‚ã¯ã‚„é©ç”¨ã—ãªã„ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹@
ã“ã¨ã«ã‚ˆã‚Šï¼Œå½“ã®~wake~lockã‚’è§£æ”¾ã™ã‚‹ã€‚
å½“ã®~lockã¯ã€
ãã®ã‚ˆã†ãªè¦è«‹ãŒæˆåŠŸã—ãŸã¨ãã«é™ã‚Šï¼Œè§£æ”¾ã•ã‚ŒãŸã‚‚ã®ã¨è¦‹ãªã•ã‚Œã‚‹ã€‚
â—
Conversely, the user agent releases the wake lock by requesting the underlying operating system to no longer apply the wake lock. The lock is considered released only when the request to the operating system succeeds.
</p>

<p>
~wake~lockãŒ
`é©ç”¨-å¯èƒ½@
ã§ã‚ã‚‹ã¨ã¯ã€
æ¬¡ãŒæº€ãŸã•ã‚Œã‚‹ã“ã¨ã‚’ã„ã†
â‡’
~OSã¯ã€
å½“ã®~lockã®é©ç”¨ã‚’è¨±å¯ã™ã‚‹çŠ¶æ…‹ã«ã‚ã‚‹
ï¼ˆä¾‹ï¼š~batteryã¯ä¸è¶³ãªãå……é›»ã•ã‚Œã¦ã„ã‚‹ï¼‰ã€‚
â—
The wake lock is applicable if the state of the operating system permits application of the lock (e.g. there is sufficient battery charge).
</p>

<p>
`~screen~wake~lock$i ã¯ã€
~screenãŒåˆ©ç”¨è€…ã«ã‚ˆã‚Šæ‰‹å‹•ã§~offã«åˆ‡æ›¿ãˆã‚‰ã‚ŒãŸå ´åˆã«ã¯ï¼Œ
å†ã³~onã«åˆ‡æ›¿ãˆã‚‰ã‚Œã‚‹ã¾ã§ï¼Œ`é©ç”¨-å¯èƒ½$ã§ãªã„ãƒ¢ãƒãƒˆã‚¹ãƒ«ã€‚
â—
The screen wake lock MUST NOT be applicable after the screen is manually switched off by the user until it is switched on again.
</p>

<p class="note">æ³¨è¨˜ï¼š
~wake~lockãŒé©ç”¨-å¯èƒ½ã‹ã©ã†ã‹ã¯ã€
ä¸€éãªæ¡ä»¶ã§ã‚ã‚‹
â€” ä¾‹ï¼š~batteryæ®‹é‡ãŒå°‘ãªãï¼Œå……é›»ã—ç›´ã•ã‚ŒãŸã¨ãã€‚
å¯è¦–æ€§~è¦ä»¶ã¨åŒæ§˜ã«ï¼Œã“ã‚Œã¯ã€
è‡ªå‹•çš„ãª~wake~lockç®¡ç†ã®ä¸€éƒ¨ã‚’æˆã™ã‚‚ã®ã§ã‚ã‚Šï¼Œ
~wake~lockã‚’è¨±å®¹ã™ã‚‹ã‹å¦èªã™ã‚‹ã‹è£å®šã™ã‚‹å‡¦ç†nã®ä¸€éƒ¨ã‚’æˆã™ã‚‚ã®ã§ã¯ãªã„ã€‚
â—
Note

Whether the wake lock is applicable is a transient condition, e.g. when the battery charge is low but then the battery is recharged. So like the visibility requirement, this is part of automatic wake lock management and not part of the decision process whether to allow or deny the wake lock.
</p>

		<section id="auto-releasing-wake-locks">
<h3 title="Auto-releasing wake locks">11.1. ~wake~lockã®è‡ªå‹•çš„ãªè§£æ”¾-æ³•</h3>

<p>
~UAã¯ã€
ã„ã¤ã§ã‚‚`~wake~lockã‚’è§£æ”¾-ï¼ #dfn-release-a-wake-lock$ã—ã¦ãƒ¨ã‚¤ã€‚
ä¾‹ãˆã°ã€
æ¬¡ã«æŒ™ã’ã‚‹ã¨ãï¼š
â—
A user agent may release a wake lock at any time. For example, when:
</p>
<ul>
	<li>
æ­£å¸¸ã§ãªã„æ¼”ç®—ã‚’æ¤œå‡ºã—ãŸã¨ã
â€” ä¾‹ï¼šç„¡é™~loopã«ãªã£ãŸï¼èª²ã•ã‚ŒãŸæ™‚é–“~åˆ¶é™sã‚’è¶…éã—ãŸ~taskãŒåœ¨ã‚‹ã€‚
â—
It detects abnormal operation: such as infinite loops and tasks exceeding imposed time limits (if any).
</li>
	<li>
~batteryã®æ®‹é‡ãŒå°‘ãªãæ”¾é›»-ä¸­ã¨è¦‹ãªã•ã‚Œã‚‹ã¨ãã€‚
â—
Battery is considered low and discharging.
</li>
	<li>
åˆ©ç”¨è€…ã¯ã€
ä½•ã‚‰ã‹ã®ç¨®é¡ã®æ©Ÿå™¨~é›»åŠ›~æ¸©å­˜~modeã‚’~onã«ã—ãŸã€‚
â—
The user turns on some kind of device power conservation mode.
</li>
	<li>
~OSã¯ã€
åˆ©ç”¨è€…ãŒå±…ã‚‹ã‹ã©ã†ã‹ã«åŸºã¥ã„ã¦ï¼Œ~screenã‚’ï¼»
æš—ãã™ã‚‹ï¼~offã«ã™ã‚‹
ï¼½ã‚ˆã†ç’°å¢ƒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚
â—
The operating system is configured to dim or turn off the screen based on the user presence state.
</li>
</ul>

		</section>
		<section id="handling-document-loss-of-full-activity">
<h3 title="Handling document loss of full activity">11.2. å…¨éƒ¨çš„ã«ä½œå‹•ä¸­ã§ãªããªã£ãŸæ–‡æ›¸ã®å–æ‰±ã„</h3>

<div class="algo">
<p>
æ‰€ä¸ã® `Document$I %æ–‡æ›¸ ãŒã‚‚ã¯ã‚„`å…¨éƒ¨çš„ã«ä½œå‹•ä¸­$ã§ãªããªã£ãŸã¨ãã¯ã€
~UAã¯ï¼Œæ¬¡ã®æ‰‹ç¶šãã‚’èµ°ã‚‰ã™ãƒ¢ãƒãƒˆã‚¹ãƒ«ï¼š
â—
When a Document document becomes no longer fully active, the user agent must run these steps:
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-active-document.https.window$wpt
</ul>
</details>

<ol>
	<li>
%æ–‡æ›¸ . `ActiveLocks$sl[ `screen^l ] ã‚’æˆã™
~EACH( %~lock )
ã«å¯¾ã—
â‡’
`~wake~lockã‚’è§£æ”¾ã™ã‚‹$( %æ–‡æ›¸, %~lock, `screen$l )
â—
For each lock in document.[[ActiveLocks]]["screen"]:
â€¢ Run release a wake lock with document, lock, and "screen".
</li>
</ol>
</div>

		</section>
		<section id="handling-document-loss-of-visibility">
<h3 title="Handling document loss of visibility">11.3. å¯è¦–ã§ãªããªã£ãŸæ–‡æ›¸ã®å–æ‰±ã„</h3>

<div class="algo">
<p>
ã“ã®ä»•æ§˜ã¯ã€
`~pageå¯è¦–æ€§~å¤‰åŒ–-æ™‚ã®æ‰‹ç¶šã$ã¨ã—ã¦
æ¬¡ã‚’å®šç¾©ã™ã‚‹
â€” ãã‚Œã¯ã€
æ‰€ä¸ã®
( `å¯è¦–æ€§~çŠ¶æ…‹$doc %çŠ¶æ…‹, %æ–‡æ›¸ )
ã«å¯¾ã—ï¼š
â—
This specification defines the following page visibility change steps with visibility state state and document:
</p>

<details>
<summary>~test</summary>
<ul>
<li>`wakelock-document-hidden-manual.https$wpt
</ul>
</details>
<ol>
	<li>
~IFï¼»
%çŠ¶æ…‹ ~NEQ `hidden^l
ï¼½
â‡’
~RET
â—
If state is not "hidden", abort these steps.
</li>
	<li>
%æ–‡æ›¸ . `ActiveLocks$sl[ `screen^l ] ã‚’æˆã™
~EACH( %~lock )
ã«å¯¾ã—
â‡’
`~wake~lockã‚’è§£æ”¾ã™ã‚‹$( %æ–‡æ›¸, %~lock, `screen$l )
â—
For each lock in document.[[ActiveLocks]]["screen"]:
â€¢ Run release a wake lock with document, lock, and "screen".
</li>
</ol>
</div>

		</section>
		<section id="acquire-wake-lock-algorithm">
<h3 title="Acquire wake lock algorithm">11.4. ~wake~lockã‚’ç²å¾—ã™ã‚‹~algo</h3>

<div class="algo">
<p>
`~wake~lockã‚’ç²å¾—ã™ã‚‹@
~algoã¯ã€
æ‰€ä¸ã®
( `~wake~lockç¨®åˆ¥$ã€ï¼ç¨®åˆ¥ã€‘ %ç¨®åˆ¥ )
ã«å¯¾ã—ï¼š
â—
To acquire a wake lock for a given type, run these steps:
</p>
<ol>
	<li>
~IFï¼»
%ç¨®åˆ¥ ç”¨ã®~wake~lockã¯`é©ç”¨-å¯èƒ½$ã§ãªã„
ï¼½
â‡’
~RET
â—
If the wake lock for type type is not applicable, abort these steps.
</li>
	<li>
%ç¨®åˆ¥ ç”¨ã®`~wake~lockã‚’é©ç”¨ã™ã‚‹ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹$
â—
Ask the underlying operating system to acquire the wake lock of type type.
</li>
</ol>
</div>

		</section>
		<section id="release-wake-lock-algorithm">
<h3 title="Release wake lock algorithm">11.5. ~wake~lockã‚’è§£æ”¾ã™ã‚‹~algo</h3>

<div class="algo">
<p>
`~wake~lockã‚’è§£æ”¾ã™ã‚‹@
~algoã¯ã€
æ‰€ä¸ã®
( %æ–‡æ›¸, %~lock, `~wake~lockç¨®åˆ¥$ %ç¨®åˆ¥ )
ã«å¯¾ã—ï¼š
â—
To release a wake lock for a given document, lock, and type, run these steps:
</p>
<ol>
	<li>
~IFï¼»
%~lock ~NIN  %æ–‡æ›¸ . `ActiveLocks$sl[ %ç¨®åˆ¥ ]
ï¼½
â‡’
~RET
â—
If document.[[ActiveLocks]][type] does not contain lock, abort these steps.
</li>
	<li>
%æ–‡æ›¸ . `ActiveLocks$sl[ %ç¨®åˆ¥ ] ã‹ã‚‰ %~lock ã‚’`é™¤å»ã™ã‚‹$
â—
Remove lock from document.[[ActiveLocks]][type].
</li>
	<li>
<p>
~IFï¼»
%æ–‡æ›¸ . `ActiveLocks$sl[ %ç¨®åˆ¥ ] ã¯`ç©º$ã§ã‚ã‚‹
ï¼½
â‡’
æ¬¡ã®æ‰‹ç¶šãã‚’`ä¸¦åˆ—çš„$ã«èµ°ã‚‰ã™
â—
If document.[[ActiveLocks]][type] is empty, then run the following steps in parallel:
</p>

<div class="algo">
<p>
æ‰‹ç¶šãã¯ï¼š
</p>
		<ol>
			<li>
%ç¨®åˆ¥ ç”¨ã®`~wake~lockã‚’ã‚‚ã¯ã‚„é©ç”¨ã—ãªã„ã‚ˆã†ä¸‹å±¤ã®~OSã«è¦è«‹ã™ã‚‹$
â—
Ask the underlying operating system to release the wake lock of type typeï¼¼
</li>
			<li>
<p>
~IFï¼»
å‰~æ®µã¯æˆåŠŸã—ãŸ
ï¼½~ANDï¼»
%ç¨®åˆ¥ ~EQ `screen^l
ï¼½
â‡’
~platformã«ç‰¹æœ‰ãªç„¡æ´»å‹•~timerã‚’è¨­å®šã—ç›´ã™
â€” ~screenãŒå®Ÿéš›ã«~offã«ã•ã‚Œã‚‹ã®ã¯ã€
ãã®å¾Œã«ãªã‚‹ã‚ˆã†
â—
and let success be true if the operation succeeded, or else false.
â—
If success is true and type is "screen" run the following:
â€¢ Reset the platform-specific inactivity timer after which the screen is actually turned off.
</p>

<p class="note">æ³¨è¨˜ï¼š
ç„¡æ´»å‹•~timerã‚’è¨­å®šã—ç›´ã™ã®ã¯ã€
~wake~lockãŒè§£æ”¾ã•ã‚ŒãŸç›´å¾Œã«~screenãŒ~offã€ï¼blankã€‘ã«ãªã‚‹ã®ã‚’é˜²æ­¢ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚
â—
Note

Resetting the inactivity timer prevents the screen from going blank immediately after the wake lock is released.
</p>
			</li>
		</ol>
</div>
	</li>
	<li>
%~lock ã® `Released$sl ~SET ~T
â—
Set lock's [[Released]] to true.
</li>
	<li>
`~eventã‚’ç™ºç«ã™ã‚‹$( %~lock, `release$et )
â—
Fire an event named "release" at lock.
</li>
</ol>
</div>

		</section>
	</section>
	<section id="security-and-privacy-considerations">
<h2 title="Security and privacy considerations">12. ~securityï¼~privacy ã®è€ƒæ…®ç‚¹</h2>

<p>
~screen~wake~lockã¯ã€
æ§˜ã€…ãªæ©Ÿå™¨~component
â€” ç‰¹ã«~display â€”
ã‚’ï¼Œ~lockã•ã‚Œãªã„å ´åˆã‚ˆã‚Šé«˜ã„é›»åŠ›ã§é‹ç”¨ã•ã›å¾—ã‚‹ã€‚
ã“ã‚Œã¯ã€
æœ›ã¾ã—ããªã„åŠ¹æœã¸è‡³ã‚‰ã›å¾—ã‚‹
â€” æ©Ÿå™¨ãŒè‡ªèº«ã‚’è‡ªå‹•çš„ã«~lockã™ã‚‹ã“ã¨ã‚’é˜²æ­¢ã—ã¦ï¼Œ~batteryã®æ¶ˆè€—ãŒé€Ÿããªã‚‹ãªã©ã€‚
ãã‚Œã¯ã€
è¿‘ãã«å¯ç”¨ãªé›»æºãŒç„¡ã„ã“ã¨ãŒå¤šã„~mobileæ©Ÿå™¨ã«ãŠã„ã¦ç‰¹ã«æ‡¸å¿µã•ã‚Œã‚‹ã€‚
äºˆæœŸã•ã‚Œãªã„æ™‚ç‚¹ã«~batteryãŒå®Œå…¨ã«æ¶ˆè€—ã™ã‚‹ã¨ã€
åˆ©ç”¨è€…ã¯ï¼Œé€šè©±ã‚„~network~serviceï¼ˆç·Šæ€¥~call~serviceã‚‚å«ã‚€ï¼‰ã‚’åˆ©ç”¨-ä¸èƒ½ã«ãªã‚‹ã€‚
â—
Screen wake locks can cause various device components - particularly the display - to operate at higher power levels than they otherwise would. This can lead to undesirable effects, such as preventing the device from automatically locking itself and faster battery depletion. Faster battery depletion is of particular concern for mobile devices, which often don't have a stationary power source readily available. Complete battery depletion at an unexpected time can lead to inability of the user to make or receive calls and use network services, including the emergency call service.
</p>

<p>
å®Ÿè£…ã¯ã€
ä¾‹ãˆã°ï¼»
~batteryå®¹é‡ãŒå°‘ãªã„å ´åˆï¼
åˆ©ç”¨è€…ãŒè‡ªèº«ã®æ©Ÿå™¨ã‚’é›»åŠ›~ç¯€ç´„~modeã«ç½®ã„ãŸå ´åˆ
ï¼½ã«ã¯ï¼Œ~screen~wake~lockç”¨ã®è¦è«‹ã‚’ç„¡è¦–ã—ã¦ã‚‚ãƒ¨ã‚¤ã€‚
â—
Implementations MAY ignore requests for screen wake lock if, for example, the battery capacity is low, or the user has put their device in a power-saving mode.
</p>

<p>
~UAã«ã¯ã€ï¼»
~screen~wake~lockãŒã„ã¤ä½œå‹•ä¸­ã«ãªã£ãŸã‹ï¼Œåˆ©ç”¨è€…ãŒçŸ¥ã‚‹ã“ã¨ã‚’è¨±å®¹ã™ã‚‹
ï¼½ã‚ˆã†ï¼Œä½•ã‚‰ã‹ã®~UIã‚„æŒ‡ç¤ºå­ã‚’ä¾›ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚
ãã®ã‚ˆã†ãª~UIã‚’ä¾›ã™ã‚‹ã“ã¨ã¯ã€
æœ«ç«¯-åˆ©ç”¨è€…ãŒï¼»
ç‰¹å®š0ã®~web~appãŒï¼Œæ©Ÿå™¨ã®æ¶ˆè²»é›»åŠ›ã«è² ãªå½±éŸ¿iãŒã‚ã‚‹
ï¼½ã“ã¨ã‚’è­˜åˆ¥ã™ã‚‹åŠ©ã‘ã«ã‚‚ãªã‚Šã€
ãã‚Œã§ã‚‚æ¬²ã•ã‚Œã‚‹å ´åˆã«ã¯ï¼Œãã®ãŸã‚ã®å‹•ä½œã‚’ã¨ã‚‹ã“ã¨ã‚‚å½¼ã‚‰ã«è¨±å®¹ã™ã‚‹ã€‚
â—
It is RECOMMENDED that a user agent provide some UI or indicator that allows the user to know when a screen wake lock is active. Providing such a UI could help end users to identify if a particular web application is having a negative energy impact on the device, and allow them to take action if so desired.
</p>

	</section>
	<section id="examples">
<h2 title="Examples">13. ä¾‹</h2>
â—éè¦ç¯„çš„

<div class="example" id="example-acquires-and-releases-a-screen-wake-lock">
<p>
~screen~wake~lockã‚’ç²å¾—ã—ã¦ï¼Œã€ä¸€å®šæ™‚é–“å¾Œã«ã€‘è§£æ”¾ã™ã‚‹ä¾‹ï¼š
â—
Example 1: Acquires and releases a screen wake lock
</p>

<pre class="lang-js">
function tryKeepScreenAlive(%minutes) {
  navigator.wakeLock.request("screen").then(%lock =&gt; {
    setTimeout(() =&gt; %lock.release(), %minutes * 60 * 1000);
  });
}

tryKeepScreenAlive(10);
</pre>
</div>

<div class="example" id="onrelease-example">
<p>
ã“ã®ä¾‹ã¯ã€ï¼»
ã‚ã‚‹~checkboxã‚’~clickã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œ~screen~wake~lockã‚’è¦è«‹ã™ã‚‹
ï¼½ã“ã¨ã‚’åˆ©ç”¨è€…ã«è¨±å®¹ã™ã‚‹ã“ã¨ã«åŠ ãˆã€
~wake~lockçŠ¶æ…‹ãŒå¤‰åŒ–ã—ãŸäº‹ä¾‹ã§ã¯ï¼Œ
å½“ã®~checkboxã‚’~checkã•ã‚ŒãŸçŠ¶æ…‹ã«æ›´æ–°ã™ã‚‹ï¼š
â—
This example allows the user to request a screen wake lock by clicking on a checkbox, but updates the checkbox checked state in case the wake lock state changes:
â—
Example 2
</p>

<pre class="lang-js">
const %checkbox = document.createElement("input");
%checkbox.setAttribute("type", "checkbox");
document.body.appendChild(%checkbox);

const %sentinel = await navigator.wakeLock.request("screen");
%checkbox.checked = !%sentinel.released;
%sentinel.onrelease = () =&gt; %checkbox.checked = !%sentinel.released;
</pre>
</div>

<div class="example" id="example-3">
<p>
2 å€‹ã®ç•°ãªã‚‹~wake~lockè¦è«‹ã‚’ç‹¬ç«‹ã«ä½œæˆã—ã¦è§£æ”¾ã™ã‚‹ä¾‹ï¼š
â—
In this example, two different wake lock requests are created and released independently:
â—
Example 3
</p>

<pre class="lang-js">
let %lock1 = await navigator.wakeLock.request("screen");
let %lock2 = await navigator.wakeLock.request("screen");

%lock1.release();
%lock2.release();
</pre>
</div>

	</section>
ã€ï¼Conformanceã€‘
	<section id="acknowledgments">
<h2 title="A. Acknowledgments">è¬è¾</h2>
â—éè¦ç¯„çš„

<p>
æ¬¡ã«æŒ™ã’ã‚‹æ–¹ã€…ã«ã‚ˆã‚‹ï¼Œã“ã®ä½œæ¥­ã«å¯¾ã™ã‚‹è²¢çŒ®ã«æ„Ÿè¬ã—ãŸã„
â‡’
`Mounir Lamouri, Sergey Konstantinov, Matvey Larionov, Dominique Hazael-Massieux, Domenic Denicola, Thomas Steiner, Anne van Kesteren^en
â—
We would like to offer our sincere thanks to Mounir Lamouri, Sergey Konstantinov, Matvey Larionov, Dominique Hazael-Massieux, Domenic Denicola, Thomas Steiner, Anne van Kesteren for their contributions to this work.
</p>

	</section>
	<section id="changes">
<h2 title="Changes">å¤‰æ›´ç‚¹</h2>

â—éè¦ç¯„çš„

<p>
ã“ã®ç¯€ã¯ã€
ä»¥å‰ã®å…¬è¡¨ã‹ã‚‰ã®å¤‰æ›´ç‚¹ã‚’æ–‡æ›¸åŒ–ã™ã‚‹ã€‚
â—
This section documents the changes since previous publications.
</p>
<dl>
	<dt id="changes-20171214">
2017å¹´ 12æœˆ 14æ—¥ å‹§å‘Šå€™è£œã‹ã‚‰ã®å¤‰æ›´ç‚¹
â—
B.1. Changes since the 14 December 2017 CR
</dt>
	<dd>
ã“ã®æ–‡æ›¸ã€ã«ãŠã‘ã‚‹~screen~wakeç¨®åˆ¥ã€‘ã‚’~screen~wake~lockã ã‘ã«çµã£ã¦ï¼Œ
~system~lockã‚’æ–°ãŸãªä»•æ§˜ã¸ç§»å‹•ã—ãŸã€‚
â—
Convert the document to purely screen wake lock, and move system lock to a new specification.
</dd>
	<dd>
åˆ©ç”¨è€…~å¯è¦–~APIã‚’æ›¸ãç›´ã—ãŸã€‚
â—
Rewrite user-visible API.
</dd>
	<dd>
å¯è¦–ã§ãªããªã£ãŸæ–‡æ›¸ã‚’å‡¦ã™ã‚‹ãŸã‚ã€
`WakeLock.request()^c ã«
`ä¸­æ­¢ã•ã‚ŒãŸã¨ãï¼ ~INFRA#if-aborted$ã®æ®µã‚’è¿½åŠ ã—ãŸã€‚
ã€ã“ã®å¤‰æ›´ã«è©²å½“ã™ã‚‹ç®‡æ‰€ã¯ã€ã“ã®ä»•æ§˜ã«ã¯ç„¡ã„ï¼ˆä»–ã®ä»•æ§˜ã«ç§»å‹•ã•ã‚ŒãŸã¨æ€ã‚ã‚Œã‚‹ï¼‰ã€‘
â—
Add an if aborted step to WakeLock.request() to deal with hidden documents.
</dd>
	<dd>
~IDLç´¢å¼•ã‚’è¿½åŠ ã—ãŸã€‚
â—
Add an IDL Index.
</dd>
	<dd>
é‡è¤‡ãªè¦ç¯„çš„ãªè¨€æ˜ã‚’é™¤å»ã—ãŸã€‚
â—
Remove duplicate normative statements.
</dd>
	<dd>
å„~ä¾‹ã‚’ç¾ä»£åŒ–ã—ãŸã€‚
â—
Modernize the examples.
</dd>
	<dd>
æ³¨é‡ˆæ–‡ã«ä»£ãˆã¦å†…éƒ¨~slotã‚’åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã—ãŸã€‚
â—
Use internal slots instead of prose.
</dd>
	<dd>
~UAãŒ ã„ã¤`~wake~lockã‚’è§£æ”¾-ï¼ #dfn-release-a-wake-lock$ã—ã¦ã‚‚ãƒ¨ã‚¤ã¨ã•ã‚Œã‚‹ã‹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’è¿½åŠ ã—ãŸã€‚
â—
Add info on when the user agent may release a wake lock.
</dd>
	<dd>
æ–‡æ›¸ã®å¯è¦–æ€§ã‚’å–æ‰±ã†ã‚ˆã†ã«ã—ãŸã€‚
â—
Handle document visibility.
</dd>
	<dd>
`ScreenWakeLock^I ã‚’æ§‹ç¯‰-å¯èƒ½ã«ã—ãŸã€‚
â—
Make ScreenWakeLock constructable.
</dd>
	<dd>
ä»»æ„é¸æŠãªè¨±å¯~promptæ³•ã‚’çµ±åˆã—ãŸã€‚
â—
Integrate optional permission prompting.
</dd>
	<dd>
ï¼»
å…¨éƒ¨çš„ã«ä½œå‹•ä¸­ã§ãªããªã£ãŸæ–‡æ›¸,
~workerå†…ã§èµ°ã£ã¦ã„ã‚‹å ´åˆ
ï¼½ã‚’å–æ‰±ã†ã‚ˆã†ã«ã—ãŸã€‚
ã€ãŒã€~workerã«é–¢ã™ã‚‹è¨˜è¿°ã¯ï¼Œã“ã®ä»•æ§˜~å†…ã«ã¯ç„¡ã„ã€‘
â—
Handle loss of full activity, as well as running in workers.
</dd>
	<dd>
Â§ åºè«–ã‚’æ›¸ãç›´ã—ãŸã€‚
â—
Rewrite the introduction section.
</dd>
	<dd>
`Feature Policy^enï¼ˆç‰¹èƒ½~æ–½ç­–ï¼‰ã‚’
`Permissions Policy^enï¼ˆè¨±å¯~æ–½ç­–ï¼‰ã«æ”¹ç§°ã—ãŸã€‚
â—
Rename Feature Policy to Permissions Policy.
</dd>
	<dd>
`WakeLockSentinel.released^c
ã‚’è¿½åŠ ã—ãŸã€‚
â—
Add WakeLockSentinel.released.
</dd>
	<dd>
ã“ã®ä»•æ§˜ã«ãŠã‘ã‚‹~taskç”¨ã®~task~sourceã‚’å®šç¾©ã—ãŸã€‚
â—
Define a task source for tasks in this specification.
</dd>
</dl>

	</section>
</main></div>

