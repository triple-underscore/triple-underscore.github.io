<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>DeviceOrientation Event Specification （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-w3c.css" type="text/css">

<style>

._matrix tr {
	border: none;
}
._matrix td {
	text-align: center;
	padding: 0.2em 0.5em;
}
._matrix {
	border-collapse: separate;
	border-spacing: 0;
	border: thin solid black;
	border-style: none solid;
	border-radius: 5px;
}

._math-formula {
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	column-gap: 0.4em;
}

div._math-formula {
	margin-left: 2em;
	
}

</style>

<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		persisted_parts: Object.create(null),
		generate: expand
	};

	{
		// 行列表現を生成
		let data = PAGE_DATA.matrix_data
.replace( /\s*●(.+)/g,
	'</tbody></table><table id="_dgm-$1" class="_matrix"><tbody>' )
.replace(/[\s\S]*?<\/table>/, '')
.replace(/\n(?=[^<\s])/g, '<tr><td>')
.replace(/,[ \t]*/g, '<td>')
.replace(/\.(\w+)/g, '<sub>$1</sub>')
.replace(/%([\wα-γθ]+)/g, '<var>$1</var>')
+ '</tbody></table>';

		delete PAGE_DATA.matrix_data;

		const div = C('div');
		div.innerHTML = data;
		for(let e = div.firstElementChild; e; e = e.nextElementSibling){
			if(e.id){
				source_data.persisted_parts[e.id] = e;
			}
		}
	}

	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;
	let ctx_ifc = '';

	return this.html.replace(
		/%[\w\-~一-鿆あ-んα-γθ]+|`(.+?)([$@\^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){
if(!indicator) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('＠');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r': // ref
	text = `[${key}]`;
	href = `#biblio-${key.toLowerCase()}`;
	break;
case 'l': // literal
	text = `"<code class="literal">${text}</code>"`;
	break;
case 'mc':
	text = 'constructor';
	href = `#dom-${key.toLowerCase()}-${key.toLowerCase()}`;
	break;
case 'I': // set context if @
	if( indicator === '@'){
		ctx_ifc = key.toLowerCase();
	}
	break;
case 'I0': // set context
	ctx_ifc = key.toLowerCase();
	return '';
	break;
case 'm':
	const n = text.indexOf('(');
	if(n > 0){
		key = text.slice(0, n);
		text = key + text.slice(n).replace(/\w+/g, '<var>$&</var>');
	}
	href = `#dom-${ctx_ifc}-${key.toLowerCase()}`;
	break;
case 'sl':
	text = `[[${text}]]`;
	break;
case 'dgm':
	return `<a id="_dgm-${key}">＊</a>`;
	break;
case 'en':
	return `<span lang="en">${key}</span>`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;

	}
}

</script>

<script type="text/plain" id="_source_data">

●●options

spec_title:DeviceOrientation Event Specification
spec_date:2023-04-21
trans_update:2023-04-01
source_checked:190131
spec_status:ED
original_url:https://w3c.github.io/deviceorientation/
ref_id_prefix:biblio-
page_state_key:SENSORS
site_nav:sensors,uievents
ref_id_lowercase:true
copyright:2023,permissive
trans_1st_pub:2019-02-28

●●class_map
et:event-type
op:op
E:error

●●tag_map
E:code
I:code
mc:code
m:code
n:code
et:code
op:span
cite:cite

●●original_id_map

●●mdn_urls
devicemotionevent:API/DeviceMotionEvent
devicemotioneventacceleration:API/DeviceMotionEventAcceleration
devicemotioneventrotationrate:API/DeviceMotionEventRotationRate
deviceorientationevent:API/DeviceOrientationEvent
	dictdef-devicemotioneventaccelerationinit:API/DeviceMotionEventAccelerationInit
	dictdef-devicemotioneventinit:API/DeviceMotionEventInit
	dictdef-devicemotioneventrotationrateinit:API/DeviceMotionEventRotationRateInit
	dictdef-deviceorientationeventinit:API/DeviceOrientationEventInit

def-deviceorientation:Events/deviceorientation
def-devicemotion:Events/devicemotion
	def-deviceorientationabsolute:Events/deviceorientationabsolute

●●link_map

	●IDL

Exposed:~WEBIDLjs#Exposed
SecureContext:~WEBIDLjs#SecureContext
boolean:~WEBIDL#idl-boolean
double:~WEBIDL#idl-double
DOMString:~WEBIDL#idl-DOMString
Promise:~WEBIDL#idl-promise

E.NotAllowedError:~WEBIDL#notallowederror
	例外／DOMException:~WEBIDL#idl-DOMException

I.DeviceMotionEvent:#devicemotionevent
I.DeviceMotionEventAcceleration:#devicemotioneventacceleration
I.DeviceMotionEventAccelerationInit:#dictdef-devicemotioneventaccelerationinit
I.DeviceMotionEventInit:#dictdef-devicemotioneventinit
I.DeviceMotionEventRotationRate:#devicemotioneventrotationrate
I.DeviceMotionEventRotationRateInit:#dictdef-devicemotioneventrotationrateinit
I.DeviceOrientationEvent:#deviceorientationevent
I.DeviceOrientationEventInit:#dictdef-deviceorientationeventinit
I.PermissionState:~PERMISSIONS#dom-permissionstate

I.Event:~DOM4#event
I.EventHandler:~WAPI#eventhandler
I.EventInit:~DOM4#dictdef-eventinit
I.Window:~WINDOW#window
I.WindowEventHandlers:~WAPI#windoweventhandlers


	■DeviceOrientationEvent
	m.Constructor:#dom-deviceorientationevent-deviceorientationevent
	%type:#dom-deviceorientationevent-deviceorientationevent-type-eventinitdict-type
	%eventInitDict:#dom-deviceorientationevent-deviceorientationevent-type-eventinitdict-eventinitdict

	m.alpha:#dom-deviceorientationevent-alpha
	m.beta:#dom-deviceorientationevent-beta
	m.gamma:#dom-deviceorientationevent-gamma
	m.absolute:#dom-deviceorientationevent-absolute
	m.requestPermission:#dom-deviceorientationevent-requestpermission

	■DeviceOrientationEventInit
	m.alpha:#dom-deviceorientationeventinit-alpha
	m.beta:#dom-deviceorientationeventinit-beta
	m.gamma:#dom-deviceorientationeventinit-gamma
	m.absolute:#dom-deviceorientationeventinit-absolute
	
	■DeviceMotionEventAcceleration
	m.x:#dom-devicemotioneventacceleration-x
	m.y:#dom-devicemotioneventacceleration-y
	m.z:#dom-devicemotioneventacceleration-z

	■DeviceMotionEventRotationRate
	m.alpha:#dom-devicemotioneventrotationrate-alpha
	m.beta:#dom-devicemotioneventrotationrate-beta
	m.gamma:#dom-devicemotioneventrotationrate-gamma
	m.Constructor:#dom-devicemotionevent-devicemotionevent
	m.type:#dom-devicemotionevent-devicemotionevent-type-eventinitdict-type
	m.eventInitDict:#dom-devicemotionevent-devicemotionevent-type-eventinitdict-eventinitdict

	■DeviceMotionEvent
	m.acceleration:#dom-devicemotionevent-acceleration
	m.accelerationIncludingGravity:#dom-devicemotionevent-accelerationincludinggravity
	m.rotationRate:#dom-devicemotionevent-rotationrate
	m.interval:#dom-devicemotionevent-interval
	m.requestPermission:#dom-devicemotionevent-requestpermission

	■DeviceMotionEventAccelerationInit
	m.x:#dom-devicemotioneventaccelerationinit-x
	m.y:#dom-devicemotioneventaccelerationinit-y
	m.z:#dom-devicemotioneventaccelerationinit-z

	■DeviceMotionEventRotationRateInit
	m.alpha:#dom-devicemotioneventrotationrateinit-alpha
	m.beta:#dom-devicemotioneventrotationrateinit-beta
	m.gamma:#dom-devicemotioneventrotationrateinit-gamma

	■DeviceMotionEventInit
	m.acceleration:#dom-devicemotioneventinit-acceleration
	m.accelerationIncludingGravity:#dom-devicemotioneventinit-accelerationincludinggravity
	m.rotationRate:#dom-devicemotioneventinit-rotationrate
	m.interval:#dom-devicemotioneventinit-interval

~window:~WINDOW#the-window-object
	n.window:~WINDOW#dom-window	→ ~window

n.ondeviceorientation:#dom-window-ondeviceorientation
n.ondeviceorientationabsolute:#dom-window-ondeviceorientationabsolute
n.ondevicemotion:#dom-window-ondevicemotion

n.rotateSelf():~GEOMETRY#dom-dommatrix-rotateself
n.rotate():~GEOMETRY#dom-dommatrixreadonly-rotate

et.orientationchange:~COMPAT#event-orientationchange
et.deviceorientation:#def-deviceorientation
et.deviceorientationabsolute:#def-deviceorientationabsolute
et.devicemotion:#def-devicemotion

	●用語
地球~基準系:#_earth-frame
本体~基準系:#_body-frame

許可:#permission

§~compass-headingの計算-法:#worked-example
	§:#introduction
	§:#use-cases
	§:#deviceorientation

	●外部
並列的:~HTMLINFRA#in-parallel

doc.可視性~状態:~HTMLinteraction#visibility-state
	可視:~PAGE-VISIBILITY#dom-visibilitystate-visible
	https://www.w3.org/TR/page-visibility-2/#dom-visibilitystate-visible

生成元:~ORIGIN#concept-origin
同一-生成元:~ORIGIN#same-origin

結付けられている文書:~WINDOW#concept-document-window
~node~navigable:~HTMLds#node-navigable
nav.作動中な文書:~HTMLds#nav-document
nav.~top-level辿可能:~HTMLds#nav-top
全部的に作動中:~HTMLds#fully-active

	bc.作動中な文書:~HTMLds#active-document
	廃）入子な閲覧~文脈:~BROWSERS#nested-browsing-context
	~top-level閲覧~文脈:~HTMLds#top-level-browsing-context

~eventを発火する:~DOM4#concept-event-fire
doc.生成元:~DOM4#concept-document-origin

~event~handler~event型:~WAPI#event-handler-event-type
~event~handler~IDL属性:~WAPI#event-handler-idl-attributes
enV.生成元:~WAPI#concept-settings-object-origin
関連な設定群~obj:~WAPI#relevant-settings-object
~taskを~queueする:~WAPI#queue-a-task
関連な大域~obj:~WAPI#concept-relevant-global
一過な作動化？:~HTMLinteraction#transient-activation

	廃）利用者の作動化により誘発され:~HTMLinteraction#triggered-by-user-activation
~promiseを却下する:~WEBIDLjs#reject
~promiseを解決する:~WEBIDLjs#resolve

enV.~secureな文脈:~WAPI#secure-context

加速度計:~MOTION-SENSORS#accelerometer
線形~加速度~sensor:~MOTION-SENSORS#linear-acceleration-sensor
~sensor融合:~SENSORS#sensor-fusion
	Motion Sensors Explainer

●●words_table1
COMPAT:compat-ja.html
	https://compat.spec.whatwg.org/
MOTION-SENSORS:motion-sensors-ja.html

pow2:<sup>2</sup>
	DIV:<span class="op">/</span>

●●words_table


	●機器
battery::::バッテリー
display::::ディスプレイ
compass::::コンパス
compass-heading:compass heading:compass の向き::コンパスの向き
gimbal-lock:gimbal lock:::ジンバルロック
gyroscope::::ジャイロスコープ
laptop-computer:laptop computer:::ノートPC
sensor::::センサー
tablet::::タブレット
hosting::::ホスト
融合:fusion::~

	握って:hold して
	握って:holding the device in their hand
乗物:vehicle:~
加速度:acceleration::~
加速度計:accelerometer::~
磁力計:magnetometer::~
信号:signal::~
搭載-:mount:~
携帯:mobile::~::モバイル
電話:phone:~
旋回する:swiveling:~
後部:rear:~
対面-:face:~
寿命:life:~
地図:map:~

較正-:calibrate::~
較正:calibration::~
右手:right-hand:~

	^en:shaking
sprite::::スプライト

	眺める:view
	~~運行:travel
	組み込まれた:integrated
	~~部位:element
	~~展開-:deploy
	引き出し式の:slide-out

	●物理／幾何
x:
y:
z:
xyz:
X:
Y:
Z:
XYZ:
右手系:right-hand convention::~
左手系:left-hand convention::~

基準座標系:coordinate frame::~
基準系:frame::~
	座標:Cartesian coordinate

運動:movement::動き
動き:motion::~
傾き:tilting::~
半径:radius::~
右周りに:right-hand bendに::~
回転-:rotate::~
回転:rotation::~
地平面:ground plane::~
地球:Earth::~
	地球:earth
地球楕円体:spheriod::~
垂直:perpendicular::~
	直立して:vertical in front
垂直面:vertical plane:~
	垂直面に:in a vertical plane
	垂直面／直立面を成す
縦置き:portrait::~
水平:horizontal::~
	水平~面に寝かされ:lying flat on a horizontal surface
面:surface::~
平面:plane::~
度d:degree:deg:度°
北極:North-Pole:~
真北:True North:~
北:North:~
東:East:~
西:West:~
	真上:Up／:uppermost
	真上を向いて:upward

	上端が真上を指すよう:the top uppermost
時計回り:clockwise::~
自由落下:free-fall::~
速度:speed::~
重力:gravity::~
重心:center of mass::~
率:rate::~
側:side::~
力学:dynamics::~
	接する:tangent
揃えら:alignさ:~
揃う:alignする:~
	オイラー角:Tait-Bryan angle
meter::::メートル
milli::::ミリ
	~milli秒:millisecond
	秒:second
線形:linear::~

	~~直交して:orthogonal
	右:right
	向く:towards
	回され:turn
	背面から先 out of the back of
	~~逆回転:in the opposite sense

	●算術
alpha:
beta:
gamma:
radian::::ラジアン
行列:matrix::~
四元数:quaternion::~
	四元数:Quaternion
四平方定理:four-square-theorem::~
座標系変換:transformation::~
数学的:mathematical::~
近似的:approximate::~
正値:positive:~
変形:transform::~

	~pow2:squared
	等し:equal

	●IDL／data／構造

	●処理
	取消~可能:cancelable
換算-:convert::~
換算:conversion::~
	計算-法:calculating
	~RET:abort

	●保安
露呈-:reveal::露わに
持続的:persistent::~

	●仕様
欠点:disadvantage:~
説明書き:explainer:~
	動き~sensor説明書き:Motion Sensors Explainer
伝える:informする:~
給-:supply:~
欠く:lackする:~
尋ねる:askする:~
選んで:chooseして:~
伝えら:informさ:~

	有用さが減る:less useful
	問わない:agnostic
	代替の:alternatively
	低次の:low
	高~level:high-level
	加えて、furthermore
	まったく:can never
	何であれ:irrespective
	足る:sufficiently
	を踏まえて、:In light of 〜
	~~有益に:beneficial impact
	主な:main
	`DOM4$r :DOM4 Events
	〜に利する:on behalf of
	抜き出す:extract illustrate
	示され:shown
	示す:show
	必要-:need
	〜とするなら:provided 〜
	-:we wish to determine the
	-:wishing to
	~~参考:aid
	選ばれた／このどちらを供したか:choice
	指し示す:signify
	集まって:gather

	●未分類
新鮮:fresh:~
game::::ゲーム
	~game用の:gaming
utility::::ユーティリティ
	-:set of intrinsic
固定-:fix::~
生の:raw::~
現実:reality::~
現実拡張:augmented-reality::~
閾値:threshold::~
	間隔:interval
新鮮:fresh:~
一過:transient::~

	ある:folded to
	上げる:increase
	対応する:corresponding
	成す:form
	指-:point
	含-:include
	始めて:Starting with
	生-:occur
	背後に回され:backgrounded
	機器~方位:Device Orientation
	~~円周／:around
	次に分類できる:categorized into following categories
	~PLUS:plus
	~MINUS:equal and opposite to
	-:Finally

	●指示語

	数種の:several
	:such that
	~~元の:previous
	一連の:series
	個の:one／:two／:three
	とは異なる:differs from

●●images
＠deviceorientation/
start｜width:450px; height:450px;｜｜.png
z-rotation｜width:450px; height:450px;｜｜.png
x-rotation｜width:450px; height:450px;｜｜.png
y-rotation｜width:450px; height:450px;｜｜.png

●●matrix_data

●equation1
0
0
−1

●equation2
cos(%α), −sin(%α), 0
sin(%α), cos(%α), 0
0, 0, 1

●equation3
1, 0, 0
0, cos(%β), −sin(%β)
0, sin(%β), cos(%β)

●equation4
cos(%γ), 0, sin(%γ)
0, 1, 0
−sin(%γ), 0, cos(%γ)

●equation13a
cos(%α) cos(%γ) − sin(%α) sin(%β) sin(%γ), −cos(%β) sin(%α), cos(%γ) sin(%α) sin(%β) + cos(%α) sin(%γ)
cos(%γ) sin(%α) + cos(%α) sin(%β) sin(%γ), cos(%α) cos(%β), sin(%α) sin(%γ) − cos(%α) cos(%γ) sin(%β)
−cos(%β) sin(%γ), sin(%β), cos(%β) cos(%γ)

●equation5e
−cos(%α)sin(%γ) − sin(%α)sin(%β)cos(%γ)
−sin(%α)sin(%γ) + cos(%α)sin(%β)cos(%γ)
−cos(%β)cos(%γ)


●●ref_normative

[DOM]
    Anne van Kesteren. ＜DOM Standard＞. Living Standard. URL: https://dom.spec.whatwg.org/
[HTML]
    Anne van Kesteren; et al. ＜HTML Standard＞. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[PAGE-VISIBILITY]
    Jatinder Mann; Arvind Jain. ＜Page Visibility (Second Edition)＞. 29 October 2013. REC. URL: https://www.w3.org/TR/page-visibility/
[PERMISSIONS]
    Marcos Caceres; Mike Taylor. ＜Permissions＞. URL: https://w3c.github.io/permissions/
[RFC2119]
    S. Bradner. ＜Key words for use in RFCs to Indicate Requirement Levels＞. March 1997. Best Current Practice. URL: https://datatracker.ietf.org/doc/html/rfc2119
[SECURE-CONTEXTS]
    Mike West. ＜Secure Contexts＞. URL: https://w3c.github.io/webappsec-secure-contexts/
[WEBIDL]
    Edgar Chen; Timothy Gu. ＜Web IDL Standard＞. Living Standard. URL: https://webidl.spec.whatwg.org/

●●ref_informative

[CSS-TRANSFORMS-2]
    Tab Atkins Jr.; et al. ＜CSS Transforms Module Level 2＞. URL: https://drafts.csswg.org/css-transforms-2/
[EULERANGLES]
    ＜Euler Angles＞. URL: https://en.wikipedia.org/wiki/Euler_angles
[FINGERPRINT]
    ＜Mobile Device Identification via Sensor Fingerprinting＞. 6 Aug 2014. URL: https://arxiv.org/abs/1408.1416
[G-FORCE]
    ＜G-Force＞. URL: https://en.wikipedia.org/wiki/G-force
[GEOMETRY-1]
    Simon Pieters; Chris Harrelson. ＜Geometry Interfaces Module Level 1＞. URL: https://drafts.fxtf.org/geometry/
[GIMBALLOCK]
    ＜Gimbal Lock＞. URL: https://en.wikipedia.org/wiki/Gimbal_Lock
[INDOORPOS]
    Shala, Ubejd; Angel Rodriguez. ＜Indoor positioning using sensor-fusion in android devices＞. 2011. URL: http://www.diva-portal.org/smash/record.jsf?pid=diva2%3A475619&amp;dswid=9050
[MOTION-SENSORS]
    Kenneth Christiansen; Alexander Shalamov. ＜Motion Sensors Explainer＞. URL: https://w3c.github.io/motion-sensors/
[QUATERNIONS]
    ＜Quaternions＞. URL: https://en.wikipedia.org/wiki/Quaternion
[SENSORID]
    Zhang, Jiexin; Beresford, Alastair R.; Sheret, Ian. ＜SensorID: Sensor Calibration Fingerprinting for Smartphones＞. 2019. URL: https://doi.org/10.1109/SP.2019.00072
[TOUCH]
    ＜TouchSignatures: Identification of User Touch Actions and PINs Based on Mobile Sensor Data via JavaScript＞. 12 Feb 2016. URL: https://arxiv.org/abs/1602.04115
[WGS84]
    National Imagery and Mapping Agency. ＜Department of Defence World Geodetic System 1984＞. 3 January 2000. Technical Report 8350.2, Third Edition. URL: http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf


●●trans_metadata
<p>
~THIS_PAGEは、~W3Cにより
編集者草案として公開された
<a href="~SPEC_URL">DeviceOrientation Event Specification</a>
を日本語に翻訳したものです。
~PUB
</p>

●●spec_metadata

最新公表バージョン
	https://www.w3.org/TR/orientation-event/
公表履歴
	https://www.w3.org/standards/history/orientation-event
フィードバック
	<a href="public-device-apis@w3.org">public-device-apis@w3.org</a> with subject line “[orientation-event] … message topic …” (<a href="https://lists.w3.org/Archives/Public/public-device-apis/">archives</a>)
	https://github.com/w3c/deviceorientation/issues
編集
	Reilly Grant (Google LLC)
	Raphael Kubo da Costa (Intel Corporation)
前任編集者
	Rich Tibbett (Opera Software ASA)
	Tim Volodine (Google Inc)
	Steve Block (Google Inc until July 2012)
	Andrei Popescu (Google Inc until July 2012)
更新履歴
	https://github.com/w3c/deviceorientation/commits/main/index.bs

</script>


</head>
<body>

<header>
	<hgroup>
<h1>DeviceOrientation Event</h1>
	</hgroup>
</header>

<div id="MAIN" hidden>
	<section id="abstract">
◎要約

<p>
この仕様は、
~hostしている機器の物理的な方位や動きについての情報を供するような，
数種の新たな~DOM~eventを定義する。
◎
This specification defines several new DOM events that provide information about the physical orientation and motion of a hosting device.
</p>

	</section>
	<section id="sotd">
◎位置付け

<p>
これは、編集者草案の公な複製です…
【以下、この内容は，~SOTD-W3Cに移譲。】
</p>

	</section>

<main id="MAIN0">

	<section id="conformance-requirements">
<h2 title="Conformance requirements">1. 適合性の要件</h2>

【この節の他の内容は、`~W3C日本語訳 共通~page＠~W3Ccommon#conformance$に移譲。】

<p>
この仕様が導入する各種~eventは、
`DOM$r に定義される `Event$I ~interfaceを実装する。
したがって，実装は、
その仕様も~supportするモノトスル。
◎
The events introduced by this specification implement the Event interface defined in the DOM Specification, [DOM]. Implementations must therefore support this specification.
</p>

	</section>
	<section id="introduction">
<h2 title="Introduction">2. 序論</h2>

◎非規範的

<p>
この仕様は、
~hosting機器の物理的な方位や運動についての情報を得するための， 2 種の新たな~DOM~eventを供する。
~eventにより供される情報は、
生の~sensor~dataではなく，高~levelな~dataであり、
下層の情報~sourceを問わない。
共通的な情報の~sourceには、［
~gyroscope, ~compass, 加速度計
］も含まれる。
◎
This specification provides two new DOM events for obtaining information about the physical orientation and movement of the hosting device. The information provided by the events is not raw sensor data, but rather high-level data which is agnostic to the underlying source of information. Common sources of information include gyroscopes, compasses and accelerometers.
</p>

<p>
この仕様は、
次に挙げる~DOM~eventを供する：
</p>

<dl>
	<dt>`deviceorientation$et</dt>
	<dd>
機器の物理的な方位を給し、
機器に局所的な基準座標系からの一連の回転として表出される。
◎
The first DOM event provided by the specification, deviceorientation, supplies the physical orientation of the device, expressed as a series of rotations from a local coordinate frame.
</dd>

	<dt>`devicemotion$et</dt>
	<dd>
機器の加速度を給し、
当の機器にて定義される基準座標系における座標で表出される。
それはまた、
機器に局所的な基準座標系についての回転~率も給する。
実用的にアリな所では、
機器の重心の加速度も~eventに供されるベキである。
◎
The second DOM event provided by this specification, devicemotion, supplies the acceleration of the device, expressed in Cartesian coordinates in a coordinate frame defined in the device. It also supplies the rotation rate of the device about a local coordinate frame. Where practically possible, the event should provide the acceleration of the device’s center of mass.
</dd>
</dl>

<p>
以下の~codeに、
これらの~eventの基本的な利用を抜き出す。
◎
The following code extracts illustrate basic use of the events.
</p>

<div class="example">
<p>
`deviceorientation$et ~eventを受取るよう登録する例：
◎
Registering to receive deviceorientation events:
</p>

<pre class="lang-js">
window.addEventListener("deviceorientation", function(%event) {
    /* <span class="comment">
%event の `alpha^m, `beta^m, `gamma^m ~memberを処理する
◎
process event.alpha, event.beta and event.gamma
</span> */
}, true);
</pre>
</div>

<div class="example">
<p>
当の機器は水平~面に寝かされていて，その~screenの上端は西を指しているときの方位は：
◎
A device lying flat on a horizontal surface with the top of the screen pointing West has the following orientation:
</p>

<pre class="lang-js">
{
  alpha: 90,
  beta: 0,
  gamma: 0
};
</pre>

<p>
~compass-heading（ `compass heading^en ）†を取得するには、
単純に 360 度dから `alpha^m を減算する。
機器が水平~面~上で回されるに伴い，~compass-headingは［
360 − `alpha^m
］になる。
【†この文脈においては、北極方向から時計回りに，~screenの上端が指す向きまでの角度。】
◎
To get the compass heading, one would simply subtract alpha from 360 degrees. As the device is turned on the horizontal surface, the compass heading is (360 - alpha).
</p>
</div>

<div class="example">
<p>
利用者が握っている機器の~screenが垂直面を成していて, 上端は真上を指しているとき、
`beta^m の値は， `alpha^m, `gamma^m が何であれ 90 になる。
◎
A user is holding the device in their hand, with the screen in a vertical plane and the top of the screen pointing upwards. The value of beta is 90, irrespective of what alpha and gamma are.
</p>
</div>

<div class="example">
<p>
利用者が対面するように握っている機器は［
~compass-heading†は %N 度dにあり，その~screenは垂直面を成していて, 上端は右を指している
］とき、
機器の方位は：
◎
A user facing a compass heading of alpha degrees is holding the device in their hand, with the screen in a vertical plane and the top of the screen pointing to their right. The orientation of the device is:
</p>

<pre class="lang-js">
{
  alpha: 270 - %N,
  beta: 0,
  gamma: 90
};
</pre>

<p class="trans-note">【†
この文脈の “~compass-heading” は、
上の例と整合していない。
おそらく、
`§~compass-headingの計算-法$にて定義されるそれを意味する（~screenに直交し，奥方を指す~vectorの水平~成分）。
】</p>
</div>

<div class="example">
<p>
`devicemotion$et ~eventを受取るよう登録する例：
◎
Registering to receive devicemotion events:
</p>

<pre class="lang-js">
window.addEventListener("devicemotion", function(%event) {
    /* <span class="comment">
%event の［
`acceleration^m,
`accelerationIncludingGravity^m,
`rotationRate^m,
`interval^m
］を処理する。
◎
Process event.acceleration, event.accelerationIncludingGravity,
event.rotationRate and event.interval
</span> */
}, true);
   
</pre>
</div>

<div class="example">
<p>
当の機器は，水平~面に寝かされていて その~screenは真上を向いている下では、
`acceleration^m は 0 になり，
`accelerationIncludingGravity^m は次の値になる：
◎
A device lying flat on a horizontal surface with the screen upmost has an acceleration of zero and the following value for accelerationIncludingGravity:
</p>

<pre class="lang-js">
{
  x: 0,
  y: 0,
  z: 9.8
};
</pre>
</div>

<div class="example">
<p>
機器は、
自由落下していて，その~screenは水平かつ真上を向いている下では：
`accelerationIncludingGravity^m は 0 になり，
`acceleration^m は次の値になる：
◎
A device in free-fall, with the screen horizontal and upmost, has an accelerationIncludingGravity of zero and the following value for acceleration:
</p>

<pre class="lang-js">
{
  x: 0,
  y: 0,
  z: -9.8
};
</pre>
</div>

<div class="example">
<p>
機器は［
半径 %r の~~円周を，右周りに速度 %v で~~運行している乗物
］に搭載されていて、
その~screenは［
垂直面を成していて,
上端は真上を指していて,
乗物の後部に対面している
］とする。
機器は［
`acceleration^m, `accelerationIncludingGravity^m
］どちらに対しても，正な~x成分［
%x ~EQ %v ~pow2 ~DIV %r
］を記録し、
`rotationRate.gamma^m に負な値［
%γ ~EQ − ( %v ~DIV %r ) ~MUL ( 180 ~DIV π )
］を記録する：
◎
A device is mounted in a vehicle, with the screen in a vertical plane, the top uppermost and facing the rear of the vehicle. The vehicle is travelling at speed v around a right-hand bend of radius r. The device records a positive x component for both acceleration and accelerationIncludingGravity. The device also records a negative value for rotationRate.gamma:
</p>

<pre class="lang-js">
{
  acceleration: {x: %x, y: 0, z: 0},
  accelerationIncludingGravity: {x: %x, y: 9.8, z: 0},
  rotationRate: {alpha: 0, beta: 0, gamma: %γ}
};
</pre>

【！ v^2/r 】
</div>

	</section>
	<section id="scope">
<h2 title="Scope">3. 視野</h2>

◎非規範的

<p>
この仕様は、［
~hosting機器の物理的な方位や動きを述べる情報を検索取得するための~DOM~event
］を供することに制限されている。
この~APIに意図される目的は、
`§ 利用事例＠#use-cases$
に示されるような単純な利用事例を可能化することである。
［
この~dataの操作-用に~utilityを供すること（座標系変換~libraryなど） ／
低次の~sensor~dataに~accessすること／
その種の~sensorを直に制御すること
］は、
この仕様の視野から外れる。
◎
This specification is limited to providing DOM events for retrieving information describing the physical orientation and motion of the hosting device. The intended purpose of this API is to enable simple use cases such as those in Use-Cases section. The scope of this specification does not include providing utilities to manipulate this data, such as transformation libraries. Nor does it include providing access to low sensor data, or direct control of these sensors.
</p>

	</section>
	<section id="description">
<h2 title="Description">4. 記述</h2>

<p>
この仕様を実装する~UAは：
</p>
<ul>
	<li>
次の表tの 2 列目に挙げる新たな~DOM~eventを供するモノトスル。
</li>
	<li>
次の表tの 1 列目に挙げる`~event~handler~IDL属性$を`~window$に供するモノトスル
— 対応する`~event~handler~event型$は，
同じ行の 2 列目に挙げる~eventとする。
</li>
</ul>

<table><thead>
<tr><th>~event~handler~IDL属性
<th>~event型
<tbody>

<tr><td>`ondeviceorientation$n
<td>`deviceorientation$et

<tr><td>`ondeviceorientationabsolute$n
<td>`deviceorientationabsolute$et

<tr><td>`ondevicemotion$n
<td>`devicemotion$et
</table>

<p class="trans-note">【
この訳では、
以下の各下位節の記述の一部を ここに集約する。
】【
これらの~event~handler~IDL属性は，
`Window$I ~interfaceに定義されているが、
`WindowEventHandlers$I ~interface~mixinに定義される方が適切に思われる。
】</p>

		<section id="deviceorientation">
<h3 title="deviceorientation Event">4.1. `deviceorientation@et ~event</h3>

<div class="p">
◎
↑↑User agents implementing this specification must provide a new DOM event, named deviceorientation.
◎
↑↑User agents must also provide an event handler IDL attribute [HTML] named ondeviceorientation on the window object. The type of the corresponding event handler event type must be deviceorientation.
</div>

<pre class="idl">
partial interface `Window$I {
  [`SecureContext$] attribute `EventHandler$I `ondeviceorientation@n;
};

[`Exposed$=Window, `SecureContext$]
interface `DeviceOrientationEvent@I : `Event$I {
  `DeviceOrientationEvent@mc(DOMString %type, optional `DeviceOrientationEventInit$I %eventInitDict = {});
  readonly attribute double? `alpha$m;
  readonly attribute double? `beta$m;
  readonly attribute double? `gamma$m;
  readonly attribute boolean `absolute$m;

  static `Promise$&lt;`PermissionState$I&gt; `requestPermission$m();
};

dictionary `DeviceOrientationEventInit@I : `EventInit$I {
  double? `alpha@m = null;
  double? `beta@m = null;
  double? `gamma@m = null;
  boolean `absolute@m = false;
};
</pre>

`DeviceOrientationEvent^I0

<div class="algo">
`alpha@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The alpha attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`beta@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The beta attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`gamma@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The gamma attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`absolute@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~F に初期化するモノトスル。
◎
The absolute attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to false.
</div>

<div class="algo">
<p>
`requestPermission()@m
静的~method手続きは：
◎
The static requestPermission() operation, when invoked, must run these steps:
</p>
<ol>
	<li>
%~promise ~LET 新たな~promise
◎
Let promise be a new promise.
</li>
	<li>
~RET %~promise
— ただし、
以降も`並列的$に走らす
◎
Run these steps in parallel:
</li>
	<li>
%生成元 ~LET コレに`関連な設定群~obj$の`生成元$enV
◎
↓</li>
	<li>
%許可 ~LET %生成元 用の`許可$
◎
Let permission be permission for relevant settings object’s origin.
</li>
	<li>
<p>
~IF［
%許可 ~EQ `default^l
］：
◎
↓</p>
		<ol>
			<li>
~IF［
コレに`関連な大域~obj$の`一過な作動化？$ ~EQ ~F
］
⇒＃
`~promiseを却下する$( %~promise, `NotAllowedError$E 例外 )；
~RET
◎
If permission is "default" and the relevant global object does not have transient activation, then reject promise with a NotAllowedError DOMException and abort these steps.
</li>
			<li>
［
%生成元 用に機器の方位を共有することは、
受容-可能かどうか
］を利用者に尋ねる
⇒
%許可 ~SET 利用者からの可否に応じて
⇒
可ならば `granted^l ／
否ならば `denied^l
◎
If permission is "default", ask the user whether sharing device orientation for the relevant settings object’s origin is acceptable. If it is, set permission to "granted", and "denied" otherwise.
</li>
		</ol>
	</li>
	<li>
<p>
次を走らす`~taskを~queueする$：
◎
Queue a task to run these steps:
</p>
		<ol>
			<li>
%生成元 用の`許可$ ~SET %許可
◎
Set permission for the relevant settings object’s origin to permission.
</li>
			<li>
`~promiseを解決する$( %~promise, %許可 )
◎
Fulfill promise with permission.
◎
↑↑Return promise.
</li>
		</ol>
	</li>
</ol>
</div>

<p>
~UAは、
方位における有意な変化が生じる度に，次を走らすモノトスル
⇒
`~eventを発火する$( 当の`~window$, `deviceorientation$et, `DeviceOrientationEvent$I )
◎
Whenever a significant change in orientation occurs, the User Agent must fire an event named deviceorientation using DeviceOrientationEvent on the window object.＼
</p>

<p>
この文脈における有意な変化の定義は、
実装に委ねられる
— 最大な閾値として，変化 1 度dが推奨されるが。
実装は~pageの~dataが新鮮でないと予見するに足る事由があるならば、
この~eventを発火してもヨイ。
◎
The definition of a significant change in this context is left to the implementation, though a maximum threshold for change of one degree is recommended. Implementations may also fire the event if they have reason to believe that the page does not have sufficiently fresh data.
</p>

<div class="p">
<p>
この~eventの［
`alpha$m, `beta$m, `gamma$m
］属性は、
次に従うモノトスル：
</p>
<ul>
	<li>
機器の方位を，`地球~基準系$から`本体~基準系$への座標系変換により指定する
— これらの基準座標系を以下に述べるように方位する下で。
</li>
	<li>
値を度d数で表出する。
</li>
	<li>
0.1 度dより精確にしない。
</li>
</ul>
◎
The alpha, beta and gamma attributes of the event＼
must specify the orientation of the device in terms of the transformation from a coordinate frame fixed on the Earth to a coordinate frame fixed in the device.＼
The alpha, beta and gamma attributes must be expressed in degrees＼
and must not be more precise than 0.1 degrees.＼
The coordinate frames must be oriented as described below.
</div>

<dl>
	<dt>`地球~基準系@（ `earth frame^en ）</dt>
	<dd class="trans-note">【
基準系は、
基準座標系（ `coordinate frame^en ）の略称。
表記を統一するため、
この訳では，一部の “基準座標系” を “基準系” と略記する。
】</dd>
	<dd>
<p>
地球~上に固定された基準座標系。
地球~基準系は、
利用者の所在における
“東, 北, 真上（ `East, North, Up^en ）”
が成す基準系であり，次の 3 軸からなる
— ここで，地平面は、
利用者の所在において［
`World Geodetic System 1984^cite `WGS84$r による地球楕円体
］に接するとする。
◎
The Earth coordinate frame is a 'East, North, Up' frame at the user’s location. It has the following 3 axes, where the ground plane is tangent to the spheriod of the World Geodetic System 1984 [WGS84], at the user’s location.
</p>

		<ul>
			<li>
東 (X) は、
地平面~内にあり，北~軸に垂直で, 正値は東を向く。
◎
East (X) is in the ground plane, perpendicular to the North axis and positive towards the East.
</li>
			<li>
北 (Y) は、
地平面~内にあり，正値は真北（北極）を向く。
◎
North (Y) is in the ground plane and positive towards True North (towards the North Pole).
</li>
			<li>
真上 (Z) は、
地平面に垂直で，正値は真上を向く。
◎
Up (Z) is perpendicular to the ground plane and positive upwards.
</li>
		</ul>
	</dd>

	<dt>`本体~基準系@（ `body frame^en ）</dt>
	<dd class="trans-note">【
原文では［
機器~基準系（ `device frame^en ）／ 機器~本体~基準系
］などとも称されるが、
この訳では “本体~基準系” に表記を統一する。
】</dd>
	<dd>
<p>
機器に固定された基準座標系。
電話や~tabletなどの携帯~機器~用には、本体~基準系は，標準な方位にある~screen
— 概して縦置き —
に相対的に定義される。
これは、［
引き出し式~keyboardなどの~~部位を~~展開していない ／
~displayなどの旋回する~~部位は その既定の位置にある
］ことを意味する。
そのような~~部位が回転されたり~~展開されて，~screenの方位が変化しても、機器に相対的な基準座標系の方位には影響しない。
~laptop-computerにおいては、本体~基準系は，組み込まれた~keyboardに相対的に定義される。
【要約すれば、機器の~~可動部でない，本体の方位に基づく。】
~API利用者は、
既存の `orientationchange$et ~eventで方位の変化を検出できる。
◎
For a mobile device such as a phone or tablet, the device coordinate frame is defined relative to the screen in its standard orientation, typically portrait. This means that slide-out elements such as keyboards are not deployed, and swiveling elements such as displays are folded to their default position. If the orientation of the screen changes when the device is rotated or a slide-out keyboard is deployed, this does not affect the orientation of the coordinate frame relative to the device. Users wishing to detect these changes in screen orientation may be able to do so with the existing orientationchange event. For a laptop computer, the device coordinate frame is defined relative to the integrated keyboard.
</p>
		<ul>
			<li>
~xは［
~screen／~keyboard
］の平面~内にあり，正値は［
~screen／~keyboard
］の右手~側を向く。
◎
x is in the plane of the screen or keyboard and is positive towards the right hand side of the screen or keyboard.
</li>
			<li>
~yは［
~screen／~keyboard
］の平面~内にあり，正値は ［
~screen／~keyboard
］の上端を向く。
◎
y is in the plane of the screen or keyboard and is positive towards the top of the screen or keyboard.
</li>
			<li>
~zは［
~screen／~keyboard
］の平面に垂直であり，正値は［
~screen／~keyboard
］から外へ【利用者~側へ】を向く。
◎
z is perpendicular to the screen or keyboard, positive out of the screen or keyboard.
</li>
		</ul>
	</dd>
</dl>

<p>
`地球~基準系$から`本体~基準系$への座標系変換は、
以下に与える回転~systemを利用するモノトスル。
◎
The transformation from the Earth coordinate frame to the device coordinate frame must use the following system of rotations.
</p>

<p>
回転は，右手系を利用するモノトスル
— 軸~周りの正な回転は、
軸の正な方向に向かって眺めたとき，時計回りになるように。
◎
Rotations must use the right-hand convention, such that positive rotation around an axis is clockwise when viewed along the positive direction of the axis.
</p>

<p class="note">注記：
この仕様が利用する座標系は、
`CSS-TRANSFORMS-2$r
`§ 変形の描画~model＠~TRANSFORM2#transform-rendering$
とは異なる
— そこでは、
~y軸の正な向きは下端を指し，回転は左手系に従う。
加えて，
`GEOMETRY-1$r に指定される［
`rotateSelf()$n ／ `rotate()$n
］は、
回転を Z-Y'-X'' 順序で適用する
— それは、
ここで指定される順序とは異なる。
◎
Note: the coordinate system used by this specification differs from CSS Transforms 2 §4 The Transform Rendering Model, where the y axis is positive to the bottom and rotations follow the left-hand convention. Additionally, rotateSelf() and rotate(), specified in [GEOMETRY-1], apply rotations in an Z - Y' - X'' order, which differs from the order specified here.
</p>

<p>
回転は、
この 2 つの基準系が揃えられた所から始めて，次の順序で適用される：
◎
Starting with the two frames aligned, the rotations are applied in the following order:
</p>
<ol id="rotations">
	<li>
<p>
初期~位置：
◎
Rotate the device frame around its z axis by alpha degrees, with alpha in [0, 360).
</p>

<figure>
<p class="alt" hidden id="_dgm-start">
開始-時の方位
◎
start orientation
</p>

<figcaption>
初期~位置にある機器においては、
`地球~基準系$（~XYZ）と`本体~基準系$（~xyz）は揃えられている。
◎
Device in the initial position, with Earth (XYZ) and body (xyz) frames aligned.
</figcaption></figure>

	</li>
	<li>
<p>
本体~基準系をその~z軸~周りで `alpha$m 度d
— 0 以上, 360 未満 —
だけ回転する。
◎
↑</p>

<figure>
<p class="alt" hidden id="_dgm-z-rotation">
~z軸~周りの回転
◎
rotation about z axis
</p>

<figcaption>
機器を~z軸~周りで角度~alphaだけ回転する
— 添字 “<sub>o</sub>” が付与された［
~x ／ ~y
］は、
~~元の［
~x ／ ~y
］軸の所在を表す
— 以下の図も同様。
◎
Device rotated through angle alpha about z axis, with previous locations of x and y axes shown as x0 and y0.
</figcaption></figure>

</li>

<li>

<p>
本体~基準系を その~x軸~周りで `beta$m 度d
— ~MINUS 180 以上, 180 未満 —
だけ回転する。
◎
Rotate the device frame around its x axis by beta degrees, with beta in [-180, 180).
</p>

<figure>
<p class="alt" hidden id="_dgm-x-rotation">
~x軸~周りの回転
◎
rotation about x axis
</p>

<figcaption>
回転された機器の新たな~x軸~周りで角度~betaだけ回転する。
◎
Device rotated through angle beta about new x axis, with previous locations of y and z axes shown as y0 and z0.
</figcaption></figure>
</li>

<li>

<p>
本体~基準系を その~y軸~周りで `gamma$m 度d
— ~MINUS 90 以上, 90 未満 —
だけ回転する。
◎
Rotate the device frame around its y axis by gamma degrees, with gamma in [-90, 90).
</p>

<figure>
<p class="alt" hidden id="_dgm-y-rotation">
~y軸~周りの回転
◎
rotation about y axis
</p>

<figcaption>
回転された機器の新たな~y軸~周りで角度~gammaだけ回転する。
◎
Device rotated through angle gamma about new y axis, with previous locations of x and z axes shown as x0 and z0.
</figcaption></figure>

</li>
</ol>

<p>
したがって角度［
`alpha$m, `beta$m, `gamma$m
］は、
Z-X'-Y'' 型のオイラー角（ `Tait-Bryan^en 角度）
`EULERANGLES$r
を成す。
これらの角度は，数学的な規約に従って選ばれたが、［
`alpha$m は~compass-heading【~screenの上端が指す方角】とは~~逆回転を表す
］こと, および［
乗物~力学に利用される `roll-pitch-yaw^en 規約には合致しない
］ことに注意。
◎
Thus the angles alpha, beta and gamma form a set of intrinsic Tait-Bryan angles of type Z - X' - Y''. [EULERANGLES] Note that this choice of angles follows mathematical convention, but means that alpha is in the opposite sense to a compass heading. It also means that the angles do not match the roll-pitch-yaw convention used in vehicle dynamics.
</p>

<p>
`deviceorientation$et ~eventは、
加速度計と~gyroscopeのみに基づいて，この 3 個の角度~用に（何らかの恣意的な方位に）相対的な値を供するようと試行する。
実装は、
相対的な値が可用でないか, 結果の~dataがより正確aになる場合には，絶対~方位を供するものと裁定してよい。
いずれの事例でも、
`absolute$m ~propは，それに則って このどちらを供したかを反映するように設定するモノトスル。
◎
The deviceorientation event tries to provide relative values for the three angles (relative to some arbitrary orientation), based on just the accelerometer and the gyroscope. The implementation can still decide to provide absolute orientation if relative is not available or the resulting data is more accurate. In either case, the absolute property must be set accordingly to reflect the choice.
</p>

<p class="trans-note">【
すなわち、
（上の段落の前まで説明に利用し続けてきた）地球~基準系は，絶対~方位に利用され、
`absolute^m は，そのときに限り ~T になる。
“恣意的な方位” は、
序論に述べたように機器（または環境）に依存する
— 少なくとも，ある程度の期間は、
地球~基準系から相対的に一定になるであろうが。
】</p>

<p>
3 個の角度のうちいずれかを供せない実装は、
未知な角度~値を ~NULL に設定するモノトスル。
どれか一つでも角度を供する場合、
`absolute$m ~propを適切に設定するモノトスル。
実装は、
方位~情報をまったく供せない場合は†，~eventの［
`alpha$m, `beta$m, `gamma$m
］属性をいずれも ~NULL に設定した上で発火するベキである。
◎
Implementations that are unable to provide all three angles must set the values of the unknown angles to null. If any angles are provided, the absolute property must be set appropriately. If an implementation can never provide orientation information, the event should be fired with the alpha, beta and gamma attributes set to null.
</p>

<p class="trans-note">【†
上述の
“有意な変化が生じる度に発火される”
を字義どおり解釈するなら、
“供せる” から “供せない”, またはその逆に変化したときに限り（加えて， “初期-時” も？），発火されることになろう。
】</p>

		</section>
		<section id="deviceorientationabsolute">
<h3 title="deviceorientationabsolute Event">4.2. `deviceorientationabsolute@et ~event</h3>

<p class="issue">
`deviceorientationabsolute$et ~eventと その `ondeviceorientationabsolute$n ~event~handler~IDL属性における`実装~経験は限られている＠https://wpt.fyi/results/orientation-event/ondeviceorientationabsolute.https.html$。
◎
The deviceorientationabsolute event and its ondeviceorientationabsolute event handler IDL attribute have limited implementation experience.
</p>

<div class="p">
<p>
~UAは、
方位における有意な変化が生じる度に，
次を走らすモノトスル
⇒
`~eventを発火する$( 当の`~window$, `deviceorientationabsolute$et, `DeviceOrientationEvent$I )
</p>
◎
User agents implementing this specification must fire an event named deviceorientationabsolute using DeviceOrientationEvent on the window object whenever a significant change in orientation occurs.
◎
↑↑User agents must also provide an event handler IDL attribute [HTML] named ondeviceorientationabsolute on the window object. The type of the corresponding event handler event type must be deviceorientationabsolute.
</div>


<pre class="idl">
partial interface `Window$I {
    [`SecureContext$] attribute `EventHandler$I `ondeviceorientationabsolute@n;
};
</pre>

<p>
`deviceorientationabsolute$et ~eventは、
絶対~方位を供する
— したがって，磁力計の様な追加的な~sensorも利用できる —
ことを除いて，
`deviceorientation$et ~eventに完全に相似的である。
`absolute$m ~propは ~T に設定するモノトスル。
実装は、
方位~情報をまったく供せない場合は，~eventの［
`alpha$m, `beta$m, `gamma$m
］属性をいずれも ~NULL に設定した上で発火するベキである。
◎
The deviceorientationabsolute event is completely analogous to the deviceorientation event, except additional sensors like the magnetometer can be used to provide an absolute orientation. The absolute property must be set to true. If an implementation can never provide absolute orientation information, the event should be fired with the alpha, beta and gamma attributes set to null.
</p>

		</section>
		<section id="devicemotion">
<h3 title="devicemotion Event">4.3. `devicemotion@et ~event</h3>

<div class="p">
<p>
この仕様を実装する~UAは、
【適切なときに，†】次を走らすモノトスル
⇒
`~eventを発火する$( 当の`~window$, `devicemotion$et, `DeviceMotionEvent$I )
</p>

<p class="trans-note">【†
いつ，どの条件の下で発火するかについては、
この仕様には述べられていない。
~event名は、
“機器が動いたとき” を示唆しているが。
】</p>
◎
User agents implementing this specification must fire an event named devicemotion using DeviceMotionEvent on the window object.
◎
↑↑User agents must also provide an event handler IDL attribute [HTML] named ondevicemotion on the window object. The type of the corresponding event handler event type must be devicemotion.
</div>


<pre class="idl">
partial interface `Window$I {
  [`SecureContext$] attribute `EventHandler$I `ondevicemotion@n;
};

[`Exposed$=Window, `SecureContext$]
interface `DeviceMotionEventAcceleration@I {
  readonly attribute double? `x@m;
  readonly attribute double? `y@m;
  readonly attribute double? `z@m;
};

[`Exposed$=Window, `SecureContext$]
interface `DeviceMotionEventRotationRate@I {
  readonly attribute double? `alpha@m;
  readonly attribute double? `beta@m;
  readonly attribute double? `gamma@m;
};

[`Exposed$=Window, `SecureContext$]
interface `DeviceMotionEvent@I : `Event$I {
  `DeviceMotionEvent@mc(DOMString %type, optional `DeviceMotionEventInit$I %eventInitDict = {});
  readonly attribute `DeviceMotionEventAcceleration$I? `acceleration$m;
  readonly attribute `DeviceMotionEventAcceleration$I? `accelerationIncludingGravity$m;
  readonly attribute `DeviceMotionEventRotationRate$I? `rotationRate$m;
  readonly attribute double `interval$m;

  static `Promise$&lt;`PermissionState$I&gt; `requestPermission$m();
};

dictionary `DeviceMotionEventAccelerationInit@I {
  double? `x@m = null;
  double? `y@m = null;
  double? `z@m = null;
};

dictionary `DeviceMotionEventRotationRateInit@I {
  double? `alpha@m = null;
  double? `beta@m = null;
  double? `gamma@m = null;
};

dictionary `DeviceMotionEventInit@I : `EventInit$I {
  `DeviceMotionEventAccelerationInit$I `acceleration@m;
  `DeviceMotionEventAccelerationInit$I `accelerationIncludingGravity@m;
  `DeviceMotionEventRotationRateInit$I `rotationRate@m;
  double `interval@m = 0;
};
</pre>

`DeviceMotionEvent^I0

<div class="algo">
`acceleration@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The acceleration attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`accelerationIncludingGravity@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The accelerationIncludingGravity attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`rotationRate@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は ~NULL に初期化するモノトスル。
◎
The rotationRate attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to null.
</div>

<div class="algo">
`interval@m
取得子~手続きは、
初期化-時の値を返す。
コレの作成-時には、
この属性は 0 に初期化するモノトスル。
◎
The interval attribute must return the value it was initialized to. When the object is created, this attribute must be initialized to 0.
</div>

<div class="algo">
<p>
`requestPermission()@m
静的~method手続きは：
◎
The static requestPermission() operation, when invoked, must run these steps:
</p>
<ol>
	<li>
%~promise ~LET 新たな~promise
◎
Let promise be a new promise.
</li>
	<li>
~RET %~promise
— ただし、
以降も`並列的$に走らす
◎
Run these steps in parallel:
</li>
	<li>
%生成元 ~LET コレに`関連な設定群~obj$の`生成元$enV
◎
↓</li>
	<li>
%許可 ~LET %生成元 用の`許可$
◎
Let permission be permission for relevant settings object’s origin.
</li>
	<li>
<p>
~IF［
%許可 ~EQ `default^l
］：
◎
↓</p>
		<ol>
			<li>
~IF［
コレに`関連な大域~obj$の`一過な作動化？$ ~EQ ~F
］
⇒＃
`~promiseを却下する$( %~promise, `NotAllowedError$E 例外 )；
~RET
◎
If permission is "default" and the relevant global object does not have transient activation, then reject promise with a NotAllowedError DOMException and abort these steps.
</li>
			<li>
［
%生成元 用に機器の動きを共有することは、
受容-可能かどうか
］を利用者に尋ねる
⇒
%許可 ~SET 利用者からの可否に応じて
⇒
可ならば `granted^l ／
否ならば `denied^l
◎
If permission is "default", ask the user whether sharing device motion for the relevant settings object’s origin is acceptable. If it is, set permission to "granted", and "denied" otherwise.
</li>
		</ol>
	</li>
	<li>
<p>
次を走らす`~taskを~queueする$：
◎
Queue a task to run these steps:
</p>
		<ol>
			<li>
%生成元 用の`許可$ ~SET %許可
◎
Set permission for the relevant settings object’s origin to permission.
</li>
			<li>
`~promiseを解決する$( %~promise, %許可 )
◎
Fulfill promise with permission.
◎
↑↑Return promise.
</li>
		</ol>
	</li>
</ol>
</div>

<p>
~UAが発火する `DeviceMotionEvent$I ~eventには、
以下に挙げる要件が適用される：
◎
In the DeviceMotionEvent events fired by the user agent, the following requirements must apply:
</p>

<ul>
	<li>
<div>
<p>
`acceleration$m 属性は、
その値を成す［
`DeviceMotionEventAcceleration^I0
`x$m, `y$m, `z$m
］属性が次に従うように，~hosting機器の加速度
— `地球~基準系$に相対的な，`本体~基準系$の加速度 —
で初期化するモノトスル：
</p>
		<ul>
			<li>
順に［
~x軸, ~y 軸, ~z軸
］における加速度を表出する。
</li>
			<li>
m/s~pow2 単位（~meter数 / 秒~pow2）で表出する。
</li>
			<li>
0.1 m/s~pow2 よりは精確にしない。
</li>
		</ul>
◎
The acceleration attribute must be initialized with the acceleration of the hosting device relative to the Earth frame, expressed in the body frame, as defined in deviceorientation Event section. The acceleration must be expressed in meters per second squared (m/s2) and must not be more precise than 0.1 m/s2.
</div>

<div>
<p>
`DeviceMotionEvent^I0
実装は、
重力の効果を伴う加速度~dataしか供せない場合（例えば~gyroscopeを欠くことに因り），その効果も含めた加速度を給してよい。
これは，多くの応用で有用さが減るが、
最善な労による~supportを供する手段として供される。
この事例では、
`accelerationIncludingGravity$m 属性は，［
~hosting機器の加速度† ~MINUS 重力に因る加速度
］で初期化するモノトスル。
ここでも，加速度†は、［
`本体~基準系$において m/s~pow2 単位で表出する／
0.1 m/s~pow2 よりは精確にしない
］モノトスル。
◎
Implementations that are unable to provide acceleration data without the effect of gravity (due, for example, to the lack of a gyroscope) may instead supply the acceleration including the effect of gravity. This is less useful in many applications but is provided as a means of providing best-effort support. In this case, the accelerationIncludingGravity attribute must be initialized with the acceleration of the hosting device, plus an acceleration equal and opposite to the acceleration due to gravity. Again, the acceleration must be given in the body frame defined in deviceorientation Event section and must be expressed in meters per second squared (m/s2) and must not be more precise than 0.1 m/s2.
</div>

<p class="trans-note">【†
これらの加速度は、
`acceleration$m 属性の値が表すそれを意味すると見受けられる。
】【
“この事例では”
— 他の事例で `accelerationIncludingGravity^m がどうなるのか記述が無いが、
下の注記のようになろう。
】</p>

<p class="note">注記：
実施においては、
`accelerationIncludingGravity$m は，
`加速度計$ `MOTION-SENSORS$r から得された生の読取り
— または `G-FORCE$r 【 “G がかかる” の “G” （加速度）】 —
を表現する一方で、
`acceleration$m は，
`線形~加速度~sensor$ `MOTION-SENSORS$r からの読取りを供する
— 後者は`~sensor融合$になる見込みが高い。
◎
Note: in practice, accelerationIncludingGravity represents the raw readings obtained from an Motion Sensors Explainer § accelerometer, or the [G-FORCE] while acceleration provides the readings of a Motion Sensors Explainer § linear-acceleration-sensor and is likely a sensor fusion.
</p>
	</li>
	<li>
<p>
`rotationRate$m 属性は、
その値を成す［
`DeviceMotionEventRotationRate^I0
`alpha$m, `beta$m, `gamma$m
］属性が次に従うように，［
空間における~hosting機器の回転~率
］で初期化するモノトスル：
</p>
		<ul>
			<li>
順に［
~x軸, ~y 軸, ~z軸
］における角度の変化~率として，回転~率を表出する。
</li>
			<li>
deg/s 単位（度d数 / 秒）で値を表出する。
</li>
			<li>
0.1 deg/s よりは精確にしない。
</li>
		</ul>

◎
The rotationRate attribute must be initialized with the rate of rotation of the hosting device in space. It must be expressed as the rate of change of the angles defined as alpha (x axis), beta (y axis), gamma (z axis). Each attribute must be expressed in degrees per second (deg/s) and must not be more precise than 0.1 degrees per second.
</li>
	<li>
<p>
`DeviceMotionEvent^I0
`interval$m 属性は、
次に従うモノトスル：
</p>
		<ul>
			<li>
下層の~hardwareから~dataが得される間隔【~~周期】に初期化する。
</li>
			<li>
ms 単位（~milli秒~数）で表出する。
</li>
			<li>
~Web~appによる~dataの~filter法を単純~化するため、
間隔は【各~event間にわたって】定数にする。
</li>
		</ul>
◎
The interval attribute must be initialized with the interval at which data is obtained from the underlying hardware and must be expressed in milliseconds (ms). It must be a constant, to simplify filtering of the data by the Web application.
</li>
	<li>
実装は、
未知なため供せない［
`acceleration$m ／
`accelerationIncludingGravity$m ／
`rotationRate$m
］属性の値については， ~NULL に初期化するモノトスル。
実装は、
動き情報を まったく供せない場合でも，~eventを発火するベキである
— これらの属性をすべて ~NULL に設定した上で。
【この場合も，発火する時機については、この仕様には述べられていない。】
◎
Implementations that are unable to provide all attributes must initialize the values of the unknown attributes to null. If an implementation can never provide motion information, the event should be fired with the acceleration, accelerationIncludingGravity and rotationRate attributes set to null.
</li>
</ul>

		</section>
		<section id="id=permission-model">
<h3 title="Permission model">4.4. 許可~model</h3>

<p class="issue">
更なる実装~経験が許可~model用に集まってきており，
この経験から伝えられた仕様の明確化が
`課題 #74＠https://github.com/w3c/deviceorientation/issues/74$
にて論じられている。
◎
Further implementation experience is being gathered for the permission model and specification clarifications informed by this experience are being discussed in GitHub issue #74.
</p>

<p>
実装は、
利用者（または利用者に利する~UA）が
`許可@
を是認した場合に限り，機器の［
方位／動き
］を【~appの生成元が】共有することを選んでもヨイ。
所与の`生成元$用に，機器の［
方位／動き
］を共有する`許可$は、
次のいずれかの文字列になる：
◎
Implementations may choose to share device orientation &amp; motion only if the user (or user agent on behalf of the user) has granted permission. The permission to share device orientation &amp; motion for a given origin is one of three strings:
</p>

<dl>
	<dt>`default^l</dt>
	<dd>
`denied^l に等価であるが、
利用者は，まだ明示的に選んではいない。
◎
This is equivalent to "denied", but the user has made no explicit choice thus far.
</dd>

	<dt>`denied^l</dt>
	<dd>
利用者は、
機器の［
方位／動き
］を共有したいと求めていないことを意味する。
◎
This means the user does not want to share device orientation or motion.
</dd>

	<dt>`granted^l</dt>
	<dd>
機器の［
方位／動き
］を共有してもヨイことを意味する。
◎
This means device orientation or motion may be shared.
</dd>
</dl>

<p class="note">注記：
`granted^l を意味するような［
`default^l に~~相応する文字列
］は無い。
その事例では、
~appにとっては`許可$を尋ねる理由は無いので，単純に `granted^l が返される。
◎
There is no equivalent to "default" meaning "granted". In that case "granted" is simply returned as there would be no reason for the application to ask for permission.
</p>
		</section>
	</section>
	<section id="security-and-privacy">
<h2 title="Security and privacy considerations">5. ~securityと~privacy上の考慮点</h2>

<p>
この仕様に定義される~APIは、［
加速度計, ~gyroscope, 磁力計
］などの~hardware~sensorからの情報を得するために利用できる。
供される~dataは、
敏感であり，悪意的な~web~pageによる攻撃の~subjectになり得るものと考えられている。
［
加速度計, ~gyroscope, 磁力計
］の較正は、
特定0の~sensor~hardwareについての持続的な詳細を露呈し得る
`SENSORID$r
。
主な攻撃~行路は、
次に分類できる：
◎
The API defined in this specification can be used to obtain information from hardware sensors, such as accelerometer, gyroscope and magnetometer. Provided data may be considered as sensitive and could become a subject of attack from malicious web pages. The calibration of accelerometers, gyroscopes and magnetometers may reveal persistent details about the particular sensor hardware [SENSORID]. The main attack vectors can be categorized into following categories:
</p>

<ul>
	<li>
利用者~入力の監視
`TOUCH$r
◎
Monitoring of a user input [TOUCH]
</li>
	<li>
所在の追跡
`INDOORPOS$r
◎
Location tracking [INDOORPOS]
</li>
	<li>
利用者の識別
`FINGERPRINT$r
◎
User identification [FINGERPRINT]
</li>
</ul>

<p>
それを踏まえて，実装は、［
当の~web~pageによる~sensorの利用に対する許可，または それを指し示す視覚的な指示子
］を考慮してよい。
加えて，［
~privacy~risk,
指紋収集,
その他の攻撃
］の機会cを最小限にするため、
実装が~eventを発火するのは，［
当の`~window$に`結付けられている文書$ %文書 【！閲覧~文脈】が ~AND↓ を満たす
］かつ［
これまでの各節に述べたとおり，属性~値の精度を制限する
］場合に限るモノトスル：
◎
In light of that, implementations may consider permissions or visual indicators to signify the use of sensors by the web page. Furthermore, to minimize privacy risks, the chance of fingerprinting and other attacks the implementations must:
</p>
<ul>
	<li>
`全部的に作動中$である
【！%文書 ~EQ %文書 の`~node~navigable$にて`作動中な文書$nav】
</li>
	<li>
%文書 の`可視性~状態$doc ~EQ `visible^l
◎
fire events only when active document is visible,
</li>
	<li>
( %文書 の`生成元$doc, %文書 の`~node~navigable$の`~top-level辿可能$navにて`作動中な文書$navの`生成元$doc )
は、
`同一-生成元$である
【！`~top-level閲覧~文脈$であるか，それと同一-生成元に属する`入子な閲覧~文脈$である】
◎
fire events only on the top-level browsing context and same-origin nested browsing contexts,
</li>
	<li>
%文書 に`関連な設定群~obj$は`~secureな文脈$enVである
`SECURE-CONTEXTS$r
◎
fire events only on secure browsing contexts [SECURE-CONTEXTS]
◎
↑↑ limit precision of attribute values as described in the previous sections.
</li>
</ul>

<p class="trans-note">【
原文は，これらの条件のうち一部を~HTMLの［
廃された／`避けるべき＠~HTMLds#warning-avoid-using-bcs$
］用語に基づいて述べているので、
この訳では，一部の記述を改めている
— 適切な用語に置換して，用語や~linkを補完して，言い回しを変形するなど。
】</p>

<p>
加えて、
そのように実装することは，
携帯~機器の~battery寿命にも~~有益になろう。
◎
Additionally, implementing these items may also have a beneficial impact on the battery life of mobile devices.
</p>

	</section>
	<section id="use-cases-and-requirements">
<h2 title="Use-Cases and Requirements">6. 利用事例と要件</h2>

		<section id="use-cases">
<h3 title="Use-Cases">6.1. 利用事例</h3>

◎非規範的

<dl>
	<dt id="controlling-a-game">
~gameの制御-法
◎
6.1.1. Controlling a game
</dt>
	<dd>
~game用の~Web~appは、
機器の方位を監視して，ある種の方向への傾きを~screen~spriteを制御する手段として解釈する。
◎
A gaming Web application monitors the device’s orientation and interprets tilting in a certain direction as a means to control an on-screen sprite.
</dd>

	<dt id="gesture-recognition">
~gesture認識
◎
6.1.2. Gesture recognition
</dt>
	<dd>
~Web~appは、
機器の加速度を監視して，ある種の~gestureを認識するために信号~処理を適用する。
例えば、
`shaking^en ~gestureを利用して ~web~formを~clearするなど。
◎
A Web application monitors the device’s acceleration and applies signal processing in order to recognize certain specific gestures. For example, using a shaking gesture to clear a web form.
</dd>

	<dt id="mapping">
地図~用
◎
6.1.3. Mapping
</dt>
	<dd>
地図~用の~Web~appは、
機器の方位を利用して，地図が現実と正しく揃うようにする。
◎
A mapping Web application uses the device’s orientation to correctly align the map with reality.
</dd>
</dl>

		</section>
		<section id="requirements">
<h3 title="Requirements">6.2. 要件</h3>

◎非規範的

<p>
仕様は、
次に従わなければナラナイ：
◎
↓</p>

<ul>
	<li>
空間における機器の物理的な［
方位, 動き
］を述べる~dataを供する。
◎
The specification must provide data that describes the physical orientation in space of the device.
◎
The specification must provide data that describes the motion in space of the device.
</li>
	<li>
機器の方位~変化に応じれる~event~handlerを登録するのを，~Web~appに許容する。
◎
The specification must allow Web applications to register for changes in the device’s orientation.
</li>
	<li>
方位, 動きとも，下層の~data~sourceは問わないとする。
◎
The specification must be agnostic to the underlying sources of orientation and motion data.
</li>
	<li>
既存の~DOM~event~frameworkを利用する。
◎
The specification must use the existing DOM event framework.
</li>
</ul>

		</section>
	</section>
	<section id="examples">
<h2 title="A. Examples">A. 各種~例</h2>

◎非規範的

【！ All equations in this section are created using MathJAX and are provided @ http://jsfiddle.net/richtr/w7Xgu/ 】

		<section id="worked-example">
<h3 title="A.1 Calculating compass heading">A.1. ~compass-headingの計算-法</h3>

◎非規範的

<p>
以下に作業した例は、
`deviceorientation$et ~eventの利用者~向けの~~参考として意図されている。
◎
The following worked example is intended as an aid to users of the DeviceOrientation event.
</p>

<p>
`§ 序論＠#introduction$
では、
機器の~screenが水平なときに~compass-headingを得する，
`deviceorientation$et ~eventの用例を供した。
この例では、
利用者が対面して握っている機器の~screenが近似的に直立しているとき，
機器の~compass-headingを決定する方法を示す。
これの応用は、
現実拡張~systemである。
◎
Introduction section provided an example of using the DeviceOrientation event to obtain a compass heading when the device is held with the screen horizontal. This example shows how to determine the compass heading that the user is facing when holding the device with the screen approximately vertical in front of them. An application of this is an augmented-reality system.
</p>

<p>
ここでの機器の~compass-headingとは、
精確には，［
機器の~screenに~~直交し，~screenの背面から先を指す~vector
］の水平~成分である。
◎
More precisely, we wish to determine the compass heading of the horizontal component of a vector which is orthogonal to the device’s screen and pointing out of the back of the screen.
</p>

<p>
%v は、
回転された`本体~基準系$（~xyz）における，この~vectorを表現するとする：
◎
If v represents this vector in the rotated device body frame xyz, then v is as follows.
• v = [0; 0; -1]
</p>

<div class="_math-formula">
%v ~EQ `equation1^dgm
</div>

<p>
~z軸~周りの回転に因る座標系変換は、
次の回転~行列 %Z で表現できる：
◎
The transformation of v due to the rotation about the z axis can be represented by the following rotation matrix.
• Z = [cos(alpha) -sin(alpha) 0; sin(alpha) cos(alpha) 0; 0 0 1]
</p>

<div class="_math-formula">
`equation2^dgm
</div>

<p>
~x軸~周りの回転に因る座標系変換は、
次の回転~行列 %X で表現できる：
◎
The transformation of v due to the rotation about the x axis can be represented by the following rotation matrix.
• X = [1 0 0; 0 cos(beta) -sin(beta); 0 sin(beta) cos(beta)]"
</p>

<div class="_math-formula">
`equation3^dgm
</div>

<p>
~y軸~周りの回転に因る座標系変換は、
次の回転~行列 %Y で表現できる：
◎
The transformation of v due to the rotation about the y axis can be represented by the following rotation matrix.
• Y = [cos(gamma) 0 sin(gamma); 0 1 0; -sin(gamma) 0 cos(gamma)]
</p>

<div class="_math-formula">
`equation4^dgm
</div>

<p>
%R は、
`地球~基準系$（~XYZ）における機器の全部的な回転~行列を表現するとする。
初期の`本体~基準系$は地球~基準系に揃えられているので、［
%R ~EQ %Z ~MUL %X ~MUL %Y
］であり，その結果は：
◎
If R represents the full rotation matrix of the device in the earth frame XYZ, then since the initial body frame is aligned with the earth, R is as follows.
• R = ZXY = [[cos(alpha) cos(gamma)-sin(alpha) sin(beta) sin(gamma), -cos(beta) sin(alpha), cos(gamma) sin(alpha) sin(beta)+cos(alpha) sin(gamma)], [cos(gamma) sin(alpha)+cos(alpha) sin(beta) sin(gamma), cos(alpha) cos(beta), sin(alpha) sin(gamma)-cos(alpha) cos(gamma) sin(beta)], [-cos(beta) sin(gamma), sin(beta), cos(beta) cos(gamma)]]
</p>

<div class="_math-formula">
`equation13a^dgm
</div>

<p>
%V は`地球~基準系$（~XYZ）における~vector %v を表現するとする。
［
【！equation5a】
%V ~EQ %R ~MUL %v
］であり，その結果は：
◎
If v' represents the vector v in the earth frame XYZ, then since the initial body frame is aligned with the earth, v' is as follows.
• v' = Rv
• v' = [-cos(alpha)sin(gamma)-sin(alpha)sin(beta)cos(gamma); -sin(alpha)sin(gamma)+cos(alpha)sin(beta)cos(gamma); -cos(beta)cos(gamma)]
</p>

<div class="_math-formula">
`equation5e^dgm
</div>

<p>
%θ は~compass-headingを表すとするとき、［
%β, %γ とも 0
］ではないとするなら［
%θ ~EQ `arctan^op( ( %V の~x成分 ) ~DIV ( %V の~y成分 ) )
］であり，その結果は
【！equation6】
⇒
%θ ~EQ `arctan^op(
( −`cos^op(%α)`sin^op(%γ) − `sin^op(%α)`sin^op(%β)`cos^op(%γ) )
~DIV
( −`sin^op(%α)`sin^op(%γ) + `cos^op(%α)`sin^op(%β)`cos^op(%γ) )
)
◎
The compass heading θ is given by
• theta = atan((v’_x)/(v’_y)) = atan((-cos(alpha)sin(gamma)-sin(alpha)sin(beta)cos(gamma))/(-sin(alpha)sin(gamma)+cos(alpha)sin(beta)cos(gamma)))
◎
provided that β and γ are not both zero.
</p>

<div class="example">
<p>
上による~compass-headingの計算は、
~JSでは次のように表現できる
— 供された各~parameterが定義されていて（ ~NULLでない），かつ絶対~方位（ `absolute^m ~EQ ~T ）を表現するならば，正しい~compass-headingを返す。
◎
The compass heading calculation above can be represented in JavaScript as follows to return the correct compass heading when the provided parameters are defined, not null and represent absolute values.
</p>

<pre class="lang-js">
var %degtorad = Math.PI / 180; /* <span class="comment">
度d ↔ ~radian 間の換算~用
◎
Degree-to-Radian conversion
</span> */

function compassHeading( %alpha, %beta, %gamma ) {

  var %_x = %beta  ? %beta  * %degtorad : 0; // %β 値
  var %_y = %gamma ? %gamma * %degtorad : 0; // %γ 値
  var %_z = %alpha ? %alpha * %degtorad : 0; // %α 値

  var %cX = Math.cos( %_x );
  var %cY = Math.cos( %_y );
  var %cZ = Math.cos( %_z );
  var %sX = Math.sin( %_x );
  var %sY = Math.sin( %_y );
  var %sZ = Math.sin( %_z );

  /* <span class="comment">
%V の~x, ~y成分を計算する
◎
Calculate Vx and Vy components
</span> */
  var %Vx = - %cZ * %sY - %sZ * %sX * %cY;
  var %Vy = - %sZ * %sY + %cZ * %sX * %cY;

  /* <span class="comment">
~compass-headingを計算する
◎
Calculate compass heading
</span> */
  var %compassHeading = Math.atan( %Vx / %Vy );

  /* <span class="comment">
~compass-headingを， 0 以上 2 π 未満に換算する
◎
Convert compass heading to use whole unit circle
</span> */
  if( %Vy &lt; 0 ) {
    %compassHeading += Math.PI;
  } else if( %Vx &lt; 0 ) {
    %compassHeading += 2 * Math.PI;
  }

  return %compassHeading * ( 180 / Math.PI ); /* <span class="comment">
度dによる~compass-heading
◎
Compass Heading (in degrees)
</span> */

}
</pre>
</div>

<p>
整合性~検査として，
%γ を 0 に設定した場合、
%θ は，期待されるとおり
【！equation7】
⇒＃
%θ ~EQ `arctan^op( −`sin^op(%α)`sin^op(%β) ~DIV `cos^op(%α)`sin^op(%β) )
~EQ `arctan^op( −`sin^op(%α) ~DIV `cos^op(%α) ) ~EQ −%α
◎
As a consistency check, if we set γ = 0, then
• theta = atan(-sin(alpha)sin(beta)/cos(alpha)sin(beta)) = -alpha
◎
as expected.
</p>

<p>
代替の整合性~検査として，
%β を 90 に設定した場合【すなわち，本体は直立している】、
%θ は，期待されるとおり
【！equation8a, equation8b】
⇒＃
%θ ~EQ `arctan^op( ( −`cos^op(%α)`sin^op(%γ) − `sin^op(%α)`cos^op(%γ) ) ~DIV ( −`sin^op(%α)`sin^op(%γ) + `cos^op(%α)`cos^op(%γ) ) )
~EQ `arctan^op( −`sin^op(%α+%γ) ~DIV `cos^op(%α+%γ) )
~EQ −(%α+%γ)
◎
Alternatively, if we set β = 90, then
• theta = atan((-cos(alpha)sin(gamma)-sin(alpha)cos(gamma))/(-sin(alpha)sin(gamma)+cos(alpha)cos(gamma)))
• theta = atan(-sin(alpha+gamma)/cos(alpha+gamma)) = -(alpha+gamma)
◎
as expected.
</p>

		</section>
		<section id="worked-example-2">
<h3 title="A.2 Alternate device orientation representations">A.2. 機器~方位の代替-表現</h3>

◎非規範的

<p>
オイラー角を利用して方位を述べることには、
~gimbal-lock `GIMBALLOCK$r を導入するなどの欠点もあり得る。
意図される応用に依存して，機器~方位を表す値を他の回転~表現に換算する方が有用になり得る。
◎
Describing orientation using Tait-Bryan angles can have some disadvantages such as introducing gimbal lock [GIMBALLOCK]. Depending on the intended application it can be useful to convert the Device Orientation values to other rotation representations.
</p>

<p>
方位~用の代替-表現としては、
回転~行列を利用するものが先ず挙げられる。
`§~compass-headingの計算-法$にて供した，成分~回転~行列を組合せることにより、
`本体~基準系$の方位を組合せた回転~行列
— その節に述べた %R —
【！equation13a】
として表現できる。
それは、
`地球~基準系$（~XYZ）からの機器の回転~行列を表現する。
◎
The first alternate orientation representation uses rotation matrices. By combining the component rotation matrices provided in the worked example above we can represent the orientation of the device body frame as a combined rotation matrix.
◎
If R represents the rotation matrix of the device in the earth frame XYZ, then since the initial body frame is aligned with the earth, R is as follows.
• R = ZXY = [[cos(alpha) cos(gamma)-sin(alpha) sin(beta) sin(gamma), -cos(beta) sin(alpha), cos(gamma) sin(alpha) sin(beta)+cos(alpha) sin(gamma)], [cos(gamma) sin(alpha)+cos(alpha) sin(beta) sin(gamma), cos(alpha) cos(beta), sin(alpha) sin(gamma)-cos(alpha) cos(gamma) sin(beta)], [-cos(beta) sin(gamma), sin(beta), cos(beta) cos(gamma)]]
</p>

<div class="example">
<p>
この回転~行列は、
~JSでは，次のように表現できる
— 供された各~parameterが定義されていて, ~NULLでなく, `absolute^m 値を表現するならば：
◎
The above combined rotation matrix can be represented in JavaScript as follows provided passed parameters are defined, not null and represent absolute values.
</p>

<pre class="lang-js">
var %degtorad = Math.PI / 180; /* <span class="comment">
度d ↔ ~radian 間の換算~用
◎
Degree-to-Radian conversion
</span> */

function getRotationMatrix( alpha, %beta, %gamma ) {

  var %_x = %beta  ? %beta  * %degtorad : 0; // %β 値
  var %_y = %gamma ? %gamma * %degtorad : 0; // %γ 値
  var %_z = %alpha ? %alpha * %degtorad : 0; // %α 値

  var %cX = Math.cos( %_x );
  var %cY = Math.cos( %_y );
  var %cZ = Math.cos( %_z );
  var %sX = Math.sin( %_x );
  var %sY = Math.sin( %_y );
  var %sZ = Math.sin( %_z );

  /* <span class="comment">
ZXY 回転~行列の構築
◎
ZXY rotation matrix construction.
</span> */

  var %m11 = %cZ * %cY - %sZ * %sX * %sY;
  var %m12 = - %cX * %sZ;
  var %m13 = %cY * %sZ * %sX + %cZ * %sY;

  var %m21 = %cY * %sZ + %cZ * %sX * %sY;
  var %m22 = %cZ * %cX;
  var %m23 = %sZ * %sY - %cZ * %cY * %sX;

  var %m31 = - %cX * %sY;
  var %m32 = %sX;
  var %m33 = %cX * %cY;

  return [
    %m11,    %m12,    %m13,
    %m21,    %m22,    %m23,
    %m31,    %m32,    %m33
  ];

};
</pre>
</div>

<p>
機器~方位~data用には、
四元数 `QUATERNIONS$r による代替-表現もある。
◎
Another alternate representation of device orientation data is as Quaternions. [QUATERNIONS]
</p>

<div>
<p>
%q ~EQ ( %w, %x, %y, %z ) は、
`地球~基準系$（~XYZ） における機器の単位~四元数を表現するとする。
初期の`本体~基準系$は地球に揃えられているので、
%q は次のようになる
【！equation14】
⇒＃
%w ~EQ `cos^op( %b ) `cos^op( %c ) `cos^op( %a ) ~MINUS `sin^op( %b ) `sin^op( %c ) `sin^op( %a ),
%x ~EQ `sin^op( %b ) `cos^op( %c ) `cos^op( %a ) ~MINUS `cos^op( %b ) `sin^op( %c ) `sin^op( %a ),
%y ~EQ `cos^op( %b ) `sin^op( %c ) `cos^op( %a ) ~PLUS `sin^op( %b ) `cos^op( %c ) `sin^op( %a ),
%z ~EQ `cos^op( %b ) `cos^op( %c ) `sin^op( %a ) ~PLUS `sin^op( %b ) `sin^op( %c ) `cos^op( %a )
</p>

<p>
ここで
⇒＃
( %a, %b, %c ) ~EQ ( %α ~DIV 2, %β ~DIV 2, %γ ~DIV 2 )
</p>

◎
If q represents the unit quaternion of the device in the earth frame XYZ, then since the initial body frame is aligned with the earth, q is as follows.
• q = [[q_w], [q_x], [q_y], [q_z]] = [[cos(beta)cos(gamma)cos(alpha) - sin(beta)sin(gamma)sin(alpha)], [sin(beta)cos(gamma)cos(alpha) - cos(beta)sin(gamma)sin(alpha)], [cos(beta)sin(gamma)cos(alpha) + sin(beta)cos(gamma)sin(alpha)], [cos(beta)cos(gamma)sin(alpha) + sin(beta)sin(gamma)cos(alpha)]]
</div>

<div class="example">
<p>
上の四元数は、
~JSでは，次のように表現できる
— 供された~parameterが定義されていて, ~NULLでなく, `absolute^m 値を表現するならば。
◎
The above quaternion can be represented in JavaScript as follows provided the passed parameters are defined, are absolute values and those parameters are not null.
</p>

<pre class="lang-js">
var %degtorad = Math.PI / 180; /* <span class="comment">
度d ↔ ~radian 間の換算~用
◎
Degree-to-Radian conversion
</span> */

function getQuaternion( %alpha, %beta, %gamma ) {

  var %_x = %beta  ? %beta  * %degtorad : 0; // %β 値
  var %_y = %gamma ? %gamma * %degtorad : 0; // %γ 値
  var %_z = %alpha ? %alpha * %degtorad : 0; // %α 値

  var %cX = Math.cos( %_x/2 );
  var %cY = Math.cos( %_y/2 );
  var %cZ = Math.cos( %_z/2 );
  var %sX = Math.sin( %_x/2 );
  var %sY = Math.sin( %_y/2 );
  var %sZ = Math.sin( %_z/2 );

  /* <span class="comment">
ZXY 四元数の構築
◎
ZXY quaternion construction.
</span> */

  var %w = %cX * %cY * %cZ - %sX * %sY * %sZ;
  var %x = %sX * %cY * %cZ - %cX * %sY * %sZ;
  var %y = %cX * %sY * %cZ + %sX * %cY * %sZ;
  var %z = %cX * %cY * %sZ + %sX * %sY * %cZ;

  return [ %w, %x, %y, %z ];

}
</pre>
</div>

<p>
単位~四元数が正しく構築されたかどうかは、
`Lagrange^en の四平方定理を利用して検査できる
— 結果は，期待されるとおり 1 になる
【！equation18】
⇒
%w ~pow2 ~PLUS %x ~pow2 ~PLUS %y ~pow2 ~PLUS %z ~pow2
~EQ 1
◎
We can check that a Unit Quaternion has been constructed correctly using Lagrange’s four-square theorem
• q_w^2 * q_x^2 * q_y^2 * q_z^2 = 1
◎
as expected.
</p>

		</section>
	</section>
	<section id="acknowledgments">
<h2 title="Acknowledgments">謝辞</h2>

<p lang="en">
Lars Erik Bolstad, Dean Jackson, Claes Nilsson, George Percivall, Doug Turner, Matt Womer, Chris Dumez
</p>

	</section>
</main></div>
