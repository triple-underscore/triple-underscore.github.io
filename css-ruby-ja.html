<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>CSS Ruby Annotation Layout Module Level 1 （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-css.css" type="text/css">

<style>
.ex-ruby-table {
	background: white;
	line-height: 1;
	font-size: 2em;
}
.ex-ruby-table td {
	text-align: center;
	padding: 0;
}
.ex-ruby-table tr {
	border: none;
	padding: 0;
}

.ex-ruby-merge {
	display: flex;
	gap: 1em;
}

.ex-ruby-merge hr {
	display: block;
	width: 0;
	height: 3em;
	border: thin dashed var(--pale-color);
}

.ex-ruby-pairing td:first-child {
	color: orange;
}

.ex-ruby-pairing td:last-child {
	color: purple;
}

merge-box {
	display: inline-block;
	margin: 0;
	border: thin solid black;
}

td:first-child > merge-box,
merge-box.ex-first-box {
	color: orange;
	border-color: orange;
}

.x-shinkansen {
	font-size: 2em;
	line-height: 1;
	text-align: center;
	display:inline-block;
}

x-bk {
	display: block;
}

#_ex-bopomofo {
	font-size: 3em;
	background: white;
	line-height: 1;
}
#_ex-bopomofo > div {
	display: inline-block;
	vertical-align: top;
}
#_ex-bopomofo > div:nth-child(even) {
	font-size: 0.35em;
	white-space: pre-line;
	color: blue;
	padding-right: 0.5em;
}

#_ex-bopomofo > div:nth-child(even) > span {
	position: relative;
	top: -1.1em;
	left: 0.9em;
}


#_ex-r-break-b {
	display: inline-block;
	border: thin solid black;
	padding: 0.2em;
}
#_ex-r-break-b > x-bk {
	display: inline-block;
	position: relative;
	vertical-align: top;
	border: thin solid currentcolor;
	height: 3em;
}

#_ex-r-break-a {
	border-collapse: collapse;
	margin:0;
}
#_ex-r-break-a td {
	padding: 0.2em;
	white-space: nowrap;
}
#_ex-r-break-a tr:nth-child(odd) {
	border:solid black 0.1em;
	color: red;
}
#_ex-r-break-a tr:nth-child(even) {
	border: none;
}
#_ex-r-break-a td > span {
	display: block;
	border: thin solid currentcolor;
	line-height: 2em;
}

.ex-ruby-boxes-table {
	display: inline-table;
	vertical-align: top;
	border-collapse: separate;
	border-spacing: 0.1em;
}

.ex-ruby-boxes-table td {
	border: solid thin;
}
.ex-ruby-boxes-base td {
	border-color: blue;
}
.ex-ruby-boxes-anno td {
	border-color: red;
	font-size:0.5em;
}

.ex-extra-space {
	border-left: solid silver 0.7rem;
	border-right: solid silver 0.7rem;
}
.ex-extra-space > .ex-extra-space {
	border-color: green;
	border-width: 1rem
}

x-box {
	display: inline-block;
	padding: 0.2rem;
	margin: 0;
	border: thin solid blue;
}
x-rb {
	display: block;
	text-align:center;
	padding: 0;
	margin: 0;
	padding: 0.1rem;
	font-size: 1.4rem;
	border: thin solid blue;
}
x-rt {
	display: block;
	text-align:center;
	padding: 0;
	margin: 0;
	font-size: 0.7rem;
	padding: 0.1rem;
	margin-bottom: 0.1rem;
	border: thin solid red;
}

x-pad,
x-full,
x-half {
	display: inline-block;
	vertical-align: top;
	box-sizing: border-box;
	border: solid 0.1em gray;
	margin:0.1em;
	padding:0.3em 0;
	text-align: center;
	height: 1.8em;
	line-height: 1;
}
x-full {
	width: 1.8em;
	background: cyan;
}

x-half {
	width: 1em;
	background: orange;
}
x-pad {
	margin:0;
	visibility: hidden;
}

x-box.x-outside {
	padding: 0.2rem 0;
	visibility: hidden;
}

x-box.x-outside > x-rb > x-full {
	visibility: visible;
	width: auto;
	color: gray;
}

</style>


<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		generate: expand,
	};

	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~一-鿆]+|`(.*?)([$@^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){
if(!indicator) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('＠');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r': // ref
	text = `[${key}]`;
	href = `#biblio-${key.toLowerCase()}`;
	break;
case 'p':
	{
		const i = text.indexOf(':');
		if( i > 0 ){
			key = text.slice(0, i);
			text = `${key}: <code class="value">${text.slice(i+1)}</code>`;
		}
	}
	break;
case 'pe': 
	text = `::${key}`;
	break;
case 'xP':
	return `<x-pad style="width:${key}em"></x-pad>`;
	break;
case 'smb':
	text = `(<span class="char-symbol">${text}</span>)`;
	break;
case 'en':
	return `<span lang="en">${key}</span>`;
	break;
case 'dgm':
	return `<a id="_dgm-${key}">＊</a>`;
	break;
case 'xCode':
	return `<a id="_ex-html-${key}">＊</a>`;
case 'issue':
	href = `~CSSissue/${key}`;
	text = `課題 #${key}`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	default:
		console.log(match);
		return match;
	}
}

return text;

	}
}

</script>

<script type="text/plain" id="_source_data">

●●options

spec_date:2022-12-27
trans_update:2022-12-31
source_checked:210205
page_state_key:CSS
original_url:https://drafts.csswg.org/css-ruby-1/
spec_status:ED
ref_id_prefix:biblio-
ref_id_lowercase:true
site_nav:typeset,css
conformance:css
copyright:2022,permissive
trans_1st_pub:2018-05-29


●●class_map
e:element
a:attr
at:at-rule
p:property
pe:pseudo
css:css
v:value
U:code-point
uc:char-prop

●●tag_map
et:code
e:code
a:code
p:code
d:code
i:i
at:code
p:code
pe:code
css:code
c:code
v:code
xF:x-full
xH:x-half
U:span
uc:b
V:var
em:em
cite:cite

●●original_id_map
	hiding:autohide

●●mdn_urls
propdef-ruby-align:CSS/ruby-align
	propdef-ruby-merge:CSS/ruby-merge
	propdef-ruby-overhang:CSS/ruby-overhang
propdef-ruby-position:CSS/ruby-position

●●link_map
p.display:~CSSDISP#propdef-display
p.direction:~CSSWM#propdef-direction
p.line-height:~CSSINLINE#propdef-line-height
	p.line-height:~CSS2J#propdef-line-height
p.padding:~CSSBOX#propdef-padding
p.ruby-align:#propdef-ruby-align
p.ruby-merge:#propdef-ruby-merge
	p.ruby-position: separate:#propdef-ruby-position
p.ruby-overhang:#propdef-ruby-overhang
p.ruby-position:#propdef-ruby-position
p.text-justify:~CSSTEXT#propdef-text-justify
p.text-transform:~CSSTEXT#propdef-text-transform
p.unicode-bidi:~CSSWM#propdef-unicode-bidi
p.vertical-align:~CSSINLINE#propdef-vertical-align
p.visibility:~CSSDISP#propdef-visibility
p.white-space:~CSSTEXT#propdef-white-space
p.word-break:~CSSTEXT#propdef-word-break
p.writing-mode:~CSSWM#propdef-writing-mode
p.text-emphasis-position:~CSSTEXTDECOR#propdef-text-emphasis-position
p.margin:~CSSBOX#propdef-margin
p.padding:~CSSBOX#propdef-padding
p.border:~CSSBG#propdef-border
p.outline:~CSSUI#propdef-outline
p.background:~CSSBG#propdef-background

v.alternate:#valdef-ruby-position-alternate
v.auto:#valdef-ruby-merge-auto
v.~auto0:#valdef-ruby-overhang-auto
v.bidi-override:~CSSWM#valdef-unicode-bidi-bidi-override
v.block:~CSSDISP#valdef-display-block
v.center:#valdef-ruby-align-center
v.collapse:~CSSDISP#valdef-visibility-collapse
v.merge:#valdef-ruby-merge-merge
v.embed:~CSSWM#valdef-unicode-bidi-embed
v.inline-block:~CSSDISP#valdef-display-inline-block
v.inline:~CSSDISP#valdef-display-inline
v.inter-character:#valdef-ruby-position-inter-character
v.isolate-override:~CSSWM#valdef-unicode-bidi-isolate-override
v.isolate:~CSSWM#valdef-unicode-bidi-isolate
v.keep-all:~CSSTEXT#valdef-word-break-keep-all
v.none:#valdef-ruby-overhang-none
v.normal:~CSSWM#valdef-unicode-bidi-normal
v.over:#valdef-ruby-position-over
v.ruby-base-container:#valdef-display-ruby-base-container
v.ruby-base:#valdef-display-ruby-base
v.ruby-text-container:#valdef-display-ruby-text-container
v.ruby-text:#valdef-display-ruby-text
v.ruby:#valdef-display-ruby
v.separate:#valdef-ruby-merge-separate
v.space-around:#valdef-ruby-align-space-around
v.space-between:#valdef-ruby-align-space-between
v.start:#valdef-ruby-align-start
v.under:#valdef-ruby-position-under
v.vertical-rl:~CSSWM#valdef-writing-mode-vertical-rl
v.0.5ic:~CSSVAL#ic

pe.first-line:~CSSPSEUDO#selectordef-first-line
pe.first-letter:~CSSPSEUDO#selectordef-first-letter

e.rp:~HEtextlevel#the-rp-element
e.ruby:~HEtextlevel#the-ruby-element
	●terms

~ruby:#ruby
整列:#rubyalign
破棄され:#anon-gen-discard-space
隠される注釈:#hidden-annotation
隠され:#hidden-annotation
隠す:#hidden-annotation
自動で隠す:#auto-hidden
自動で隠され:#auto-hidden
注釈を併合する:#merged-annotation
併合される注釈:#merged-annotation
文字~間:#ruby-position-inter-character-annotation
文字~間の注釈:#ruby-position-inter-character-annotation
行l間:#interlinear-annotations
行l間の注釈:#interlinear-annotations

~ruby~col:#ruby-columns

~level間の空白:#inter-level-white-space
~level内の空白:#intra-level-white-space
注釈~間の空白:#inter-annotation-white-space
基底~間の空白:#inter-base-white-space
区分~間の空白:#inter-segment-white-space
内部~ruby~box:#internal-ruby-boxes
~ruby内の空白:#intra-ruby-white-space

~level:#annotation-level
注釈~level:#annotation-level
基底~level:#base-level

~pair法:#pairing

注釈:#ruby-annotation-box
~ruby注釈:#ruby-annotation-box
~ruby注釈~box:#ruby-annotation-box
	注釈~容器:#ruby-annotation-container-box
~ruby注釈~容器:#ruby-annotation-container-box
~ruby注釈~容器~box:#ruby-annotation-container-box

~ruby基底:#ruby-base-box
~ruby基底~box:#ruby-base-box
	基底~box:#ruby-base-box
~ruby基底~容器:#ruby-base-container-box
~ruby基底~容器~box:#ruby-base-container-box
	基底~容器:#ruby-base-container-box
~ruby容器:#ruby-container
~ruby容器~box:#ruby-container

~ruby整形~文脈:#ruby-formatting-context
~ruby区分:#ruby-segments
	~ruby内部 ~ruby容器~box:#nested-pairing
~span:#span
	~spanしている注釈:#spanning-annotation
	~spanしている:#spanning-annotation
~spanning注釈:#spanning-annotation
	~text分布:#collapsed-ruby
	匿名かつ空な:#_anonymous-empty

注音符号:#g-bopomofo
注音符号~声調~符:#bopomofo-tone-marks
注音符号~文字:#bopomofo-characters
	拼音:#g-
表語文字:#g-ideogram
漢字:#_g-han
日文漢字:#g-kanji
韓文漢字:#g-hanja
中文漢字:#_g-hanzi
平仮名:#g-hiragana
片仮名:#g-katakana
仮名:#g-kana


	●用語（CSS
強制d行l分断:~CSSTEXT#forced-line-break
強制d行l分断:~CSSTEXT#forced-line-break
区分~分断:~CSSTEXT#segment-break
縮約-可能:~CSSTEXT#collapsible-white-space
両端揃え機会:~CSSTEXT#justification-opportunity
自動折返し機会:~CSSTEXT#soft-wrap-opportunity
空白:~CSSTEXT#white-space
文字:~CSSTEXT#character
字l:~CSSTEXT#letter
行-分断ng規則:~CSSTEXT#line-breaking-process
行-分断ng:~CSSTEXT#line-breaking-process
§ 空白~処理~規則:~CSSTEXT#white-space-rules
	#white-space-processing
~Unicode用字系:~CSSTEXT#unicode-script

初期~値:~CASCADE#initial-value
指定d値:~CASCADE#specified-value
算出d値:~CASCADE#computed-value

書字~mode:~CSSWM#writing-mode
横書き:~CSSWM#horizontal-writing-mode
縦書き:~CSSWM#vertical-writing-mode
行内~基底~方向:~CSSWM#inline-base-direction
行-上面:~CSSWM#line-over
行-下面:~CSSWM#line-under
塊-軸:~CSSWM#block-axis
行内-軸:~CSSWM#inline-axis
双向~隔離:~CSSWM#bidi-isolate

内容~区画:~CSSBOX#content-area
内容~box:~CSSBOX#content-box
~margin~box:~CSSBOX#margin-box
	~margin:~CSSBOX#margin
	~padding:~CSSBOX#padding
	~border:~CSSBOX#border

自動的~size:~SIZING#automatic-size

置換され:~CSSDISP#replaced-element
外縁~表示~型:~CSSDISP#outer-display-type
内縁~表示~型:~CSSDISP#inner-display-type
表示~型:~CSSDISP#display-type
内部~ruby要素:~CSSDISP#internal-ruby-element
内部~table要素:~CSSDISP#internal-table-element
行内~塊:~CSSDISP#inline-block
塊~化:~CSSDISP#blockify
行内~化:~CSSDISP#inlinify
首要~box:~CSSDISP#principal-box
~flow内:~CSSDISP#in-flow
匿名~box:~CSSDISP#anonymous
匿名:~CSSDISP#anonymous

塊~levelの~box:~CSSDISP#block-level-box
行内~levelの~box:~CSSDISP#inline-level-box
行内~level:~CSSDISP#inline-level
行内~box:~CSSDISP#inline-box
不可分な行内:~CSSDISP#atomic-inline
	可分な行内~level:~CSSDISP#inline
塊~容器:~CSSDISP#block-container
包含塊:~CSSDISP#containing-block

絶対的に位置され:~CSSPOS#absolute-position
相対~位置決め:~CSSPOS#relative-position

行l~box:~CSSINLINE#line-box
行内~整形~文脈:~CSSINLINE#inline-formatting-context
	行内~整形~文脈:~CSS2J#inline-formatting
	行内~整形~文脈:~CSSDISP#inline-formatting-context
行lに相対的なズラシ値:~CSSINLINE#line-relative-shift-values

整形~文脈:~CSSDISP#formatting-context
独立な整形~文脈:~CSSDISP#independent-formatting-context

~table包装~box:~CSSWG/css-tables-3/#table-wrapper-box
整形される最初の行l:~CSSPSEUDO#first-formatted-line

	~text連なり
	~box~prop
	背景~prop
	外形線~prop


●●words_table1

auto0:auto

●●words_table

	●文字／用字系
alphabetic:::
Latin:
CJK:
韓文漢字:Hanja::~
中文漢字:Hanzi::~
漢字:Han::~
日文漢字:kanji::~
	日文漢字:kanji character
roman:
日中韓:China, Japan, Korea::~
中国語:Chinese::~
日本語:Japanese::~
台湾:Taiwan::~
台湾式:Taiwanese-style::~
英語:English::~
英文:English sentence:~
韓国語:Korean::~
外来語:foreign words::~
平仮名:hiragana::~
熟語:jukugo::~
片仮名:katakana::~
対語:taigo::~
用字系:script::~
表語文字:ideograph::~
表語的:ideographic::~
音節:syllable::~
音節的:syllabic::~
振仮名:振り仮名
仮名:Kana::~
書記体系:writing system::~
東Asia:East Asia::東アジア
東Asian:East Asian::東アジアの
複合語:compound word::~

	標準中国語Mandarin:standard Mandarin
注音符号:bopomofo::~
	注音符号:Bopomofo
拼音:<span lang="zh">拼音</span>
声調:tone::~
	声調~符:Bopomofo Tone mark
発音符:phonetic::~
発音:pronunciation::~
符:mark::~
	符~法:marking
筆記的:cursive::~
繁体字:traditional::~
翻訳:translation::~
連なり:run::~
字l:letter::字°
中立的:neutral:~

	●ruby／文字組版
glyph::::グリフ
上線:overline::~
下線:underline::~
基底線:baseline::~::ベースライン
隠され:hideされ::~
隠す:hideする::~
隠法:hide 法::隠し方
	隠法:hiding
ruby::::ルビ
Ruby:
肩付き:Katatsuki:~
	( 基底, 注釈 ):base-annotation
注釈付き:annotated::~
	注釈付き:-annotated
注釈-:annotate::~
注釈:annotation::~
基底:base::~

	group-ruby:::
mono::::モノ
	~pair法:pairing
col:column
	~ruby~col:col
row:
削る:trimする:~
削られ:trimされ:~
span:::
spanning:::
	~span法:spanning
typography::::タイポグラフィ
typographic::::タイポグラフィック
	typographic上の:typographical
間隔:space::アキ
	間隔をとる
間隔法:spacing::アキ組
半-:half-:~
leading:::行アキ

両端揃え:justification:~

並替えら:reorderさ:並び替えら
並替える:reorderする:並び替える
	傍／傍に沿って:alongsideに:沿って
	沿って／沿い:along
筋:track:~
並行して:parallelに:~
並行する:parallelな:~
隣接な:adjacentな:隣接する
	隣接している:neighbouring／:neighboring
角張った:angularな:~
丸まった:rounded:丸みを帯びた
行-:line-::~
行高:line-height::~
上面:over::~
下面:under::~
	上面／下面:over

	boundaries
限界域:bounds:境界部
分割0:divide:分割
分布-:distribute::~
分布:distribution::~
	字間:separation
介在な:intervening:介在する
包装:wrapper::~
折返す:wrapする::折り返す
区分:segment::~
	方向性たち:directionalities
双向:bidi::~
	双向~性:bidi
双方向-:bidirectional::~
字下げ:indentation:~
狭小:narrow:~
幅広:wide:~
	幅広さ:wide
	より幅広:wider
	最も幅広:widest
全角:wide-cell:~
半角:narrow-cell:~
半角幅:narrow-width:~
	halfwidth

張出す:overhangする::張り出す
張出せる:overhangできる::張り出せる
張出して:overhangして::張り出して
張出n:overhang::張り出し
張出ng:overhanging::張り出し
折返ng:wrapping::折り返し
自動折返し:soft wrap::自動折り返し
消去る:disappearする:消え去る
混在する:mixされた:~
強制d:forced::強制
併合-:merge::~
	ひとまとめに:as a group
縮約-:collapse::~
相殺-:collapse::~
継合され:spliceされ:継ぎ合され
送幅:advance::送り幅
圏点:emphasis mark::~
	~~圏点:Emphasis Dots
	注:gloss
合字:ligature::~
形状付けら:shapeさ:~
形状付け:shaping:~

	●layout
cell:
寄与-:contribute:~
中央:center:~
中央化され:centerされ:中央に寄せられ
中央化する:centerする:中央に寄せる
側:side:~
外形線:outline::~
外方:outward:~
右方:rightward:~
左方:leftward:~
	先頭:beginning／
	右肩:to the right of or above
堆積-:stack::~
	堆積-法:stacking
	塊~化:blockify／blockification
	行内~化:inlinify／inlining
	匿名~box:anonymous-box

	~~半分:50%
	半分:half
収まる:fitする:~
収まら:fitし:~
収まり:fitし:~
収容-:accommodate:~
埋める:fillする:~

可分:non-atomic::~
変形n:transformation::変形
変形:transform::~
拡がる:expandする:~
	分量比が互いに近くなる:proportionally balance the amount

浮動体:float::~
浮動-:float::~

縦方向:vertical::~
書字:writing::~
縦書き:vertical::~
	縦書き:vertical writing
横書き:horizontal::~
	横方向／

連続する:consecutiveな:~
連続性:contiguous 性:~
連続的:contiguous:~
部屋:room:~
重合しな:overlapしな:重なり合わな
重合して:overlapして:重なり合って
重合した:overlapした:重なり合った
重合する:overlapする:重なり合う
首要:principal::主要
ズラされ:shiftされ:ずらされ
ズラす:shiftする:ずらす
ズラシ:shift:ずらし

空いた:blankな:~
量:amount:~
縮小-:scale down:~
差挟まれ:interleaveされ:差し挟まれ
衝突-:collide:~
	衝突-:collision:~

	挟んで:immediately-
	挟む:surround
	周り:around
	前後:around
	収まり切らない:not enough space 〜 to fit
	個数が一致ない:not enough
	~~傍にある:upper/lower
	囲い込む:trap
	~~長さ:how much
	反対向き:opposing
	超えて~~侵入する:cross
	居座る:sits
	中段:middle
	2 個目の:middle
	外へ:past／:out
	差:difference
	最も右端:rightmost
	一致-:coincide
	~~拡げる:cause 〜 grow
	~~拡げる:grow
	押し出す:push
	外へ:apart

	●CSS
	~level:Level
mark-up::::マークアップ
	style付け:styling
	~style上の:stylistic
下位型:subtype:~

外見:appearance:~
描かれ:drawされ:~
描く:drawする:~
装飾-:decorate::~
装飾:decoration::~

	親が違えられた:misparented
	親子関係:parented
	選択子:Selectors

	●仕様
XHTML:
複雑:complicated:~
役割:role:~
必要十分:adequate:~
図:figure:~
	場合によっては:possibly
厳格:rigorous:~

idea::::アイデア

仕様策定者:spec-writer:~
堅牢:robust:~
凡例:legend:~
適度:reasonable:~
用語集:glossary:~
黙示-:imply:~
	暗黙に:implying／:implied
稀:rare:~
競合:conflict:~
高度な:advancedな:~
open:
close:
魔法:magic:~
対応関係:correspondence:~
借用-:borrow:~
疑って:suspectして:~
順応-:adapt:~
装って:pretendして:~
助力:help:~
想定-:suppose:~
調節-:tweak:~
調和-:harmonize:~
機能:function:~
導入:introduction:~
多方面:extensive:~
需要:demand:~
正当化-:justify:~
探求段階:exploratory stages:~
連絡-:contact:~
記事:article:~
決定的:deterministic:~
循環依存:circular dependency:~
対象読者:audience:読者
	~~読者:people

	国際-化~WG:Internationalization WG
	同様:like 〜
	同じに:as for
	単に:merely
	責務である:responsible
	よく知られた:well-known
	総称:collective term／
	いくつか変種がある:with some variation
	~~実際に:indeed
	別法として:alternatively
	仕様~策定者の世迷言:ramblings of an insane spec-writer
	基準に:with respect to
	ほとんどの面で:In most respects
	近現代では:in recent times
	-:we
	謝意:thank
	その結果:To this end,
	thereof
	thereby
	こともある:sometimes
	~~支持を受けて:in favor of
	~~異常に:pathological
	~~現時点:at the moment
	~~限定されない:but not exclusively
	どちらであろうが:nevertheles
	下位-~system:subsystem
	明確化-:clarification
	-:clarity
	予め定義-済み:pre-defined
	~span:correspond
	付与され:attached
	対応する:relevant／:respective／:attached
	respectively
	-:with the intention that
	利用されてない:unused
	課-:impose／:imposing
	書-:write
	造り直-:revamp
	相当に:substantially
	得る:achieve
	-:take place
	~~保つ:remain
	見かけ:look
	似る:more like
	~~具体的な:scanned
	検討する:look into
	— 要検討。might need to look into this later.
	欠けている:missing
	~~要点を明らかにする:make a point
	選んだ:chose
	考え:think
	〜に注目:Notice
	-:said
	になるもの:serve
	称される:referred to as
	-:refer to
	chose
	行える:do-able
	~~膨大な:crazy proposed
	し直した:back
	〜ようにする限り:provided 〜 made
	織り込まれる:factor into
	少し:slightly
	より深い:more in-depth
	委ねられ:up to
	施され:takes place
	主な:main
	近い:close
	まったく:quite
	保たれ:keep
	どこまで:extent
	所まで:not cause 〜 extent
	許容されるかどうか:allowance
	伴って指定されて:in combination with
	残されて:remain
	~model化:modeled
	~~緩めた:loosen
	整備-:tighten up
	規範的でない:informative
	~GitHub
	色分け:colored
	誤って~pairにされた:mispaired
	乱す:disturb
	調整-:Made 〜 adjustement
	総称され:collectively 〜 all considered

	●未分類
所属-:belong:~
測定法:measure:~
触れる:touchする:~
退化な:degenerate:退化した
連なる:runする:~

継続性:continuity:~
可変:variable:~
教育用:educational:~
	文脈を成す:contextual
種類:kind:~
丸括弧:parentheses:~
	丸括弧:parens
	丸括弧を伴わない:unparenthesized
記号:symbol:~
	記号~的:symbolic
連結-:concatenate:~
青色:blue:~
順列:permutation:~
	両側:double-sided／-
排他的:exclusive:~
交替-:alternate:~

	論理-順序で:logically-
	保つ:keep
	残され:left
	共有-法:sharing
	生成-法:generating
	association
	~~論理順:in memory
	複数~行lに:across lines
	~~位置する／一緒であり続ける:stay
	~~露わにする／図解-:illustrate
	~~図式:illustration
	取り出した:took 〜 out of
	後続する:follow
	後続して:subsequently
	-:away
	~flow内:in-flow
	行l端~辺:line-edge
	-:pattern
	-:so-corresponding
	交互に挟まれ:alternating
	句:phrase
	個数が最も少ない:least number
	から~~昇順:starting with the ... increasing number of
	注釈~levelの~~昇順:increasing level order
	〜が属する:enclosing
	都市:city
	問い合わせる:inquiring
	並び:sequence
	増やさ:increase
	を処するほど十分~賢くする労をかけるに価しない:be worth the effort to make 〜 smart enough to deal with
	小学一年生:first grade
	教わる:taught
	上級生で教わる:more advanced
	しないよう:prevent
	からなる:composed
	~~数字
	漢数字
	洋数字

	^en:line feed
	^en:endings
	^en:particle
	^en:excess

	●指示語
余分:extra:~
	尾部:trailing
	頭部:leading
	~~直に:immediate に
	最も近い:nearest
	最も少ない:fewest
	大きい:large
	後者の:second
	以前の:previous
	副次的なもの:incidental
	同時に:simultaneous
	主に:mainly
	次:next
	ほとんど:mostly
	わたって:across
	より早い:earlier
	より深い:more in-depth
	より近い:closer
	短い:short
	より短い:shorter
	より短く:shorter
	短い方の:shorter
	長い:long
	より長い:longer
	長い方の:longer
	方が長い:longer
	最も長い:longest
	より高い:taller
	最終的に:ultimately
	一体として:as a whole
	一部:part of
	一致:coincide
	無:nothing
	各:either
	満たない:is less than
	他にも〜ある:is not the sole
	ある:some
	いくぶん:somewhat
	次:next
	周囲の:surrounding
	まず:initially
	~~先行する:prior
	全体を通して:throughout

●●html_code_list


■box-fixup-1
<ruby>×<rbc>×<rb></rb>⬕<rb></rb>×</rbc>☒<rtc>×<rt></rt>⬔<rt></rt>×</rtc>◼<rbc>×<rb></rb>…</rtc>×</ruby>

■furigana-separate
<ruby>
  <rb>振</rb><rb>り</rb><rb>仮</rb><rb>名</rb>
  <rp>(</rp><rt>ふ</rt><rt>り</rt><rt>が</rt><rt>な</rt><rp>)</rp>
</ruby>

■ruby-pairing
<ruby><rb>昆<rb>虫<rb>記<rt>こん<rt class=easy>ちゅう<rt>き</ruby>

■tokyo
<ruby>
  <rb>東</rb><rb>京</rb>
  <rt>とう</rt><rt>きょう</rt>
  <rtc><rt>Tō</rt><rt>kyō</rt></rtc>
</ruby>

■WWW
<ruby>
  <rb>W</rb><rb>W</rb><rb>W</rb>
  <rt>World</rt> <rt>Wide</rt> <rt>Web</rt>
</ruby>

■Gainsborough
<ruby>
  <rb>Aerith</rb><rb> </rb><rb>Gainsborough</rb>
  <rt>エアリス</rt><rt>・</rt><rt>ゲインズブール</rt>
</ruby>

■nosmoke-1
<ruby>
  屋<rt>おく</rt>内<rt>ない</rt>
  禁<rt>きん</rt>煙<rt>えん</rt>
</ruby>


■nosmoke-2
<ruby>
  屋<rt>おく</rt>  内<rt>ない</rt>
  禁<rt>きん</rt>  煙<rt>えん</rt>
</ruby>


■kocho
<ruby>蝴<rt>hú</rt>蝶<rt>dié</rt>

■onetwo
<ruby><rb>one</rb> <rb>two</rb> <rt>1</rt> <rt>2</rt></ruby>

■inter-character-1
<ruby>基底<rtc><em>問題になり得る</em>注釈</ruby>

<ruby>base<rtc><em>problematic</em> annotation</ruby>

■inter-character-2
<ruby>基底<rt><em>問題になり得る</em>注釈</ruby>

<ruby>base<rt><em>problematic</em> annotation</ruby>

■inter-character-3
<ruby>基底<rtc><rt><em>問題になり得る</em>注釈</ruby>

<ruby>base<rtc><rt><em>problematic</em> annotation</ruby>

■mujo-separate
<p><ruby>無<rt>む</ruby><ruby>常<rt>じょう</ruby>
<p><ruby style="ruby-merge:separate"><rb>無<rb>常<rt>む<rt>じょう</ruby>

■mujo-collapse
<p><ruby>無常<rt>むじょう</ruby>
<p><ruby style="ruby-merge:merge"><rb>無<rb>常<rt>む<rt>じょう</ruby>


●●ref_key_map
CSS3TEXTDECOR:CSSTEXTDECOR3
CSS3WRITINGMODES:CSSWRITINGMODES3

●●ref_normative

[CSS-BOX-4]
    Elika Etemad. ＜CSS Box Model Module Level 4＞. URL: https://drafts.csswg.org/css-box-4/
[CSS-CASCADE-5]
    Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. ＜CSS Cascading and Inheritance Level 5＞. URL: https://drafts.csswg.org/css-cascade-5/
[CSS-DISPLAY-3]
    Tab Atkins Jr.; Elika Etemad. ＜CSS Display Module Level 3＞. URL: https://drafts.csswg.org/css-display/
[CSS-DISPLAY-4]
    CSS Display Module Level 4 URL: https://drafts.csswg.org/css-display-4/
[CSS-FONTS-5]
    Myles Maxfield; Chris Lilley. ＜CSS Fonts Module Level 5＞. URL: https://drafts.csswg.org/css-fonts-5/
[CSS-GRID-2]
    Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. ＜CSS Grid Layout Module Level 2＞. URL: https://drafts.csswg.org/css-grid-2/
[CSS-INLINE-3]
    Dave Cramer; Elika Etemad. ＜CSS Inline Layout Module Level 3＞. URL: https://drafts.csswg.org/css-inline-3/
[CSS-PSEUDO-4]
    Daniel Glazman; Elika Etemad; Alan Stearns. ＜CSS Pseudo-Elements Module Level 4＞. URL: https://drafts.csswg.org/css-pseudo-4/
[CSS-SIZING-3]
    Tab Atkins Jr.; Elika Etemad. ＜CSS Box Sizing Module Level 3＞. URL: https://drafts.csswg.org/css-sizing-3/
[CSS-SYNTAX-3]
    Tab Atkins Jr.; Simon Sapin. ＜CSS Syntax Module Level 3＞. URL: https://drafts.csswg.org/css-syntax/
[CSS-TABLES-3]
    François Remy; Greg Whitworth; David Baron. ＜CSS Table Module Level 3＞. URL: https://drafts.csswg.org/css-tables-3/
[CSS-TEXT-3]
    Elika Etemad; Koji Ishii; Florian Rivoal. ＜CSS Text Module Level 3＞. URL: https://drafts.csswg.org/css-text-3/
[CSS-TEXT-4]
    Elika Etemad; et al. ＜CSS Text Module Level 4＞. URL: https://drafts.csswg.org/css-text-4/
[CSS-TEXT-DECOR-4]
    Elika Etemad; Koji Ishii. ＜CSS Text Decoration Module Level 4＞. URL: https://drafts.csswg.org/css-text-decor-4/
[CSS-VALUES-3]
    Tab Atkins Jr.; Elika Etemad. ＜CSS Values and Units Module Level 3＞. URL: https://drafts.csswg.org/css-values-3/
[CSS-VALUES-4]
    Tab Atkins Jr.; Elika Etemad. ＜CSS Values and Units Module Level 4＞. URL: https://drafts.csswg.org/css-values-4/
[CSS-WRITING-MODES-4]
    Elika Etemad; Koji Ishii. ＜CSS Writing Modes Level 4＞. URL: https://drafts.csswg.org/css-writing-modes-4/
[CSS2]
    Bert Bos; et al. ＜Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification＞. URL: https://drafts.csswg.org/css2/
[CSS3-TEXT-DECOR]
    Elika Etemad; Koji Ishii. ＜CSS Text Decoration Module Level 3＞. URL: https://drafts.csswg.org/css-text-decor-3/
[CSS3-WRITING-MODES]
    Elika Etemad; Koji Ishii. ＜CSS Writing Modes Level 3＞. URL: https://drafts.csswg.org/css-writing-modes-3/
[HTML]
    Anne van Kesteren; et al. ＜HTML Standard＞. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[RFC2119]
    S. Bradner. ＜Key words for use in RFCs to Indicate Requirement Levels＞. March 1997. Best Current Practice. URL: https://datatracker.ietf.org/doc/html/rfc2119

●●ref_informative

[CLREQ]
    Bobby Tung; et al. ＜Requirements for Chinese Text Layout - 中文排版需求＞. URL: https://w3c.github.io/clreq/
[CSS-ALIGN-3]
    Elika Etemad; Tab Atkins Jr.. ＜CSS Box Alignment Module Level 3＞. URL: https://drafts.csswg.org/css-align/
[CSS-FLEXBOX-1]
    Tab Atkins Jr.; et al. ＜CSS Flexible Box Layout Module Level 1＞. URL: https://drafts.csswg.org/css-flexbox-1/
[JIS4051]
    ＜Formatting rules for Japanese documents (『日本語文書の組版方法』).＞ Japanese Standards Association. 2004. JIS X 4051:2004. In Japanese
[JISX4051]
    ＜Line composition rules for Japanese documents.＞ Japanese Standards Association. 1995. JIS X 4051-1995. In Japanese
[JLREQ]
    Hiroyuki Chiba; et al. ＜Requirements for Japanese Text Layout 日本語組版処理の要件(日本語版)＞. URL: https://w3c.github.io/jlreq/
[QA-RUBY]
    Richard Ishida. ＜What is ruby?＞. URL: https://www.w3.org/International/questions/qa-ruby
[RUBY]
    Marcin Sawicki; et al. ＜Ruby Annotation＞. 31 May 2001. REC. URL: https://www.w3.org/TR/ruby/
[SIMPLE-RUBY]
    Florian Rivoal; Atsushi Shimono; Richard Ishida. ＜Rules for Simple Placement of Japanese Ruby＞. URL: https://w3c.github.io/simple-ruby/


●●trans_metadata
<p>
~THIS_PAGEは、 W3C により
として公開された
<a href="~SPEC_URL">CSS Ruby Annotation Layout Module Level 1</a>
を日本語に翻訳したものです。
~PUB
</p>

●●spec_metadata

最新公表バージョン
	https://www.w3.org/TR/css-ruby-1/
公表履歴
	https://www.w3.org/standards/history/css-ruby-1

テスト一式
	https://www.w3.org/International/tests/repo/results/css-ruby
	http://test.csswg.org/suites/css-ruby-1_dev/nightly-unstable/
フィードバック
	<a href="https://github.com/w3c/csswg-drafts/labels/css-ruby-1">CSSWG Issues Repository</a>

編集
	<a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad / fantasai</a> (Invited Expert)
	<a href="mailto:kojiishi@gmail.com">Koji Ishii</a> (Google)
	<a href="https://www.upsuper.org/">Xidorn Quan</a> (Mozilla)
	<a href="https://florian.rivoal.net/">Florian Rivoal</a> (Invited Expert)

Suggest an Edit for this Spec:</dt>
	<a href="https://github.com/w3c/csswg-drafts/blob/main/css-ruby-1/Overview.bs">GitHub Editor</a>
commit 履歴
	https://github.com/w3c/csswg-drafts/commits/main/css-ruby-1
</script>

</head>

<body>

<template id="_persisted_parts">

<x-diagram
	aria-describedby="_dgm-ruby-context"
>
<table
	class="ex-ruby-table"
><tbody>
<tr style="font-size: 0.5em;"><td>くん<td>し<td><td>わ<td><td>どう<td>
<tr><td>君<td>子<td>は<td>和<td>して<td>動<td>ぜず
</tbody></table>
</x-diagram>

<table
	id="_dgm-licence"
	class="ex-ruby-table"
	style="font-size: 2em; display: inline-table;"
><tbody>
<tr><td style="font-size:0.6em;">ラ イ セ ン ス
<tr><td>利用許諾
</tbody></table>

<x-diagram
	aria-describedby="_dgm-ruby-univ"
>
<table
	class="ex-ruby-table"
><tbody>
<tr style="font-size: 0.5em;">
<td>けい<td>おう<td>ぎ<td>じゅく<td>だい<td>がく

<tr><td>慶<td>應<td>義<td>塾<td>大<td>学
<tr style="font-size: 0.5em;" lang="en"><td colspan="4">Keio
<td colspan="2">University
</tbody></table>
</x-diagram>

<table
	id="_dgm-ruby-boxes-simple"
	class="ex-ruby-table ex-ruby-boxes-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td>上<td>手
<tr class="ex-ruby-boxes-anno"><td>じょう<td>ず
</tbody></table>

<table
	id="_dgm-ruby-boxes-complex"
	class="ex-ruby-table ex-ruby-boxes-table"
><tbody>
<tr class="ex-ruby-boxes-anno"><td>jiù<td>jīn<td>shān
<tr class="ex-ruby-boxes-base"><td>旧<td>金<td>山
<tr class="ex-ruby-boxes-anno"><td colspan="3">San Francisco
</tbody></table>

<table
	id="_dgm-ex-pairing"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno"><td colspan="7">複数個の基底に span する注釈
<tr class="ex-ruby-boxes-anno"><td>A1<td>[ws]<td>A2<td>[  ]<td>A3<td>[ws]<td>A4
<tr class="ex-ruby-boxes-base"><td>B1<td>[ws]<td>B2<td>[ws]<td>B3<td>[  ]<td>B4
</tbody></table>

<x-diagram
	aria-describedby="_dgm-furigana-separate"
>
<table
	class="ex-ruby-table"
><tbody>
<tr style="font-size: 0.5em;">
<td>ふ<td><td>が<td>な
<tr><td>振<td>り<td>仮<td>名
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-pairing-full"
>
<table
	class="ex-ruby-table ex-ruby-pairing"
><tbody>
<tr style="font-size: 0.5em;">
<td>こん<td>ちゅう<td>き
<tr><td>昆<td>虫<td>記
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-pairing-collapse"
>
<table
	class="ex-ruby-table ex-ruby-pairing"
><tbody>
<tr style="font-size: 0.5em;">
<td>こん<td><td>き
<tr><td>昆<td>虫<td>記
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-pairing-invisible"
>
<table
	class="ex-ruby-table ex-ruby-pairing"
><tbody>
<tr style="font-size: 0.5em;">
<td>こん<td><span style="visibility:hidden;">ちゅう</span><td>き
<tr><td>昆<td>虫<td>記
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-pairing-discard"
>
<table
	class="ex-ruby-table ex-ruby-pairing"
><tbody>
<tr style="font-size: 0.5em;">
<td>こん<td style="color:purple;">き<td>
<tr><td>昆<td>虫<td>記
</tbody></table>
</x-diagram>

<table
	id="_dgm-ex-separate"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno"><td>A1<td>A2<td>A3 A3 A3
<tr class="ex-ruby-boxes-base"><td>B1<td>B2<td>B3
</tbody></table>

<table
	id="_dgm-ex-short-span"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno"><td>A1<td colspan="2">A2
<tr class="ex-ruby-boxes-base"><td>B1<td>B2<td>B3
</tbody></table>

<table
	id="_dgm-ex-long-span"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno"><td>A1<td colspan="2">A2 A2 A2 A2 A2 A2
<tr class="ex-ruby-boxes-base"><td>B1<td>B2<td>B3
</tbody></table>

<table
	id="_dgm-ex-short-merge"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno"><td colspan="3">
<div style="display:flex; justify-content:space-between;"><span>A1</span> <span>A1</span></div>
<!-- text-align:justify; text-align-last:justify -->
<tr class="ex-ruby-boxes-base"><td>B1<td>B2<td>B3
</tbody></table>

<table
	id="_dgm-ex-multi-level-span-1"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno">
<td><div class="ex-extra-space">A1</div><td><div class="ex-extra-space">A2 A2 A2 A2</div>
<td><div class="ex-extra-space">A3</div>
<tr class="ex-ruby-boxes-anno">
<td colspan="3">A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1
<tr class="ex-ruby-boxes-base">
<td><div class="ex-extra-space">B1</div>
<td><div class="ex-extra-space">B2</div>
<td><div class="ex-extra-space">B3</div>
</tbody></table>

<table
	id="_dgm-ex-multi-level-span-2"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno">
<td>A1
<td colspan="2">A2 A2 A2 A2 A2 A2 A2 A2
<tr class="ex-ruby-boxes-anno">
<td>A1
<td><div class="ex-extra-space">A2 A2 A2 A2</div>
<td><div class="ex-extra-space">A3</div>
<tr class="ex-ruby-boxes-base">
<td>B1
<td><div class="ex-extra-space">B2</div>
<td><div class="ex-extra-space">B3</div>
</tbody></table>

<table
	id="_dgm-ex-multi-level-mutli-span"
	class="ex-ruby-table ex-ruby-boxes-table"
	style="font-size:2em;"
><tbody>
<tr class="ex-ruby-boxes-anno">
<td><div class="ex-extra-space">A1</div>
<td colspan="2" style="color:green;"><div class="ex-extra-space" style="border-width: 1.4rem">A2 A2 A2 A2 A2 A2</div>
<tr class="ex-ruby-boxes-anno">
<td><div class="ex-extra-space">A1</div>
<td><div class="ex-extra-space"><div class="ex-extra-space">A2</div></div>
<td><div class="ex-extra-space"><div class="ex-extra-space">A3</div></div>
<tr class="ex-ruby-boxes-anno">
<td colspan="3" style="color:gray;">A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1
<tr class="ex-ruby-boxes-base">
<td><div class="ex-extra-space">B1</div>
<td><div class="ex-extra-space"><div class="ex-extra-space">B2</div></div>
<td><div class="ex-extra-space"><div class="ex-extra-space">B3</div></div>
</tbody></table>


<x-diagram
	aria-describedby="_dgm-shinkansen-top"
	class="x-shinkansen"
>
<x-bk style="font-size:0.5em;">しんかんせん</x-bk>
<x-bk>新幹線</x-bk>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-shinkansen-right"
	class="x-shinkansen"
	style="writing-mode: vertical-rl;"
>
<x-bk style="font-size:0.5em;">しんかんせん</x-bk>
<x-bk>新幹線</x-bk>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-shinkansen-bottom"
	class="x-shinkansen"
>
<x-bk>新幹線</x-bk>
<x-bk style="font-size:0.6em;" lang="en">shinkansen</x-bk>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-shinkansen-left"
	class="x-shinkansen"
	style="writing-mode: vertical-rl;"
>
<x-bk>新幹線</x-bk>
<x-bk style="font-size:0.6em;" lang="en">shinkansen</x-bk>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-bopomofo"
	id="_ex-bopomofo"
	lang="zh-tw"
><div>電
</div><div class="x-bpmf">ㄉ
ㄧ
ㄢ
<span>ˋ</span>
</div><div>腦
</div><div class="x-bpmf" style="padding-top:0.5em;">ㄋ
ㄠ
<span>ˇ</span>
</div></x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-mono"
	class="ex-ruby-merge"
>
<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>上</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td><merge-box>じ</merge-box><merge-box>ょ</merge-box><merge-box>う</merge-box><td><merge-box>ず</merge-box>
</tbody></table>

<hr>

<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>下</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td><merge-box>へ</merge-box><td><merge-box>た</merge-box>
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-merge"
	class="ex-ruby-merge"
>
<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>上</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td><merge-box>じ</merge-box><merge-box>ょ</merge-box><td><merge-box class="ex-first-box">う</merge-box><merge-box>ず</merge-box>
</tbody></table>
<hr>
<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>下</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td style="text-align:right;"><merge-box>へ</merge-box><td style="text-align:left;"><merge-box>た</merge-box>
</tbody></table>
</x-diagram>

<x-diagram
	aria-describedby="_dgm-ruby-jukugo"
	class="ex-ruby-merge"
>
<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>上</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td><merge-box>じ</merge-box><merge-box>ょ</merge-box><td><merge-box class="ex-first-box">う</merge-box><merge-box>ず</merge-box>
</tbody></table>
<hr>
<table
	class="ex-ruby-table"
><tbody>
<tr class="ex-ruby-boxes-base"><td><merge-box>下</merge-box><td><merge-box>手</merge-box>
<tr class="ex-ruby-boxes-anno"><td><merge-box>へ</merge-box><td><merge-box>た</merge-box>
</tbody></table>
</x-diagram>

</template>

<header>

	<hgroup>
<h1>CSS ルビ注釈 — CSS Ruby Annotation Layout Module Level 1</h1>
	</hgroup>
</header>

<div id="MAIN" hidden>
	<section id="abstract">
◎要約

<p>
“~ruby” は、
行l間に併記される注釈のある形であり，基底~textの傍に沿って現れる短い~text連なりである。
それらは概して，東Asian文書に利用され、
発音を指示したり短い注釈を供する。
この~moduleは、
~CSSにおける，~ruby注釈の表示に関係する［
描画~model／整形~制御
］について述べる。
◎
“Ruby”, a form of interlinear annotation, are short runs of text alongside the base text. They are typically used in East Asian documents to indicate pronunciation or to provide a short annotation. This module describes the rendering model and formatting controls related to displaying ruby annotations in CSS.
</p>

~CSSisaLANG

	</section>
	<section id="sotd">
◎位置付け

<p>
これは、
編集者草案の公な複製です…
【以下、この節の内容は，~SOTD-CSSに移譲。】
</p>

	</section>

<main id="MAIN0">

	<section id="intro">
<h2 title="Introduction">1. 序論</h2>

		<section id="ruby-def">
<h3 title="What is ruby?">1.1. ~rubyとは何か？</h3>

◎非規範的

<p>
`~ruby@
とは，［
その “基底” と称される，ある~text連なり
］に並行して現れる別の~text連なりであり、［
基底に対する注釈や発音の手引きになるものとして，結付けられたもの
］を指すときに，共通的に利用されている名前である。
◎
Ruby is the commonly-used name for a run of text that appears alongside another run of text (referred to as the “base”) and serves as an annotation or a pronunciation guide associated with that run of text.
</p>

<figure>
<p class="alt" hidden id="_dgm-ruby-context">
日本語~text内の各 日文漢字の上に平仮名による~ruby注釈がある
◎
Hiragana ruby annotations above each kanji in Japanese text
</p>
<figcaption>
日本語~textが成す連なりには、
各~表語文字の発音を指示している発音符を与える~ruby注釈が伴われる。
◎
A run of Japanese text with phonetic ruby annotations indicating the pronunciation of each ideograph.
</figcaption></figure>

<p>
単純な~rubyの例と, より複雑な構造を有する~rubyの例を，以下の図に示す：
◎
The following figures show two examples of Ruby, a simple case and one with more complicated structure.
</p>

<div class="example">

<p>
次の例では、
単独の注釈を利用して複数個の文字からなる基底~textを注釈している。
◎
In this example, a single annotation is used to annotate a base text consisting of multiple characters.
</p>

<figure>
<x-diagram aria-describedby="_alt-licence">
`licence^dgm
<span>（上段は~ruby注釈~text, 下段は~ruby基底~text）</span>
</x-diagram>
<p class="alt" hidden id="_alt-licence">
日本語~表記の上端に適用される~rubyの例
◎
Example of ruby applied on top of a Japanese expression
</p>
<figcaption>
日本語で利用される~rubyの例（単純な事例）
◎
Example of ruby used in Japanese (simple case)
</figcaption></figure>

<p>
日本語~typographyでは、
これは，［
対語~ruby（すなわち，単語~~単位の~ruby）／~group~ruby
］と呼ばれることもある
— 当の注釈は、
一体として，複-文字からなる単語に結付けられているので。
◎
In Japanese typography, this case is sometimes called taigo ruby (Japanese: 対語ルビ, i.e. per-word ruby) or group-ruby, because the annotation as a whole is associated with multi-character word (as a whole).
</p>
</div>

<div class="example">
<p>
次の例では、
基底~並びに 2 個の~levelの注釈が付与されている。
上端にある`平仮名$による文字たちは，基底を成す各 `日文漢字$の発音を示している一方で、
下端にある単語［
“`Keio^en” , “`University^en”
］は，英語~翻訳を与えている。
◎
In this second example, two levels of annotations are attached to the base text: the hiragana characters on top refer to the pronunciation of each of the base kanji characters, while the words “Keio” and “University” on the bottom are give the English translation.
</p>

<figure>
<p class="alt" hidden id="_dgm-ruby-univ">
基底~文字の上面にも下面にも注釈~textを伴う複階的な~rubyを示す例
◎
Example showing complex ruby with annotation text over and under the base characters
</p>
<figcaption>
基底~文字の上面と下面に注釈~textを伴う，複階的な~ruby。
◎
Complex ruby with annotation text over and under the base characters
</figcaption></figure>

<p>
注釈~levelの`平仮名$からなる~textを成す各 文字~並びと,
対応する基底~levelの`日文漢字$からなる~textを成す各 文字との正しい結付けを【表示に】反映するため、
後者を成す文字たちの各 合間の間隔は調整されていることに注目
（上の図では、
4 個目の日文漢字
（それは、
3 文字の発音符からなる注【すなわち，振仮名】を伴う）
の前後に生じている）。
上の例で，`平仮名$からなる`注釈を併合する$ように~styleをアテガえば、
基底~textの各~合間の間隔が可変になるのを避けれる
— その見かけは、
先に示した~group~rubyの例に似るが、
~ruby構造~内には，各
( 基底, 注釈 )
が成す`~pair法$が記録されるので、
~textが複数~行lに分断される場合でも，注釈~文字は，対応する基底~文字と正しく~pairになるように~~位置する。
◎
Notice that to reflect the correct association of hiragana characters and their corresponding Kanji base characters, the spacing within the base-level text is adjusted. (This happens around the fourth Kanji character in the figure above, which has a three-character phonetic gloss.) To avoid variable spacing of the base text in the example above, the hiragana annotations can be styled as a merged annotation, which will look more like the group-ruby example earlier. However because the base-annotation pairings are recorded in the ruby structure, if the text breaks across lines, the annotation characters will stay correctly paired with their respective base characters.
</p>

</div>

<p>
~HTMLにおいては、
~ruby構造とそれを表現する~markupは，
`Ruby Markup Extension^cite 仕様
【`参照＠~TR/html-ruby-extensions/$】
にて述べられる。
この~moduleは、
そのような~markupの~ruby~layoutに関連な，~CSSによる描画~modelと整形~制御について述べる。
◎
In HTML, ruby structure and markup to represent it is described in the Ruby Markup Extension specification. This module describes the CSS rendering model and formatting controls relevant to ruby layout of such markup.
</p>

<p>
`~ruby$, その整形に関する もっと深い導入は、
`QA-RUBY$r による記事 “~rubyとは何か（ `What is Ruby^en ）” に見出せる。
日本語において`~ruby$が伝統的に整形されてきた主な仕方についての多方面な情報は、
`JIS4051$r （日本語のみ）, および
`JLREQ$r
`§ ~rubyと~~圏点＠~TR/jlreq/#ruby_and_emphasis_dots$
（日本語, 英語 併記）にて見出せる。
`SIMPLE-RUBY$r もまた，日本語~rubyの整形~用にアリな~approachを述べる。
`CLREQ$r
`§ 行l間~注釈＠~TR/clreq/#interlinear_annotations$
は、
中国語~typography用の関係する実施を述べる（中国語, 英語 併記）。
◎
A more in-depth introduction to Ruby and its formatting can be found in the “What is Ruby“ article [QA-RUBY]. Extensive information about the main ways ruby has traditionally been formatted in Japanese can be found in JIS X-4051 [JIS4051] (in Japanese) and in “Ruby and Emphasis Dots” in Requirements for Japanese Text Layout [JLREQ] (in English and Japanese); Rules for Simple Placement of Japanese Ruby [SIMPLE-RUBY] also describes (in English) one possible approach for Japanese ruby formatting. “Interlinear annotations” in Requirements for Chinese Text Layout [CLREQ] describes the related practices for Chinese typography (in Chinese and English).
</p>

		</section>
		<section id="placement">
<h3 title="Module interactions">1.2. ~module間の相互作用</h3>

<p>
この~moduleは、
`CSS2$r の行内~box~modelを，~rubyを~supportするように拡張する。
◎
This module extends the inline box model of CSS Level 2 [CSS2] to support ruby.
</p>

<p>
この~moduleのどの~propも［
`first-line$pe ／ `first-letter$pe
］疑似要素には適用されない。
しかしながら， `ruby-position$p は、
`first-line$pe を通して，最初の行l【`整形される最初の行l$】にある~ruby注釈に影響するように継承され得る。
◎
None of the properties in this module apply to the ::first-line or ::first-letter pseudo-elements; however ruby-position can inherit through ::first-line to affect ruby annotations on the first line.
</p>

		</section>
		<section id="values">
<h3 title="Value Definitions">1.3. 値~定義</h3>

<p class="trans-note">【
この節の内容は `~CSS日本語訳 共通~page＠~CSScommon#values$に移譲。
】</p>

		</section>
		<section id="diagram-conventions">
<h3 title="Diagram conventions">1.4. 図式の表記規約</h3>

◎非規範的

<p>
東Asian~typographyにおける多くの~typographic上の表記規約は、
描画される文字が［
`wide^en （“~~全角”, ~CJK）,
`narrow^en （“~~半角”, 非~CJK）
］のどちらであるかに依存する。
この文書の いくつかの~~図式では、
その区別と~text連なり内の文字~付番を，次のような凡例で表す：
◎
Many typographical conventions in East Asian typography depend on whether the character rendered is wide (CJK) or narrow (non-CJK). There are a number of illustrations in this document for which the following legend is used:
</p>

<dl>
	<dt>
<x-diagram
	aria-describedby="_dgm-fullwidth"
	style="font-size: 1.5em;"
>
`四^xF
</x-diagram>
<p class="alt" hidden id="_dgm-fullwidth">
記号~的な全角~glyph表現
◎
Symbolic wide-cell glyph representation
</p>
	</dt>
	<dd>
これは、
~text連なり内の 4 個目の文字を指す，全角~glyphを表す（例： `漢字$）。
全角~glyphとして描画される文字は、
このように漢数字で表される。
◎
Wide-cell glyph (e.g. Han) that is the nth character in the text run. They are typically sized to 50% when used as annotations.
</dd>

	<dt>
<x-diagram
	aria-describedby="_dgm-halfwidth"
	style="font-size: 1.5em;"
>
`4^xH
</x-diagram>
<p class="alt" hidden id="_dgm-halfwidth">
記号~的な半角~glyph表現
◎
Symbolic narrow-cell glyph representation
</p>
	</dt>
	<dd>
これは、
~text連なり内の 4 個目の文字を指す，半角~glyphを表す（例： ~roman ）。
半角~glyphとして描画される文字は、
このように洋数字で表される。
◎
Narrow-cell glyph (e.g. Roman) which is the nth glyph in the text run.
</dd>
</dl>

<p>
いずれも，注釈においては、
概して，基底の~~半分~sizeで示される。
◎
↑</p>

<p class="trans-note">【
この訳では、［
漢数字, 洋数字
］でこれらを区別することにする。
原文では、
文字, 文字大小, ~~数字による添字
（ F<sub>%n</sub> ／ h<sub>%n</sub> ）
で区別されている。
】</p>

<p>
図式においては、［
上の記号を成す~~数字の方位
］が，そのまま［
その~~数字が表現する~glyphを~UAが描画するときの方位
］として意図されるものと見做される。
図式におけるこれらの文字~間の間隔は、
~~要点を明らかにするために意図的に変更されない限り，副次的なものである。
◎
The orientation which the above symbols assume in the diagrams corresponds to the orientation that the glyphs they represent are intended to assume when rendered by the user agent. Spacing between these characters in the diagrams is incidental, unless intentionally changed to make a point.
</p>

<p class="trans-note">【
便宜上，この訳では、
原文の［
`wide-cell^en ／ `narrow-cell^en
］を［
~~全角／~~半角
］と対訳しているが，いわゆる［
~~全角（ `fullwidth^en ）／~~半角（ `halfwidth^en ）
］とは技術的に異なるかもしれない
（例えば “~~半角カナ” は、
本当はどちらに分類されるべきか？）。
~Unicode仕様における， `East_Asian_Width^en ~propの［
`wide^en ／ `narrow^en
］を意味するようにも見受けられるが、
原文でも説明されていないので，深く立ち入らないことにする。
】</p>

		</section>
	</section>
	<section id="ruby-model">
<h2 title="Ruby Box Model">2. ~ruby~box~model</h2>

<p>
~CSS~ruby~modelは、
次に基づく
⇒＃
`W3C HTML5 Ruby Markup＠~TR/html5/text-level-semantics.html#the-ruby-element$cite ~model†,
`XHTML Ruby Annotation Recommendation＠~TR/ruby/$cite `RUBY$r
◎
The CSS ruby model is based on the W3C HTML5 Ruby Markup model and the XHTML Ruby Annotation Recommendation [RUBY].＼
</p>

<p class="trans-note">【†
これは、
廃された旧~HTML仕様を指している
— 今や，現行の仕様（ WHATWG ）の
<a href="~HEtextlevel#the-ruby-element">§ `ruby^e 要素</a>
に~redirectされるが、
その当時における~modelを指すように思われる。
】</p>

<p>
この~modelにおける~ruby構造は、
次のものからなる：
◎
In this model, a ruby structure consists of＼
</p>
<ul>
	<li>
基底~text（注釈が付与される~text）を表現する， 1 個以上の［
`~ruby基底$を指示する要素
］。
◎
one or more ruby base elements representing the base (annotated) text,＼
</li>
	<li>
それぞれが基底~textに結付けられる注釈を表現する， 1 個以上の~level
— 各~levelは， 1 個以上の［
`~ruby注釈$を指示する要素
］からなる。
◎
associated with one or more levels of ruby annotation elements representing the annotations.＼
</li>
</ul>

<div class="p">
<p>
~rubyの構造は、
~tableのそれに類似する
— そこには，一連の［
“~row”, “~col”
］がある：
</p>
<ul>
	<li>
各 “~row” は、［
`基底~level$, または ある`注釈~level$
］に属する~textからなる。
</li>
	<li>
各 “~col” （`~ruby~col$）は、
ある`~ruby基底$と，それに対応する各`注釈~level$に属する`~ruby注釈$たちからなる。
</li>
</ul>
◎
The structure of ruby is similar to that of a table: there are “rows” (the base text level, each annotation level) and “columns” (each ruby base and its corresponding ruby annotations).
</div>

<figure>
<x-diagram
	aria-describedby="_ruby-boxes-simple"
>
`ruby-boxes-simple^dgm
<p style="display:inline-block; font-size:smaller;">
全体を成す~ruby容器~内の
⇒＃
1 本目の “~row” は `~ruby基底~容器$,
その中の各~青線~boxは `~ruby基底$,
2 本目の “~row” は `~ruby注釈~容器$,
その中の各~赤線~boxは `~ruby注釈$
</p>
</x-diagram>
<p class="alt" hidden id="_ruby-boxes-simple">
~tableとして配列された~ruby構造。
1 本目の “~col” は、
基底~box内に "上" を包含していて，その下には注釈~box内に "じょう" を伴う。
2 本目の “~col” は、
別々な基底~box内に "手" を包含していて，その下には別の注釈~box内に "ず" を伴う。
各~colに対し，基底~textと対応する注釈~textは、
中央が揃えられる。
◎
Ruby structure arranged as a table, the first “column” containing 上 in a base box with じょう centered below in an annotation box and the second “column” containing 手 in a separate base box with ず centered below in another annotation box.
</p>
<figcaption>
<p>
日本語の複合語 "~~上手" は、
その発音 "じょうず" で注釈されている。
各~音節は、
個別に，対応する基底~文字に結付けられる。
</p>
◎
The Japanese compound word “上手” annotated with its pronunciation “じょうず”. Each syllable is associated individually with its base character.
</figcaption></figure>

<p>
［
連続する基底たちと，それらに対応する連続する注釈たち
］が成す集合は、
`~ruby区分$の中に一緒に~group化される。
`~ruby区分$の中では、
`~ruby注釈$は，複数個の`~ruby基底$に`~span$することもある。
◎
Sets of consecutive bases and their consecutive annotations are grouped together into ruby segments. Within a ruby segment, a ruby annotation may span multiple ruby bases.
</p>

<figure>
<x-diagram aria-describedby="_ruby-boxes-complex">
`ruby-boxes-complex^dgm
<p style="display:inline-block; font-size:smaller;">
全体を成す~ruby容器~内の
⇒＃
2 本目の “~row” は `~ruby基底~容器$,
その中の各~青線~boxは `~ruby基底$,
1 本目, 3 本目の “~row” は `~ruby注釈~容器$,
その中の各~赤線~boxは `~ruby注釈$
</p>
</x-diagram>
<p class="alt" hidden id="_ruby-boxes-complex">
~tableとして配列された~ruby構造。
1 本目の “~col” は、
基底~box内に "旧" を包含していて，その上には注釈~box内に "jiù" を伴う。
2 本目の “~col” は、
基底~box内に "金" を包含していて，その上には注釈~box内に "jīn" を伴う。
3 本目の “~col” は、
基底~box内に "山" を包含していて，その上には注釈~box内に "shān" を伴う。
各~colに対し，基底~textと対応する注釈~textは、
中央が揃えられる。
句~全体の下には、
3 本の “~col” すべてに~spanする注釈~box内に名前 "San Francisco" を伴い，
その中央は全体の中央と揃えられる。
◎
Ruby structure arranged as a table, the first “column” containing 旧 in a base box with jiù centered above in an annotation box, the second “column” containing 金 in a base box with jīn centered above in an annotation box, the third “column” containing 山 in a base box with .shān centered above it in an annotation box, and the name San Francisco centered below the entire phrase in an annotation box that spans all three “columns”.
</p>
<figcaption>
中国語による都市~名 "~~旧金山" は、［
拼音（ `pinyin^en ）によるその発音 "jiùjīnshān" , および
その英語~名 "`San Francisco^en"
］で注釈されている。
拼音を成す各~音節は、
個別に，対応する基底~文字に結付けられる。
一方で，英語~名は、
一体としての名前に結付けられる。
◎
The Chinese city name “旧金山” annotated with its pronunciation in Pinyin “jiùjīnshān” and its English name “San Francisco”. Each Pinyin syllable is associated individually with its base character, however the English name is associated with the name as a whole.
</figcaption></figure>

<p class="note">注記：
~HTMLにおいては、
単独の `ruby^e 要素が，複数個の`~ruby区分$を包含することもある。
（~XHTML~Ruby~modelでは、
単独の `ruby^e 要素が包含し得る`~ruby区分$は， 1 個だけである。）
◎
Note: In HTML, a single &lt;ruby&gt; element may contain multiple ruby segments. (In the XHTML Ruby model, a single &lt;ruby&gt; element can only contain one ruby segment.)
</p>

		<section id="ruby-display">
<h3 title="Ruby-specific display Values">2.1. ~rubyに特有な `display^p 値</h3>

<p>
予め定義-済みな~ruby要素を備えていない文書~言語（~XMLの応用など）用には、
作者は，文書~言語の要素を~ruby要素に対応付けることが要求される
— これは、
`display$p ~propで行われる。
◎
For document languages (such as XML applications) that do not have pre-defined ruby elements, authors must map document language elements to ruby elements; this is done with the display property.
</p>

◎名 `display$p
◎新値
`ruby$v | `ruby-base$v | `ruby-text$v | `ruby-base-container$v | `ruby-text-container$v
◎表終

<p>
次に挙げる新たな `display$p 値は、
任意な要素に~ruby~layoutの役割をアテガう：
◎
The following new display values assign ruby layout roles to an arbitrary element:
</p>

<dl>
	<dt>`ruby@v</dt>
	<dd>
要素は
`~ruby容器~box@
を生成するよう指定する
（~HTML／~XHTMLの `ruby^e 要素に対応する）。
◎
Specifies that an element generates a ruby container box. (Corresponds to HTML/XHTML &lt;ruby&gt; elements.)
</dd>

	<dt>`ruby-base@v</dt>
	<dd>
要素は
`~ruby基底~box@
を生成するよう指定する
（~HTML／~XHTMLの `rb^e 要素に対応する）。
◎
Specifies that an element generates a ruby base box. (Corresponds to HTML/XHTML &lt;rb&gt; elements.)
</dd>

	<dt>`ruby-text@v</dt>
	<dd>
要素は
`~ruby注釈~box@
を生成するよう指定する
（~HTML／~XHTMLの `rt^e 要素に対応する）。
◎
Specifies that an element generates a ruby annotation box. (Corresponds to HTML/XHTML &lt;rt&gt; elements.)
</dd>

	<dt>`ruby-base-container@v</dt>
	<dd>
要素は
`~ruby基底~容器~box@
を生成するよう指定する
（~XHTMLの `rbc^e 要素に対応する
— ~HTMLにおいては，`匿名~box$として生成される）。
◎
Specifies that an element generates a ruby base container box. (Corresponds to XHTML &lt;rbc&gt; elements; generated as an anonymous box in HTML.)
</dd>

	<dt>`ruby-text-container@v</dt>
	<dd>
要素は
`~ruby注釈~容器~box@
を生成するよう指定する
（~HTML／~XHTMLの `rtc^e 要素に対応する）。
◎
Specifies that an element generates a ruby annotation container box. (Corresponds to HTML/XHTML &lt;rtc&gt; elements.)
</dd>
</dl>

<p class="trans-note">【
`rb^e, `rtc^e は，現在の~HTMLでは`廃された＠~HTMLobs#rb$ので、
~HTMLにおいては，
`rbc^e と同じく`匿名~box$として生成されることになる
（この仕様に現れる “XHTML” は、
`~XML構文を利用する~HTML＠~HTMLxml#writing-xhtml-documents$ではなく，
過去に策定された方の仕様を指す）。
（あるいは、
入子にされた `ruby^e 要素が それらの~boxを生成することになるかもしれないが、
まだ仕様~化されていない）。
この仕様が定義する~ruby用の~propは，どれも継承されるので、
~HTMLにおいて，それらの~propを［
`~ruby基底$／`~ruby基底~容器$／`~ruby注釈~容器$
］に適用したいときは、
親の`~ruby容器$（ `ruby^e ）に指定することになろう。
】</p>

<p class="advisement">
専用の~ruby~markupを~supportする言語（~HTMLなど）を利用している作者は、
その~markupを利用するべきである
— （ `span^e の様な）任意な要素に
~ruby `display$p 値で~styleをアテガうのでなく。
正しい~markupを利用すれば、
~screen読取器や非~CSS描画器が ~ruby構造を解釈できることを確保できる。
◎
Authors using a language (such as HTML) that supports dedicated ruby markup should use that markup rather than styling arbitrary elements (like &lt;span&gt;) with ruby display values. Using the correct markup ensures that screen readers and non-CSS renderers can interpret the ruby structures.
</p>

<div class="note">
<p>注記：
`置換され$る要素は、
その `display$p の値【算出d値】が：
</p>
<ul>
	<li>
［
`ruby-base$v ／
`ruby-text$v ／
`ruby-base-container$v ／
`ruby-text-container$v
］になる場合
⇒
`行内~levelの~box$として扱われる
— `CSS-DISPLAY-3$r
`§ ~layout内部の表示~型＠~CSSDISP#layout-specific-display$
に従って。
</li>
	<li>
［
`ruby$v ／ `inline ruby^v
］になる場合
⇒
要素の`外縁~表示~型$に則って挙動する
— `CSS-DISPLAY-3$r
`§ ~flow~layoutにおける外縁に対する表示の役割＠~CSSDISP#outer-role$
に従って。
</li>
</ul>

<p>
（ `§ 非~行内~ruby＠#block-ruby$ も見よ。）
</p>
◎
Note: Replaced elements with a display value of ruby-base, ruby-text, ruby-base-container, and ruby-text-container are treated as inline-level boxes, as per CSS Display 3 §2.4 Layout-Internal Display Types: the table-* and ruby-* keywords; replaced elements with a display value of ruby or inline ruby behave according to their outer display type, as per CSS Display 3 §2.1 Outer Display Roles for Flow Layout: the block, inline, and run-in keywords. (See also § 2.1.2 Non-Inline Ruby.)
</div>

			<section id="formatting-context">
<h4 title="The Ruby Formatting Context">2.1.1. ~ruby整形~文脈</h4>

<p>
`~ruby容器$は、
可分な`行内~levelの~box$【すなわち，`行内~box$】である。
それは、
定例の`行内~box$の様に複数~行lに分断され得る
（ `CSS-INLINE-3$r `§ 行内~layout~model＠~CSSINLINE#model$ を見よ）。
また，その`包含塊$は、
先祖の, 最も近い`塊~容器$になる。
また、
`行内~box$の内容が［
当の行内~boxを包含する`行内~整形~文脈$
］に関与するのと同じく，`~ruby容器$とその`基底~level$の内容は［
当の~ruby容器を包含する`行内~整形~文脈$
］に関与する。
◎
Ruby containers are non-atomic inline-level boxes. Like regular inline boxes (see CSS Inline Layout 3 §2 Inline Layout Model), they break across lines, and their containing block is the nearest block container ancestor. And just as the contents of an inline box participate in the same inline formatting context that contains the inline box itself, a ruby container and its base-level contents participate in the same inline formatting context that contains the ruby container itself.
</p>

<p>
しかしながら、
`~ruby容器$は，
`~ruby整形~文脈@
も確立する
— すなわち，注釈を~hostするために、［
`行内~整形~文脈$の一~区分を成す，自身
］の周りに更なる構造を築く。
<span class="note">注記：
この`整形~文脈$は、
`独立な整形~文脈$`ではない^em。
</span>
`内部~table要素$と同様に、［
`~ruby基底$／`~ruby注釈$／`~ruby基底~容器$／`~ruby注釈~容器$
］は，
`内部~ruby~box@
と総称される
— これらは、
~ruby~layoutに特有な役割を有し，`~ruby容器$の`~ruby整形~文脈$に関与する。
`~ruby基底$は、
`~ruby整形~文脈$におけるその役割に加えて，`~ruby容器$と同じ［
基底~levelの`行内~整形~文脈$
］にも同時に関与する。
一方で，`~ruby注釈$は、
`~ruby容器$により確立された別々な［
注釈~levelの`行内~整形~文脈$
］に関与する。
◎
However ruby containers also establish a ruby formatting context that builds further structure around their segment of the inline formatting context in order to host their annotations. Note: this formatting context is not an independent formatting context. Ruby bases, ruby annotations, ruby base containers, and ruby annotation containers are internal ruby boxes: like internal table elements, they have specific roles in ruby layout, and participate in their ruby container’s ruby formatting context. In addition to their role in the ruby formatting context, ruby bases simultaneously participate in the same base-level inline formatting context as the ruby container, while ruby annotations participate in separate annotation-level inline formatting contexts established by the ruby container.
</p>

<p>
`行内~box$の内容と同じく、
`~ruby容器$の内容（および，その すべての`内部~ruby~box$）用の`包含塊$は，
`~ruby容器$の`包含塊$になる。
よって，例えば浮動体を囲い込むのは、
各種~ruby~box型ではなく，`~ruby容器$の`包含塊$になる。
◎
As with the contents of inline boxes, the containing block for the contents of a ruby container (and all its internal ruby boxes) is the containing block of the ruby container. So floats, for example, are trapped by the ruby container’s containing block, not any of the ruby box types.
</p>

			</section>
			<section id="block-ruby">
<h4 title="Non-Inline Ruby">2.1.2. 非~行内~ruby</h4>

<p>
要素の［
`内縁~表示~型$が `ruby$v，`外縁~表示~型$が `inline$v 以外
］である場合、
2 個の~box
— `外縁~表示~型$から要求される `首要~box$, および
【その中に】
`行内~level$の`~ruby容器$ —
が生成されることになる。
要素~上に指定される~propは、
すべて，`首要~box$に適用される
（また，継承-可能であれば，`~ruby容器~box$にも継承される）。
これにより、
要素を
— その内部の~ruby構造を正しく保守しながら —
塊として~styleできるようになる。
◎
If an element has an inner display type of ruby and an outer display type other than inline, then it generates two boxes: a principal box of the required outer display type type, and an inline-level ruby container. All properties specified on the element apply to the principal box (and if inheritable, inherit to the ruby container box). This allows styling the element as a block, while correctly maintaining the internal ruby structure.
</p>

<p class="note">注記：
［
`絶対的に位置され$た／浮動された
］要素の`外縁~表示~型$は、
`塊~化$される
（ `CSS-DISPLAY-3$r, `CSS2$r `§ 9.7＠~CSS2J#dis-pos-flo$
を見よ）。
`内部~ruby要素$（ `内部~ruby~box$を生成させる要素 ）用には、
これにより算出される `display$p 値は `block$v になる。
◎
Note: Absolute positioning or floating an element causes its display value to compute to a block-level equivalent. (See [CSS-DISPLAY-3] or [CSS2] section 9.7.) For the internal ruby display types, this causes their display value to compute to block.
</p>

			</section>
		</section>
		<section id="box-fixup">
<h3 title="Anonymous Ruby Box Generation">2.2. 匿名な~ruby~boxの生成</h3>

<p>
~CSS~modelでは、
文書~言語が，各種~ruby~boxのそれぞれに対応する要素を含むことは、
要求されない。
文書~構造に欠けている部分に対しては、
以下に与えられる，
`~tableを正規化するときに利用される規則＠~CSS2TABLE#anonymous-boxes$ `CSS2$r
に似た規則を通して、
`匿名~box$が暗黙に生成される。
◎
The CSS model does not require that the document language include elements that correspond to each of these components. Missing parts of the structure are implied through the anonymous box generation rules similar to those used to normalize tables. [CSS2]
</p>

<ol>
	<li id="anon-gen-inlinize">
<p>
<strong>`塊~levelの~box$を`行内~化$する</strong>：
◎
Inlinify block-level boxes:＼
</p>
<p>
`~flow内$にある~boxに直に包含されている［
`~ruby容器$／
`内部~ruby~box$【！`~ruby基底~box$／`~ruby注釈~box$／`~ruby基底~容器$／`~ruby注釈~容器$】
］は
— `行内~level$の内容のみを包含するよう —
“`行内~化$” され、
`display$p 値はそれに則って算出される。
例えば，`~flow内$にある要素が［
自身の `display$p は `block$v，親の `display$p は `ruby-text$v にされている
］場合、
要素の `display$p ~propは， `inline-block$v に算出される。
`CSS-DISPLAY-3$r
◎
Any in-flow boxes directly contained by a ruby container, ruby base container, ruby annotation container, ruby base box, or ruby annotation box are “inlinified” per [CSS-DISPLAY-3]), and their display value computed accordingly, so that they contain only inline-level content. For example, the display property of an in-flow element with display: block parented by an element with display: ruby-text computes to inline-block.
</li>
	<li id="anon-gen-anon-ruby">
<p>
<strong>匿名な~ruby容器を生成する</strong>：
◎
Generate anonymous ruby containers:＼
</p>
<p>
不適正に包含されている`内部~ruby~box$
【！`~ruby基底~容器$／`~ruby注釈~容器$／`~ruby基底~box$／`~ruby注釈~box$】
（および介在な`空白$）からなる，連続する並びは、
`匿名$【！~CSS2TABLE#anonymous-boxes】な`~ruby容器$内に包装する。
この段の目的においては、
次のものが不適正に包含されているとされる：
◎
Any consecutive sequence of improperly-contained ruby base containers, ruby annotation containers, ruby bases, and/or ruby annotations (and any intervening white space) is wrapped in an anonymous ruby container. For the purpose of this step:
</p>
		<ul>
			<li>
`~ruby基底$であって，その親は［
`~ruby基底~容器$／`~ruby容器$
］でないもの。
◎
an improperly-contained ruby base is one not parented by a ruby base container or ruby container
</li>
			<li>
`~ruby注釈$であって，その親は［
`~ruby注釈~容器$／`~ruby容器$
］でもないもの。
◎
an improperly-contained ruby annotation is one not parented by a ruby annotation container or ruby container
</li>
			<li>
［
`~ruby基底~容器$／`~ruby注釈~容器$
］であって，その親は`~ruby容器$でないもの。
◎
an improperly-contained ruby base container or ruby annotation container is one not parented by a ruby container
</li>
		</ul>
	</li>
	<li id="anon-gen-bare-inlines">
<p>
<strong>親が違えられた`行内~level$の内容を包装する</strong>：
◎
Wrap misparented inline-level content:＼
</p>
<p>
連続する［
~textや`行内~levelの~box$
］からなる並びのうち，その親が：
◎
↓</p>
		<ul>
			<li>
［
`~ruby容器$／`~ruby基底~容器$
］であるものは、
`匿名$な`~ruby基底$内に包装する。
◎
Any consecutive sequence of text and inline-level boxes directly parented by a ruby container or ruby base container is wrapped in an anonymous ruby base.＼
</li>
			<li>
`~ruby注釈~容器$であるものは、
`匿名$な`~ruby注釈$内に包装する。
◎
Similarly, any consecutive sequence of text and inline-level boxes directly parented by a ruby annotation container is wrapped in an anonymous ruby annotation.＼
</li>
		</ul>
<p>
（この目的においては、
親が違えられた`内部~table要素$は，`行内~level$の内容として扱われる
— 親が~ruby~boxにされるものは、
最終的に`行内~level$の`~table包装~box$で包装されることになるので。）
◎
(For this purpose, misparented internal table elements are treated as inline-level content since, being parented by ruby boxes, they will be ultimately wrapped by an inline-level table wrapper box.)
</p>

<p>
ただし，そのように構築された`匿名~box$が`空白$のみを包含する場合、
それは
`~ruby内の空白@
と見なされ、
下に述べるように，破棄されるか保全される。
◎
However, if an anonymous box so constructed contains only white space, it is considered intra-ruby white space and is either discarded or preserved as described below.
</p>
	</li>

	<li>
<p id="anon-gen-trim-space">
<strong>頭部／尾部にある空白を削る</strong>：
</p>

<p>
`~ruby内の空白$のうち， ~AND↓ を満たすものは、
`display:none$p にされていたかのように除去する：
</p>
		<ul>
			<li>
親は［
`~ruby容器$／`~ruby注釈~容器$／`~ruby基底~容器$
］である
</li>
			<li>
親の`~flow内$にある子のうち，［
最初か最後
］のそれである
</li>
			<li>
親には、
他にも`~flow内$にある子がある
</li>
		</ul>
◎
Trim leading/trailing white space:＼
Any intra-ruby white space that is not the sole in-flow child of its parent and is the first or last in-flow child of a ruby container, ruby annotation container, or ruby base container is removed, as if it had display: none
</li>
	<li>
<p>
他の`~ruby内の空白$は、
その直前, 直後の`~flow内$にある同胞~box（`内部~ruby~box$【！`~ruby基底$／`~ruby注釈$／`~ruby基底~容器$／`~ruby注釈~容器$】）に応じて，次の表に挙げる下位型に分類される：
</p>

<table>
<colgroup span="2"></colgroup>
<colgroup span="2"></colgroup>

<thead><tr><th>直前の~box
<th>直後の~box
<th>~box型
<th>下位型
</thead><tbody>

<tr><td>任意
<td>`~ruby注釈~容器$
<td>なし
<td>`~level間の空白@

<tr><td>`~ruby注釈$でない
<td>`~ruby注釈$
<td>なし
<td>同上

<tr><td>`~ruby注釈$
<td>`~ruby注釈$
<td>`~ruby注釈$
<td>`注釈~間の空白@

<tr><td>`~ruby基底$
<td>`~ruby基底$
<td>`~ruby基底$
<td>`基底~間の空白@

<tr><td colspan="2">上に挙げたもの以外の任意の組み合わせ
<td>`~ruby基底$
<td>`区分~間の空白@

</tbody></table>

<p>
これらのうち，`~level間の空白$以外のものは、
`~level内の空白@
と総称される。
</p>

◎
↓</li>

	<li>
<p id="anon-gen-discard-space">
<strong>`~level間の空白$を除去する</strong>：
◎
Remove inter-level white space:＼
</p>
<p>
`~level間の空白$は、
`display:none$p にされていたかのように除去する。
◎
Any intra-ruby white space whose immediately adjacent in-flow siblings match one of the patterns below is inter-level white space and is removed, as if it had display: none.
• Previous box｜Next box
• any｜ruby annotation container
• not ruby annotation｜ruby annotation
</li>
	<li id="anon-gen-interpret-space">
<p>
<strong>`~level内の空白$を解釈する</strong>：
◎
Interpret intra-level white space:＼
</p>
<p>
`~level内の空白$には、
上の表に示した対応する~box型をアテガう
— これらは、
`~pair法$と~layoutにおいては，後述するように特別に扱われる。
◎
Any intra-ruby white space box whose immediately adjacent in-flow siblings match one of the patterns below is assigned the box type and subtype defined in the table below:
• Previous box｜Next box｜Box type｜Subtype
• ruby base｜ruby base｜ruby base｜inter-base white space
• ruby annotation｜ruby annotation｜ruby annotation｜inter-annotation white space
• ruby annotation or ruby annotation container｜ruby base or ruby base container｜ruby base｜inter-segment white space
• ruby base or ruby base container｜ruby base container
• ruby base container｜ruby base or ruby base container
◎
The intra-level white space boxes defined above are treated specially for pairing and layout. See below.
</li>

	<li id="anon-gen-unbreak">
<p>
<strong>行l分断を抑止する</strong>：
◎
Suppress line breaks:＼
</p>
<p>
`~ruby注釈$の内側にあるすべての`強制d行l分断$は、
`縮約-可能$な`区分~分断$として，
`CSS-TEXT-3$r
`§ 区分~分断の変形n規則＠~CSSTEXT#line-break-transform$
による定義に従って変換する（ `white-space$p 値に関わらず）。
◎
Convert all forced line breaks inside ruby annotations (regardless of white-space value) as defined for collapsible segment breaks in CSS Text Level 3 § 4.1.2.
</p>

<p class="issue">
これの目標は、
~ruby注釈の中では，行l分断を抑止して~layout~modelを単純~化することにある。
別法として、
受容-可能な何らかの種類の挙動を定義しようと試行することもできたが。
◎
The goal of this is to simplify the layout model by suppressing any line breaks within ruby annotations. Alternatively we could try to define some kind of acceptable behavior for them.
</p>
	</li>

	<li id="anon-gen-anon-containers">
<p>
<strong>匿名~levelの容器を生成する</strong>：
◎
Generate anonymous level containers:＼
</p>
		<ul>
			<li>
連続する［
`~ruby基底$／`基底~間の空白$
］からなる並びであって，親は`~ruby基底~容器$でないものは、
`匿名$な`~ruby基底~容器$内に包装する。
◎
Any consecutive sequence of ruby bases and inter-base white space (and not inter-segment white space) not parented by a ruby base container is wrapped in an anonymous ruby base container.＼
</li>
			<li>
連続する［
`~ruby注釈$／`注釈~間の空白$
］からなる並びであって，親は`~ruby注釈~容器$でないものは、
`匿名$な`~ruby注釈~容器$内に包装する。
◎
Similarly, any consecutive sequence of ruby annotations and inter-annotation white space not parented by a ruby annotation container is wrapped in an anonymous ruby annotation container.
</li>
		</ul>
	</li>
</ol>

<p>
この節の規則により，~ruby~layout構造~内の親子関係がすべて適正にされたなら、
~UAは，基底とそれらの注釈とを結付けることになる。
◎
Once all ruby layout structures are properly parented, the UA can start to associate bases with their annotations.
</p>

<p class="note">注記：
~UAには、
これらの`匿名~box$
（および， `§ 注釈の~pair法＠#ruby-pairing$による［
`匿名$かつ空な`~level内の空白$ ~box
］）を，~~実際に内部~構造に作成することは要求されない
— `~pair法$と~layoutが，それらが存在するかのように挙動する限り。
◎
Note: The UA is not required to create any of these anonymous boxes (or the anonymous empty intra-level white space boxes in § 2.3 Annotation Pairing) in its internal structures, as long as pairing and layout behaves as if they existed.
</p>


<div class="example">

<p>
次の~markup図式は、
`~ruby内の空白$がどこで保全され, どこで破棄されるかを示す様々な~boxを表現する：
◎
The following markup diagram representing the various boxes shows where intra-ruby white space is preserved or discarded:
</p>

`box-fixup-1^xCode

<p>
ここで、
各記号は，次を表現する
【 “破棄される” と記されたもの以外は保全される】
⇒＃
×：`頭部や尾部にある空白＠#anon-gen-trim-space$（破棄される）／
☒：`~level間の空白＠#anon-gen-discard-space$（破棄される）／
⬕：`基底~間の空白$／
⬔：`注釈~間の空白$／
◼：`区分~間の空白$
◎
where
• × represents discarded leading/trailing white space
• ☒ represents discarded inter-level white space
• ⬕ represents inter-base white space
• ⬔ represents inter-annotation white space
• ◼ represents inter-segment white space
</p>
</div>

		</section>
		<section id="ruby-pairing">
<h3 title="Annotation Pairing">2.3. 注釈の~pair法</h3>

<p>
注釈の
`~pair法@
は、
`~ruby注釈$たちと`~ruby基底$たちとを結付ける処理nである：
◎
Annotation pairing is the process of associating ruby annotations with ruby bases.＼
</p>

<ul>
	<li>
<p>
各 `~ruby注釈$には、
1 個~以上の`~ruby基底$が結付けられる
— このことを［
`~ruby注釈$は，それらの基底に
`~span@
する
］という
（複数個の基底に`~span$する`~ruby注釈$は、
`~spanning注釈@
と呼ばれる†）。
◎
Each ruby annotation is associated with one or more ruby bases, and is said to span those bases. (A ruby annotation that spans multiple bases is called a spanning annotation.)
</p>

<p class="trans-note">【†
この訳では，この用語は利用せず、
複数に限定する必要がある所では，明示的に
“複数個の基底に~spanする”
と記す。
“~spanする”
が単数も複数も含意するのに対し，
“~spanning（~spanしている）”
が単数の否定を含意することは、
（少なくとも~~日本語の感覚としては，）直感的でないので。
】</p>
	</li>
	<li>
ある`~ruby基底$に結付けられる`~ruby注釈$の個数は、
`注釈~level$ごとに 1 個までである。
`注釈~level$が複数個あれば、
同じ~ruby基底に複数個の`~ruby注釈$が結付けられ得る。
◎
A ruby base can be associated with only one ruby annotation per annotation level. However, if there are multiple annotation levels, it can be associated with multiple ruby annotations.
</li>
</ul>

<div class="p">
<p>
`~pair法$が完了したなら、
一連の
`~ruby~col@
が定義される
— 各`~ruby~col$は、
ある`~ruby区分$内の，次に挙げるもので表現される：
</p>
<ul>
	<li>
1 個の`~ruby基底$
</li>
	<li>
各 `行l間$の`注釈~level$に対し
⇒
それに属する 1 個の（場合によっては`匿名$かつ空な）`~ruby注釈$
</li>
</ul>
◎
Once pairing is complete, ruby columns are defined, each represented by a single ruby base and one ruby annotation (possibly an empty, anonymous one) from each interlinear annotation level in its ruby segment.
</div>

<p class="trans-note">【
`文字~間の注釈$は、
自前の~ruby~colを形成する。
それ以外の点では、
`~ruby~col$と`~ruby区分$は，同一視できよう
（これらの用語は、
同じ概念の 2 つの側面
— 順に，~layout上の側面, 構造~上の側面 —
を表す）。
】</p>

			<section id="segment-pairing">
<h4 title="Segment Pairing and Annotation Levels">2.3.1. ~ruby区分の~pair法と注釈~level</h4>

<div class="p">
<p>
~ruby構造は、
いくつかの
`~ruby区分@
に分割0される
— 各`~ruby区分$は、
次のものからなる：
</p>

<ul>
	<li>
先頭に在る`~ruby基底~容器$。
それは、
`~ruby区分$の
`基底~level@
を表現する。
</li>
	<li>
<p>
後続する 1 個以上の`~ruby注釈~容器$
— そのそれぞれは：
</p>
		<ul>
			<li>
ある 1 つの
`注釈~level@
を成す，基底~text用の注釈を表現する
— `N^V 個目のそれは、
`N^V 個目の~levelを成す注釈を表現する。
</li>
			<li>
`基底~level$の`~ruby基底~容器$と~pairにされる。
</li>
		</ul>
	</li>
</ul>
◎
A ruby structure is divided into ruby segments, each consisting of a single ruby base container followed by one or more ruby annotation containers. Each ruby annotation container in a ruby segment represents one level of annotation for the base text: the first one represents the first level of annotation, the second one represents the second level of annotation, and so on. The ruby base container represents the base level. The ruby base container in each segment is thus paired with each of the ruby annotation containers in that segment.
</div>

<p>
退化な事例を取扱うため：
◎
In order to handle degenerate cases, some empty anonymous containers are assumed:
</p>
<ul>
	<li>
`~ruby容器$の最初の子が`~ruby注釈~容器$である場合
⇒
その前に，`匿名$かつ空な`~ruby基底~容器$が存在するものと見做される。
◎
If the first child of a ruby container is a ruby annotation container, an anonymous, empty ruby base container is assumed to exist before it.
</li>
	<li>
`~ruby容器$が 連続する複数個の`~ruby基底~容器$を包含する場合
⇒
それらの各~合間に，`匿名$かつ空な`~ruby注釈~容器$が存在するものと見做される。
◎
Similarly, if the ruby container contains consecutive ruby base containers, anonymous, empty ruby annotation containers are assumed to exist between them.
</li>

</ul>

<p>
`区分~間の空白$は、
実質的に，自前の`~ruby区分$を成す。
◎
Inter-segment white space is effectively a ruby segment of its own.
</p>

			</section>
			<section id="base-annotation-pairing">
<h4 title="Unit Pairing and Spanning Annotations">2.3.2. 単位ごとの~pair法, 複数個の基底に~spanする注釈</h4>

<p>
`~ruby区分$の中では、
`~ruby基底~容器$内の各`~ruby基底$は、
同じ`~ruby区分$内の各`~ruby注釈~容器$に属する 1 個の`~ruby注釈$と，~pairにされる。
◎
Within a ruby segment, each ruby base in the ruby base container is paired with one ruby annotation from each ruby annotation container in its ruby segment.
</p>

<p>
`~ruby注釈~容器$が 1 個の`匿名$な`~ruby注釈$しか包含しない場合、
その`~ruby注釈$は，その`~ruby区分$内のすべての`~ruby基底$と~pairにされる
（すなわち，それらに`~span$する）。
◎
If a ruby annotation container contains only a single, anonymous ruby annotation, then that ruby annotation is paired with (i.e. spans across) all of the ruby bases in its ruby segment.
</p>

<div >
<p>
他の場合、
各`~ruby注釈$と, それが属する`~ruby区分$内の対応する`~ruby基底$とが、
文書~順序で~pairにされる。
~ruby注釈と~ruby基底の個数が一致しない場合：
</p>
<ul>
	<li>
対応する`~ruby注釈$がない`~ruby基底$は、［
`~ruby注釈~容器$の末尾に挿入される，`匿名$かつ空な注釈
］と~pairにされる。
</li>
	<li>
対応する`~ruby基底$がない`~ruby注釈$は、［
`~ruby基底~容器$の末尾に挿入される，`匿名$かつ空な基底
］と~pairにされる。
</li>
</ul>
◎
Otherwise, each ruby annotation is paired, in document order, with the corresponding ruby base in that segment. If there are not enough ruby annotations in a ruby annotation container, the remaining ruby bases are paired with anonymous empty annotations inserted at the end of the ruby annotation container. If there are not enough ruby bases, any remaining ruby annotations pair with empty, anonymous bases inserted at the end of the ruby base container.
</div>

<p>
明示的に，複数個の基底に~spanさせる~ruby~markup
（例：
`RUBY$r `§ 複階的な~ruby~markup＠~TR/ruby/#complex$【！XHTML Complex Ruby Annotations】）
を~supportする実装は、［
そのような各~注釈, それが`~span$している基底たち
］が~pairにされるよう，`~pair法$の規則を適切に調整するモノトスル。
◎
If an implementation supports ruby markup with explicit spanning (e.g. XHTML Complex Ruby Annotations), it must adjust the pairing rules to pair spanning annotations to their bases appropriately.
</p>

<div class="p">
<p>
`~level内の空白$は、
注釈~用の標準な`~pair法$には関与しない
— ただし：
</p>
<ul>
	<li>
`~level内の空白$を挟んで隣接な［
2 個の`~ruby基底$ ／ 2 個の`~ruby注釈$
］が［
2 個の`~ruby注釈$ ／ 2 個の`~ruby基底$
］と~pairにされている下では、
その空白も，後者の 2 個に挟まれた`~level内の空白$
— 無いならば、
`匿名$かつ空な`~level内の空白$~boxが存在するものと見做す —
と~pairにされる。
</li>
	<li>
`~level内の空白$を挟んで隣接な 2 個の`~ruby基底$が，同じ`~ruby注釈$と~pairにされている下では（注釈は それらの基底に`~span$している）、
その空白も，その~ruby注釈と~pairにされる。
</li>
</ul>

◎
Intra-level white space does not participate in standard annotation pairing. However, if the immediately-adjacent ruby bases or ruby annotations are paired
• with two ruby bases or annotations that surround corresponding intra-level white space in another level, then the so-corresponding intra-level white space boxes are also paired.
• with a single spanning ruby annotation, then the intra-level white space is also paired to that ruby annotation
• with two ruby bases or annotations with no intervening intra-level white space, then the intra-level white space box pairs with an anonymous empty intra-level white space box assumed to exist between them.
</div>

<div class="example">

<p>
次の図式に、
定例の［
`~ruby基底~box$と`~ruby注釈~box$
］の~pair法, および`~ruby内の空白$（ [ws] として表現される）の~pair法を示す：
◎
The following diagram shows the pairing of regular base and annotation boxes as well as the pairing of intra-ruby white space (represented as ws ):
</p>

<figure>`ex-pairing^dgm
◎
|[  s p a n n i n g   a n n o t a t i o n ]|
|[ a1 ]|[ws]|[ a2 ]|[  ]|[ a3 ]|[ws]|[ a4 ]|
|[ b1 ]|[ws]|[ b2 ]|[ws]|[ b3 ]|[  ]|[ b4 ]|
</figure>

<p>
青い~boxは`~ruby基底$（`~ruby~col$に一対一に対応する）,
赤い~boxは`~ruby注釈$を表現する。
【！, gray bars (|) represent the limits of ruby columns.】
"[ws]" は`~ruby内の空白$を表現する。
"[ ]" は、
別の~level内の`~ruby内の空白$と~pairにされて自動的に生成される，匿名かつ空な［
基底／注釈
］を表現する。
［
`~ruby容器$／`~ruby基底~容器$／`~ruby注釈~容器$
］は省略している。
◎
Blue brackets ([ ]) represent base boxes,＼
red brackets ([ ]) represent annotation boxes,＼
gray bars (|) represent the limits of ruby columns,＼
[ws] represents intra-ruby white space,＼
and [] represents an empty anonymous base or annotation automatcally generated to pair with intra-ruby white space in another level.＼
Ruby containers, base containers, and annotation containers are omitted.
</p>
</div>

			</section>
		</section>
		<section id="hiding">
<h3 title="Hiding Annotations: visibility: collapse and auto-hidden ruby">2.4. 注釈の隠法： `visibility:collapse^p と自動で隠される~ruby</h3>

<p>
`~ruby注釈$のうち，その `visibility$p が `collapse$v にされたものは、
`隠される注釈@
になる。
他の`~ruby注釈$のうち，その~text内容が対応する`~ruby基底$と正確に同じであるものも、
~UAにより自動的に`隠され$る。
後者は、
`自動で隠され@
ると称される。
◎
A ruby annotation whose visibility is collapse is a hidden annotation. Additionally, if a ruby annotation has the exact same text content as its base, it is automatically hidden (auto-hidden) by the UA.
</p>

<p>
`~ruby注釈$は、
`隠され$ても，注釈の`~pair法$には影響しない。
しかしながら，`隠され$た注釈は、
可視にはならず，［
同~levelの中で隣接な`~ruby注釈~box$の並びを分離する
］以外には，~layoutへの影響iはない
— 当の注釈が別々な`~ruby区分$に所属していて，［
対応する基底は`~ruby基底$ではなく介在な行内であった
］かのように。
◎
Hiding a ruby annotation does not affect annotation pairing. However the hidden annotation is not visible, and it has no impact on layout other than to separate adjacent sequences of ruby annotation boxes within its level, as if they belonged to separate segments and the hidden annotation’s base were not a ruby base but an intervening inline.
</p>

<div class="example">

<p>
`自動で隠す$ことは、
`日文漢字$と`平仮名$が混在する日本語~単語~用の注釈の表示を，正しく行内~化することを許容する。
例えば、
単語
"振仮名"
は、
次のように行内~化されるべきである：
◎
Auto-hiding allows correct inlined display of annotations for Japanese words that are a mix of kanji and hiragana. For example, the word 振り仮名 should be inlined as
</p>

<figure>
振仮名(ふりがな)
</figure>

<p>
したがって、
次のように~mark-upされる：
◎
and therefore marked up as
</p>

`furigana-separate^xCode

<p>
しかしながら，~rubyとして表示されるときは、
“り” は，`隠され$るべきである。
◎
However, when displayed as ruby, the “り” should be hidden
</p>

<figure>
<p class="alt" hidden id="_dgm-furigana-separate">
各 日文漢字 基底~文字の上に，その発音を与える振仮名~用の平仮名による注釈が現れる。
◎
Hiragana annotations for 振り仮名 appear, each pronunciation above its kanji base character.
</p>
<figcaption>
振仮名~用の`平仮名$~ruby。
"り" は`平仮名$内にすでにあるので、
その上には，対する`平仮名$注釈は示されないことに注目。
◎
Hiragana ruby for 振り仮名. Notice there is no hiragana annotation above り, since it is already in hiragana.
</figcaption></figure>

</div>

<div class="example">

<p>
この例に現れる日本語の単語は、
3 個の`日文漢字$からなる。
うち 2 個目は小学一年生で教わり，他の 2 個は上級生で教わる。
（基底~pairの対応関係を示すため、
各~文字は色分けされている。）
◎
The Japanese word in this example is composed of three kanji characters, one of which is taught in first grade, while the other two are more advanced. (Characters colored to show base-pair correspondances.)
</p>

`ruby-pairing^xCode

<figure>
<p class="alt" hidden id="_dgm-ruby-pairing-full">
この "昆虫記" は、
3 文字~すべてに注釈（発音符）を伴う。
2 個目の注釈は，対応する基底より幅広なので、
注釈が隣接な注釈に衝突しないよう，基底~文字の前後に間隔が導入される。
◎
昆虫記, with phonetic annotations on all three characters. Because the middle annotation is wider than its base, space has been introduced around the base character to prevent its annotation from colliding with the adjacent annotations.
</p>
<figcaption>
全部的に注釈された 3 文字からなる単語
◎
Fully annotated three-character word
</figcaption></figure>

<p>
一部の対象読者には，
3 文字~すべてに発音~指導が必要になるかもしれないが、
他の対象読者にとっては，
易しい文字~用の注釈は隠す方が適切になる。
この隠法は、
`visibility:collapse$p を適用すれば可能化される：
◎
Although some readers might need pronunciation guidance on all three characters, for other audiences it is more appropriate to hide the annotation on the easier character. Applying visibility: collapse enables this hiding:
</p>

<figure>
<p class="alt" hidden id="_dgm-ruby-pairing-collapse">
この "昆虫記" は、
2 個目以外の文字の上面に，中央化された注釈（発音符）を伴う。
◎
昆虫記, with phonetic annotations centered over the first and last characters.
</p>
<figcaption>
2 個目の注釈は `visibility:collapse$p
◎
Middle annotation as visibility: collapse
</figcaption></figure>

<p>
`visibility:collapse$p により`隠す$ときの挙動は、
`visibility:hidden^p によるそれと相違する
— 後者は、
注釈を不可視にするが，その~layoutに対する影響iは除去しない：
◎
The hiding behavior of visibility: collapse differs from visibility: hidden—which makes the annotation invisible, but does not remove its impact on layout:
</p>

<figure>
<p class="alt" hidden id="_dgm-ruby-pairing-invisible">
この "昆虫記" は、
2 個目以外の文字に注釈（発音符）を伴う。
2 個目の文字の上面には注釈は示されていないが、
それを保持する間隔は予約され，両隣の基底~文字を外へ押し出す。
◎
昆虫記, with phonetic annotations on the first and last characters. Over the second one, even though no annotation is showing, space is reserved as if to hold it, which pushes the base characters apart.
</p>
<figcaption>
2 個目の注釈は `visibility:hidden$p
◎
Middle annotation as visibility: hidden
</figcaption></figure>

<p>
`visibility:collapse$p はまた、
`display:none$p からも相違する。
前者は，~pair法の関係性も保全する一方で、
後者は，~boxを~treeからまるごと除去して，後続の注釈の~pair法を乱すので：
◎
It also differs from display: none because visibility: collapse preserves pairing relationships, whereas display: none removes the box from the tree entirely, disturbing the pairing of any annotations after it:
</p>

<figure>
<p class="alt" hidden id="_dgm-ruby-pairing-discard">
この "昆虫記" は、
誤って~pairにされた注釈（発音符）を伴う。
2 個目の文字~用の注釈が除去される結果、
3 個目の文字~用の注釈が 2 個目の基底の上面に表示される。
◎
昆虫記, with mispaired phonetic annotations: the annotation for the second character having been removed, the annotation for the third character is displayed over the second one.
</p>
<figcaption>
2 個目の注釈は `display:none$p
◎
Middle annotation as display: none
</figcaption></figure>
</div>

<p>
`~ruby注釈~容器$の `ruby-merge$p の`算出d値$が `merge$v の場合、
注釈を`隠す$ふるまいは不能化される。
算出d値が `auto$v の場合、
~UAは，それを不能化するかどうか裁定してもヨイが、
~UAの~layout~algoが `separate$v による結果と類似な結果を生産する場合には，可能化することが推奨される。
◎
When the computed value of ruby-merge on the annotation container is merge, hiding is disabled. When that value is auto, the user agent may decide whether to disable hiding of its annotations, but it is recommended to enable hiding if the user agent’s layout algorithm produces the results similar to separate.
</p>

<p>
`自動で隠す$ための内容~比較は、［
（ `white-space$p による）空白の縮約-法 ／
（ `text-transform$p による）~text変形n
］に先立って行われ，要素は無視される（~boxの `textContent^c のみを考慮する）。
◎
The content comparison for auto-hiding takes place prior to white space collapsing (white-space) and text transformation (text-transform) and ignores elements (considers only the textContent of the boxes).
</p>

<p class="note">注記：
~CSS~Rubyの将来の~levelでは，`自動で隠す$ための制御も追加され得るが、
この~levelでは常に強制される。
◎
Note: Future levels of CSS Ruby may add controls for auto-hiding, but in this level it is always forced.
</p>

		</section>
		<section id="white-space">
<h3 title="White Space Collapsing">2.5. 空白の縮約-法</h3>

<p>
`§ 匿名~ruby~boxの生成＠#box-fixup$
にて論じたとおり、
~ruby構造の中の空白のうち次のいずれかに該当するものは，
`破棄される＠#anon-gen-discard-space$：
◎
As discussed in § 2.2 Anonymous Ruby Box Generation, white space within a ruby structure is discarded:
</p>
<ul>
	<li>
［
`~ruby容器$／`~ruby注釈~容器$／`~ruby基底~容器$
］の先頭や末尾にあるもの。
◎
at the beginning and end of a ruby container, annotation container, or base container,
</li>
	<li>
`~ruby基底~容器$と, それに後続する`~ruby注釈~容器$との合間にあるもの。
◎
between a base container and its following annotation container, 
</li>
	<li>
`~ruby注釈~容器$たちの各~合間にあるもの。
◎
between annotation containers.
</li>
</ul>

<div class="example">
<p>
例えば，次の~markupは、
間隔を伴わずに表示されることになる：
◎
For example, the following markup will display without any spaces:
</p>

`tokyo^xCode

</div>

<p>
しかしながら，［
`~ruby区分$どうしの合間 ／
`~ruby基底$どうしの合間 ／
`~ruby注釈$どうしの合間
］にある空白は、
破棄されず，［
`区分~間の空白$ ／
`基底~間の空白$ ／
`注釈~間の空白$
］として描画するために保守される
（上述した
`~level内の空白を解釈する＠#anon-gen-interpret-space$
を見よ）。
◎
Between ruby segments, between ruby bases, and between ruby annotations, however, white space is not discarded, and is maintained for rendering as inter-base, inter-annotation, or inter-segment white space. (See Interpret intra-level white space, above.)
</p>

<div class="example">

<p>
空白を保全する規則により、
~Latinなどの~space等で分離される用字系にも，~rubyを利用できるようになる。
例えば：
◎
The rules preserving white space allow ruby to be used with space-separated scripts such as Latin. For example,
</p>

`WWW^xCode

<p>
それはまた、
注釈付き空白も保全されることを確保する。
例えば：
◎
They also ensure that annotated white space is preserved. For example,
</p>

`Gainsborough^xCode

</div>

<p>
破棄されない空白が`縮約-可能$になる所では、
標準な
`CSS-TEXT-3$r `§ 空白~処理~規則$
に従って，各~行l~box内の隣接な~boxたちに わたって縮約されることになる。
［
別々な`~ruby区分$に属する注釈どうし／
`隠される注釈$で分離された注釈どうし
］は、
隣接な注釈とは見なされない。
しかしながら，`基底~level$の内容
— `不可分な行内$として扱われる`文字~間の注釈$も含む —
においては、
そのような~~例外はない。
したがって，［
`~ruby区分$たちの合間にある`縮約-可能$な空白（`区分~間の空白$）用に，
`区分~分断の変形n＠~CSSTEXT#line-break-transform$
を決定する
］ための文脈を成す前後の~textは、
両~側にある`~ruby基底$により与えられる
— それらは、
文書~順序において，~source内で当の空白の両~側にある~textになるとは限らない
（そのような~textは、
`行l間の注釈$を含み得るので）。
◎
Where undiscarded white space is collapsible, it will collapse across adjacent boxes in each line box following the standard white space processing rules [CSS-TEXT-3]. Annotations in separate ruby segments or separated by hidden annotations are not considered adjacent; however all base-level content (including inter-character annotations, which are treated as atomic inlines) is. For collapsible white space between ruby segments (inter-segment white space), the contextual text for determining segment break transformations is thus given by the ruby bases on either side, not necessarily the text on either side of the white space in source document order (which could include interlinear annotations).
</p>

<div class="note">

<p>注記：
`CSS-TEXT-3$r `§ 空白~処理~規則$では、
`区分~分断$（ `line feed^en など）を包含している空白~並びは，［
`漢字$, および`仮名$
］文字たちの合間では，`無に縮約される＠~CSSTEXT#line-break-transform$。
これは、［
中国語／日本語
］~rubyでは、
~ruby~markupの字下げに，空白を安全に利用できることを意味する。
例えば，次の~markupは、
間隔を伴わずに表示されることになる：
◎
Note: The white space processing rules cause a white space sequence containing a segment break (such as a line feed) to collapse to nothing between Han and Kana characters. This means that Chinese and Japanese ruby can safely use white space for indentation of ruby markup. For example, the following markup will display without any spaces:
</p>

`nosmoke-1^xCode

<p>
しかしながら、
`区分~分断$を包含しない空白は，完全には縮約されないので、
次の~markupは，
1 個目と 2 個目の~ruby~pairの合間に間隔を伴って表示されることになる：
◎
However, white space that does not contain a segment break does not collapse completely away, so this markup will display with a space between the first and second ruby pairs:
</p>

`nosmoke-2^xCode

</div>

		</section>
	</section>
	<section id="ruby-layout">
<h2 title="Ruby Layout">3. ~ruby~layout</h2>

<p>
~ruby構造が~lay-outされるときは、
まず，【各`~ruby区分$に対し】その`基底~level$が
— 正確に［
それを成す`~ruby基底$たちは，定例の`行内~box$たちが成す並びで、
前者が属する`~ruby容器$は，後者を包装している定例の`行内~box$であった
］かのように —
同じ行lに~lay-outされる。
◎
When a ruby structure is laid out, its base level is initially laid out on the line exactly as if its ruby bases were a regular sequence of inline boxes and the ruby container a regular inline box wrapped around it.
</p>

<p>
`~ruby容器$に`文字~間の注釈$がある場合、
それらは`基底~level$の中に~lay-outされる
— その詳細は、
`§ 文字~間~rubyの~layout＠#inter-character-layout$に従う。
後続して、
`~ruby基底~容器$が~sizeされ，`行l間の注釈$が~lay-outされる
— 後者の詳細は、
`§ 文字~間~rubyの~layout＠#inter-character-layout$に従う。
◎
If a ruby container has any inter-character annotations, they are laid out into the base level as detailed in § 3.2 Inter-character Ruby Layout. Subsequently, the base container is sized and interlinear annotations are laid out as detailed in § 3.1 Interlinear Ruby Layout.
</p>

<p>
他の~CSS~layout~modelと同じく、
~boxに対する［
`相対~位置決め$, 変形, その他の~graphicな効果
］は，この~layoutより後に適用される。
◎
As in other CSS layout models, relative positioning, transforms, and other graphical effects apply after this layout of the boxes.
</p>

		<section id="interlinear-layout">
<h3 title="Interlinear Ruby Layout">3.1. 行l間の~ruby~layout</h3>

<p>
同じ`注釈~level$に属する`行l間$の`~ruby注釈$は、
まず，［
それらが，同じ`行内~整形~文脈$に関与している`行内~box$であった
］かのように~lay-outされ、
実質的に，当の`~ruby容器$内で それらの注釈~用の`行l~box$を確立する。
`~ruby注釈$と`~ruby基底$どうしは、
以下に述べるとおりに間隔法を調整することにより，互いに整列される。
◎
Interlinear ruby annotations within a level are initially laid out as if they were inline boxes participating in the same inline formatting context, effectively establishing a line box for that level of annotation in the ruby container. Annotations and bases are aligned to each other by adjusting their spacing as described below.
</p>

			<section id="interlinear-inline">
<h4 title="Inline-axis Interlinear Layout">3.1.1. 行内-軸における行l間の注釈の~layout</h4>

<p>
行内-軸においては、
`行l間$の`~ruby注釈$は、
それが属する`~ruby注釈~容器$の `ruby-merge$p 値に則って，対応する`~ruby基底$を基準に整列される。
◎
In the inline axis, interlinear ruby annotations are aligned with respect to their ruby base boxes in accordance with their annotation container’s ruby-merge value.
</p>

<p>
`ruby-merge$p が `separate$v のときは、
各`~ruby~col$は、
それに属する最も幅広な内容（`~ruby基底$／`~ruby注釈$）に~sizeされる。
`~ruby注釈$が複数個の`~ruby基底$に`~span$している事例では
（ `ruby-merge$p に対する `merge$v により，そのように~spanするよう装っているものも含む）、
当の注釈の内容が，それが~spanする`~ruby~col$たちより幅広な場合、
その差は，それらの`~ruby~col$に等しくに分布する。
そのような注釈が同じ`~ruby区分$内に複数個ある場合、
この追加的な間隔の分布は，~spanしている基底の個数が最も少ないものから~~昇順に遂行される。
次に，各［
`~ruby基底$／`~ruby注釈$
］は、
それが属する`~ruby~col$（たち）に正確に~spanするよう~sizeされる。
◎
When ruby-merge is separate, each ruby column is sized to the widest content (ruby base or ruby annotation) in that column. In the case of spanning annotations (whether actually spanning or pretending to span per ruby-merge: merge), if the content of a spanning annotation would be wider than the columns that it spans, then the difference is distributed equally among the spanned columns. If a ruby segment contains multiple spanning annotations, this distribution of additional space is performed starting with the spanning annotations that span the least number of bases, and then in increasing number of bases spanned. Each ruby base and ruby annotation is then sized to exactly span its column(s).
</p>

<p class="note">注記：
異なる`~level$に属する複数個の注釈が，同じ個数の
— 互いに重合しているが一致していない —
基底たちに~spanしている場合、
間隔をどう分布するかは，未定義である。
これは，~HTML~markupでは起こり得ないが、
`RUBY$r などの明示的な~span法を伴う~markup言語では，起こり得ることに注意。
◎
Note: If there are multiple annotations in different levels spanning the same number of bases that overlap but do not coincide, the distribution of space is undefined. Note this is not possible with HTML markup, but can happen in markup languages with explicit spanning such as in [RUBY].
</p>

<p>
`~ruby注釈~容器$ %容器 の `ruby-merge$p が `auto$v にされている下で，
%容器 内のある`~ruby注釈$が対応する`~ruby基底$より幅広な場合、
%容器 内の`~ruby注釈$たちは，それらの`~ruby~col$（たち）の外側へ拡張し得る。
そうなるとき、
それらが交差する`~ruby~col$の測定法にどう波及するかは、［
%容器 が属する`~ruby区分$は，その内容すべてが収まるに十分な幅広さになる
］ようにする限り，~UAに委ねられる。
◎
If any ruby annotation in an annotation container with ruby-merge: auto is wider than its base, then ruby annotations in that annotation container may extend outside of their column(s). When they do, their influence on the measure of the columns they intersect is up to the user agent, provided that the ruby segment is made wide enough to fit all its content.
</p>


<p>
`文字~間の注釈$は、
`~ruby~col$たちの合間に差挟まれる
— それらは、
両側に隣接な`~ruby~col$には含まれないが，その両方に~spanする注釈の測定には織り込まれることに加え、
`行l間の注釈$の［
~sizing／位置決め
］により影響されることは決してない。
◎
Inter-character annotations are interleaved between columns: they factor into measurement of annotations that span both adjacent columns, but are not included in either column and are never affected by the sizing or positioning of interlinear annotations.
</p>

<p>
［
各［
`~ruby基底$／`~ruby注釈$
］~boxの中で，~boxの内容が~boxに対する測定結果より狭小になる
］とき，余分な間隔が どう分布するかは、
~boxの `ruby-align$p ~propが指定する。
◎
Within each base and annotation box, how the extra space is distributed when its content is narrower than the measure of the box is specified by its ruby-align property.
</p>


<div class="example">

<p>
これらの規則を，次に挙げる図式に図解する
— それらは、
代表的な状況, および少数の より複階的なものを受持つ。
各~事例では、［
`~ruby基底$／`~ruby注釈$
］の `ruby-align$p は `center$v と見做される一方で，
`~ruby注釈~容器$の `ruby-align$p は `space-between$v と見做される。
◎
The following diagrams illustrate these rules, covering typical situations as well as a few more complex ones. In each case, base boxes and annotation boxes are assumed to have ruby-align: center, while annotation containers are assumed to have ruby-align: space-between.
</p>

<p class="trans-note">【
原文の図式は ASCII art で呈示されているが、
ここでは，~table~markupで呈示する。
】</p>

<p>
青い~box（ “B…” ）は`~ruby基底$（`~ruby~col$に一対一に対応する）,
赤い~box（ “A…” ）は`~ruby注釈$を表現する。
【！, and gray bars (|) represent the limits of ruby columns.】
［
`~ruby容器$／`~ruby基底~容器$／`~ruby注釈~容器$
］は省略している。
◎
Blue brackets ([ ]) represent base boxes, red brackets ([ ]) represent annotation boxes, and gray bars (|) represent the limits of ruby columns. Ruby containers, base containers, and annotation containers are omitted.
</p>

<dl>
	<dt id="ex-separate">
どの注釈も 1 個の基底に~spanする場合（ “~mono~ruby” ／ `separate$v ）：
◎
Separate / non-spanning:
</dt>
	<dd>
<figure>`ex-separate^dgm
◎
|[  a1  ]|[  a2  ]|[annotation-3]|
|[base 1]|[base 2]|[   base 3   ]|
</figure>


<p>
各`~ruby~col$の中の【各~levelに属する】~boxは、
それらのうち，最も幅広なものに合致するよう~sizeされる。
各［
`~ruby基底$／`~ruby注釈$
］の `ruby-align$p の値が，各~box内の余分な間隔を分布するために利用される。
◎
Boxes within each column are sized to match the widest box of that column. The value of ruby-align on each base box and annotation box is used to distribute the extra space in each box.
</p>
	</dd>

	<dt id="ex-short-span">
複数個の基底に`~span$している短い注釈：
◎
Spanning (short):
</dt>
	<dd>
<figure>`ex-short-span^dgm
◎
|[  a1  ]|[   short span  ]|
|[base 1]|[base 2]|[base 3]|
</figure>

<p>
`~ruby注釈$ %注釈 が，複数個の`~ruby基底$に`~span$していて，それらの基底より短いときは、
各~基底に分布する余分な間隔は無い。
%注釈 の中の余分な間隔は、
1 個の基底に~spanするときと同じく，
%注釈 の`ruby-align$p に則って分布される。
◎
When a spanning annotation is shorter than the spanned bases, there is no extra space to distribute to these bases. Extra space within the spanning annotation is distributed according to ruby-align on that annotation box, as for non spanning ones.
</p>
	</dd>

	<dt id="ex-long-span">
複数個の基底に`~span$している長い注釈：
◎
Spanning (long):
</dt>
	<dd>
<figure>`ex-long-span^dgm
◎
|[  a1  ]|[spanning annotation]|
|[base 1]|[ base 2 ]|[ base 3 ]|
</figure>

<p>
`~ruby注釈$が，複数個の`~ruby基底$に`~span$していて，それらの基底より長いときは、
余分な間隔は，各~基底に等しく分布される。
◎
When the spanning annotation is longer than the spanned base boxes, the extra space is distributed equally between them.
</p>
	</dd>

	<dt id="ex-short-merge">
併合された短い注釈（ `merge$v ）：
◎
Merged (short):
</dt>
	<dd>
<figure>`ex-short-merge^dgm
◎
|[merged        annotation]|
|[base 1]|[base 2]|[base 3]|
</figure>

<p>
`併合される注釈$は、
複数個の`~ruby基底$に`~span$するものと類似に挙動する
— ただし，余分な間隔の分布は、
`~ruby注釈$ではなく，`~ruby注釈~容器$の `ruby-align$p の値により決定される。
◎
A merged annotation behaves similarly to a spanning one, except that distribution of any extra space in it is determined by the value of ruby-align on the annotation container, not on any of its annotation boxes.
</p>
	</dd>

	<dt id="ex-multi-level-span">
注釈~levelが複数個ある中で，複数個の基底に~spanする注釈がある：
◎
Several levels, with spanning annotation:
</dt>
	<dd>
<figure>`ex-multi-level-span-1^dgm
◎
|[   a1   ]|[ annotation-2 ]|[   a3   ]|
|[long annotation spanning all content]|
|[ base 1 ]|[    base 2    ]|[ base 3 ]|
</figure>

<figure>`ex-multi-level-span-2^dgm
◎
|[  xx  ]|[annotation spanning bases]|
|[  a1  ]|[ annotation-2 ]|[   a3   ]|
|[base 1]|[    base 2    ]|[ base 3 ]|
</figure>

<p>
これら 2 つの例は、
どちらも複数個の`注釈~level$を伴う。
各`~ruby~col$は，それに属する最も長い内容に~sizeされ、
複数個の`~ruby基底$に`~span$する`~ruby注釈$のうち，それが~spanする`~ruby~col$の総和より長いものは、
各~colを更に~~拡げるように等しく間隔を追加する
（図では、
灰色な矩形で示される）。
◎
In these two examples with multiple levels, each column is sized to its longest content, and spanning annotations that are still longer than the sum of the columns that they span grow them further, adding to each equally.
</p>
	</dd>

	<dt id="ex-multi-level-mutli-span">
注釈~levelが複数個ある中で，複数個の基底に~spanする注釈が複数個ある：
◎
Several levels, with multiple spanning annotations:
</dt>
	<dd>
<figure>`ex-multi-level-mutli-span^dgm
◎
|[   xx   ]|[  annotation spanning bases  ]|
|[   a1   ]|[  annotation-2  ]|[    a3    ]|
|[lengthy annotation spanning base content]|
|[ base 1 ]|[     base 2     ]|[  base 3  ]|
</figure>

<p>
複数個の`~ruby基底$に`~span$する`~ruby注釈$が複数個ある場合、
それらのうち，~spanしている`~ruby基底$の個数が最も少ないものから処理される。
この事例では、
2 個の基底に~spanするもの（図の緑色~text）が，
3 個の基底に~spanするもの（図の灰色~text）より前に処理される
（それらの注釈により他へ分布される間隔は、
図では，同じ色の矩形で示されている）。
この順序を変更すると間隔の分布も変化することになる。
【前者の注釈は 2 個の基底に~spanするので、後者の注釈により追加される間隔も 2 倍になる。】
◎
When there are multiple spanning annotations, those that span fewest bases are processed first. In this case, the green one, which spans two bases, is processed before the orange one, which spans three. Changing this order would change the distribution of space.
◎
To help identify which spanning annotation is responsible for which extra spacing, in this diagram the color of the text in each spanning annotation is matched with the background color of spacing it adds to other boxes.
</p>
	</dd>
</dl>
</div>

			</section>
			<section id="interlinear-block">
<h4 title="Block-axis Interlinear Layout">3.1.2. 塊-軸における行l間の注釈の~layout</h4>

<p class="issue">
`vertical-align$p が，各種~ruby~boxにどこまで影響するか定義する。
`4987$issue を見よ。
◎
Define the extent to which vertical-align affects these ruby boxes. See Issue 4987.
</p>

<div class="p">
<p>
次に，各`~ruby基底~容器$ %容器 は、
次に該当するもの すべての`~margin~box$を正確に包含するように，~sizeされ位置される：
</p>
<ul>
	<li>
%容器 に属する`~ruby基底$, および
それらに結付けられた`文字~間$の`~ruby注釈$（もしあれば）
</li>
	<li>
%容器 の子孫の`~ruby容器$内の［
`~ruby基底~容器$／`~ruby注釈~容器$
］のうち，この【%容器 と同じ基底~levelの】`行内~整形~文脈$に関与しているもの
</li>
</ul>
<p>
（ %容器 に`~flow内$にある内容が無い場合、
1 個の空な`~ruby基底$を包含していたかのように，~sizeされ位置される。）
</p>

◎
Each base container is then sized and positioned to contain exactly all of its ruby bases’ margin boxes—and all their associated inter-character ruby annotation margin boxes, if any—as well as the base and annotation containers of any descendant ruby containers also participating in this inline formatting context. (If a base container has no in-flow content, it is sized and positioned as if it contained a single empty ruby base.)
</div>

<div class="p">
<p>
各`行l間$の`~ruby注釈~容器$ %容器 は、
次に該当するもの すべての`~margin~box$を正確に包含するように，~sizeされ位置される：
</p>
<ul>
	<li>
%容器 に属する`~ruby注釈$
</li>
	<li>
%容器 の子孫の`~ruby容器$内の［
`~ruby基底~容器$／`~ruby注釈~容器$
］のうち，
%容器 と同じ`注釈~level$の`行内~整形~文脈$に関与しているもの
</li>
</ul>
<p>
（ %容器 に`~flow内$にある内容が無い場合、
1 個の空な`~ruby注釈$を包含していたかのように，~sizeされ位置される。）
</p>
◎
Each interlinear annotation container is sized and positioned to contain exactly all of its ruby annotations’ margin boxes as well as the base and annotation containers of any descendant ruby containers also participating in this annotation level’s inline formatting context. (If an annotation container has no in-flow content, it is sized and positioned as if it contained a single empty ruby annotation.)＼
</div>

<p>
これらの各`~ruby注釈~容器$は、
（その `ruby-position$p に応じて，）対応する`~ruby基底~容器$の［
上面／下面
］から外方へ，介在な間隔を伴わずに堆積される
— したがって，`~ruby注釈$の`塊-軸$における位置は、
対応する`~ruby基底$を基準に決定される。
◎
These annotation containers are then stacked outward over or under (depending on ruby-position) their corresponding base container, without any intervening space, thus determining the block-axis positioning of the ruby annotations with respect to their ruby bases.
</p>

<p class="issue">
塊-軸~marginは相殺するべきか？
これは，~layoutをより堅牢にするが、
行内~boxたち【！行内】の`行内-軸$沿いにおける挙動と一貫しなくなる。
◎
Should block-axis margins collapse? This makes layout more robust, but is inconsistent with how inlines behave along the inline-axis.
</p>

			</section>
		</section>
		<section id="inter-character-layout">
<h3 title="Inter-character Ruby Layout">3.2. 文字~間~rubyの~layout</h3>

<p>
`文字~間の注釈$の~layoutは、
特別になる。
`文字~間$の`~ruby注釈~box$は、
`基底~level$の~layoutの一部として継合され, 測定される。
そのような注釈~boxは、［
それが`~span$している`~ruby基底$のうち最も右端にあるもの
］の直後に配置され、
以下に述べることを除けば，`行内~塊$と正確に同じに~lay-outされる。
◎
Inter-character annotations have special layout. Inter-character ruby annotation boxes are spliced into and measured as part of the layout of the base level. Each ruby annotation is inserted to the right of the ruby base it is paired with; a spanning inter-character annotation is placed after the rightmost of all the bases that it spans. Inter-character ruby annotations are laid out exactly like inline blocks, except as described below.
</p>

<p class="note">注記：
`inter-character$v の定義により，`文字~間の注釈$は、
その `writing-mode$p は常に `vertical-rl$v になり，それが属する`~ruby容器$が`横書き$の場合にしか存在し得ない。
◎
Note: As per the definition of inter-character, inter-character annotations always have a vertical-rl writing-mode, and only exist in horizontal ruby containers.
</p>

<p>
`文字~間$の`~ruby注釈~容器$【！`~ruby注釈$】 %容器 は、
対応する`~ruby基底$の右端に, `基底~間の空白$（または`区分~間の空白$）の直前に配置される。
%容器 内に`文字~間$の`~ruby注釈~box$が複数個ある【`注釈~level$が複数個ある】場合、
それらの`~margin~box$は
— 介在な間隔を伴わずに，`注釈~level$の~~昇順で —
右方へ堆積される†。
◎
Each ruby annotation is placed immediately to the right of the relevant ruby base, before any inter-base white space (or inter-segment white space). If multiple inter-character ruby annotation boxes are placed against the same ruby base, their margin boxes are stacked rightwards without intervening space, in increasing level order.
</p>

<p class="trans-note">【†
右横書きの下では、
`~ruby基底$の左端から，左方へ堆積されよう
（そのような利用事例は無いであろうが、
理論的には）。
】</p>

<p>
`文字~間$の`~ruby注釈~box$ %注釈 の`内容~区画$の縦幅が`自動的~size$にされていて
— %注釈 を配置した後において —
対応する`~ruby基底$の`内容~box$の縦幅より短くなる場合、
%注釈 の`内容~box$の縦幅は、
その縦幅に正確に合致するよう増やされる。
◎
If the automatic height of the ruby annotation box’s content area would be shorter than the height of the content box of the ruby base after which it is placed, its content box height is increased to match that height exactly.
</p>

<p>
`文字~間$の`~ruby注釈~box$ %注釈 の整列は、
その `ruby-align$p ~propに依存する
— ［
%注釈, 対応する`~ruby基底$
］の`内容~box$は
⇒＃
`ruby-align$p は `start$v ならば，上端~辺どうしが整列される／
~ELSE_ 縦方向において中央どうしが整列される
◎
The alignment of the ruby annotation box depends on the ruby-align property on the ruby annotation:
• If ruby-align is start, the top edge of the ruby annotation's content box is aligned with the top edge of the ruby base's content box.
• Otherwise, the center of the ruby annotation's content box is vertically aligned with the center of the ruby base's content box.
</p>

<p>
`文字~間$の`~ruby注釈~容器~box$は、
その`内容~box$が対応する`~ruby基底~容器$の`内容~box$と正確に一致するよう，~sizeされ, 配置される。
◎
The ruby annotation container box of an inter-character annotation is sized and placed so that its content box coincides exactly with that of the ruby base container box.
</p>


<p class="note">注記：
`文字~間$の`~ruby注釈~容器~box$の~sizeと位置には、
~layoutに対する効果は無い。
上の定義は、
単に，それらを~program的に問い合わせることで決定的な結果を生産するためにある【？】。
◎
Note: The size and position of inter-character ruby annotation container boxes has no effect on layout. The above definition is merely so that programmatically inquiring about them produces deterministic results.
</p>

<p>
［
`ruby-align$p による整列,
`~ruby~col$の~sizing
］の目的においては、
`文字~間$の`~ruby注釈$は，
（`§ ~ruby~layout＠#ruby-layout$にて論じたように）［
対応する基底と同じ`~ruby~col$の一部を成す
］とは見なされない
— それは、
実質的に自前の`~ruby~col$を形成する。
◎
For the purpose of alignment and column sizing (as discussed in § 3 Ruby Layout), inter-character ruby annotations are not considered to be part of the same column as the base to with they are attached; rather, they effectively form a column of their own.
</p>

		</section>
		<section id="box-style">
<h3 title="Styling Ruby Boxes">3.3. ~ruby~boxの~style法</h3>

<div class="p">
<p>
`行内~box$に適用されるすべての~propは、
他が指定されない限り，［
`~ruby基底~box$／`~ruby容器$【！treated as inline boxes】／`~ruby注釈$
］にも同じ仕方で適用される。
ただし：
</p>
<ul>
	<li>
`vertical-align$p に対する`行lに相対的なズラシ値$（ `top^v, `bottom^v †）は、
無視する（ 0 として扱う）モノトスル。
【† `center^v も該当するが、明示的に挙げられていない。】
</li>
	<li>
`line-height$p は、
`~ruby注釈$には適用されない。
</li>
</ul>
◎
Ruby bases and ruby containers are treated as inline boxes, and all properties that apply to inline boxes, unless otherwise specified, also apply to them in the same way. However, the line-relative shift values of vertical-align (top, bottom) must be ignored (treated as zero).
◎
All properties that apply to inline boxes, unless otherwise specified, also apply to ruby annotations in the same way, except line-height, which does not apply. Also, the line-relative shift values of vertical-align (top, bottom) must be ignored (treated as zero).
</div>

<p>
次に挙げる~propは、［
`~ruby基底~容器$／`~ruby注釈~容器$
］には適用されない
⇒＃
~margin~prop【 `margin$p, その下位prop】,
~padding~prop【 `padding$p, その下位prop】,
~border~prop【 `border$p, その下位prop】,
`行内~box$には適用されない~prop
◎
Neither the margin, padding, border properties nor the any properties that do not apply to inline boxes apply to base containers or annotation containers.＼
</p>

<p>
`line-height$p ~propは、
`~ruby注釈~容器$には適用されない。
◎
Additionally, line-height does not apply to annotation containers.
</p>

<p>
［
`~ruby基底~容器~box$ ／ `~ruby注釈~容器~box$
］に対しては：
◎
↓</p>
<ul>
	<li>
次に挙げる~propの~supportは、
~UAには要求されない
⇒＃
背景~prop【 `background$p, その下位prop】 ／
外形線~prop【 `outline$p, その下位prop】／
当の~boxの限界域を~~露わにするような他の~prop
◎
The UA is not required to support any of the background properties or outline properties, or any other property that illustrates the bounds of the box on ruby base container boxes or ruby annotation container boxes.＼
</li>
	<li>
~UAは、
これらの~boxを，単純に［
その内容の~layoutに対する［
継承, 制御
］用の抽象-化
］として実装してもヨイ。
◎
The UA may implement these boxes simply as abstractions for inheritance and control over the layout of their contents.
</li>
</ul>

		</section>
		<section id="line-breaks">
<h3 title="Breaking Across Lines">3.4. 複数~行lへの分断-法</h3>

<p>
`~ruby容器$全体が 1 行lに収まり切らない, かつ
すべての~levelが同時に分断を許容している場合、
~rubyは，分断されてもヨイ
（行l分断法の詳細は、
`CSS-TEXT-3$r `§ 行l分断法と単語~境界＠~CSSTEXT#line-breaking$
を見よ）。
~rubyは，［
基底, 注釈
］が成す集合どうしの合間にて分断することが最も多いが、
`~ruby基底$（および, それに結付けられ, それに並行する各`~ruby注釈~box$たち）の中でも，分断できる
— `行-分断ng規則$がそれを許容するならば。
◎
When there is not enough space for an entire ruby container to fit on the line, the ruby may be broken wherever all levels simultaneously allow a break. (See CSS Text 3 §5 Line Breaking and Word Boundaries for details on line breaking.) Ruby most often breaks between base-annotation sets, but if the line-breaking rules allow it, can also break within a ruby base (and, in parallel, its associated ruby annotation boxes).
</p>

<p>
~rubyを複数~行lに分断するときは、
各`~ruby注釈$と対応する`~ruby基底$たちは
— `文字~間の注釈$の事例においても —
一緒であり続けるモノトスル。
注釈と基底たちの合間では，行lを`分断しない^emモノトスル。
◎
Whenever ruby breaks across lines, ruby annotations must stay with their respective ruby bases. The line must not break between a ruby base and its annotations, even in the case of inter-character annotations.
</p>

<figure>
<x-diagram
	aria-describedby="_dgm-r-break-b"
	style="padding: 2em 0;"
>
<x-bk id="_ex-r-break-b">
	<x-bk style="color:blue; width:3em; text-align:center;">~ruby<br>基底</x-bk>
	<x-bk style="color:red; width:1.5em; position:relative;">
		<x-bk style="position:absolute; top:-2em; left:0; white-space:nowrap;">~ruby~text（基底の右）</x-bk>
		<x-bk style="position:absolute; top:-1em; left:0;">↓</x-bk>
	</x-bk>
	<x-bk style="width:0; border:none; color:gray;">
		<x-bk style="position:absolute; top:0; width:0; height:4em; border:dashed currentcolor 0.1em;"></x-bk>
		<x-bk style="position:absolute; width:16em; left:-8em; bottom:-2.5em; text-align:center;">行l分断ng機会</x-bk>
	</x-bk>
	<x-bk style="color:blue; width:3em; text-align:center;">~ruby<br>基底</x-bk>
	<x-bk style="color:red; width:1.5em; position:relative;">
		<x-bk style="position:absolute; top:-1em; left:0;">↓</x-bk>
	</x-bk>
</x-bk>
</x-diagram>
<p class="alt" hidden id="_dgm-r-break-b">
注音符号~rubyにおける行l分断ng機会を示す図式
◎
Diagram showing the line breaking opportunity in a "Bopomofo" ruby
</p>
<figcaption>
`inter-character$v ~rubyにおける行l分断ng機会
◎
inter-character ruby line breaking opportunity
</figcaption></figure>

<p>
各~断片は、
行lを分断した後，独立に
⇒＃
まず，`~lay-outされ＠#ruby-layout$、
次に， `ruby-align$p による整列が施される。
◎
After line-breaking, each fragment is laid out independently, and ruby alignment takes place within each fragment.
</p>

			<section id="break-between">
<h4 title="Breaking Between Bases">3.4.1. 基底~間の分断-法</h4>

<p>
代表的な事例では、［
`~ruby基底~box$／`~ruby注釈~box$
］には，内部の行l折返ngを禁止するように~styleがアテガわれ、
強制d分断は包含しない
（`付録 A＠#default-stylesheet$ を見よ）。
そのような事例では、
`~ruby容器$を分断できる所は、
隣接な`~ruby基底$どうしの合間であって，かつ それら複数個の`~ruby基底$に`~span$している`~ruby注釈$も無いときに限られる。
◎
In typical cases, ruby base boxes and ruby annotation boxes are styled to forbid internal line wrapping and do not contain forced breaks. (See Appendix A.) In such cases the ruby container can only break between adjacent ruby bases, and only if no ruby annotations span those ruby bases.
</p>

<figure>
<x-diagram
	aria-describedby="_dgm-r-break-a"
	style="padding: 2em 0;"
>
<x-bk style="color:green;">~group~ruby↓</x-bk>
<x-bk style="border:thin solid green; padding:0.2em; display:inline-block;">
<table id="_ex-r-break-a"><tbody>
<tr><td><span>~ruby~text（上面）</span>
<td rowspan="5" style="padding:0;"><x-bk style="position:relative; top:-0.5em; width:0.2em; color:gray;">&nbsp;
<x-bk style="position:absolute; top:0; height:10em; border:dashed currentcolor 0.1em;"
><x-bk style="position:absolute; left:-8em; bottom:-1em; width:16em; text-align:center;"
>行l分断ng機会</x-bk></x-bk>
</x-bk>

<td><span>~ruby~text</span>
<tr><td><td>
<tr style="color:blue;"><td><span>~ruby基底</span><td><span>~ruby基底</span>
<tr><td><td>
<tr><td><span>~ruby~text（下面）</span><td><span>~ruby~text</span>
</tbody></table>
</x-bk>
</x-diagram>
<p class="alt" hidden id="_dgm-r-break-a">
複階的な~rubyにおける行l分断ng機会を示す図式
◎
Diagram showing the line breaking opportunity in a complex ruby
</p>
<figcaption>
~rubyにおける行l分断ng機会
◎
Ruby line breaking opportunity
</figcaption></figure>

<p>
隣接な 2 つの`~ruby基底$の合間で ~rubyを分断できるかどうかは、
基底~text用の通常の`行-分断ng規則$により
— 正確に［
当の`~ruby基底$たちが隣接な`行内~box$たちであった
］かのように —
制御される。
（注釈たちは、
`基底~level$用の自動折返し機会を決定するときには無視される。）
◎
Whether ruby can break between two adjacent ruby bases is controlled by normal line-breaking rules for the base text, exactly as if the ruby bases were adjacent inline boxes. (The annotations are ignored when determining soft wrap opportunities for the base level.)
</p>

<div class="example">

<p>
例えば、
隣接な~ruby基底が［
"蝴", "蝶"
］であったなら、
行lは，それらの合間で分断されてもヨイ
—  2 個の`漢字$文字の合間では，通常は行lを分断することが許容されるので。
しかしながら， `word-break$p が `keep-all$v である場合、
その行l分断は禁止される。
◎
For example, if two adjacent ruby bases are “蝴” and “蝶”, the line may break between them, because lines are normally allowed to break between two Han characters. However, if word-break is keep-all, that line break is forbidden.
</p>

`kocho^xCode

</div>

<p>
`基底~間の空白$は、［
`~ruby基底$たちの各~合間にある行l分断~機会を評価するとき
］には有意になる
— 行l分断がそこにあるときには、
行内たちの各~合間にある空白と同じく，
`CSS-TEXT-3$r `§ 空白~処理~規則$に従って，縮約される。
同様に、
`注釈~間の空白$も行l分断の所で削られる。
◎
Inter-base white space is significant for evaluating line break opportunities between ruby bases. As with white space between inlines, it collapses when the line breaks there, following the rules detailed in CSS Text 3 §4.1 The White Space Processing Rules. Similarly, annotation white space is also trimmed at a line break.
</p>

<div class="example">
<p>
例えば、
次の~markupが与えられたとき：
◎
For example, given the following markup:
</p>

`onetwo^xCode

<p>
~spaceに因り，行lは［
"one", "two"
］の合間で分断されてもヨイ。

行l分断がそこにある場合、
その~space, および "1", "2" の合間にある~spaceは、
標準な~CSS空白~処理~規則に則って消去る。
◎
Due to the space, the line may break between “one” and “two“. If the line breaks there, that space—and the space between “1” and “2”—disappears, in accordance with standard CSS white space processing rules.
</p>

</div>

			</section>
			<section id="break-within">
<h4 title="Breaking Within Bases">3.4.2. 各~基底の中での分断-法</h4>

<p>
より長い基底~text用には、
( 基底, 注釈 )
~pairの中でも分断ngを許容した方が，適切になることもある。
例えば，英文を日本語~翻訳で注釈する場合、
~textを折返すのを許容した方が，段落における行l分断法は適度に挙動するようになる。
◎
For longer base texts, it is sometimes appropriate to allow breaking within a base-annotation pair. For example, if an English sentence is annotated with its Japanese translation, allowing the text to wrap allows for reasonable line breaking behavior in the paragraph.
</p>

<p class="issue">
~~読者が これを単なる仕様~策定者の世迷言と考えないよう，~~具体的な例を挿入する。
◎
Insert scanned example so people don’t think this is just the ramblings of an insane spec-writer.
</p>

<p>
`~ruby基底$の中で`行-分断ng$が許容されるのは、［
`~ruby基底$, および それに並行する どの`注釈$の `white-space$p ~propも，それを許容する
］, かつ各［
基底~box／注釈~box
］の内容`の中^em（すなわち，始端でも終端でもない）に`自動折返し機会$が存在する場合に限られる。
`~ruby基底$の内容を成す各~断片と`注釈$のそれらとの間には，構造上の対応関係はないので、
~UAは，［
基底の中, 注釈の中
］の機会たちの どの~~組み合わせで分断してもヨイが、
各~断片における［
基底の内容, 注釈の内容
］が成す分量比が互いに近くなるよう試みることが推奨される。
◎
Line-breaking within a ruby base is only allowed if the white-space property of the ruby base and all its parallel annotations allow it, and there exists a soft wrap opportunity within (i.e. not at the start or end) the content of each base/annotation box. Since there is no structural correspondence between fragments of content within ruby bases and annotations, the UA may break at any set of opportunities; but it is recommended that the UA attempt to proportionally balance the amount of content inside each fragment.
</p>

<p>
`文字~間の注釈$の中には、
行l分断ng機会はない。
◎
There are no line breaking opportunities within inter-character annotations.
</p>

			</section>
		</section>
		<section id="bidi">
<h3 title="Bidi Reordering">3.5. 双向~並替ng</h3>

<p>
同じ段落の中で，方向性が互いに反対向きな用字系に属する文字が混在する場合、
~Unicode双方向-~algoにより，論理-順序で格納された~textは 視覚的な呈示~用に並替えられる。
◎
The Unicode bidirectional algorithm reorders logically-stored text for visual presentation when characters from scripts of opposing directionalities are mixed within a single paragraph.
</p>

<p>
`~ruby注釈$と対応する`~ruby基底$との対応関係を保全するため、
次の制約が課される：
◎
To preserve the correspondence of ruby annotations to their respective ruby bases, a few restrictions must be imposed:
</p>

<ul>
	<li>
［
`~ruby基底$／`~ruby注釈$
］の内容の連続性は、
~~保つモノトスル。
◎
The contents of a ruby base or ruby annotation must remain contiguous.
</li>

	<li>
`~ruby基底$と，対応する`~ruby注釈$たちとは、
一緒に並替えるモノトスル。
◎
Ruby annotations must be reordered together with their ruby bases.
</li>

	<li>
`~ruby注釈$が`~span$している`~ruby基底$たちの連続性は、
~~保つモノトスル。
◎
All ruby bases spanned by a single ruby annotation must remain contiguous.
</li>
</ul>

<p>
その結果：
◎
To this end,
</p>

<ul>

	<li>
<p>
`双向~隔離$は、［
すべての`内部~ruby~box$と,
`~ruby容器$
］に対し，強制される
— すなわち， `unicode-bidi$p の`算出d値$は、
`指定d値$に応じて，次に従う
⇒＃
`normal$v ならば `isolate$v ／
`embed$v ならば `isolate^v ／
`bidi-override$v ならば `isolate-override$v
◎
Bidi isolation is forced on all internal ruby boxes and the ruby container: the normal and embed values of unicode-bidi compute to isolate, and bidi-override computes to isolate-override.
</p>

<p class="note">注記：
このことは、［
暗黙的な双向~並替ngが，~ruby基底たちに わたって働く
］ことはないことを意味する。
よって，作者は、［
`~ruby容器$に宣言される方向性は，その内容に~~実際に合致する
］ことを確保する必要がある。
◎
Note: This means that implicit bidi reordering does not work across ruby bases, so authors will need to ensure that the ruby container’s declared directionality does indeed match its contents.
</p>
	</li>
	<li>
~layoutの間，同じ`~ruby容器$の中にある`~ruby区分$たちは、
`~ruby容器$の `direction$p ~propにより順序付けられる。
◎
During layout, ruby segments are ordered within the ruby container by the direction property of their ruby container.
</li>
	<li>
<p>
同じ`~ruby区分$の中の［
`~ruby注釈$たち／`~ruby基底$たち
］は、
その~ruby区分の`~ruby基底~容器$の `direction$p ~propにより，それらが属する［
`~ruby基底~容器$／`~ruby注釈~容器$
］の中で順序付けられる。
ただし，`併合される注釈$を成す`~ruby注釈~容器$に属する`~ruby注釈$たちは、
当の容器の `direction$p ~propにより順序付けられる
— それらが，正確に［
当の容器の中の`行内~box$並びであった
］かのように。
◎
Within a segment, ruby bases and ruby annotations that are not merged are ordered within their respective containers by the direction property of the segment’s ruby base container. Merged annotations are ordered by the direction property of their annotation container, exactly as if they were a sequence of inline boxes within their annotation container.
</p>

<p class="note">注記：
このことは、
`併合される注釈$を成さない`~ruby注釈~容器$の `direction$p ~propは，~layoutの目的においては無視されることを意味する。
しかしながら，容器の子へは依然として継承できる
— その結果，それが包含するどの`~ruby注釈$の`行内~基底~方向$にも影響する。
◎
Note: This means the direction property on ruby annotation containers is ignored for the purpose of layout of non-merged annotations. However, it can still inherit into the container’s children and thereby affect the inline base direction of any ruby annotations it contains.
</p>
	</li>
</ul>

<p>
他の`行内~level$の内容と同じく、
`内部~ruby~box$たちの双向~並替ngは、
`行-分断ng$の後に起こる
— 内容が複数~行lに分割0されるときには、
自身の論理-順序に則るようにするため。
◎
As with other inline-level content, the bidi reordering of internal ruby boxes happens after line-breaking so that content is divided across lines according to its logical order.
</p>

<p class="note">注記：
これらの規則を［
特定0の`~ruby注釈~容器$の `ruby-merge$p が `merge$v のときに、
個々の注釈に対し`双向~隔離$を強制しないで，それらが一緒に処理されるのを可能化する
］よう，少し調整すると有用にもなり得る。
しかしながら，これは、
実装に複階性を追加することになり、
この状況を取扱う需要が無い下では，正当化されないと見受けられる。
これが取扱われるようにする必要がある者は、
~CSS~WGに連絡することが奨励される。
◎
Note: It could be useful to adjust these rules slightly so that when ruby-merge is merge on a particular annotation container, bidi isolation is not forced onto the individual annotations, enabling them to be processed together. However, this would add complexity to implementations, which does not seem justified in the absence of demand to handle this situation. Anyone with a need for this to be handled is encouraged to contact the CSS Working Group.
</p>

<p>
~CSSにおける双方向-~textについての より深い論は、
`CSS3-WRITING-MODES$r を見よ。
◎
See [CSS3-WRITING-MODES] for a more in-depth discussion of bidirectional text in CSS.
</p>

		</section>
		<section id="line-height">
<h3 title="Line Spacing">3.6. 行l間の間隔法</h3>

<p>
~CSSでは、
`line-height$p ~propが，各~行lの合間の間隔法を制御する。
ある行l上の行内~内容【の行l高さ】が `line-height$p より短いときは、
`CSS-INLINE-3$r `§ 論理-縦幅と行-間の間隔法＠~CSSINLINE#line-height$
に指定されるとおり，内容の両~側に半-~leadingが追加される。
`CSS2$r
◎
The line-height property controls spacing between lines in CSS. When inline content on line is shorter than the line-height, half-leading is added on either side of the content, as specified in CSS Inline Layout 3 § 5 Logical Heights and Inter-line Spacing.
</p>

<p>
各 行l間の間隔法が一貫することを確保するため、
~rubyを伴う文書における
`line-height$p は、
概して，~textの各~行lの合間に置かれる~rubyを収容するに十分な大きさが確保されるようにされる。
したがって，普通は、［
`~ruby注釈~容器$／`~ruby注釈~box$
］は，行lの行内~内容に測定される縦幅には寄与しない
— どの［
整列（ `vertical-align$p を見よ） ／ 行高~計算
］も、
それが正確に通常の行内であったかのように，`~ruby基底~容器$のみを利用して遂行される。
◎
In order to ensure consistent spacing of lines, documents with ruby typically ensure that the line-height is large enough to accommodate ruby between lines of text. Therefore, ordinarily, ruby annotation containers and ruby annotation boxes do not contribute to the measured height of a line’s inline contents; any alignment (see vertical-align) and line-height calculations are performed using only the ruby base container, exactly as if it were a normal inline.
</p>

<p>
しかしながら，`~ruby容器$に指定された `line-height$p が、［
上端にある`~ruby注釈~容器$の上端から，下端にある`~ruby注釈~容器$の下端
］までの距離に満たない場合、［［
塊が 3 個の行lからなっていて, その各~行lが これと一致する~rubyを包含している
］場合にも，互いの`~ruby容器$は重合しない
］ように，`~ruby基底~容器$の適切な側（たち）に~leadingが追加される。
◎
However, if the line-height specified on the ruby container is less than the distance between the top of the top ruby annotation container and the bottom of the bottom ruby annotation container, then additional leading is added on the appropriate side(s) of the ruby base container such that if a block consisted of three lines each containing ruby identical to this, none of the ruby containers would overlap.
</p>

<p class="note">注記：
これは、
`~ruby注釈$たちを`行l~box$の中に~~保つことは確保しない。
これは単に、
`各 行l間の間隔法がすべて等しい^em, かつ
`~ruby注釈$たちの量と位置決めも互いに等価な場合に，重合するのを避けるに十分な部屋を確保するに過ぎない。
◎
Note: This does not ensure that the ruby annotations remain within the line box. It merely ensures that if all lines had equal spacing and equivalent amounts and positioning of ruby annotations, there would be enough room to avoid overlap.
</p>

<p>
作者は、
~rubyを収容するに適切な［
`line-height$p ／ `padding$p
］を確保するべきである。
また、
特に，塊の［
先頭／末尾
］の所, および
行lが［
段落の既定の~font~sizeより高い`行内~level$の内容
（画像, `行内~塊$, `vertical-align$p でズラされた要素たち，など）
］を包含するときに，特に気を付けるべきである。
◎
Authors should ensure appropriate line-height and padding to accommodate ruby, and be particularly careful at the beginning or end of a block and when a line contains inline-level content (such as images, inline blocks, or elements shifted with vertical-align) taller than the paragraph’s default font size.
</p>

<figure>
<x-diagram
	aria-describedby="_dgm-rlh-a"
	style="width:8em; font-size:1.6em; text-align:center; line-height:1.2"
>
	<x-bk style="border:0.05em dotted blue; padding:0.4em 0;">
<x-bk style="border:0.1em solid gray;">前の行l</x-bk>
	</x-bk>
	<x-bk style="border:0.05em dotted blue; padding:0.4em 0; position:relative;">
<x-bk style="position:absolute; top:-0.7em; width:100%;"><span style="font-size:0.5em; color:red; border:0.2em solid gray;">~ruby~text</span></x-bk>
<x-bk style="border:0.1em solid gray;">~ruby基底</x-bk>
	</x-bk>
</x-diagram>
<p class="alt" hidden id="_dgm-rlh-a">
各~行lの内容は，その行l高さの~~中間に居座る。
上下各~側にある追加的な間隔は、
半-~leading（ `half-leading^en ）と呼ばれる。
~rubyは半-~leadingの 2 倍~以下ならば，行lと行lの合間に収まるが、
それは，~rubyが前の行lに所属する半-~leadingも占めることを意味する。
◎
The content of each line sits in the middle of its line height; the additional space on each side is called half-leading. Ruby fits between lines if it is smaller than twice the half-leading, but this means that it occupies space belonging to the half-leading of the previous line.
</p>
<figcaption>
~ruby注釈たちは、
行lを~overflowすることが多い
— 作者は、
~ruby注釈付き行lの［
上面／下面
］にある内容の間隔を必要十分にとって，~ruby用の部屋を残すことを確保するべきである。
◎
Ruby annotations will often overflow the line; authors should ensure content over/under a ruby-annotated line is adequately spaced to leave room for the ruby.
</figcaption></figure>

<p class="note">注記：
~rubyが［
整列／行l~layout
］にどう影響するかについての更なる制御は、
`CSS Line Layout Module Level 3^cite 【 `CSS-INLINE-3$r ？】
の一部になる。
それは現在，開発の探求段階にあるので、
新たな特能の記述は，まだ それに依拠するべきでない。
◎
Note: More control over how ruby affects alignment and line layout will be part of the CSS Line Layout Module Level 3. Note, it is currently in the exploratory stages of development; descriptions of new features should not yet be relied upon.
</p>

		</section>
	</section>
	<section id="ruby-props">
<h2 title="Ruby Formatting Properties">4. 各種~ruby整形~prop</h2>

<p>
~rubyの
`位置決め＠#rubypos$,
`~text分布＠#collapsed-ruby$,
`整列＠#rubyalign$
を制御するため、
以下の各種~propが導入される。
◎
The following properties are introduced to control ruby positioning, text distribution, and alignment.
</p>

		<section id="rubypos">
<h3 title="Ruby Positioning: the ruby-position property">4.1. ~rubyの位置決め： `ruby-position^p ~prop</h3>

◎名 `ruby-position@p
◎値 [ `alternate$v || [ `over$v | `under$v ] ] | `inter-character$v
◎初 `alternate$v
◎適 `~ruby注釈~容器$
◎継 される
◎百 受容しない
◎算 指定された~keyword
◎順 文法に従う
◎ア 離散的
◎表終

<p>
この~propは、
基底から~~相対的な，`~ruby注釈$の位置を制御する。
各種 値の意味は：
◎
This property controls position of the ruby annotation with respect to its base. Values have the following meanings:
</p>

<dl>
	<dt>`alternate@v</dt>
	<dd>
<p>
~~先行する`~level$の注釈と［
`over$v, `under$v
］が交替するように挙動させる。
すなわち、
当の`~ruby注釈~容器$が属する`~ruby区分$において，~~先行する`注釈~level$を成す`行l間の注釈$が：
◎
Different levels of annotations alternate between over and under.
</p>
		<ul>
			<li>
無い場合
⇒＃
この値が `under$v と伴に指定されているならば `under^v と同じに挙動する／
~ELSE_ `over$v と同じに挙動する
◎
If the annotation container is the first level of annotation in its ruby segment, or if all prior levels are inter-character,＼
then alternate, either on its own or in combination with over, behaves the same as over, while alternate in combination with under behaves the same as under.
</li>
			<li>
在る場合、
そらのうち最後のものが［
`over$v ／ `under$v
］として挙動するならば［
`under$v ／ `over$v
］と同じに挙動する。
（この事例では、
`over^v や `under^v の有無に関わらず，挙動に相違は無い。）
◎
Otherwise, if the previous level of interlinear annotation is over, alternate behaves like under, and vice versa.＼
(In this case, whether alternate is specified alone or in combination with over or under makes no difference.)
</li>
		</ul>
	</dd>

	<dt>`over@v</dt>
	<dd>
~ruby注釈は、
基底の`行-上面$に現れる。
◎
The ruby annotation appears line-over the base.
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-shinkansen-top">
横書き~modeにおける基底の上に現れる~ruby~glyph~layoutの図式
◎
Diagram of ruby glyph layout in horizontal mode with ruby annotation appearing above the base
</p>
<figcaption>
横書き~layoutにおける日本語~基底~textの上面にある~ruby
◎
Ruby over Japanese base text in horizontal layout
</figcaption></figure>
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-shinkansen-right">
縦書き~modeにおける基底の右に縦に現れる~ruby~glyph~layoutの図式
◎
Diagram of ruby glyph layout in vertical mode with ruby annotation appearing vertically on the right of the base
</p>
<figcaption>
縦書き~layoutにおける日本語~基底~textの上面（すなわち右端）にある~ruby
◎
Ruby to the right of Japanese base text in vertical layout
</figcaption></figure>
</dd>

	<dt>`under@v</dt>
	<dd>
~ruby注釈は、
基底の`行-下面$に現れる。
表語的 東Asian書記体系で利用されるのは 相対的に稀な設定であり、
教育用~textに最も見出され易い。
◎
The ruby annotation appears line-under the base. This is a relatively rare setting used in ideographic East Asian writing systems, most easily found in educational text.
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-shinkansen-bottom">
横書き~modeにおける基底の下に現れる~ruby~glyph~layoutの図式
◎
Diagram of ruby glyph layout in horizontal mode with ruby annotation appearing below the base
</p>
<figcaption>
横書き~layoutにおける日本語~基底~textの下面にある~ruby
◎
Ruby under Japanese base text in horizontal layout
</figcaption></figure>
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-shinkansen-left">
縦書き~modeにおける基底の左に縦に現れる~ruby~glyph~layoutの図式
◎
Diagram of ruby glyph layout in vertical mode with ruby annotation appearing vertically on the left of the base
</p>
<figcaption>
縦書き~layoutにおける日本語~基底~textの下面（すなわち左端）にある~ruby
◎
Ruby to the left of Japanese base text in vertical layout
</figcaption></figure>
</dd>

	<dt>`inter-character@v</dt>
	<dd>
<p>
この~ruby注釈~容器 %注釈~容器 が属する`~ruby容器$の`書字~mode$に応じて：
◎
↓</p>
		<ul class="switch">
			<li>
`縦書き$の場合、
この値による効果は `over$v と同じになる。
◎
If the writing mode of the enclosing ruby container is vertical, this value has the same effect as over.
</li>
			<li>
<p>
`横書き$の場合、
%注釈~容器 は
`文字~間@
の（ `inter-character^en な）`~ruby注釈~容器$になる。
そのような注釈は、
対応する（横書きな）基底たちの右端に現れる。
この場合、
%注釈~容器 の子である各`~ruby注釈$の `writing-mode$p の`算出d値$は，
`vertical-rl$v に強制される。
◎
Otherwise, the ruby annotation becomes an inter-character annotation. The annotation appears on the right of the base in horizontal text. This forces the computed value of writing-mode of the ruby annotation children of this ruby annotation container to be vertical-rl.
</p>

<p class="note">注記：
%注釈~容器 自体の `writing-mode$p の算出d値は影響されない。
これは、
同じ要素~上の［
`writing-mode$p,
`display$p,
`ruby-position$p
］~propの算出d値どうしの循環依存を避けるため。
◎
Note: The computed value of writing-mode on the ruby annotation container itself is not affected. This is to avoid circular dependencies between computed values on the writing-mode, display, and ruby-position properties on the same element.
</p>

<p class="trans-note">【
`~ruby注釈~容器$内の`~ruby注釈$は、
`文字~間$の`~ruby注釈$と呼ばれる。
原文には明示的に述べられていないが、
“`文字~間の注釈$” は，これらの総称を表す。
】</p>

			</li>
		</ul>
	</dd>
	<dd>
この値は、
とりわけ台湾で利用されている，繁体字~中国語の特別な事例~用に供されている。
その文脈においては、
（`注音符号$用の~glyphたちからなる）~rubyは
— 基底~文字の~layoutは横書きであっても —
基底~glyphの右端~側に沿って縦書きに現れる：
◎
This value is provided for the special case of traditional Chinese as used especially in Taiwan: ruby (made of bopomofo glyphs) in that context appears vertically along the right side of the base glyph, even when the layout of the base characters is horizontal:
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-bopomofo">
台湾式~rubyの例
◎
Example of Taiwanese-style ruby
</p>
<figcaption>
横書き~layoutにおける，繁体字~中国語における “注音符号” ~ruby注釈（青色）
【~ruby注釈の右端に在るのは声調~符】
◎
“Bopomofo” ruby in traditional Chinese (ruby annotation shown in blue for clarity) in horizontal layout
</figcaption></figure>
</dd>
	<dd class="note">
<p>注記：
継承は
— ~ruby~layout用に作成される匿名~boxを織り込むことなく —
要素~treeに対し働くので、
`文字~間の注釈$を利用する作者は，［
要素に基づく`~ruby注釈~容器$,
匿名な`~ruby注釈$,
更なる子孫~要素
］を孕んでいる~markup~patternを避けるよう気を付ける必要がある
— それらの子孫は、
自身の書字~modeを［
`writing-mode$p が `vertical-rl$v に変更された`~ruby注釈$
］ではなく，`~ruby注釈~容器$から継承することになるので。
◎
Note: As inheritance works on the element tree without accounting for anonymous boxes created for ruby layout, when using inter-character annotations authors need to be careful to avoid markup patterns involving an element-based ruby annotation container, an anonymous ruby annotation, and further descendant elements, as those descendants would inherit their writing mode from the ruby annotation container, and not from the ruby annotation whose writing-mode has been changed to vertical-rl.
</p>

<div class="example">

<pre class="lang-css">
ruby { ruby-position: inter-character; }
</pre>

`inter-character-1^xCode

<p>
上の~markupでは、
“~~問題になり得る~~注釈” 全体を包装するために，
匿名な`~ruby注釈~box$が `rtc^e 要素の子として作成される。
それは，［
`ruby-position$p が `inter-character$v になる`~ruby注釈~容器$
］の子なので、
その `writing-mode$p は期待されるとおり `vertical-rl$v になる。
しかしながら、
`em^e 要素は，自身の `writing-mode$p を［
`vertical-rl$v に強制されていない `rtc^e 要素
］から直に継承する。
◎
In the above markup, an anonymous ruby annotation box is created as a child of the &lt;rtc&gt; element to wrap the whole “problematic annotation”. Since it is a child of an annotation container whose ruby-position is inter-character, its writing-mode will be vertical-rl, which is expected. However, the &lt;em&gt; element inherits its writing-mode directly from the &lt;rtc&gt; element, which has not been forced to vertical-rl.
</p>

<p>
この例では，`~ruby注釈~容器$を与える要素は明示的に必要とされないので、
代わりに`~ruby注釈$を与える要素を利用して，問題を避けることになろう：
◎
In this example, the explicit ruby annotation container element was not necessary, so using a ruby annotation element instead would avoid the problem:
</p>

`inter-character-2^xCode

<p>
`~ruby注釈~容器$を与える要素が明示的に必要になる場合、
`~ruby注釈$を与える要素を利用して，問題に取組むことになろう：
◎
If an explicit ruby annotation container element is needed, then using a ruby annotation element as well would also address the problem:
</p>

`inter-character-3^xCode
</div>
	</dd>
</dl>

<p>
`~ruby注釈~容器$のうち，`文字~間$のそれでないものは、
`行l間@
の（ `interlinear^en な）`~ruby注釈~容器$
と呼ばれる。
◎
Annotation containers that are not inter-character annotations are called interlinear annotations.
</p>

<p class="trans-note">【
そのような容器~内の`~ruby注釈$は、
`行l間$の`~ruby注釈$と呼ばれる。
原文では明瞭に述べられていないが、
“`行l間の注釈$” は，これらの総称を表す。
】</p>

<p>
【同じ`~ruby~col$内の】
複数個の`~ruby注釈~容器$に対し `ruby-position$p が同じになる場合、
それらは，基底~textから外方に堆積される。
◎
If multiple ruby annotation containers have the same ruby-position, they stack outwards from the base text.
</p>

		</section>
		<section id="collapsed-ruby">
<h3 title="Sharing Annotation Space: the ruby-merge property">4.2. 注釈~間隔の共有-法： `ruby-merge^p ~prop</h3>

◎名 `ruby-merge@p
◎値 `separate$v | `merge$v | `auto$v
◎初 `separate$v
◎適 `行l間$の`~ruby注釈~容器$
◎継 される
◎百 受容しない
◎算 指定された~keyword
◎順 文法に従う
◎ア 算出d値の型による
◎表終

<div class="p">
<p>
この~propは、
`~ruby容器~box$内に`~ruby注釈~box$が 1 つ以上あるときに，注釈は 次のどれに従って描画されるべきかを制御する：
</p>

<ul>
	<li>
~pairどうしの分離を保つ（ `separate^v する）
</li>
	<li>
ひとまとめに
`注釈を併合する@
（ `merge^v する）
</li>
	<li>
分離を保つかどうかを，可用な空間に基づいて決定する（ `auto^v ）
</li>
</ul>
◎
This property controls how ruby annotation boxes should be rendered when there are more than one in a ruby container box: whether each pair should be kept separate, the annotations should be merged and rendered as a group, or the separation should be determined based on the space available.
</div>

<p class="note">注記：
`文字~間$の`~ruby注釈~容器$は、
常に別々であり，この~propは適用されない。
◎
Note: Inter-character annotations are always separate, and this property does not apply.
</p>

<p>
各種 値の意味は：
◎
Possible values:
</p>

<dl>
	<dt>`separate@v</dt>
	<dd>
各~ruby注釈~boxは、
それが`~span$する基底~box（たち）と同じ`~ruby~col$（たち）の中に描画される
— すなわち、
両~側にある隣接な基底と重合しない。
この~styleは、
`JLREQ$r では “~mono~ruby”【！モノルビ】 と呼ばれている。
◎
Each ruby annotation box is rendered within the same column(s) as its corresponding base box(es), i.e. without overlapping adjacent bases on either side. This style is called “mono ruby” in [JLREQ].
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-ruby-mono">
他より長い~pairがあるとき、
各~注釈を対応する基底に排他的に保つため，余分な間隔が［基底や注釈］に追加される。
例えば， “上手” 用の注釈における余分な間隔は、
長い方の注釈 “じょう” を収容するために 1 個目の文字の前後に追加される。
一方で，2 個目の文字~用の短い方の注釈 “ず” は、
単純に対応する基底~文字を基準に位置され, 整列される。
◎
Extra space is added to base or annotations when one of the pair is longer than the other in order to keep each annotation exclusive to its own base. For example, in the annotation for “上手”, extra space is added around the first character to accommodate its longer annotation “じょう” while the shorter annotation “ず” for the second character is simply positioned and aligned with respect to its base characters.
</p>
<figcaption>
`center$v 整列の下での
`ruby-merge:separate^p の効果。
◎
ruby-merge: separate with center alignment
</figcaption></figure>
	</dd>

	<dd class="example">
<p>
例えば、
次の 2 つの行lを描画した結果は，同じになる：
◎
For example, the following two lines render the same:
</p>

`mujo-separate^xCode

	</dd>

	<dt>`merge@v</dt>
	<dd>
同じ`~ruby区分$の中の同じ行l上にある すべての`~ruby注釈~box$は、
それらが属する`~ruby注釈~容器$の中で`行内~box$として連結され，［
対応する`~ruby基底~box$たち すべてに`~span$している，単独の`~ruby注釈~box$
］内に~lay-outされる。
この~styleによる描画は、
単独の行lに~lay-outされるときは，
`JLREQ$r による “~group~ruby” に類似する。
しかしながら、
複数~行lに分断されるときは，各［
`~ruby注釈$と対応する`~ruby基底$たち
］は一緒に保たれる。
◎
All ruby annotation boxes within the same ruby segment on the same line are concatenated as inline boxes within their annotation container, and laid out in a single anonymous ruby annotation box spanning all their associated ruby base boxes. When laid out on a single line, this style renders similar to “group ruby” in [JLREQ]. However, when it breaks across lines, ruby annotations are kept together with their respective ruby bases.
</dd>

	<dd>
<figure>
<p class="alt" hidden id="_dgm-ruby-merge">
結合された注釈は、
結合された基底を基準に，中央化される
— その結果，注釈の内容の一部が異なる基底の上面／下面に配置されるとしても。
"~~上手" の事例では、
1 個目の基底の注釈に属する "う" と 2 個目の基底の注釈に属する "ず" は，
2 個目の基底の上面／下面で空間を共有することになる。
◎
The combined annotation is centered with respect to the combined base, even if this would place an annotation’s content over a different base. In the case of “上手”, the “う” from the first base’s annotation and the “ず” from the second base’s annotation end up sharing space over the second base.
</p>
<figcaption>
`center$v 整列の下での
`ruby-merge:merge^p
による効果。
◎
ruby-merge: merge with center alignment
</figcaption></figure>
	</dd>


	<dd class="example">
<p>
次の 2 つの行lの描画は、
両者とも文字~並びは 1 行lに収まるならば，同じになる：
◎
The following two lines render the same if both characters fit on one line:
</p>

`mujo-collapse^xCode

<p>
しかしながら，後者は、
2 つの基底が複数~行lに分割されるときには，
`separate$v のときと同じに描画される。
◎
However, the second one renders the same as ruby-position: separate when the two bases are split across lines.
</p>
	</dd>

	<dt>`auto@v</dt>
	<dd>
<p>
【！with the intention that】
~UAは、
各~ruby注釈~boxが，対応する基底~boxに どう描画するか決定するときには、
次が満たされる限り，どのような~algoを利用してもヨイ：
</p>
		<ul>
			<li>
すべての注釈が，それらに対応する基底の上面に収まる場合の結果は、
`separate$v と一致する。
</li>
			<li>
ある注釈が それが~spanする基底より幅広になる場合には、
それらの基底と隣接な基底との合間に間隔が課されないよう，何らかの仕方で空間が共有される。
</li>
		</ul>
◎
The user agent may use any algorithm to determine how each ruby annotation box is rendered to its corresponding base box, with the intention that if all annotations fit over their respective bases, the result is identical to separate, but if some annotations are wider than their bases the space is shared in some way to avoid imposing space between bases.
</dd>
	<dd>
<figure>
<p class="alt" hidden id="_dgm-ruby-jukugo">
十分な空間があれば，注釈は対応する基底に整列されるが、
そうでない場合，注釈は隣接な注釈と空間を共有し得る。
したがって， "~~上手" 用の注釈は
— `merge^v の事例と同じく —
2 個目の基底の上面／下面で間隔を共有するが、
"~~下手" 用の各~文字に対する注釈は， `separate^v の事例と同じに描画される。
◎
If there is enough space, annotations are aligned to their bases; but if there is not, then annotations can share space with adjacent annotations. Thus the annotations for “上手” share space over the second base as in the 'merge' case, but the annotations for “下手” which are one character each end up rendering as for 'separate'.
</p>
<figcaption>
`center$v 整列の下での
`ruby-merge:auto^p
による効果。
◎
ruby-merge: auto with center alignment
</figcaption></figure>
	</dd>


	<dd class="note">
<p>注記：
この挙動は、
複合語~用に意図される。
`QA-RUBY$r `“~rubyとは何か？” 内の “熟語~ruby”＠https://www.w3.org/International/questions/qa-ruby#jukugo$
を見よ。
◎
Note: This behavior is intended for compound words, see “Jukugo Ruby” in “What is ruby?”. [QA-RUBY]
</p>

<p>
この型の~rubyを描画するための規約には様々なものがあり、
それに応じて複階性も変わる
— 例えば，次を見よ
⇒＃
`SIMPLE-RUBY$r `熟語~rubyの配置＠~TR/simple-ruby/#placement-of-jukugo-ruby$,
`JLREQ$r `熟語~rubyの位置決め＠~TR/jlreq/#positioning_of_jukugoruby_with_respect_to_base_characters$,
`JISX4051$r <cite>4.12.3(c) 熟語~rubyの処理</cite>
◎
There are various conventions for rendering this type of ruby, see Placement of Jukugo-ruby in [SIMPLE-RUBY], Positioning of Jukugo-ruby in [JLREQ], and 4.12.3(c) 熟語ルビの処理 in [JISX4051] for examples of varying complexity.
</p>

<p>
最も単純な，そのような規約は、
次に従うことである
⇒
［
次が満たされるならば `separate$v ／ 他の場合は `merge$v
］として描画する
⇒
どの`~ruby注釈~box$も，それが`~span$する`~ruby基底~box$たちの送幅の中に収まる
◎
The simplest of these is to render as separate if all ruby annotation boxes fit within the advances of their corresponding base boxes, and render as merge otherwise.
</p>
	</dd>
</dl>

<p class="note">注記：
`双向~隔離$があるので、［
複数個の`~ruby注釈$／複数個の~ruby基底
］にわたって，~textが合字を形成する（または合字に形状付けられる）ことはない
— 前者が`併合される注釈$を成す場合でも。
`§ 双向~並替ng＠#bidi$,
`CSS-TEXT-3$r `§ 要素~境界をまたがる形状付け＠~CSSTEXT#boundary-shaping$
を見よ。
◎
Note: Text does not shape or form ligatures across ruby annotations or bases, even merged ones, due to bidi isolation. See § 3.5 Bidi Reordering and CSS Text 3 §7.3 Shaping Across Element Boundaries.
</p>

		</section>
		<section id="ruby-align-property">
<h3 title="Ruby Text Distribution: the ruby-align property">4.3. ~ruby~textの分布： `ruby-align^p ~prop</h3>
<span id="rubyalign"></span>

◎名 `ruby-align@p
◎値 `start$v | `center$v | `space-between$v | `space-around$v
◎初 `space-around$v
◎適 `~ruby基底$, `~ruby注釈$, `~ruby基底~容器$, `~ruby注釈~容器$
◎継 される
◎百 受容しない
◎算 指定された~keyword
◎順 文法に従う
◎ア 算出d値の型による
◎表終

<p>
この~propは、
各種~ruby~boxの中で，その内容が対応する~boxを正確に埋めないときに，~textが どう分布するかを指定する。
`ruby-align$p により分布される間隔は、
両端揃えに因り分布される間隔とは無関係であり，独立になることに注意。
◎
This property specifies how text is distributed within the various ruby boxes when their contents do not exactly fill their respective boxes. Note that space distributed by ruby-align is unrelated to, and independent of, any space distributed due to justification.
</p>

<p>
この~propは、
`文字~間$の注釈に対しては，~box自身の整列にも影響し得る
（ `§ 文字~間~rubyの~layout＠#inter-character-layout$ を見よ）。
他の注釈に対しては、
~boxの中の内容の整列には影響するが，~box自身の［
~size／位置
］には影響しない。
◎
For inter-character annotations, this property can also affect the alignment of the box itself (see § 3.2 Inter-character Ruby Layout). It otherwise only affects the alignment of content within the box, not the size or position of the box itself.
</p>

<p>
各種 値の意味は：
◎
Values have the following meanings:
</p>

<dl>

	<dt>`start@v</dt>
	<dd>
~ruby内容は、
~boxの始端~辺に整列される。
◎
The ruby content is aligned with the start edge of its box.
</dd>
	<dd>
<figure>
<x-diagram aria-describedby="_dgm-ra-l">
<x-box>
<x-rt>`四^xF`五^xF`六^xF`七^xF`4^xP</x-rt>
<x-rb>`一^xF`二^xF`三^xF</x-rb>
</x-box>

【！ra-r】
<x-box><x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`二^xF`2^xP</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-l">
~glyph~layoutの図式：
注釈と基底の~~長さが揃わないときに，短い方が左端に整列される様子
◎
Diagram of glyph layout in left aligned ruby when ruby text is shorter than base
◎
Diagram of glyph layout in left aligned ruby when ruby text is longer than base
</p>
<figcaption>
`start$v による~rubyの分布
◎
start ruby distribution
</figcaption></figure>
	</dd>
	<dd class="issue">
“肩付き~ruby” は、
この値に近いが，まったく同じではない。
特に，それが基底から張出すときの挙動は、
周囲の文脈に依存して，始端への整列と相違する。
`JLREQ$r `§ ~mono~rubyの基底~文字に~~相対的な位置決め＠~TR/jlreq/#positioning_of_monoruby_with_respect_to_base_characters$
を見よ。
肩付き~rubyはまた，縦書きにしか利用されたことはなく、
JLTF【？】 は，それを特に重要ではないものと見なすので、
この値は，肩付き~rubyを処するほど十分~賢くする労をかけるに価しないであろう。
この値は、
他の何らかの目的で必要になるなら，保たれるべきであるが、
他の場合，単に落とすことにもなろう。
◎
"Katatsuki ruby" (肩付きルビ) is close to, but not quite the same as, this start value. In particular, its behavior when overhanging its base can differ from start alignment depending on surrounding context, see JLREQ. Also, it’s only ever used in vertical writing, and the JLTF considers it not particularly important, so it may not be worth the effort to make this value smart enough to deal with katatsuki ruby. If start is needed for some other purpose, we should keep it. Otherwise, maybe just drop it?
</dd>

	<dt>`center@v</dt>
	<dd>
~ruby内容は、
~boxの中で中央化される。
◎
The ruby content is centered within its box.
</dd>
	<dd>
<figure>
<x-diagram aria-describedby="_dgm-ra-c">
<x-box>
<x-rt>`四^xF`五^xF`六^xF`七^xF</x-rt>
<x-rb>`一^xF`二^xF`三^xF</x-rb>
</x-box>

【！ra-c-rb】
<x-box>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`二^xF</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-c">
~glyph~layoutの図式：
注釈と基底の~~長さが揃わないときに，短い方が中央化される様子
◎
Diagram of glyph layout in center aligned ruby when ruby text is shorter than base
◎
Diagram of glyph layout in center aligned ruby when ruby text is longer than base
</p>
<figcaption>
`center$v による~rubyの分布
◎
center ruby distribution
</figcaption></figure>
	</dd>

	<dt>`space-between@v</dt>
	<dd>
~ruby内容は（ `text-justify$p により定義される）通常の~text両端揃えに対するときと同じように拡がる
— ただし，`両端揃え機会$が無い場合、
内容は中央化される。
◎
The ruby content expands as defined for normal text justification (as defined by text-justify), except that if there are no justification opportunities the content is centered.
</dd>
	<dd>
<figure>
<x-diagram aria-describedby="_dgm-ra-dl">
<x-box>
<x-rt>`四^xF`1.33^xP`五^xF`1.33^xP`六^xF`1.33^xP`七^xF</x-rt>
<x-rb>`一^xF`二^xF`三^xF</x-rb>
</x-box>

【！ra-dl-rb】
<x-box>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`2^xP`二^xF</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-dl">
~glyph~layoutの図式：
注釈と基底の~~長さが揃わないときに，短い方を成す字lたちが分布するように整列される様子
◎
Diagram of glyph layout in distribute-letter aligned ruby when ruby text is shorter than base
◎
Diagram of glyph layout in distribute-letter aligned ruby when ruby text is longer than base
</p>
<figcaption>
`space-between$v による~ruby分布
◎
space-between ruby distribution
</figcaption></figure>
	</dd>

	<dt>`space-around@v</dt>
	<dd>
`両端揃え機会$が余分に存在する場合には，間隔のうち半分は~ruby内容の前, 半分は後に分布されることを除いて、
`space-between$v のときと同じになる。
◎
As for space-between except that there exists an extra justification opportunities whose space is distributed half before and half after the ruby content.
</dd>
	<dd>
<figure>
<x-diagram aria-describedby="_dgm-ra-ds">
<x-box>
<x-rt>`四^xF`1^xP`五^xF`1^xP`六^xF`1^xP`七^xF</x-rt>
<x-rb>`一^xF`二^xF`三^xF</x-rb>
</x-box>
【！ra-ds-rb】
<x-box>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`1^xP`二^xF</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-ds">
~glyph~layoutの図式：
注釈と基底の長さが揃わない, かつ短い方が~~全角のときに，短い方が自動的に整列される様子
◎
Diagram of glyph layout in auto aligned ruby when ruby text is shorter than base
◎
Diagram of glyph layout in auto aligned ruby when ruby text is longer than base
</p>
<figcaption>
`space-around$v による~ruby分布
◎
space-around ruby distribution
</figcaption></figure>
</dd>
	<dd class="example">
<p>
`既定の~UA~stylesheet＠#default-ua-ruby$は、
`~ruby注釈$に `text-justify:ruby$p を適用する。
それは，`両端揃え機会$を［
隣接な~CJK`文字$たちの各~合間には定義するが，
隣接な［
~Latin／注音符号
］`文字$たちの各~合間には定義しない
］ので、［
`space-around$v, `space-between$v
］どちらであろうが，後者を成す`文字$たちは中央化される結果になる：
◎
The default UA style sheet applies text-justify: ruby to ruby annotations, defining justification opportunities between every adjacent pair of CJK characters but not between adjacent pairs of Latin or Bopomofo characters. Thus, the space-around and space-between values will nevertheless result in Latin or Bopomofo characters centered:
</p>

<figure>
<x-diagram aria-describedby="_dgm-ra-dc-h">
<x-box>
<x-rt>`4^xH`5^xH`6^xH`7^xH</x-rt>
<x-rb>`一^xF`二^xF`三^xF</x-rb>
</x-box>

【！ra-dc-rb-h】
<x-box>
<x-rt>`四^xF`五^xF`六^xF`七^xF`八^xF`九^xF</x-rt>
<x-rb>`1^xH`2^xH`3^xH</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-dc-h">
~glyph~layoutの図式：
注釈と基底の長さが揃わない, かつ短い方が~~半角のときに，短い方が自動的に整列される様子
◎
Diagram of glyph layout in auto aligned ruby when halfwidth ruby text is shorter than base
◎
Diagram of character layout in auto aligned ruby when ruby text is longer than narrow-width base
</p>
<figcaption>
［
`space-around$v ／ `space-between$v
］による~ruby分布においては、
~CJK以外の~ruby~textは中央化される。
◎
Non-CJK ruby text in space-around and space-between ruby distribution are centered
</figcaption></figure>

<p>
間隔の分布は、
`text-justify$p を介して制御できる。
`CSS-TEXT-3$r
◎
The distribution of space can be controlled via text-justify. [CSS-TEXT-3]
</p>

	</dd>
</dl>

<p>
［
`~ruby注釈~box$／`~ruby基底~box$
］の内容は、
当の~boxの `ruby-align$p の値に基づいて，当の~boxの中で整列される。
ただし，`併合される注釈$を成す`~ruby注釈~容器$ %容器 に属する`~ruby注釈$たちに対しては、
それらの `ruby-align$p は無視され、
それらの内容は，
%容器 の `ruby-align$p の値に基づいて %容器 の中で整列される。
◎
Content in ruby bases and ruby annotations, except those that span due to ruby-merge: merge, is aligned within its box based on the value of ruby-align on that box. Content in merged annotations is aligned within the ruby annotation container based on the value of ruby-align on the annotations container, ignoring the value of ruby-align on the individual ruby annotations.
</p>

<p class="issue">
`併合される注釈$が`~ruby区分$より幅広になる場合、
どうする？
現在~指定されるとおり，各~基底を`併合される注釈$に~spanしているかのように~~拡げるか？
これは例えば、
`併合される注釈$の方が長いときに，複-基底な基底~容器~内の~textを中央化することを許容しない【？】。
代わりに、
基底~容器にも `ruby-merge$p を適用するのを許容するべきであろう
— これは、
次のいずれかを要求することになる
⇒＃
1 個の基底が複数個の注釈に~spanするのを許容する（基底は併合される一方で，併合されない注釈~levelもある）／
基底が併合される場合、すべての注釈~levelも併合されなければならない。
◎
What if a merged annotation causes the ruby segment to be wider? Does it cause each base to grow as if it were spanning them, as currently specified? This does not allow e.g. centering the text in a multi-base base container when its merged annotation is longer. Instead, maybe we should allow ruby-merge to apply to base containers as well, but this would require us either to allow a single base to span multiple annotations (if the base is merged but some annotation levels are not), or to require that if the base is merged, then all annotation levels must be merged as well.
</p>

<p>
`ruby-merge$p が `auto$v のときに内容が整列される仕方は，~UAに委ねられるが、
どの注釈も それに対応する基底たちに収まるときには，
`separate$v による整列と一致させるモノトスル。
◎
The way content is aligned when ruby-merge is auto is up to the user agent, but must be identical to that of ruby-merge: separate when all annotations fit over their respective bases.
</p>

		</section>
		<section id="ruby-text-decoration">
<h3 title="Ruby Text Decoration">4.4. ~ruby~text装飾</h3>

<p>
~text装飾は、
基底~textから各 注釈へは伝播しない。
◎
Text decoration does not propagate from the base text to the annotations.
</p>

<p>
~rubyの先祖に~text装飾が指定されたときは、
その装飾は，~ruby基底~容器の内容~区画 全体にわたって
— 長い注釈を収容するために~ruby基底~内容の各~側に追加された余分な間隔も含め —
描かれる。
この余分な間隔は、
~text装飾が~ruby基底~自身に指定されている場合には，装飾されない
— ~text装飾が その~boxに直に指定されたときに，~boxの自前の~paddingは装飾されないのと類似に。
`CSS3-TEXT-DECOR$r
◎
When text decoration is specified on an ancestor of the ruby, it is drawn across the entire content area of the ruby base container, including any extra space added on either side of the ruby base contents to accommodate long annotations. When text decoration is specified on a ruby base itself, this extra space is not decorated, similar to how a box’s own padding is not decorated when text decoration is specified directly on that box. [CSS3-TEXT-DECOR]
</p>

<p>
~text装飾は、
直に［
~ruby基底~容器／~ruby注釈~容器
］に指定されてもヨイ
— そのような事例では、
その装飾は，容器のすべての［
基底／注釈
］（同順）に伝播され，継続性のため，それらの各~合間にも描かれる。
◎
Text decoration may be specified directly on ruby base containers and ruby annotation containers: in such cases it is propagated to all of the container’s bases or annotations (respectively), and is also drawn between them for continuity.
</p>

<p>
~ruby注釈の位置は、
基底~textに適用されている［
上線／下線
］装飾との競合を避けるため，調整されてもヨイ。
基本的な，~font~sizeと基底線~整列が一貫である事例では、［
上線／下線
］は，当の`基底~level$と その側にある注釈との合間に位置される。
◎
The positions of ruby annotations may be adjusted to avoid potential conflicts with overline and underline decorations applied to the base text. In the basic case of consistent font size and baseline alignment, an underline or overline is positioned between the base level and any annotations on that side.
</p>

<p class="issue">
この節は、
隣接な［
基底／注釈
］を成す内容の合間に装飾を描くことについて，何らかの明確化が必要である。
それは、
それらの各~boxとそれが属する`~ruby~col$の幅広さが~~等しくなるかどうかに依存する。
◎
This section needs some clarification about drawing decorations between the content of adjacent bases/annotations. Depends on if those boxes are as wide as their column or not.
</p>

		</section>
	</section>
	<section id="edge-effects">
<h2 title="Edge Effects">5. 辺における効果</h2>

		<section id="ruby-overhang">
<h3 title="Overhanging Ruby: the ruby-overhang property">5.1. 張出ng~ruby： `ruby-overhang^p ~prop</h3>

◎名 `ruby-overhang@p
◎値 `~auto0$v | `none$v
◎初 `~auto0^v
◎適 `~ruby注釈~容器$
◎継 される
◎百 受容しない
◎算 指定された~keyword
◎順 文法に従う
◎ア 算出された値~型による
◎表終

<p>
`ruby-overhang$p ~propは、
`~ruby注釈$が［
`~ruby容器$の外側にある隣接な~text
］に重合しても【すなわち，張出しても】よいかどうかを制御する。
各種 値の意味は：
◎
The ruby-overhang property controls whether ruby annotations may overlap adjacent text outside the ruby container. Values have the following meanings:
</p>

<dl>
	<dt>`~auto0@v</dt>
	<dd>
`~ruby注釈~容器$は、
対応する`~ruby基底~容器$より長くなるときは，隣接な~boxに部分的に重合してもヨイ。
◎
When a ruby annotation container is longer than its corresponding ruby base container, the ruby annotation container may partially overlap adjacent boxes.
</dd>
	<dd>
どの条件の下で，どれだけ張出すかは、
~UAが決定する。
◎
Whether, how much, and under which conditions to overhang are determined by the UA.
</dd>

	<dt>`none@v</dt>
	<dd>
`~ruby注釈~容器$は、
自身の外へ拡張することは，決して許容されない。
◎
A ruby annotation container is never allowed to extend past the ruby annotation container.
</dd>
</dl>

<p>
`~ruby注釈$が張出すのは許容されないときには、
`~ruby容器$は，伝統的な`行内~box$の様に挙動する。
すなわち、
~boxの境界の中に描画されるものは，~boxの自前の内容に限られ、
隣接な要素がその境界を超えて~~侵入することはない：
◎
When ruby annotations are not allowed to overhang, the ruby container behaves like a traditional inline box, i.e. only its own contents are rendered within its boundaries and adjacent elements do not cross the box boundary:
</p>

<!-- 
clip: rect(0,0,0,10px)
<div style="position:relative">
<div style="display:inline-block; position:absolute">
</div></div>
 -->
<figure>
<x-diagram aria-describedby="_dgm-ro-n">
<x-box class="x-outside">
<x-rt>`0.1^xP</x-rt>
<x-rb><x-full style="border-left:none;">…</x-full></x-rb>
</x-box><x-box>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`1^xP`二^xF</x-rb>
</x-box><x-box class="x-outside">
<x-rt>`0.1^xP</x-rt>
<x-rb><x-full style="border-right:none;">…</x-full></x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ro-n">
~ruby~boxと隣接な~textとの相互作用を示す図式
◎
Diagram showing the ruby boxes interacting with adjacent text
</p>
<figcaption>
単純~ruby
— その~textが隣接な~textへ張出すのは、
許容されない
◎
Simple ruby whose text is not allowed to overhang adjacent text
</figcaption></figure>

<p>
しかしながら，`~ruby注釈~容器$に張出nが許容される場合、
それが属する`~ruby容器$は，隣接している内容と重合してもヨイ
— すなわち、
当の`~ruby注釈$（たち）を周囲の`行内~level$の内容の［
上面／下面
］に部分的に描画することも許容される。
張出nが許容されるのは、
隣接している内容と［
`~ruby注釈~容器$に属する`~ruby注釈~box$／重合した`~ruby基底$の内容
］とが衝突しない所までに限られる。
◎
However, if a ruby annotation container is allowed to overhang, neighbouring content may overlap the ruby container box, allowing its ruby annotation(s) to partially render over/under surrounding inline-level content. Overhang is only allowed to the extent that it does not cause collisions between the neighboring content and the ruby container’s annotation boxes or its overlapped base’s contents.
</p>

<figure>
<x-diagram aria-describedby="_dgm-ro-a">
<x-box class="x-outside">
<x-rt>`0.1^xP</x-rt>
<x-rb style="position:relative; left:0.9em;"><x-full style="border-left:none;">…</x-full></x-rb>
</x-box><x-box>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`1^xP`二^xF</x-rb>
</x-box><x-box class="x-outside">
<x-rt>`0.1^xP</x-rt>
<x-rb style="position:relative; right:0.9em;"><x-full style="border-right:none;">…</x-full></x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ro-a">
~ruby~boxと隣接な~textとの相互作用を示す図式
◎
Diagram showing the ruby boxes interacting with adjacent text
</p>
<figcaption>
単純~ruby
— その~textが隣接な~textへ張出すのは、
許容される
◎
Simple ruby whose text is allowed to overhang adjacent text
</figcaption></figure>

<p class="note">注記：
ある`~ruby基底$に対応する`~ruby注釈$が別の`~ruby基底$に張出せるかどうかは、
`ruby-merge$p により制御される。
◎
Note: Whether ruby annotations related to a ruby base can overhang another ruby base is controlled by ruby-merge.
</p>

<p>
［
基底／注釈
］の内容の整列は、
概して，張出ngの挙動には影響されない
— ［
整列／間隔の分布
］（ `ruby-align$p を見よ）は、
張出nが許容されるかどうかに関わらず，同じ仕方で達成され、
重合するために可用な間隔を決定する前に算出される。
しかしながら，~UAは、
張出nが許容される所では，それを考慮する下で［
注釈や基底における間隔の分布／
注釈と基底どうしの整列
］を決定してもヨイ。
◎
Typically, the alignment of the contents of the base or the annotation is not affected by overhanging behavior: alignment and space distribution (see ruby-align) is achieved the same way regardless of the overhang allowance, and is computed before the space available for overlap is determined. However, UAs may consider allowed overhang when determining space distribution and/or alignment of annotations and bases.
</p>

<p class="issue">
編集者は、
一部の事例では，張出ngが整列と相互作用する必要もあると疑っている
— 要検討。
◎
I suspect overhanging interacts with alignment in some cases; might need to look into this later.
</p>

<p class="example">
~UAは、
張出す長さの最大として，
`JIS4051$r により推奨される `0.5ic$v （~~全角~文字の半分）を利用してよい。
日本語において，［
~ruby~textが隣接な文字に どう張出せるか
］についての詳細な規則は、
`JLREQ$r に述べられる。
◎
The user agent may use [JIS4051] recommendation of using 0.5ic (half of a full-width character) in the annotation’s font as the maximum overhang length. Detailed rules for how ruby text can overhang adjacent characters for Japanese are described by [JLREQ].
</p>

		</section>
		<section id="line-edge">
<h3 title="Line-edge Alignment">5.2. 行l端~辺における整列</h3>

<p>
`~ruby基底$より長い`~ruby注釈~box$が，行lの［
始端／終端
］辺を超えるときは、
~UAは行lの辺に触れる側の
`~ruby注釈$を基底の対応する辺に整列するように`強制してもヨイ^em。
この型の整列は、
`JLREQ$r にて述べられている。
◎
When a ruby annotation box that is longer than its ruby base is at the start or end edge of a line, the user agent may force the side of the ruby annotation that touches the edge of the line to align to the corresponding edge of the base. This type of alignment is described by [JLREQ].
</p>

<p>
この挙動を制御する仕組みは、
この~levelの仕様では供されない。
◎
This level of the specification does not provide a mechanism to control this behavior.
</p>

<figure>
<x-diagram aria-describedby="_dgm-ra-le-l"
	style="padding-top: 2em;"
>
<x-box style="position: relative;">
<div style="position: absolute; top:-2em; left:-0.2em; height: 8em; border-left: thin dashed blue; white-space:nowrap;">左端~margin辺</div>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`一^xF`1^xP`二^xF`1^xP</x-rb>
</x-box>
【！ra-le-r】
<x-box style="position:relative;">
<div style="position: absolute; top:-2em; right:-0.2em; height: 8em; border-right: thin dashed blue; white-space:nowrap; text-align:right;">右端~margin辺</div>
<x-rt>`三^xF`四^xF`五^xF`六^xF`七^xF`八^xF</x-rt>
<x-rb>`1^xP`一^xF`1^xP`二^xF</x-rb>
</x-box>
</x-diagram>
<p class="alt" hidden id="_dgm-ra-le-l">
~glyph~layoutの図式：
行l端にある注釈が基底より長いときに，注釈が行l端~辺に整列される様子
◎
Diagram of glyph layout in line-edge aligned ruby when ruby text is shorter than base
◎
Diagram of glyph layout in line-edge aligned ruby when ruby text is longer than base
</p>
<figcaption>
行l端~辺における整列
◎
Line-edge alignment
</figcaption></figure>

		</section>
	</section>
	<section id="default-stylesheet">
<h2 title="Sample Style Sheets">付録 A. 見本~stylesheet</h2>

◎非規範的

		<section id="default-ua-ruby">
<h3 title=" A.1 Default UA Style Sheet">A.1. 既定の~UA~stylesheet</h3>

<p>
~HTML／~XHTML
による~ruby~markupを~ruby~layoutとして描画するための
既定の~UA~stylesheetは、
次で表現される：
◎
The following represents a default UA style sheet for rendering HTML and XHTML ruby markup as ruby layout:
</p>

<pre class="lang-css">
ruby { display: ruby; }
rp   { display: none; }
rbc  { display: ruby-base-container; }
rtc  { display: ruby-text-container; }
rb   { display: ruby-base; white-space: nowrap; }
rt   { display: ruby-text; }
ruby, rb, rt, rbc, rtc { unicode-bidi: isolate; }

rtc, rt {
  font-variant-east-asian: ruby;  /* <span class="comment">
`CSS-FONTS-3^r を見よ
◎
See [[CSS-FONTS-3]]
</span> */
  text-justify: ruby;             /* <span class="comment">
`CSS-TEXT-4^r を見よ
◎
See [[CSS-TEXT-4]]
</span> */
  text-emphasis: none;            /* <span class="comment">
`CSS-TEXT-DECOR-3^r を見よ
◎
See [[CSS-TEXT-DECOR-3]]
</span> */
  white-space: nowrap;
  line-height: 1;
}

rtc, :not(rtc) &gt; rt {
  font-size: 50%;
}
rtc:lang(zh-TW),
:not(rtc) &gt; rt:lang(zh-TW),
rtc:lang(zh-Hanb),
:not(rtc) &gt; rt:lang(zh-Hanb) {
  font-size: 30%;                /* <span class="comment">`注音符号$</span> */
}
</pre>

<p class="trans-note">【
存在しない言語~tag "zh-Hanb" は "zh-Hant" の誤記と思われる
（ § 変更点には "zh-Hant" と記されているので、
"zh-Hans" の誤記ではないであろう）。
】</p>


<p class="note">注記：
作者は、
上の規則を利用するべきでない
— ~ruby~layoutを~supportする~UAは、
上の規則を既定で供するべきである。
◎
Note: Authors should not use the above rules: a UA that supports ruby layout should provide these by default.
</p>

<p>
利用者が “最小~font~size” を制御できる特能を実装している~UAは、
~ruby注釈~用の最小を縮小することも考慮するベキである。
◎
UAs implementing a user-controlled “minimum font size” feature should consider scaling that minimum down for ruby annotations.
</p>

		</section>
		<section id="default-inline">
<h3 title=" A.2 Inlining Ruby Annotations">A.2. ~ruby注釈の行内~化法</h3>

<p>
~HTML／~XHTML
による~ruby~markupを~inline注釈として描画するための
見本~stylesheetは、
次で表現される:
◎
The following represents a sample style sheet for rendering HTML and XHTML ruby markup as inline annotations:
</p>

<pre class="lang-css">
ruby, rb, rt, rbc, rtc, rp {
  display: inline;
  white-space: inherit;
  font: inherit;
  text-emphasis: inherit;
}
</pre>

		</section>
		<section id="default-parens">
<h3 title=" A.3 Generating Parentheses">A.3. 丸括弧の生成-法</h3>

<p>
あいにく，選択子は~text~nodeには合致し得ないので、［
~HTMLにおいてアリな，どの~ruby~markup~patternに対しても、
丸括弧を伴わない~ruby注釈に，丸括弧を自動的かつ正しく追加する
］ための規則を~CSSで表出することはアリでない
（このことは、
~HTMLの~rubyでは，対応する要素が無い生の~textにより黙示される`~ruby基底$も許容されるためである）。
◎
Unfortunately, because Selectors cannot match against text nodes, it’s not possible with CSS to express rules that will automatically and correctly add parentheses to unparenthesized ruby annotations for all possible ruby markup patterns in HTML. (This is because HTML ruby allows implying the ruby base from raw text without a corresponding element.)
</p>

<p>
しかしながら，［
`rb^e ／ `rtc^e
］が厳格に利用されている事例に対しては、
次の規則が，各~注釈~並びの前後に丸括弧を追加することになる。
◎
However, these rules will add parentheses around each annotation sequence in cases where either &lt;rb&gt; or &lt;rtc&gt; is used rigorously:
</p>

<pre class="lang-css">
/* <span class="comment">
`rtc^e の前後に丸括弧を追加する
◎
Parens around &lt;rtc&gt;
</span> */
rtc::before { content: "（"; }
rtc::after  { content: "）"; }

/* <span class="comment">
最初の `rt^e の前に丸括弧を追加する
— `rtc^e の内側ではなく
◎
Parens before first &lt;rt&gt; not inside &lt;rtc&gt;
</span> */
rb  + rt::before,
rtc + rt::before { content: "（"; }

/* <span class="comment">
`rt^e の後に丸括弧を追加する
— `rtc^e の内側ではなく
◎
Parens after &lt;rt&gt; not inside &lt;rtc&gt;
</span> */
rb ~ rt:last-child::after,
rt + rb::before  { content: "）"; }
rt + rtc::before { content: "）（"; }
</pre>

<p>
別法として、
~markupが純粋に交互に挟まれる~styleで利用されていて
（例：
`&lt;ruby&gt;A&lt;rt&gt;a&lt;/rt&gt;B&lt;rt&gt;b&lt;/rt&gt;C&lt;rt&gt;c&lt;/rt&gt;&lt;ruby&gt;^c ），
隣接な~ruby注釈は無いことが既知な場合、
次の規則が，各~注釈の前後に丸括弧を追加することになる：
◎
Alternatively, if it is known that a purely alternating style of markup is used (&lt;ruby&gt;A&lt;rt&gt;a&lt;/rt&gt;B&lt;rt&gt;b&lt;/rt&gt;C&lt;rt&gt;c&lt;/rt&gt;&lt;ruby&gt;) where there are no adjacent ruby annotations, the following rules will add parentheses around each annotation:
</p>

<pre class="lang-css">
/* <span class="comment">
各 `rt^e の前後に丸括弧を追加する
◎
Parens around each &lt;rt&gt;
</span> */
rt::before { content: "（"; }
rt::after  { content: "）"; }
</pre>

		</section>
	</section>
	<section id="glossary">
<h2 title="Glossary">6. 用語集</h2>

<dl>
	<dt>
`注音符号@
（ `Bopomofo^en ／ `Zhuyin Fuhao^en ）
（中国語：
<span lang="zh-Bopo">ㄅㄆㄇㄈ</span> ／
<span lang="zh-Hant">~~注音符號</span> ／
<span lang="zh-Hans">~~注音符号</span>
）
◎
Bopomofo or Zhuyin Fuhao (Chinese: ㄅㄆㄇㄈ, 注音符號, or 注音符号)
</dt>
	<dd>
中国語の発音符に利用するために開発された［
文字, 声調
］からなる符~法
— とりわけ標準中国語（ `standard Mandarin^en ）。
これらは、
~ruby注釈~用に利用されることが多いが，それに~~限定されない。
【台湾のそれ。大陸の中国語に利用される拼音（ `pinyin^en ）ではない。】
◎
Characters and tone markings developed for use as phonetics in Chinese, especially standard Mandarin. These are often, but not exclusively, used for ruby annotations.
</dd>
	<dd>
<figure>
<x-diagram aria-describedby="_dgm-zhuyin-example">
【画像は省略する（ `inter-character$v に挙げられた図と同じ）。】
</x-diagram>
<p class="alt" hidden id="_dgm-zhuyin-example">
注音符号は、
横書き~textにおける各 中文漢字の右側に沿って縦方向に連なる。
◎
Bopomofo characters (in blue) run vertically along the right side of each Hanzi character in the horizontal text.
</p>
<figcaption>
中国語において文字~間~発音符の注釈として利用される注音符号の例。
◎
Example of Bopomofo used as phonetic inter-character annotations in Chinese
</figcaption></figure>
	</dd>
	<dd>
`注音符号~声調~符@
は、
（~~論理順で）各 注音符号~音節の終端に生じる文字であり、
間隔法を要する。
それらは、
概して，別々な筋~内に，他の注音符号の右肩【！right of or above】に表示される。
また、
声調~符の位置は，音節~内の文字~数に依存する。
しかしながら，中立的な声調~符は、
注音符号の
— 傍ではなく —
前に（かつ同じ行lに）配置される。
【！See Taiwanese requirements doc for EPUB at https://lists.w3.org/Archives/Public/www-archive/2020Apr/att-0005/EGLS_TW_eng.ppt】
◎
Bopomofo tone marks are spacing characters that occur (in memory) at the end of each bopomofo syllable. They are typically displayed in a separate track to the right of or above the other bopomofo characters, and the position of the tone mark depends on the number of characters in the syllable. The neutral tone mark, however, is placed before (and in line with) the bopomofo, not alongside it.
</dd>
	<dd class="note">注記：
~textを表示する際に，各~glyphを
— `注音符号~声調~符$も含めて —
それが［
~ruby注釈~内で生じるか, 通常の行内~内容として生じるか
］に応じて —
正しく［
位置される／相対的に整列される
］ことを確保することは、［
~UA, ~font下位-~system
］の責務である。
そのような~glyph配置は、
~CSS~ruby~layoutの機能ではない。
◎
Note: The user agent and font subsystem are responsible for ensuring the correct relative alignment and positioning of glyphs, including bopomofo tone marks, when displaying text—whether the text occurs in ruby annotations or as normal inline content. Such glyph placement is not a function of CSS ruby layout.
</dd>
	<dd>
<p>
次に挙げるものが，注音符号を成す：
◎
↓</p>
		<ul>
			<li>
`~Unicode用字系$ `Bopomofo^uc に属する`字l$【！誤）~CSSSYN#letter】
（これらは、
現時点では，
{ `3100^U 〜 `312F^U },
{ `31A0^U 〜 `31BF^U }
に対応付けられる）。
◎
Bopomofo letters belong to the Bopomofo Unicode script (and are currently mapped in the U+3100–312F and U+31A0–31BF blocks);＼
</li>
			<li>
<p>
`注音符号~声調~符$
— 次に挙げるもの
⇒＃
`02C9^U `ˉ^smb,
`02CA^U `ˊ^smb,
`02C7^U `ˇ^smb,
`02CB^U `ˋ^smb,
`02EA^U `˪^smb,
`02EB^U `˫^smb,
`02D9^U `˙^smb
◎
the Bopomofo tone marks are U+02C9 (ˉ), U+02CA (ˊ), U+02C7 (ˇ), U+02CB (ˋ), U+02EA (˪), U+02EB (˫), U+02D9 (˙).＼
</li>
		</ul>
<p>
これらは、
~CSSの目的においては，
`注音符号~文字@
と総称される。
◎
Collectively these are all considered Bopomofo characters for the purpose of CSS.
</p>
	</dd>

	<dt>
`漢字@
（ `Han^en ）
</dt>
	<dd class="trans-note">【
この項は、
この訳による補足。
明確に定義されてないが、
主に日中韓で利用されている
~~漢字／表語文字
の総称と思われる
（該当する文字は、
他の用字系にもあるかもしれない）。
】</dd>

	<dt>
`韓文漢字@
（ `Hanja^en ）
（韓国語： <span lang="ko">~~漢字</span> ）
◎
Hanja (Korean: 漢字)
</dt>
	<dd>
韓国語~書記体系の下位集合であり，中国語~書記体系から［
借用した／順応した
］表語的~文字を用立てるもの。
`日文漢字$も見よ。
◎
Subset of the Korean writing system that utilizes ideographic characters borrowed or adapted from the Chinese writing system. Also see Kanji.
</dd>

	<dt>
`中文漢字@
（ `Hanzi^en ）
（中国語：
<span lang="zh-Hans">汉字</span> ／
<span lang="zh-Hant">漢字</span>
）
</dt>
	<dd class="trans-note">【
この項は、
この訳による補完。
中国語の~~漢字を指すと見受けられる。
（中国語は ほぼすべて漢字で記され，ほぼ “中国語の字l” と同義になるので、
用語として挙げられていないのかもしれない。）
】</dd>

	<dt>
`平仮名@
（ `hiragana^en ）
（日本語： ~~平仮名）
◎
Hiragana (Japanese: 平仮名)
</dt>
	<dd>
日本語の音節的~用字系, または その用字系の文字。
筆記的には、
丸まった外見。
日本語~書記体系の下位集合であり、
`日文漢字$や`片仮名$と一緒に利用される。
近現代では、
日本語~単語を書く際に［
日文漢字が［
可用でない／適切でない
］とき／
単語の~~送り~~仮名（ `ending^en ）や~~助詞（ `particle^en ）
］に利用されることがほとんどである。
`片仮名$も見よ。
◎
Japanese syllabic script, or character of that script. Rounded and cursive in appearance. Subset of the Japanese writing system, used together with kanji and katakana. In recent times, mostly used to write Japanese words when kanji are not available or appropriate, and word endings and particles. Also see Katakana.
</dd>

	<dt>
`表語文字@
（ `ideograph^en ）
◎
</dt>
	<dd>
~alphabeticなど音節的な用字系の文字とは対照的に、［
~idea／単語／単語のある成分
］を表現するときに利用される文字（用字系に応じて いくつか変種がある）。
東Asia（日中韓, 他）で利用されるものが、
最もよく知られた表語的 用字系である。
◎
A character that is used to represent an idea, word, or word component, in contrast to a character from an alphabetic or syllabic script. The most well-known ideographic script is used (with some variation) in East Asia (China, Japan, Korea,...).
</dd>

	<dt>
`仮名@
（ `kana^en ）
（日本語： ~~仮名）
◎
Kana (Japanese: 仮名)
</dt>
	<dd>
`平仮名$, `片仮名$を併せた総称。
◎
Collective term for hiragana and katakana.
</dd>

	<dt>
`日文漢字@
（ `Kanji^en ）
（日本語： ~~漢字）
◎
Kanji (Japanese: 漢字)
</dt>
	<dd>
日本語における，`表語文字$を指す用語
— 日本語で利用される`表語文字$。
日本語~書記体系の下位集合であり、
`平仮名$, `片仮名$と一緒に利用される。
`韓文漢字$も見よ。
◎
Japanese term for ideographs; ideographs used in Japanese. Subset of the Japanese writing system, used together with hiragana and katakana. Also see Hanja.
</dd>

	<dt>
`片仮名@
（ `katakana^en ）
（日本語： ~~片仮名）
◎
Katakana (Japanese: 片仮名)
</dt>
	<dd>
日本語の音節的~用字系, または その用字系の文字。
角張った外見。
日本語~書記体系の下位集合であり、
`日文漢字$, `平仮名$と一緒に利用される。
近現代では、
主に外来語を書くときに利用される。
`平仮名$も見よ。
◎
Japanese syllabic script, or character of that script. Angular in appearance. Subset of the Japanese writing system, used together with kanji and hiragana. In recent times, mainly used to write foreign words. Also see Hiragana.
</dd>
</dl>

	</section>
	<section id="acknowledgments">
<h2 title="Acknowledgments">謝辞</h2>

<p>
この仕様は、
次の方々からの助力~抜きにはアリでなかった：
◎
This specification would not have been possible without the help from:
</p>

<div lang="en">
David Baron,
Robin Berjon,
Susanna Bowen,
Stephen Deach,
Martin Dürst,
Hideki Hiura (<span lang="ja">樋浦 秀樹</span>),
Masayasu Ishikawa (<span lang="ja">石川雅康</span>),
Taichi Kawabata,
Chris Pratley,
Xidorn Quan,
Takao Suzuki (<span lang="ja">鈴木 孝雄</span>),
Frank Yung-Fong Tang,
Chris Thrasher,
Masafumi Yabe (<span lang="ja">家辺勝文</span>),
Boris Zbarsky,
Steve Zilles.
</div>

<p>
以前の編集者たちにも特別な謝意を：
</p>

<div lang="en">
Special thanks goes to the previous editors: Michel Suignard and Marcin Sawicki of Microsoft, and Richard Ishida of W3C.
</div>

	</section>
	<section id="changes">
<h2 title="Changes">変更点</h2>

<p>
この節では、
以前の公表版からの変更点を文書化する。
◎
This section documents the changes since previous publications.
</p>
<dl>
	<dt id="changes-20211202">
2021 年 12月 2日 作業草案からの変更点
◎
Changes since the 2 December 2021 WD
</dt>
	<dd>
`文字~間の注釈$の `writing-mode$p の算出d値は、
`~ruby注釈~容器~box$ではなく，`~ruby注釈~box$に適用するよう調整した。
◎
Made the computed-value adjustement of writing-mode on inter-character annotations apply to the ruby annotation box rather than the ruby annotation container box.
</dd>
	<dd>
~HTML用の~UA~stylesheetを成す［
~ruby注釈に `font-size:30%^p を適用する規則
］に zh-Hant を追加した。
◎
Added zh-Hant to rule applying font-size: 30% to ruby annotations in HTML.
</dd>
	<dd>
既定の~UA~stylesheetに
`text-justify:ruby^p
を追加した。
（ `771$issue, `779$issue ）
◎
Added text-justify: ruby to the UA default style sheet. (Issue 771 Issue 779)
</dd>

	<dt id="changes-20200429">
2020 年 4月 29日 作業草案からの変更点
◎
Changes since the 29 April 2020 WD
</dt>
	<dd>
`ruby-position$p に~keyword `alternate$v を追加して，それを`初期~値$にした。
◎
Added alternate keyword to ruby-position and made it the initial value.
</dd>
	<dd>
`ruby-merge$p 用の値 `collapse^v を `merge$v に改称した。
（ `5004$issue ）
◎
Renamed collapse value of ruby-merge to merge. (Issue 5004)
</dd>
	<dd>
<code class="css">`visibility$p: `collapse^v</code>
は、
`自動で隠され$る注釈と同じ仕方で明示的に注釈を`隠す$ものと定義した
（ `5927$issue ）
◎
Defined visibility: collapse to explicitly hide an annotation the same way auto-hidden annotations are hidden. (Issue 5927)
</dd>
	<dd>
各種~ruby表示~型に どの~propが適用されるかを，もっと精確に指定した
（ `§ ~ruby~boxの~style法＠#box-style$）。
［
~ruby／~ruby基底／~ruby注釈
］~boxは、
他が指定される場合を除き，定例の`行内~box$と同じに挙動するものと定義した。
（ `4935$issue, `4936$issue, `4976$issue, `4979$issue ）
◎
Specified more precisely which properties apply to the various ruby display types (§ 3.3 Styling Ruby Boxes) and defined ruby, ruby base, and ruby annotation boxes to behave the same as regular inline boxes except as otherwise specified. (Issue 4935, Issue 4936, Issue 4976, Issue 4979)
</dd>
	<dd>
`§ ~ruby~layout＠#ruby-layout$を相当に造り直して、［
`行l間$／`文字~間$
］の~ruby~layout,
その `ruby-align$p との相互作用を もっと明瞭に定義した。
`文字~間$の~rubyは、
今や，`行内~塊$の~layoutに基づく
— その`行l間$の~rubyとの相互作用も きちんと定義した。
複数個の基底に`~span$する`~ruby注釈$に対し，［
`文字~間$の~ruby用の行内-軸における間隔の分布
］をもっと精確に定義した。
【！(modeled on max-content grid tracks)？】
◎
Substantially revamped § 3 Ruby Layout to more clearly define interlinear and inter-character ruby layout and their interaction with ruby-align. Inter-character ruby is now based on inline block layout, and its interaction with interlinear ruby is also now well-defined. Inline-axis space distribution for interlinear ruby is now more precisely defined for spanning annotations (modeled on max-content grid tracks).
</dd>
	<dd>
入子にされた~rubyの取扱いを定義した
— その［
`~ruby基底~容器$,
`~ruby注釈~容器$
］を［
塊-軸における`行l間$の~rubyの~sizing
］に織り込むことにより。
（ `4986$issue, `4980$issue ）
◎
Defined handling of nested ruby by accounting for their base and annotation containers in the block-axis sizing of interlinear ruby. (Issue 4986, Issue 4980)
</dd>
	<dd>
`ruby-align$p がどう働くかを もっと精確に指定した。
◎
Specified more precisely how ruby-align works.
</dd>
	<dd>
［
~rubyの張出nは、
~ruby内容の整列には影響しない
］とするよう要件を~~緩めた。
［
~rubyの張出nは、
~ruby内容に隣接な内容に衝突しない
］とする要件を追加した。
◎
Loosened requirement that ruby overhang not affect the alignment of ruby contents, added requirement that it not cause ruby content to collide with adjacent content.
</dd>
	<dd>
［
双向~並替ngと`併合される注釈$
］の相互作用を明確化した。
（ `§ 双向~並替ng＠#bidi$ ）
◎
Clarified interaction of bidi reordering and merged annotations. (§ 3.5 Bidi Reordering)
</dd>
	<dd>
全体を通して、
規範的な注釈文を整備した。
◎
Tightened up normative prose throughout.
</dd>
	<dd>
［
`§ 序論＠#intro$,
例,
その他の規範的でない~text
］を改善した。
◎
Improved introduction, examples, and other informative text.
</dd>
	<dd class="note">注記：
まだ多くの~openな課題が残されている
— 
`各~commentに対する処置集＠~CSSWG/css-ruby-1/issues-wd-2020$／
GitHub にて追跡されている
`より新たな課題＠https://github.com/w3c/csswg-drafts/issues?q=is%3Aissue+label%3Acss-ruby-1$
も見よ。
◎
Note: There remain many open issues, see Disposition of Comments and the newer issues tracked in GitHub.
</dd>

	<dt id="changes-20140805">
2014年 8月 5日 作業草案からの変更点
◎
Changes since the 5 August 2014 WD
</dt>
	<dd>
~rubyが張出す挙動に対する基本的な制御-用に，
`ruby-overhang$p を追加し直した。
◎
Add back ruby-overhang: auto | none for basic control over ruby overhang behavior.
</dd>
	<dd>
行内~化が `CSS-DISPLAY-3$r と調和するようにした。
◎
Harmonize inlinification with the CSS Display Module.
</dd>
	<dd>
下線や上線と競合する場合には，~rubyや圏点をズラすことを~UAに許容した。
◎
Allow UA to shift ruby/emphasis marks if they conflict with underlines/overlines.
</dd>
	<dd>
`ruby-merge$p の`算出d値$が `collapse^v †のときには、
自動で隠すのを不能化した。
【† `merge$v に改称された。】
◎
Disable auto-hiding when the computed value of ruby-merge is collapse.
</dd>
	<dd>
`既定の~stylesheet＠#default-stylesheet$を調節した。
◎
Tweak the default style sheet.
</dd>
	<dd>
~text装飾との相互作用を定義する
`§ ~ruby~text装飾＠#ruby-text-decoration$
を追加した。
◎
Add section defining interaction with text decoration.
</dd>
	<dd>
`ruby-position$p 用の値［
`right^v, `left^v
］を次の~levelへ先送りした。
◎
Defer the right and left values of ruby-position to the next level.
</dd>
	<dd>
~ruby`~pair法$の規則を，匿名な~ruby注釈に~spanしているもの
（すなわち， `rtc^e 要素に直に包含される内容）
に限り適用されるよう変更した。【？】
◎
Change ruby pairing rules to only apply spanning on anonymous annotations (i.e. content directly contained by an rtc).
</dd>
	<dd>
~pairは、［
~ruby基底／~ruby注釈
］を自動-生成される空な匿名［
~ruby基底／~ruby注釈
］で `excess^en する【？】。
◎
Pair excess bases / annotations with auto-generated empty anonymous bases / annotations.
</dd>
	<dd>
`ruby-position$p は `first-line$pe に適用することにした。
（`課題 #2998＠~CSSissue/2998$）
◎
Apply ruby-position to ::first-line. (Issue 2998)
</dd>
	<dd>
~ruby~box【`~ruby容器$】, その内容の包含塊は、
他の`行内~box$の事例と同じく，最も近い塊~容器であることを明確化した。
◎
Clarify containing block of ruby boxes and contents is, as in the case of other inline boxes, the nearest block container.
</dd>
	<dd>
親が違えられた内部~table要素の取扱いを明確化した。
◎
Clarify handling of misparented internal table elements.
</dd>
	<dd>
［
`~ruby容器$／`~ruby注釈~容器$／`~ruby基底~容器$【！~ruby基底~基底~容器】
］内の［
頭部, 尾部
］にある空白は、
~pair法に干渉しないよう，削ることにした。
◎
Trim leading/trailing white space in ruby containers, base base containers, and annotation containers to prevent it from interfering with pairing.
</dd>
	<dd>
空な［
`~ruby基底$, `~ruby注釈~容器$
］の~layout効果を定義した。
◎
Define layout effect of empty base and annotation containers.
</dd>
	<dd>
［
`~ruby基底~容器$／`~ruby注釈~容器$
］に対する［
~margin, ~padding, ~border
］は不能化するようにした
（が、［
`~ruby基底$／`~ruby注釈$
］においては不能化されない）。
◎
Disable margins, padding, and borders on ruby base containers and ruby annotation containers (but not on ruby bases and ruby annotations).
</dd>

	<dt id="changes-20130919">
2013年 9月 19日 作業草案からの変更点
◎
Changes since the 19 September 2013 WD
</dt>
	<dd>
匿名~boxの生成~規則と空白の取扱い規則を書き直した。
匿名な空白~boxに特化された`~pair法$を定義した。
◎
Rewrite anonymous box generation rules and white space handling rules, defined specialized pairing of anonymous white space boxes.
</dd>
	<dd>
`~pair法$から，入子な~rubyの取扱いを取り出した。
（ ~sizing／~layoutを介して取扱うことになる。）
【が、入子な~rubyの取扱いは，除去された。】
◎
Take nested ruby handling out of pairing. (Will be handling it via sizing/layout.)
</dd>
	<dd>
~ruby構造の双向~layoutを定義した。
◎
Define bidi layout of ruby structures.
</dd>

	<dt id="changes-20110630">
2011年 6月 30日 作業草案からの変更点
◎
Changes since the 30 June 2011 WD
</dt>
	<dd>
`ruby-span^p および
`rbspan^a への言及を除去した。
~HTML~rubyにおいては、
明示的な~span法は
— 暗黙的な~span法の~~支持を受けて —
利用されない。
両側へ~~異常に~spanする一部の事例は取扱えなくなるが、
~~現時点では，その要件は無いように見受けられる
（複階的な~XHTML~Rubyを全部的に~supportする実装は、
~table内で~spanしている~cellを取扱うときと同じ魔法な仕方で，~markupから~span法を黙示できる。
~level 1 においては、
この制御を含めることは必要とされないと見受けられる。）
◎
Remove ruby-span and mentions of rbspan.
• Explicit spanning is not used in HTML ruby in favor of implicit spanning. This can’t handle some pathological double-sided spanning cases, but there seems to be no requirement for these at the moment. (For implementations that support full complex XHTML Ruby, they can imply spanning from the markup the same magic way that we handle cell spanning from tables. It doesn’t seem necessary to include controls this in Level 1.)
</dd>
	<dd>
`ruby-overhang^p, および
`ruby-align^p に対する `line-end^v は、
~level 2 へ先送りした。
これは、
いくぶん複雑で高度な特能である。
この挙動を~UAが定義することにして，受容-可能な~optionを成す何らかの例を供する提案がある。
◎
Defer ruby-overhang and ruby-align: line-end to Level 2.
• It’s somewhat complicated, advanced feature. Proposal is to make this behavior UA-defined and provide some examples of acceptable options.
</dd>
	<dd>
`rp$e 要素~用に `display^p 値 `rp^v を要請する国際-化~WGから追加された課題を，
`display^p に `none^v を利用することにより~closeした。
`rp^v には， `ruby$e が~rubyとして表示されるときに隠すことが想定されているが、
これはすでに， `none^v で容易に成遂げれる。
◎
Close issue requesting display: rp: use display: none.
• The Internationalization WG added an issue requesting a display value for rp elements. They’re supposed to be hidden when ruby is displayed as ruby. But this is easily accomplished already with display: none.
</dd>
	<dd>
`ruby-position$p 値を `text-emphasis-position$p に合致するよう変更した。
保つ必要がある `inter-character$v 以外は、
~ruby位置と `text-emphasis-position$p を整列する方がイミを成し，［
横書き／縦書き
］に対する様々な選好の組合nを正しく取扱えるので。
◎
Change ruby-position values to match text-emphasis-position.
• Other than inter-character, which we need to keep, it makes more sense to align ruby positions with text-emphasis-position, which can correctly handle various combinations of horizontal/vertical preferences.
</dd>
	<dd>
`ruby-align$p 用の値［
`left^v, `right^v, `end^v
］は、
利用されておらず，必要ないので除去した。
◎
Remove unused values of ruby-align.
• left, right, and end are not needed.
</dd>
	<dd>
`ruby-align$p の用の値［
`auto^v,
`distribute-letter^v,
`distribute-space^v
］を［
`space-between$v,
`space-around$v
］に置換した。
`auto^v は，内容を検分することに依拠して挙動を決定していたが、
`space-around$v と標準な両端揃え規則を併用するだけで避けれる
（それは、
~CJK間の間隔法は許容する一方で，~Latin間には許容しない）。
`CSS-FLEXBOX-1$r, `CSS-ALIGN-3$r
における各種 分布~keywordとの一貫性を得るため，および
`text-justify:distribute^p の定義への~linkを避けるため、［
`distribute-letter^v, `distribute-space^v
］を［
`space-between^v, `space-around^v
］に置換した。
◎
Replace auto, distribute-letter, and distribute-space from ruby-align with space-between and space-around.
• The auto value relied on inspecting content to determine behavior; this can be avoided by just using space-around with standard justification rules (which allow spacing between CJK but not between Latin). Replaced distribute-letter and distribute-space with space-between and space-around for consistency with distribution keywords in [CSS-FLEXBOX-1] and [CSS-ALIGN-3] and to avoid any links to the definition of text-justify: distribute.
</dd>
	<dd>
熟語の描画を制御する `ruby-merge$p ~propを追加した。
これは、
~style上の効果であり，構造上の効果ではない。
以前の~modelでは、
構造上の効果と見做して，~markupを変更することで それを取扱うよう示唆していた。
 :(
◎
Added ruby-merge property to control jukugo rendering.
• This is a stylistic effect, not a structural one; the previous model assumed that it was structural and suggested handling it by changing markup. :(
</dd>
	<dd>
`ruby-position$p から `inline^v を除去した。
これは、
~rubyに関係するすべての要素~上で， `display^p を `inline^v にすることを介して行えるので。
`§ ~ruby注釈の行内~化法＠#default-inline$
を見よ。
◎
Remove inline from ruby-position.
• This is do-able via display: inline on all the ruby-related elements, see Appendix A.
</dd>
	<dd>
国際-化~WGから要請された，
`既定の~style規則＠#default-stylesheet$を追加した。
◎
Added Default Style rules
• As requested by Internationalization WG.
</dd>
	<dd>
匿名~boxの生成~規則を書いて、
基底と注釈の`~pair法$を定義した。
今や，~HTML~ruby~markupが成す~~膨大な順列~すべてを取扱うはずである。
◎
Wrote anonymous box generation rules
• And defined pairing of bases and annotations. Should now handle all the crazy proposed permutations of HTML ruby markup.
</dd>
	<dd>
~rubyの~layoutを定義した。
間隔~分布, 空白の取扱い, 行l分断法, 行l堆積-法, 等々を詳細に定義した。
双向~性の課題は~openなまま残された。
◎
Defined layout of ruby
• Defined in detail space distribution, white space handling, line breaking, line stacking, etc. Open issue left for bidi.
</dd>
</dl>

	</section>
</main></div>
