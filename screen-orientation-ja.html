<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>The Screen Orientation API （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-w3c.css" type="text/css">

<style>
.test {
	float: right;
}
</style>

<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		generate: expand,
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~一-鿆あ-ん]+|`(.*?)([$@^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){
if(!indicator) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('＠');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r': // ref
	text = `[${key}]`;
	href = `#bib-${key.toLowerCase()}`;
	break;
case 'm':
	const n = text.indexOf('(');
	if(n > 0){
		key = text.slice(0, n);
		text = key + text.slice(n).replace(/\w+/g, '<var>$&</var>');
	}
	break;
case 'oT': // literal
case 'oL': // literal
case 'l': // literal
	text = `"<code class="literal">${key}</code>"`
	break;
case 'sl': // JS internal slot
	text = `[[${key}]]`;
	break;
case 'test':
	return (
`<span class="test">《test: <a href="https://w3c-test.org/screen-orientation/${key}.html">${key}</a>》</span>`
	);
	break;
case 'en':
	return `<span lang="en">${key}</span>`
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;

	}
}
</script>

<script type="text/plain" id="_source_data">

●●options

spec_title:The Screen Orientation API
spec_date:2022-10-10
trans_update:2022-10-13
source_checked:221010
original_url:https://w3c.github.io/screen-orientation/
	abbr_url:SCREEN-ORIENTATION
spec_status:ED
ref_id_prefix:bib-
ref_id_lowercase:true
site_nav:uievents
conformance:w3c
copyright:2022,permissive
trans_1st_pub:2021-01-05

●●class_map
et:event-type
E:error
sl:js-slot
jv:js-value
test:test

●●tag_map
I:code
m:code
E:code
et:code
sl:span
c:code
jv:code
i:i
cite:cite
test:span

●●original_id_map

●●mdn_urls

dom-screenorientation:API/ScreenOrientation
	dom-orientationlocktype:API/OrientationLockType
	dom-orientationtype:API/OrientationType

●●link_map

	●idl

Exposed:~WEBIDLjs#Exposed
SameObject:~WEBIDLjs#SameObject

E.AbortError:~WEBIDL#aborterror
E.InvalidStateError:~WEBIDL#invalidstateerror
E.NotSupportedError:~WEBIDL#notsupportederror
E.SecurityError:~WEBIDL#securityerror

Promise:~WEBIDL#idl-promise
I.Promise:~WEBIDL#idl-promise
undefined:~WEBIDL#idl-undefined
unsigned short:~WEBIDL#idl-unsigned-short

I.DOMException:~WEBIDL#idl-DOMException
I.Document:~DOM4#concept-document
I.Document:~DOM4#document
	？I.Document:~HTMLdom#document
I.EventHandler:~WAPI#eventhandler
I.EventTarget:~DOM4#eventtarget
	I.Screen:~TR/cssom-view-1/#screen
I.Screen:~CSSOMVIEW#screen
I.Window:~WINDOW#window

I.ScreenOrientation:#dom-screenorientation
I.OrientationLockType:#dom-orientationlocktype
I.OrientationType:#dom-orientationtype

	ScreenOrientation
m.lock:#dom-screenorientation-lock
m.unlock:#dom-screenorientation-unlock
m.type:#dom-screenorientation-type
m.angle:#dom-screenorientation-angle
m.onchange:#dom-screenorientation-onchange

m.orientation:#dom-screen-orientation
m.requestFullscreen:~FULLSCREEN#dom-element-requestfullscreen

	OrientationLockType
oL.any:#dom-orientationlocktype-any
oL.natural:#dom-orientationlocktype-natural
oL.landscape:#dom-orientationlocktype-landscape
oL.portrait:#dom-orientationlocktype-portrait
oL.portrait-primary:#dom-orientationlocktype-portrait-primary
oL.portrait-secondary:#dom-orientationlocktype-portrait-secondary
oL.landscape-primary:#dom-orientationlocktype-landscape-primary
oL.landscape-secondary:#dom-orientationlocktype-landscape-secondary

	OrientationType
oT.portrait-primary:#dom-orientationtype-portrait-primary
oT.portrait-secondary:#dom-orientationtype-portrait-secondary
oT.landscape-primary:#dom-orientationtype-landscape-primary
oT.landscape-secondary:#dom-orientationtype-landscape-secondary

sl.orientationLock:#dfn-orientationlock
sl.orientationPendingPromise:#dfn-orientationpendingpromise
sl.angle:#dfn-angle
sl.type:#dfn-type

et.orientationchange:~COMPAT#event-orientationchange

	●用語
縦置き方位:#dfn-portrait
横置き方位:#dfn-landscape
自然な方位:#dfn-natural
全~方位:#dfn-any
	縦置き:#dfn-portrait
	横置き:#dfn-landscape
	自然:#dfn-natural
首-方位:#dfn-primary
	横置き首-方位:#dfn-primary
	縦置き首-方位:#dfn-primary
副-方位:#dfn-secondary
	横置き副-方位:#dfn-secondary
	縦置き副-方位:#dfn-secondary

既定の~screen方位:#dfn-default-screen-orientation
現在の方位~種別:#dfn-current-orientation-type
現在の方位~角度:#dfn-current-orientation-angle
~screen方位~値~表:#dfn-screen-orientation-values-table
事前~lock条件:#dfn-pre-lock-conditions
方位~lock:#dfn-orientation-lock
方位~情報を更新する:#dfn-update-the-orientation-information
方位を~lockする:#dfn-lock-the-orientation
作動中の方位~lock:#dfn-active-orientation-lock
利用者が生成した方位~変更により誘発された:#dfn-triggered-by-a-user-generated-orientation-change
方位~obj:#_orientation-object
子孫~閲覧~文脈:#dfn-descendant-browsing-context
子孫~文書~群:#_descendant-documents
~lockする:#dfn-lock-the-screen-orientation
~screen方位を~lockする:#dfn-lock-the-screen-orientation
~screen方位:#dfn-screen-orientations

OrientationLockType:#dfn-orientationlocktype
OrientationType:#dfn-orientationtype

	●用語（外部

解決する:~WEBIDLjs#resolve
却下する:~WEBIDLjs#reject
新たな~promise:~WEBIDLjs#a-new-promise
却下される~promise:~WEBIDLjs#a-promise-rejected-with
コレ:~WEBIDL#this
~THROW:~WEBIDL#dfn-throw

~UA:~INFRA#user-agent
~EACH:~INFRA#list-iterate
有順序~集合:~INFRA#ordered-set

~eventを発火する:~DOM4#concept-event-fire
文書:~DOM4#concept-document
	？文書:~HTMLdom#document
作動中の文書:~BROWSERS#active-document
作動中の~window:~BROWSERS#active-window
先祖~閲覧~文脈:~BROWSERS#ancestor-browsing-context
閲覧~文脈:~BROWSERS#browsing-context
属する閲覧~文脈:~BROWSERS#concept-document-bc
全部的に作動中:~BROWSERS#fully-active
~top-level閲覧~文脈:~BROWSERS#top-level-browsing-context
閲覧~文脈~容器:~BROWSERS#browsing-context-container

~task:~WAPI#concept-task
大域~taskを~queueする:~WAPI#queue-a-global-task
~taskを~queueする:~WAPI#queue-a-task
~DOM操作~task源:~WAPI#dom-manipulation-task-source
~event~handler~event型:~WAPI#event-handler-event-type
~event~handler:~WAPI#event-handlers
関連な大域~obj:~WAPI#concept-relevant-global

結付けられている文書:~WINDOW#concept-document-window
並列的:~HTMLINFRA#in-parallel
閲覧~文脈~sandbox化( 方位~lock )~flag:~ORIGIN#sandboxed-orientation-lock-browsing-context-flag
子孫~閲覧~文脈~list:~BROWSERS#list-of-the-descendant-browsing-contexts

doc.可視性~状態:~HTMLinteraction#visibility-state

本質的:~TR/WCAG21/#dfn-essential

~animation~frame:~WANIM#animation-frame
	~animation~frame:~TR/web-animations-1/#animation-frame

	●用例（補完
0.requestFullscreen:~FULLSCREEN#dom-element-requestfullscreen
0.orientation:#dom-screen-orientation
0.lock:#dom-screenorientation-lock
0.unlock:#dom-screenorientation-unlock
0.screen:~CSSOMVIEW#dom-window-screen
0.fullscreenElement:~FULLSCREEN#dom-document-fullscreenelement
0.documentElement:~DOM4#dom-document-documentelement
0.addEventListener:~DOM4#dom-eventtarget-addeventlistener
0.getElementById:~DOM4#dom-nonelementparentnode-getelementbyid

	●●●●旧
	I.Screen:#dom-screen
	~list:~INFRA#list
作動中の~sandbox法~flag集合:~BROWSERS#active-sandboxing-flag-set
~navigate:~NAVI#navigate

	●他

●●words_table1
APPMANIFEST:appmanifest-ja.html
COMPAT:compat-ja.html

●●words_table

	●方位／UI／機器
副-:secondary::~
首-:primary::~
時計回り:clockwise::~
反時計回り:counterclockwise:~
回転-:rotate::~
回転:rotation::~
	回した／回され:-turn
	反対の:opposite
	ではない方:opposite
横置き:landscape:::~
	各種~機器どうし:cross-devices
縦置き:portrait:::~
	~lock法:locking
unlock::::アンロック
	unlockする::::ロックを外す
	~unlock法:unlocking
pre-lock
gesture::::ジェスチャ
desktop::::デスクトップ
fullscreen::::全スクリーン
	~click::::クリック
	可視でない:non-visible
装着-:mount::~
描かれ:drawされ::~
度d:degree:deg:度°
	度d数:degrees

	^en:upright
対面-:face:~
	手:hand

	●IDL／型／構造
列挙:enum::~

	●処理一般
稼働時:runtime::~

	-:sub-steps
	%現在の~lock~promise:currentLockPromise
	%子孫~文書~群:descendantDocs
	%子孫~文書:doc
	%方位~lock種別:orientation
	%方位~lock:-
	%方位~種別:-

	取得子~手続き:When getting
	~method手続き:When 〜 is invoked, the user agent MUST
	~~戻す:return
	これまでに:previously-

	●仕様
達成基準:Success Criterion:~
末端-:end:~:::エンド
見做そう:assumeしよう:~
	どう見做そうが:Any assumption
順応-:adapt:~
助言-:advise:~
補う:compensateする:~
保つ:keepする:~

	~program的:programmatical
	共同で:in concert with
	なり得る:can be a potential
	よって:hence
	満たす:meet
	問わず:irrespective
	間違い:wrong
	〜ではなく:as opposed to
	効く:in place
	でなくなった:stop being
	事前-条件:precondition
	必ず〜して:making sure
	-:is going to
	$r:Web Application Manifest
	$r:Web Content Accessibility Guidelines (WCAG) 2.1

	●未分類
車椅子:wheelchair:~
arm::::アーム
game::::ゲーム
	game:computer game
排他的:exclusive::~
固定的:fixed:~
cell::::セル

	~~移行:go into
	~web~site:website
	等しく:equal
	表:table
	-:assign
	-:computing
	一部:part of
	初回:first-time
	最後に:latest
	次回の:next
	より大きい:greater


●●ref_normative

[cssom-view]
    ＜CSSOM View Module＞. Simon Pieters.  W3C. 17 March 2016. W3C Working Draft. URL: https://www.w3.org/TR/cssom-view-1/
[dom]
    ＜DOM Standard＞. Anne van Kesteren.  WHATWG. Living Standard. URL: https://dom.spec.whatwg.org/
[html]
    ＜HTML Standard＞. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[infra]
    ＜Infra Standard＞. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: https://infra.spec.whatwg.org/
[RFC2119]
    ＜Key words for use in RFCs to Indicate Requirement Levels＞. S. Bradner.  IETF. March 1997. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc2119
[RFC8174]
    ＜Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words＞. B. Leiba.  IETF. May 2017. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc8174
[web-animations]
    ＜Web Animations＞. Brian Birtles; Robert Flack; Stephen McGruer; Antoine Quint.  W3C. 8 September 2022. W3C Working Draft. URL: https://www.w3.org/TR/web-animations-1/
[WEBIDL]
    ＜Web IDL Standard＞. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: https://webidl.spec.whatwg.org/

●●ref_informative

[appmanifest]
    ＜Web Application Manifest＞.
 Marcos Caceres; Kenneth Christiansen; Matt Giuca; Aaron Gustafson; 
Daniel Murphy; Anssi Kostiainen.  W3C. 17 February 2022. W3C Working 
Draft. URL: https://www.w3.org/TR/appmanifest/
[WCAG21]
    ＜Web Content Accessibility Guidelines (WCAG) 2.1＞. Andrew Kirkpatrick; Joshue O'Connor; Alastair Campbell; Michael Cooper.  W3C. 5 June 2018. W3C Recommendation. URL: https://www.w3.org/TR/WCAG21/


●●trans_metadata
<p>
~THIS_PAGEは、~W3Cにより編集者草案として公開された
<a href="~SPEC_URL">The Screen Orientation API</a>
を日本語に翻訳したものです。
~PUB
</p>

●●spec_metadata

最新公表バージョン
	https://www.w3.org/TR/screen-orientation/
公表履歴
	https://www.w3.org/standards/history/screen-orientation
編集者草案
	https://w3c.github.io/screen-orientation/

テスト一式
	https://w3c-test.org/screen-orientation/
編集
	Marcos Cáceres (Apple Inc.)
フィードバック
	<a href="https://github.com/w3c/screen-orientation/">GitHub w3c/screen-orientation</a> (<a href="https://github.com/w3c/screen-orientation/pulls/">pull requests</a>, <a href="https://github.com/w3c/screen-orientation/issues/new/choose">new issue</a>, <a href="https://github.com/w3c/screen-orientation/issues/">open issues</a>)
ブラウザサポート
	https://caniuse.com/screen-orientation
commit 履歴
	https://github.com/w3c/screen-orientation/commits/
公表者
	<a href="https://www.w3.org/groups/wg/webapps">Web Applications WG</a>
</script>

</head>
<body>
<header>
	<hgroup>
<h1>The Screen Orientation API</h1>
	</hgroup>
</header>

<hr>

<div id="MAIN" hidden>
	<section id="abstract">
~ABSTRACT

<p>
`Screen Orientation API^cite
【 “~screen方位~API” 】は、
~web~app用に，機器の現在の~screen方位の種別と角度を公開する。
また、
機器の~screen方位が変化したときには~eventを配送する。
これは、［
多くのアリな~screen方位~用に，利用者~体験を~program的に順応すること
］を~CSSとの共同で~web~appに許容する。
この~APIは、［
~supportされる
］かつ［
ある種の事前-条件が満たされる
］ならば，~screen方位を~lockする能も供する。
これは、［
利用者が機器を物理的に回転しても，~screen方位~自体は変化してはならない
］ような，~gameなどの~appにて有用になる。
◎
For web applications, the Screen Orientation API exposes the type and angle of a device's current screen orientation, and dispatches events if the device's screen orientation changes. This allows web applications to programmatically adapt the user experience for many possible screen orientations in concert with CSS. If supported and if certain preconditions are met, the API also provides the ability to lock the screen orientation. This is useful in applications such as computer games where users physically rotate the device but the screen orientation itself mustn't change.
</p>

	</section>
	<section id="sotd">
~STATUSofTHIS

<p>
これは、
編集者草案の公な複製です…
【以下、この節の内容は，~SOTD-W3Cに移譲。】
</p>

	</section>

<main id="MAIN0">

	<section id="_conventions">
<h2>【この訳に特有な表記規約】</h2>

<p>
この訳の，~algoや定義の記述に利用されている各種記号（ ~LET, ~EQ, ~IF, ~EACH (…), ~RET, 等々）の意味や定義の詳細は、
~SYMBOL_DEF_REFを~~参照されたし。
</p>

<p>
この仕様が対象にする`文書$は、
次を満たすものに限られる
⇒
それが`属する閲覧~文脈$ ~NEQ ~NULL
</p>

	</section>
	<section id="examples">
<h2 title="Examples">1. 例</h2>

~INFORMATIVE

		<section id="locking-to-a-specific-orientation-and-unlocking">
<h3 title="Locking to a specific orientation and unlocking">1.1. 特定の方位への~lock法と~unlock法</h3>

<div class="example" id="example-1">
<p>
この例では、
“~lockする” ~buttonを~clickすると，
~fullscreenへ~~移行するよう要請してから，~screenを反対の方位
【横置きなら縦置き, 縦置きなら横置き】
に~lockする。
“~unlockする” ~buttonを~clickすると，
~screenを~unlockする。
◎
In this example clicking the "Lock" button requests to go into fullscreen and then locks the screen to the opposite orientation. clicking the "unlock" button unlocks the screen.
◎
Example 1
</p>

<pre>&lt;script&gt;
function updateLockButton() {
  const %lockButton = document.`getElementById$0("button");
  const %buttonOrientation = getOppositeOrientation();
  %lockButton.textContent = ``^${%buttonOrientation} に~lockする``^;
}

function getOppositeOrientation() {
  const { %type } = `screen$0.`orientation$0;
  return %type.startsWith("portrait") ? "landscape" : "portrait";
}

async function rotate(%lockButton) {
  if (!document.`fullscreenElement$0) {
    await document.`documentElement$0.`requestFullscreen$0();
  }
  const %newOrientation = getOppositeOrientation();
  await `screen$0.`orientation$0.`lock$0(%newOrientation);
  updateLockButton(%lockButton);
}

`screen$0.`orientation$0.`addEventListener$0("change", updateLockButton);

window.addEventListener("load", updateLockButton);
&lt;/script&gt;

&lt;button onclick="rotate(this)" id="button"&gt;
  ~lockする
&lt;/button&gt;
&lt;button onclick="`screen$0.`orientation$0.`unlock$0()"&gt;
  ~unlockする
&lt;/button&gt;
</pre>
</div>

		</section>
	</section>
	<section id="concepts">
<h2 title="Concepts">2. 概念</h2>

<p id="dfn-associated-screen">
各 `Window$I ~objには、
ある `Screen$I ~objが結付けられる。
`Window$I ~objの
`方位~obj@
は、
この `Screen$I ~objの `orientation$m 属性にあてがわれる `ScreenOrientation$I ~objを指す。
◎
The Window object has an associated Screen, which is a Screen object.
</p>

<p class="trans-note">【
`方位~obj$（この訳による追加）は、
他所を簡潔に述べるために導入している。
】</p>

<p>
所与の
`閲覧~文脈$ %A, %B に対し，
%A は %B の
`子孫~閲覧~文脈@
であるとは、
%B は %A の`先祖~閲覧~文脈$であることをいう。
◎
A browsing context A is called a descendant browsing context of a browsing context B if and only if B is an ancestor browsing context of A.
</p>

<p>
所与の`文書$ %文書 の
`子孫~文書~群@
は、
%文書 が`属する閲覧~文脈$の各`子孫~閲覧~文脈$にて`作動中の文書$からなる，~tree順序による`有順序~集合$である。
</p>

<p class="trans-note">【
この用語（この訳による追加）は、
他所を簡潔に述べるために導入している。
“~tree順序” は、
`閲覧~文脈$の`閲覧~文脈~容器$に基づく。
`子孫~閲覧~文脈~list$と同義にも見えるが、
その定義と同じく~shadow~treeも織り込まれるかどうかは，定かでない。
】</p>

		<section id="screen-orientation-types-and-locks">
<h3 title="Screen orientation types and locks">2.1. ~screen方位の種別と~lock</h3>

<p>
%文書 の~screen方位を ある %方位 に
`~lockする@
とは、
利用者は~screenを特定の方位（たち）にしか回転できないことを意味する。
例えば，方位を`横置き方位$に~lockするとは、
利用者は~screenを`縦置き方位$ではない方位
— `landscape-primary$oT, `landscape-secondary$oT —
に回転できることを意味する。
◎
To lock the screen orientation to an orientation means that the screen can only be rotated by the user to specific orientations (possibly at the exclusion of other orientations). For example, locking the orientation to landscape means that the screen can be rotated by the user to landscape-primary and landscape-secondary, and not to any portrait orientation.
</p>

<p>
~screenは、
次に挙げるいずれかの
`~screen方位@
［
をとり得る／に~lockされ得る
］：
◎
A screen can be in or locked to one of the following screen orientations:
</p>
<dl>
	<dt>
`自然な方位@
（ `natural^en ）
◎
Natural:
</dt>
	<dd>
利用者が機器を［
~viewする／保持する
］とき，最も自然とされる方位であり、
下層の~OSにより決定される。
例えば、
~screenに対面している利用者が，自身の手で機器を `upright^en† に［
~viewして／保持して
］いるとき。
【† よくあるスマホなら縦に, 等々。】
◎
The most natural orientation of the device if it was viewed or held by the user, as determined by the underlying operating system. For example, a device viewed, or held upright in the user's hand, with the screen facing the user.
</dd>
	<dt>
`横置き方位@
（ `landscape^en ）
◎
Landscape:
</dt>
	<dd>
~screenの横幅は縦幅より大きい。
◎
The screen's width is greater than the height.
</dd>
	<dt>
`縦置き方位@
（ `portrait^en ）
◎
Portrait:
</dt>
	<dd>
~screenの縦幅は横幅より大きい。
◎
The screen's height is greater than the width.
</dd>
	<dt>
`首-方位@
（ `primary^en ）
◎
Primary:
</dt>
	<dd>
機器の~screenは［
`縦置き方位$／`横置き方位$
］用の`自然な方位$にある。
◎
The device's screen natural orientation for either portrait or landscape.
</dd>
	<dt>
`副-方位@
（ `secondary^en ）
◎
Secondary:
</dt>
	<dd>
機器の~screenは［
`縦置き方位$／`横置き方位$
］用の`首-方位$ではない方にある。
◎
The opposite of the device's screen primary orientation for portrait or landscape.
</dd>
	<dt>
`全~方位@
（ `any^en ）
◎
Any:
</dt>
	<dd>
利用者は~screenを［
機器の~OS／末端-利用者
］により許容される どの方位にも回転できる。
◎
The screen can be rotated by the user to any orientation allowed by the device's operating system or by the end-user.
</dd>
	<dt>
`既定の~screen方位@
◎
The default screen orientation:
</dt>
	<dd>
`作動中の方位~lock$が無い
（すなわち，方位は “~unlockされて” いる）
とき
【すなわち， `orientationLock$sl ~EQ ~NULL のとき】
に~screenが~lockされる方位。
この方位は、［
機器の~OS／~UA
］により決定されるか
（例：`§ Web Application Manifest との相互作用＠#interaction-with-web-application-manifest$ ），
末端-利用者により制御される。
◎
The orientation to which the screen is locked when there is no active orientation lock (i.e., the orientation is "unlocked"). This orientation is determined by the device's operating system, or the user agent (e.g., 9.2 Interaction with Web Application Manifest), or controlled by the end-user.
</dd>
</dl>

		</section>
		<section id="the-current-screen-orientation-type-and-angle">
<h3 title="The current screen orientation type and angle">2.2 現在の~screen方位の種別と角度</h3>

<p>
出力~機器の~screenには、
`現在の方位~種別@
,
`現在の方位~角度@
がある。
これらの値を導出するため、
`~UA$は，`閲覧~文脈$が作成されたときには`方位~情報を更新する$モノトスル。
その際には、
`現在の方位~種別$と`現在の方位~角度$の関係性が一貫するように保つモノトスル。
◎
The screen of the output device has a current orientation type and a current orientation angle. To derive these values, the user agent MUST update the orientation information when a browsing context is created. The relationship between the current orientation type and the current orientation angle MUST be kept consistent.
</p>

<p>
［
`現在の方位~種別$, `現在の方位~角度$
］用にアリな値は、
次の`~screen方位~値~表$に呈示される。
この表は、［
機器の`自然な方位$により決定される［
首-, 副-
］方位~値（ “1” ）
］, および［
もう一方の［
首-, 副-
］方位~値（ “2” ）を設定するために`~UA$に可用な可能性
］を指定する：
◎
The screen orientation values table presents the possible value for the current orientation type and current orientation angle. The table specifies the primary and secondary values that are determined by the device's natural orientation and the possibilities available to the user agent for setting the other primary and secondary orientation values.
</p>

<div>
<table>
<caption>
`~screen方位~値~表@
<p>
† 副-方位 2 にあてがう角度は、
首-方位 2 に利用されない方を選ぶとする。
</p>
</caption>

<thead><tr>
<th>`自然な方位$
<th>`首-方位$ 1
<th>`副-方位$ 1
<th>`首-方位$ 2
<th>`副-方位$ 2
</thead><tbody>

<tr><td>`縦置き方位$
<td class="preline">`portrait-primary$oT,
角度 0
<td class="preline">`portrait-secondary$oT,
角度 180
<td class="preline">`landscape-primary$oT,
角度［ 90 ／ 270 ］
<td class="preline">`landscape-secondary$oT,
角度［ 270 ／ 90 ］†
<tr><td>`横置き方位$
<td class="preline">`landscape-primary$oT,
角度 0
<td class="preline">`landscape-secondary$oT,
角度 180
<td class="preline">`portrait-primary$oT,
角度［ 90 ／ 270 ］
<td class="preline">`portrait-secondary$oT
角度［ 270 ／ 90 ］†
</tbody></table>

◎
The screen orientation values table
◎
In the natural orientation is...｜Primary Orientation 1｜Secondary Orientation 1｜Primary Orientation 2｜Secondary Orientation 2
Portrait｜portrait-primary
angle 0｜portrait-secondary
angle 180｜landscape-primary
angle 90 or angle 270｜landscape-secondary
Set at the angle not used for landscape-primary
Landscape｜landscape-primary
angle 0｜landscape-secondary
angle 180｜portrait-primary
angle 90 or angle 270｜portrait-secondary
The angle not used for portrait-primary.
</div>

<div class="advisement">
<p id="bp-angle-and-type-relationship">
最善な実施
— `angle$m と `type$m の関係性
⇒
~screen方位の［
種別, 角度
］の間に，機器どうしで関係性があるものとは、
決して見做さないこと。
どう見做そうが間違いになる
— ある機器における種別 `landscape^oT 用の角度は［
90 ／ 270
］であっても、
別の機器においては`自然な方位$に依存して［
0 または 180
］になるかもしれない。
代わりに，［
角度, 種別
］の関係性は、
稼働時に検査することが推奨される。
◎
Best Practice 1: angle and type relationship
◎
Never assume any cross-devices relationship between the screen orientation type and the screen orientation angle. Any assumption would be wrong given that a device might have 90 and 270 as the angles for landscape types but another device will have 0 and 180, depending on its natural orientation. Instead, it is recommended to check during runtime the relationship between angle and type.
</p>
</div>

		</section>
		<section id="locking-the-screen-orientation">
<h3 title="Locking the screen orientation">2.3 ~screen方位の~lock法</h3>

<p>
`~UA$は、
`方位~lock$を許容するための
`事前~lock条件@
を要求してもヨイ
— それは、
~screen方位を`~lockする$ために［
`文書$, それが`属する閲覧~文脈$
］が満たす必要がある条件を与える。
例えば，
`§ Fullscreen API との相互作用＠#interaction-with-fullscreen-api$を見よ。
◎
The user agent MAY require a Document and its associated browsing context to meet one or more pre-lock conditions in order to lock the screen orientation in order to allow an orientation lock. See, for example, 9.1 Interaction with Fullscreen API).
</p>

<p>
`~UA$は、
~platform規約にて［
~appは~screen方位を変更-可能である
］ものと期待されていない場合には，
~screen方位を~lockしようとする どの試みも却下してヨイ。
例えば，ほとんどの~desktop~platformでは、
~appは~screen方位を変更し得ない。
◎
The user agent MAY reject all attempts to lock the screen orientation if the platform conventions do not expect applications to be able to change the screen orientation. For example, on most desktop platforms, applications can not change the screen orientation.
</p>

		</section>
	</section>
	<section id="extensions-to-the-screen-interface">
<h2 title="Extensions to the Screen interface">3. `Screen^I ~interfaceに対する拡張</h2>

<pre class="idl">
partial interface `Screen$I {
  [`SameObject$] readonly attribute `ScreenOrientation$I `orientation@m;
};
</pre>

	</section>
	<section id="screenorientation-interface">
<h2 title="ScreenOrientation interface">4. `ScreenOrientation^I ~interface</h2>

<pre class="idl">
[`Exposed$=Window]
interface `ScreenOrientation@I : `EventTarget$I {
  `Promise$&lt;`undefined$&gt; `lock$m(`OrientationLockType$I %orientation);
  `undefined$ `unlock$m();
  readonly attribute `OrientationType$I `type$m;
  readonly attribute `unsigned short$ `angle$m;
  attribute `EventHandler$I `onchange$m;
};
</pre>

		<section id="internal-slots">
<h3 title="Internal Slots">4.1. 内部~slot</h3>

<p>
◎
Internal Slot 	Description
</p>
<dl>
	<dt>
`angle@sl
</dt>
	<dd>
~screenの`現在の方位~角度$を `unsigned short^c 型の度d数として与える。
◎
The current orientation angle in degrees as an unsigned short.
</dd>

	<dt>
`type@sl
</dt>
	<dd>
~screenの`現在の方位~種別$
— `OrientationType$I 列挙~値として表現される。
◎
The current orientation type of the screen, represented as an OrientationType enum value.
</dd>
</dl>

		</section>
		<section id="lock-method">
<h3 title="lock() method">4.2. `lock()^m ~method</h3>

<div class="algo">
<p>
`lock(orientation)@m
~method手続きは：
`lock-bad-argument^test
`lock-basic^test
◎
When the lock() method is invoked, the user agent MUST run the the following steps.
</p>
<ol>
	<li>
%文書 ~LET コレに`関連な大域~obj$に`結付けられている文書$
◎
Let document be this's relevant global object's associated Document.
</li>
	<li>
~IF［
%文書 は`全部的に作動中$でない
］
⇒
~RET `InvalidStateError$E 例外で`却下される~promise$
◎
If document is not fully active, return a promise rejected with an "InvalidStateError" DOMException.
</li>
	<li>
~IF［［
これまでに確立された利用者~選好,
~security~risk,
~platform制限
］いずれかに因り，`~UA$は~screen方位の~lock法を~supportしない
］
⇒
~RET `NotSupportedError$E 例外で`却下される~promise$
◎
If the user agent does not support locking the screen orientation due to previously-established user preference, security risk, or platform limitation, return a promise rejected with a "NotSupportedError" DOMException and abort these steps.
</li>
	<li>
~IF［
`閲覧~文脈~sandbox化( 方位~lock )~flag$ ~IN %文書 にて`作動中の~sandbox法~flag集合$
］~OR［
%文書 は`事前~lock条件$を満たしていない
］
⇒
~RET `SecurityError$E 例外で`却下される~promise$
`lock-sandboxed-iframe^test
◎
If document has the sandboxed orientation lock browsing context flag set, or doesn't meet the pre-lock conditions, return a promise rejected with a "SecurityError" DOMException and abort these steps.
</li>
	<li>
<p>
~IF［
%文書 .`orientationPendingPromise$sl ~NEQ ~NULL
］：
`lock-basic^test
◎
If document's [[orientationPendingPromise]] is not null:
</p>
		<ol>
			<li>
%現在の~lock~promise ~LET %文書 .`orientationPendingPromise$sl
◎
Let currentLockPromise be document's [[orientationPendingPromise]].
</li>
			<li class="algo">
次を走らす`大域~taskを~queueする$( `~DOM操作~task源$, コレに`関連な大域~obj$ )
⇒
`AbortError$E 例外で %現在の~lock~promise を`却下する$
◎
Queue a global task on the DOM manipulation task source with this's relevant global object to reject currentLockPromise with an "AbortError" DOMException.
</li>
		</ol>
	</li>
	<li>
%文書 .`orientationPendingPromise$sl ~SET `新たな~promise$
`lock-basic^test
◎
Set document's [[orientationPendingPromise]] to a new promise.
</li>
	<li class="algo">
<p>
この段は`並列的$に走らす：
◎
↓↓ Return document's [[orientationPendingPromise]]＼
and in parallel:
</p>
		<ol>
			<li>
<p>
%文書 の`子孫~文書~群$を成す
~EACH( %子孫~文書 )
に対し：
◎
Let descendantDocs be an ordered set consisting of documents's descendant browsing contexts' active documents, if any, in tree order.
◎
For each doc in descendantDocs:
</p>
				<ol>
					<li>
~IF［
%子孫~文書 .`orientationPendingPromise$sl ~EQ ~NULL
］
⇒
~CONTINUE
◎
If doc [[orientationPendingPromise]] is null, continue.
</li>
					<li class="algo">
<p>
次を走らす`大域~taskを~queueする$( `~DOM操作~task源$, %子孫~文書 に`関連な大域~obj$ )：
◎
Queue a global task on the DOM manipulation task source with doc's relevant global object to:
</p>
						<ol>
							<li>
`AbortError$E 例外で %子孫~文書 .`orientationPendingPromise$sl を`却下する$
◎
Reject doc's [[orientationPendingPromise]] with "AbortError" DOMException.
</li>
							<li>
%子孫~文書 .`orientationPendingPromise$sl ~SET ~NULL
◎
Set doc's [[orientationPendingPromise]] to null.
</li>
						</ol>
					</li>
				</ol>
			</li>
			<li>
`方位を~lockする$( %文書, %orientation )
◎
Lock the orientation of document to orientation.
</li>
			<li>
<p>
~IF［
%文書 は`全部的に作動中$でなくなった
］：
</p>
				<ol>
					<li class="algo">
次を走らす`大域~taskを~queueする$( `~DOM操作~task源$, コレに`関連な大域~obj$ )
⇒
`AbortError$E 例外で %文書 .`orientationPendingPromise$sl を`却下する$
</li>
				</ol>
◎
If document stops being fully active, queue a global task on the DOM manipulation task source with this's relevant global object to reject [[orientationPendingPromise]] with an "AbortError" DOMException.
</li>
		</ol>
	</li>
	<li>
~RET %文書 .`orientationPendingPromise$sl
◎
↑↑</li>
</ol>

<p class="note">注記：
方位を~lockした結果，方位が変化する場合、
この~promiseは，方位が変化するときに解決されることになる。
◎
Note
If locking the orientation results in an orientation change, the promise will be resolved when the orientation changes.
</p>
</div>

		</section>
		<section id="unlock-method">
<h3 title="unlock() method">4.3. `unlock()^m ~method</h3>

<div class="algo">
<p>
`unlock()@m
~method手続きは：
◎
When the unlock() method is invoked, the user agent MUST run the following steps:
</p>
<ol>
	<li>
%文書 ~LET コレに`関連な大域~obj$に`結付けられている文書$
【この段は、この訳による補完】
</li>
	<li>
~IF［
%文書 は`全部的に作動中$でない
］
⇒
~THROW `InvalidStateError$E
◎
If document is not fully active, throw an "InvalidStateError" DOMException.
</li>
	<li>
%文書 の~screen方位を`既定の~screen方位$に`~lockする$
◎
Lock the screen orientation of this's relevant global object's associated Document to the default screen orientation.
</li>
</ol>
</div>

<p class="note">注記：
`unlock()$m が~promiseを返さないのは、
それが`既定の~screen方位$に~lockすることに等価であり，
その方位は`~UA$に既知でないこともあるからである。
よって，~UAは、
新たに どの方位になるのか
— さらには、
方位が変化するかどうかさえも —
予測できない。
◎
Note: Why does unlock() not return a promise?
◎
unlock() does not return a promise because it is equivalent to locking to the default screen orientation which might or might not be known by the user agent. Hence, the user agent can not predict what the new orientation is going to be and even if it is going to change at all.
</p>

		</section>
		<section id="type-attribute">
<h3 title="type attribute">4.4. `type^m 属性</h3>

<div class="algo">
<p>
`type@m
取得子~手続きは
⇒
~RET コレ.`type$sl
◎
When getting, return this's [[type]].
</p>
</div>

		</section>
		<section id="angle-attribute">
<h3 title="angle attribute">4.5. `angle^m 属性</h3>

<div class="algo">
<p>
`angle@m
取得子~手続きは
⇒
~RET コレ.`angle$sl
◎
When getting, return this's [[angle]].
</p>
</div>

<p class="note">注記：
この属性は、
利用者が機器を自然な方位から反時計回りに，どれだけ回したかを表現する。
利用者が反時計回りに 90度d回転したなら、
それを補うように，~screenは 90度d時計回りに回転されるので、
`angle$m は 90 を返す。
◎
Note: What does the value given for angle represent?
◎
angle represents how far the user has turned the device counterclockwise from the natural orientation. When the device is rotated 90° counterclockwise, the screen compensates by rotating 90° clockwise, so angle returns 90.
</p>

<p>
機器がどう回転されたかに依存して角度がどう変化するかは、
`~screen方位~値~表$に示される。
◎
The screen orientation values table shows how the angle changes depending on the how the device is rotated.
</p>

		</section>
		<section id="onchange-attribute">
<h3 title="onchange attribute">4.6. `onchange^m 属性</h3>

<p>
`onchange@m
属性は、
`~event~handler$であり，
対応する`~event~handler~event型$は `change^et である。
◎
The onchange attribute is an event handler whose corresponding event handler event type is "change".
</p>

		</section>
	</section>
	<section id="orientationlocktype-enum">
<h2 title="OrientationLockType enum">5. `OrientationLockType^I 列挙</h2>

<pre class="idl">
enum `OrientationLockType@I {
  `any$oL,
  `natural$oL,
  `landscape$oL,
  `portrait$oL,
  `portrait-primary$oL,
  `portrait-secondary$oL,
  `landscape-primary$oL,
  `landscape-secondary$oL
};
</pre>

<p>
`OrientationLockType$I 列挙は、
~screenを どの~screen方位に回転できるかを表現する：
◎
The OrientationLockType enum represents the screen orientations to which a screen can be rotated.
</p>

<div>
<table><thead><tr>
<th>値
<th>表現する方位
</thead><tbody>

<tr><td>`any@oL
<td>`全~方位$

<tr><td>`natural@oL
<td>`自然な方位$

<tr><td>`landscape@oL
<td>`横置き方位$

<tr><td>`portrait@oL
<td>`縦置き方位$

<tr><td>`portrait-primary@oL
<td>`縦置き方位$かつ`首-方位$

<tr><td>`portrait-secondary@oL
<td>`縦置き方位$かつ`副-方位$

<tr><td>`landscape-primary@oL
<td>`横置き方位$かつ`首-方位$

<tr><td>`landscape-secondary@oL
<td>`横置き方位$かつ`副-方位$
</tbody></table>

◎
"any" enum value represents the any orientation,
◎
"natural" enum represents the natural orientation,
◎
"landscape" enum represents the landscape orientation,
◎
"portrait" enum represents the portrait orientation,
◎
"portrait-primary" enum represents the portrait-primary orientation,
◎
"portrait-secondary" enum represents the portrait-secondary orientation,
◎
"landscape-primary" enum represents the landscape-primary orientation,
◎
"landscape-secondary" enum represents the landscape-secondary orientation.
</div>

	</section>
	<section id="orientationtype-enum">
<h2 title="OrientationType enum">6. `OrientationType^I 列挙</h2>

<pre class="idl">
enum `OrientationType@I {
  `portrait-primary$oT,
  `portrait-secondary$oT,
  `landscape-primary$oT,
  `landscape-secondary$oT
};
</pre>

<p>
`OrientationType$I 列挙は、
現在の実際の~screen方位を表現する
— ~screenにどの~lockが適用されたかを問わず：
◎
The OrientationType enum represents the actual current screen orientation that the screen is in irrespective of which lock is applied.
</p>

<div>
<table><thead><tr>
<th>値
<th>表現する方位
</thead><tbody>

<tr><td>`portrait-primary@oT
<td>`縦置き方位$かつ`首-方位$

<tr><td>`portrait-secondary@oT
<td>`縦置き方位$かつ`副-方位$

<tr><td>`landscape-primary@oT
<td>`横置き方位$かつ`首-方位$

<tr><td>`landscape-secondary@oT
<td>`横置き方位$かつ`副-方位$
</tbody></table>

◎
"portrait-primary" enum represents the portrait-primary orientation,
◎
"portrait-secondary" enum represents the portrait-secondary orientation,
◎
"landscape-primary" enum represents the landscape-primary orientation,
◎
and the "landscape-secondary" enum represents the landscape-secondary orientation.
</div>

	</section>
	<section id="extensions-to-the-document-interface">
<h2 title="Extensions to the Document interface">7. `Document$I ~interfaceに対する拡張</h2>

		<section id="internal-slots-0">
<h3 title="Internal Slots">7.1. 内部~slot</h3>

<p>
◎
Internal Slot 	Description
</p>
<dl>
	<dt>
`orientationLock@sl
</dt>
	<dd>
~NULL ／
`作動中の方位~lock$を与える `OrientationLockType$I 列挙~値
◎
The [[orientationLock]] is the active orientation lock as a OrientationLockType or null.
</dd>

	<dt>
`orientationPendingPromise@sl
</dt>
	<dd>
~NULL ／
~supportされるいずれかの方位に~screenを~lockする要請を表現する `Promise$I
◎
Either null or a Promise. When assigned a Promise, that promise represents a request to lock the screen orientation.
</dd>
</dl>

		</section>
	</section>
	<section id="algorithms">
<h2 title="Algorithms">8. ~algo</h2>

		<section id="updating-the-orientation-information">
<h3 title="Updating the orientation information">8.1 方位~情報の更新-法</h3>

<div class="algo">
<p>
`方位~情報を更新する@
ときは、
所与の
( `閲覧~文脈$ %文脈 )
に対し：
`orientation-reading^test
◎
The steps to update the orientation information of a browsing context context:
</p>
<ol>
	<li>
%方位 ~LET %文脈 の`~screen方位$に合致する `OrientationType$I 列挙~値
◎
Let orientation be the OrientationType enum that matches the screen orientation of context.
</li>
	<li>
%角度 ~LET `~screen方位~値~表$にて %方位 に合致する角度
`orientation-reading^test
◎
Let angle be the angle that matches the orientation from the screen orientation values table.
</li>
	<li>
%方位~obj ~LET %文脈 にて`作動中の~window$の`方位~obj$
◎
↓</li>
	<li>
%方位~obj .`type$sl ~SET %方位
◎
Set associated Screen's ScreenOrientation's' [[type]] internal slot to orientation.
</li>
	<li>
%方位~obj .`angle$sl ~SET %角度
◎
Set associated Screen's ScreenOrientation's' [[angle]] internal slot to angle.
</li>
</ol>
</div>

		</section>
		<section id="locking-the-orientation">
<h3 title="Locking the orientation">8.2 方位の~lock法</h3>

<div class="algo">
<p>
`方位を~lockする@
ときは、
所与の
( `文書$ %文書, `OrientationLockType$I 値 %方位~lock種別 )
に対し：
◎
The steps to lock the orientation of document to orientation are as follows.
</p>
<ol>
	<li>
%文書 .`orientationLock$sl ~SET %方位~lock種別
`lock-basic^test
◎
Set the Document's [[orientationLock]] to orientation.
</li>
	<li>
%方位~lock ~LET `作動中の方位~lock$()
◎
↓</li>
	<li>
<p>
~IF［
%方位~lock ~NEQ %文書 .`orientationLock$sl
］
⇒
~RET
</p>

<p class="trans-note">【
この段は余計と思われる
（さもなければ、
この~algoは，常に この段か次の段で ~RET することになる）。
】</p>
◎
If the active orientation lock is not the document's [[orientationLock]], abort these steps.
</li>
	<li>
~IF［
%方位~lock ~EQ %方位~lock種別
］
⇒
~RET
◎
If the active orientation lock value is equal to orientation value, abort these steps.
</li>
	<li>
<p>
%方位~群 ~LET %方位~lock種別 に応じて，次で与えられる集合：
</p>
		<ul class="switch">
			<li>
`any$oL
⇒
{ `portrait-primary$oT, `portrait-secondary$oT, `landscape-primary$oT, `landscape-secondary$oT }
</li>
			<li>
`natural$oL
⇒
{ `自然な方位$を表現する `OrientationType$I 列挙~値 }
</li>
			<li>
`landscape$oL
⇒
{ `landscape-primary$oT, `landscape-secondary$oT }
</li>
			<li>
`portrait$oL
⇒
{ `portrait-primary$oT, `portrait-secondary$oT }
</li>
			<li>
`portrait-primary$oL
⇒
{ `portrait-primary$oT }
</li>
			<li>
`portrait-secondary$oL
⇒
{ `portrait-secondary$oT }
</li>
			<li>
`landscape-primary$oL
⇒
{ `landscape-primary$oT }
</li>
			<li>
`landscape-secondary$oL
⇒
{ `landscape-secondary$oT }
</li>
		</ul>

<p class="trans-note">【
この段は、
原文に述べられてない %方位~群 の意味を明確化するための，この訳による追加。
】</p>

◎
↓</li>
	<li>
<p>
~IF［
%方位~群 は 1 個の値 %方位~種別 のみからなる
］：
◎
If orientations contains only one value, run the following sub-steps:
• Let orientation be the value contained in orientations.
</p>
		<ol>
			<li>
［
`現在の方位~種別$ ~EQ %方位~種別
］になるよう，
%文書 の表示域がどう描かれるかを変更する
◎
Change how the viewport is drawn so that the Document's current orientation type will be equal to orientation.
</li>
			<li>
この手続き【！those steps】が再び走るまで、
%文書 【が`属する閲覧~文脈$】の`~top-level閲覧~文脈$の~screen方位が変化するのを防止する。
◎
After the change has happened, prevent the Document's top-level browsing context's screen orientation from changing until those steps are run again.
◎
Abort these steps.
↓</li>
		</ol>
	</li>
	<li>
<p>
~ELSE：
</p>
		<ol>
			<li>
~platform規約に依存して、
%文書 の表示域の描かれ方を［
`現在の方位~種別$が変化する
］かつ［
`現在の方位~種別$ ~IN %方位~群
］になるよう変更する
◎
If the Document's current orientation type is not part of orientations, change how the viewport is drawn such as the Document's current orientation type will be equal to one of orientations' values.
◎
Otherwise, depending on platform conventions, change how the viewport is drawn in order to make it match another screen orientation type.
</li>
			<li>
この手続き【！those steps】が再び走るまで、
~screen方位を［
%方位~群 を成す ある値
］に変更することを利用者に許容する。
現在の~screen方位を定義する手法は、
~platform規約に合致する必要がある。
◎
Allow the user to change the screen orientation to any value part of orientations and only those values until those steps are run again. The method to define the current screen orientation has to match the platform conventions.
</li>
		</ol>
	</li>
</ol>
</div>

		</section>
		<section id="determining-the-active-orientation-lock">
<h3 title="Determining the active orientation lock">8.3. 作動中の方位~lockの決定-法</h3>

<p>
`方位~lock@
は、
`文書$に`作動中の方位~lock$があるときに効く。
◎
An orientation lock is in place when a document has an active orientation lock.
</p>

<div class="algo">
<p>
`作動中の方位~lock@
を決定する手続きは：
◎
The steps to determine the active orientation lock are as follows:
</p>
<ol>
	<li>
%文書~群 ~LET 次を満たす`文書$からなる集合
⇒
［
`可視性~状態$doc ~EQ `visible^l
］~AND［
`属する閲覧~文脈$は`~top-level閲覧~文脈$である
］
◎
↓</li>
	<li>
~IF［
%文書~群 を成す`文書$は 1 個だけ
］
⇒
~RET その文書 .`orientationLock$sl
◎
If there is only one top-level browsing context with a document whose visibility state is "visible", the active orientation lock is the document's [[orientationLock]].
</li>
	<li>
~IF［
%文書~群 を成す`文書$のうち~focusされているものは 1 個だけ
］
⇒
~RET その文書 .`orientationLock$sl
◎
Otherwise, if there are more than one top-level browsing context with a document that has a visibility state is "visible" but only one of those documents is focused, the [=Document/active orientation lock is the focused document's [[orientationLock]].
</li>
	<li>
~IF［
作動中の~platform規約により言明される方位がある
］
⇒
~RET その方位（たち） 
◎
↓</li>
	<li>
~RET 【 %文書~群 を成す`文書$のうち？】最後に~focusされた`文書$ .`orientationLock$sl
◎
Otherwise, the active orientation lock SHOULD be the latest focused document's [[orientationLock]], unless stated otherwise by the active platform conventions.
</li>
</ol>
</div>

<p>
`作動中の方位~lock$が変化したときは、
`~UA$は，次を走らすモノトスル
⇒
`方位を~lockする$( `文書$, `文書$ .`orientationLock$sl )
【どの文書？】
◎
Whenever the active orientation lock changes, the user agent MUST run the steps to lock the orientation of the Document to the Document's [[orientationLock]].
</p>

<p>
`~top-level閲覧~文脈$が`~navigate$されたときは、
`~UA$は，~screenを`既定の~screen方位$に~~戻すモノトスル。
◎
Whenever a top-level browsing context is navigated, the user agent MUST return the screen to the default screen orientation.
</p>

			<section id="screen-orientation-change">
<h4 title="Screen orientation change">8.3.1 ~screen方位の変化</h4>

<div class="algo">
<p>
【`文書$ %文書 の】
表示域の角度が変化したときは、
`~UA$は，次回の`~animation~frame$の一部として次の手続きを走らすモノトスル：
`onchange-event^test
◎
Whenever the viewport's angle changes, the user agent MUST run the following steps as part of the next animation frame:
</p>
<ol>
	<li>
<p>
%文書 の`子孫~文書~群$を成す
~EACH( %子孫~文書 )
に対し：
◎
Let descendantDocs be an ordered set consisting of documents's descendant browsing contexts' active documents, if any, in tree order.
◎
For each doc in descendantDocs:
</p>
		<ol>
			<li>
~IF［
%子孫~文書 の`可視性~状態$doc ~EQ `hidden^l
］
⇒
~CONTINUE【！abort these steps】
◎
If doc's visibility state is "hidden", abort these steps.
</li>
			<li>
`方位~情報を更新する$( %子孫~文書 が`属する閲覧~文脈$ )
◎
Update the orientation information of doc's browsing context.
</li>
			<li>
~IF［
この方位~変化は、
（ `lock()$m の~callではなく，）利用者の~gestureにより誘発された
（例：利用者が機器を回した）
］
⇒
この~algoを走らせている`~task$を`利用者が生成した方位~変更により誘発された$ものと注釈する
【！when running the next step】
◎
If the orientation change was triggered by a user gesture such as the user turning the device, as opposed to a call to lock(), the task MUST be annotated with process user orientation change when running the next step.
</li>
			<li class="algo">
<p>
次を走らす`~taskを~queueする$( `~DOM操作~task源$ )：
◎
Queue a task to on the DOM manipulation task source to:
</p>
				<ol>
					<li>
`~eventを発火する$( %子孫~文書 に`関連な大域~obj$の`方位~obj$, `change^et )
◎
Fire an event named change at doc's relevant global object's associated Screen's orientation attribute.
</li>
					<li>
<p>
~IF［
%子孫~文書 .`orientationPendingPromise$sl ~NEQ ~NULL
］：
◎
If doc's [[orientationPendingPromise]] is not null:
</p>
						<ol>
							<li>
`undefined^jv で %子孫~文書 .`orientationPendingPromise$sl を`解決する$
◎
Resolve doc's [[orientationPendingPromise]] with undefined.
</li>
							<li>
%子孫~文書 .`orientationPendingPromise$sl ~SET ~NULL
◎
Set doc's [[orientationPendingPromise]] to null.
</li>
						</ol>
					</li>
				</ol>
			</li>
		</ol>
	</li>
</ol>
</div>

<p>
この節の~algoを走らせている`~task$は、
`利用者が生成した方位~変更により誘発された@
ものと注釈され得る。
【この定義は、 `requestFullscreen()$m から利用される。`FULLSCREEN$r 】
◎
An algorithm is triggered by a user generated orientation change if the task in which the algorithm is running is annotated with process user orientation change.
</p>

<div class="algo">
<p>
`文書$ %文書 の`可視性~状態$doc が `visible^l になった【変化した】ときは、
`~UA$は，次回の`~animation~frame$の一部として次の手続きを走らすモノトスル：
◎
Whenever a Document's visibility state becomes "visible", the user agent MUST run the following sub-steps as part of the next animation frame:
</p>
<ol>
	<li>
%種別 ~LET `現在の方位~種別$
◎
↓</li>
	<li>
%角度 ~LET `現在の方位~角度$
◎
Let type and angle be the current orientation type and current orientation angle, respectively.
</li>
	<li>
`方位~情報を更新する$( %文書 が`属する閲覧~文脈$ )
◎
Update the orientation information of the document's browsing context.
</li>
	<li>
<p>
~IF［
%種別 ~NEQ `現在の方位~種別$
］~OR［
%角度 ~NEQ `現在の方位~角度$
］：
◎
If type is different from the current orientation type or angle from the current orientation angle, run the following sub-steps:
</p>
		<ol>
			<li>
~IF［
この方位~変化は、
（ `lock()$m の~callではなく，）利用者の~gestureにより誘発された
（例：利用者が機器を回した）
］
⇒
この~algoを走らせている`~task$を`利用者が生成した方位~変更により誘発された$ものと注釈する
【！when running the next step】
◎
If the orientation change was triggered by a user gesture such as the user turning the device, as opposed to a call to lock(), the task MUST be annotated with process user orientation change when running the next step.
</li>
			<li>
`~eventを発火する$( %文書 に`関連な大域~obj$の`方位~obj$ `change^et )
◎
Fire an event named "change" at doc's relevant global object's associated Screen's orientation attribute.
</li>
			<li>
<p>
~IF［
%文書 .`orientationPendingPromise$sl ~NEQ ~NULL
］：
◎
If the Document's [[orientationPendingPromise]] is not null:
</p>
				<ol>
					<li>
`undefined^jv で %文書 .`orientationPendingPromise$sl を`解決する$
◎
Resolve the Document's [[orientationPendingPromise]] with undefined.
</li>
					<li>
%文書 .`orientationPendingPromise$sl ~SET ~NULL
◎
Set the Document's [[orientationPendingPromise]] to null.
</li>
				</ol>
			</li>
		</ol>
	</li>
</ol>
</div>

<p class="note">注記：
開発者は、
`文書$ %文書 において［
%文書 の`可視性~状態$doc ~EQ `hidden^l
］の間は、［
%文書 に`関連な大域~obj$の`方位~obj$【！`orientation$m ~obj】
は，方位~変化~event【 `orientationchange$et 】を受取らない
］ことを自覚する必要がある。
これは、
可視でない~web~appにおける［
~layout等々に対する不必要な変化
］を防止するためである。
◎
Developers need to be aware that a orientation object from a Document with a "hidden" visibility state will not receive an orientation change event. This is to prevent unnecessary changes to layout, etc. in the non-visible web application.
</p>

			</section>
		</section>
	</section>
	<section id="interactions-with-other-specifications">
<h2 title="Interactions with other specifications">9. 他の仕様との相互作用</h2>

<p>
この節は、
この仕様が~platformの関係する他の仕様とどう相互作用するかを説明する。
◎
This section explains how this specification interacts with other related specifications of the platform.
</p>

		<section id="interaction-with-fullscreen-api">
<h3 title="Interaction with Fullscreen API">9.1. `Fullscreen API^cite との相互作用</h3>

<p>
`事前~lock条件$として、
~UAは，~screen方位の~lock法を単純な~fullscreen文書に制約するベキである。
【 “単純な（ `simple^en ）” とは何を意味する？】
◎
As a pre-lock condition, a user agent SHOULD restrict locking the screen orientation to simple fullscreen documents.
</p>

		</section>
		<section id="interaction-with-web-application-manifest">
<h3 title="Interaction with Web Application Manifest">9.2. `Web Application Manifest^cite との相互作用</h3>

~INFORMATIVE

<p>
`appmanifest$r は、
`文書$の`既定の~screen方位$を設定することを，~web~appに許容する。
◎
The Web Application Manifest allows web applications to set the Document's default screen orientation.
</p>

		</section>
		<section id="interaction-with-web-content-accessibility-guidelines">
<h3 title="Interaction with Web Content Accessibility Guidelines">9.3. `Web Content Accessibility Guidelines^cite との相互作用</h3>

~INFORMATIVE

<p>
`WCAG21$r は、
~screen方位に関係する`達成基準＠~TR/WCAG21/#orientation$を含んでいる。
その意図は、
次を確保することにある
⇒
`本質的$な［
内容, 機能性
］は、
表示-方位（縦置きか横置きか）に関わらず，すべて可用になる。
◎
The Web Content Accessibility Guidelines (WCAG) 2.1 includes a Success Criterion related to screen orientation.
◎
​The intent of this Success Criterion is to ensure that all essential content and functionality is available regardless of the display orientation (portrait or landscape).＼
</p>

<p>
一部の~web~siteや~appは、
~screenを自動的に特定0の表示-方位に設定して，［
利用者が、
それに合致するよう自身の機器を回転するよう応答する
］ことを期待するが、
自身の機器を固定的な方位に装着している利用者もある（例：車椅子の~arm上に）。
したがって，~web~siteや~appは、
どちらの方位に対しても，`本質的$な［
内容, 機能性
］を必ず可用にして~supportする必要がある
— ［
内容の順序／機能性の手法
］には相違があってもよいが、［
内容, 機能性
］は常に可用にしなければナラナイ。
特定0の方位が`本質的$である場合、
当の方位~要件を利用者に助言する必要がある。​
◎
Some websites and applications automatically set the screen to a particular display orientation and expect that users will respond by rotating their device to match.
◎
However, some users may have their devices mounted in a fixed orientation (e.g. on the arm of a wheelchair). Therefore, websites and applications need to support both orientations by making sure essential content and functionality is available in each orientation. While the order of content and method of functionality may have differences the content and functionality must always be available. When a particular orientation is essential, the user needs to be advised of the orientation requirements.
</p>

		</section>
	</section>
	<section id="privacy-and-security-considerations">
<h2 title="Privacy and Security Considerations">10. ~privacyと~securityの考慮点</h2>

~INFORMATIVE

		<section id="access-to-aspects-of-a-user-s-local-computing-environment">
<h3 title="Access to aspects of a user’s local computing environment">10.1. 利用者に局所的な環境を成す各種~側面への~access</h3>

<p>
この文書に指定した~APIは、
機器の~screen方位の［
種別, 角度
］に~accessでき，指紋収集~行路になり得る。
◎
The screen orientation type and angle of the device can be accessed with the API specified in this document, and can be a potential fingerprinting vector.
</p>

		</section>
	</section>
</main></div>

