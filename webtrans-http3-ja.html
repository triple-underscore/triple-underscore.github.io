<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>WebTransport over HTTP/3（日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="http-common.css" type="text/css">

<style>
.settings-parameter,
.frame-type,
.capsule,
.error-code {
	font-family: sans-serif0, sans-serif;
	color: var(--K-color);
}

.frame-diagram {
	margin: 0;
}

.frame-diagram > span[lang="en"] {
	white-space: pre;
}

.webtransport-layers {
	max-width: 20em;
	border: thin solid var(--K-color);
}

.webtransport-layers > * {
	border-top: thin solid var(--K-color);
	padding: 0.2em;
	text-align: center;
}
.webtransport-layers > *:first-child {
	border-top-style: none;
	padding: 0.2em;
	text-align: center;
}

</style>


<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		toc_main: 'MAIN0',
		generate: expand,
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~一-鿆あ-ん]+|`(.+?)([$@\^§])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){

if(!key) {//%
	return `<var>${match.slice(1)}</var>`;
}

let href = '';
let href1 = '';
{
	const n = key.indexOf('＠');
	if(n > 0) {
		href1 = key.slice(n + 1);
		key = key.slice(0, n);
	}
}
let text = key;

switch(klass){
case 'r':
	text = `[${key}]`;
	href = `#${key}`;
	break;
case 'ph':
	text = `:${key}`;
	break;
case 'pull':
	text = `#${key}`;
	href = `https://github.com/ietf-wg-webtrans/draft-ietf-webtrans-http3/pull/${key}`;
	break;
case 'en':
	return `<span lang="en">${key}</span>`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = href1 || link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '§':
		text = ` <a href="${href}">§ ${text}</a> `;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;

	}
}

</script>


<script type="text/plain" id="_source_data">

●●options

spec_date:2025-10-23
trans_update:2025-10-23
source_checked:250624
original_url:https://ietf-wg-webtrans.github.io/draft-ietf-webtrans-http3/draft-ietf-webtrans-http3.html
	abbr_url:WT-HTTP3
spec_status:IETFID
page_state_key:HTTP
no_original_dfn:true
	ref_id_prefix:
ref_rfc:true
site_nav:network
trans_1st_pub:2023-12-30

●●original_urls

●●class_map
ft:frame-type
cps:capsule
er:error-code
sp:settings-parameter
st:status
h:header
ph:pseudo-header
m:method
hex:hex-value
2119:rfc2119

●●tag_map
2119:em
ft:code
cps:code
er:code
hex:span
sp:code
st:code
h:code
ph:code
m:code
c:code
p:code
cite:cite
i:i

●●original_id_map
abstract:
	fig-webtransport-layers:name-webtransport-layering
	fig-webtransport-layers:figure-1
	fig-unidi:name-unidirectional-webtranspor
	fig-unidi:figure-2
	fig-bidi-client:name-bidirectional-webtransport-
	fig-bidi-client:figure-3
	fig-remap-errors:name-pseudocode-for-converting-b
	fig-remap-errors:figure-4
	fig-wt_drain_session:name-wt_drain_session-capsule-fo
	fig-wt_drain_session:figure-5
	fig-wt-exporter-context:name-webtransport-exporter-conte
	fig-wt-exporter-context:figure-6
	fig-wt_max_streams:name-wt_max_streams-capsule-form
	fig-wt_max_streams:figure-7
	fig-wt_streams_blocked:name-wt_streams_blocked-capsule-
	fig-wt_streams_blocked:figure-8
	fig-wt_max_data:name-wt_max_data-capsule-format
	fig-wt_max_data:figure-9
	fig-wt_data_blocked:name-wt_data_blocked-capsule-for
	fig-wt_data_blocked:figure-10
	fig-wt_close_session:name-wt_close_session-capsule-fo
	fig-wt_close_session:figure-11

●●link_map

p.authority:~RFCx/rfc3986#section-3.2
p.path:~RFCx/rfc3986#section-3.3

c.https:~HTTPinfra#https.uri

ph.scheme:~HTTPv3#ph-scheme
ph.authority:~HTTPv3#ph-authority
ph.path:~HTTPv3#ph-path

h.Capsule-Protocol:~HTTPdatagram#hdr
	~HTTPdatagram#section-3.4
	~HTTPdatagram#name-the-capsule-protocol-header
h.Priority:~HTTPpriority#header-field
h.Origin:~FETCH#http-origin
	h.Origin:~RFCx/rfc6454#section-4
h.WT-Available-Protocols:#field-wt-available-protocol
h.WT-Protocol:#field-wt-protocol

m.CONNECT:~HTTPsem#CONNECT

st.404:~HTTPsem#status.404
st.403:~HTTPsem#status.403
st.2xx:~HTTPsem#status.2xx
st.3xx:~HTTPsem#status.3xx

cps.WT_CLOSE_SESSION:#WT_CLOSE_SESSION
cps.WT_DRAIN_SESSION:#WT_DRAIN_SESSION
cps.WT_MAX_STREAMS:#WT_MAX_STREAMS
cps.WT_STREAMS_BLOCKED:#WT_STREAMS_BLOCKED
cps.WT_MAX_DATA:#WT_MAX_DATA
cps.WT_DATA_BLOCKED:#WT_DATA_BLOCKED
	cps.WT_STREAM:？

ft.WT_STREAM:#WT_STREAM
ft.RESET_STREAM:~RFCx/rfc9000#frame-reset-stream
ft.STOP_SENDING:~RFCx/rfc9000#frame-stop-sending
ft.MAX_STREAMS:~RFCx/rfc9000#frame-max-streams
ft.MAX_DATA:~RFCx/rfc9000#frame-max-data
ft.CONNECTION_CLOSE:~RFCx/rfc9000#frame-connection-close
ft.DATAGRAM:~RFCx/rfc9221#datagram-frame-types
ft.SETTINGS:~HTTPv3#frame-settings
ft.GOAWAY:~HTTPv3#frame-goaway
ft.PRIORITY_UPDATE:~HTTPpriority#frame
ft.RESET_STREAM_AT:~RELIABLERESET#name-reset_stream_at-frame

sp.SETTINGS_WT_MAX_SESSIONS:#SETTINGS_WT_MAX_SESSIONS
sp.SETTINGS_WT_INITIAL_MAX_DATA:#SETTINGS_WT_INITIAL_MAX_DATA
sp.SETTINGS_WT_INITIAL_MAX_STREAMS_UNI:#SETTINGS_WT_INITIAL_MAX_STREAMS_UNI
sp.SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI:#SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI

sp.SETTINGS_H3_DATAGRAM:~HTTPdatagram#setting
	~HTTPdatagram#section-2.1.1
sp.SETTINGS_ENABLE_CONNECT_PROTOCOL:~RFCx/rfc9220#websockets-upgrade-over-http3

~HTTP~datagram:~HTTPdatagram#dfn-http-datagram
~HTTP3~datagram:~HTTPdatagram#format
	~HTTPdatagram#section-2.1
	~HTTPdatagram#name-http-3-datagrams

er.WT_BUFFERED_STREAM_REJECTED:#WT_BUFFERED_STREAM_REJECTED
er.WT_SESSION_GONE:#WT_SESSION_GONE
er.WT_FLOW_CONTROL_ERROR:#WT_FLOW_CONTROL_ERROR
er.WT_APPLICATION_ERROR:#WT_APPLICATION_ERROR

er.H3_SETTINGS_ERROR:~HTTPv3#H3_SETTINGS_ERROR
er.H3_FRAME_ERROR:~HTTPv3#H3_FRAME_ERROR
er.H3_MESSAGE_ERROR:~HTTPv3#H3_MESSAGE_ERROR
er.H3_ID_ERROR:~HTTPv3#H3_ID_ERROR
er.H3_REQUEST_REJECTED:~HTTPv3#H3_REQUEST_REJECTED

c.max_datagram_frame_size:~RFCx/rfc9221#section-3

	●用語
~CONNECT~stream:#connect-stream
~session~ID:#session-id
~WebTransport~stream:#webtransport-stream
応用~client:#application-client
応用~server:#application-server
~flow制御~capsule:#flow-control-capsule

	●用語（外部
安全:~HTTPsem#safe-method
制御~data:~HTTPinfra#control-data
~message:~HTTPinfra#message
要請~message:~HTTPinfra#request
応答~message:~HTTPinfra#response
媒介者:~HTTPinfra#intermediary
隣点間:~HTTPinfra#hop-by-hop
端点間:~HTTPinfra#end-to-end

~HTTP3接続:~HTTPv3#h3-connection
~stream~ID:~HTTPv3#quic-stream-id
接続~error:~HTTPv3#quic-connection-error
設定:~HTTPv3#setting
一方向~stream:~HTTPv3#quic-unidirectional-stream
双方向~stream:~HTTPv3#quic-bidirectional-stream
~HTTP3~server:~HTTPv3#h3-server
~stream種別:~HTTPv3#h3-stream-type
可変長な整数:~HTTPv3#variable-length-integer
受信器:~HTTPv3#h3-receiver
送信器:~HTTPv3#h3-sender
~server~push:~HTTPv3#h3-server-push

~WebTransport~client:~WT-OVERVIEW#webtransport-client
~WebTransport~server:~WT-OVERVIEW#webtransport-server
~WebTransport応用:~WT-OVERVIEW#webtransport-application
~WebTransport端点:~WT-OVERVIEW#webtransport-endpoint
	~WebTransport~UA:~WT-OVERVIEW#webtransport-ua
~WebTransport~session:~WT-OVERVIEW#webtransport-session
	~datagram:~WT-OVERVIEW#datagram
不依拠-可能:~WT-OVERVIEW#unreliable

~reset:~RFCx/rfc9000#stream-operations
~capsule:~HTTPdatagram#dfn-capsule
~capsule~protocol:~HTTPdatagram#dfn-capsule-protocol
1.~capsule~protocol:~HTTPdatagram#capsule-protocol
	~HTTPdatagram#section-3
	~HTTPdatagram#name-capsules

有構造~field:~STRUCTURED-FIELDS#structured-field
~sf~list:~STRUCTURED-FIELDS#sf-list
~sf~item:~STRUCTURED-FIELDS#sf-item
~sf文字列:~STRUCTURED-FIELDS#sf-string
~sf~parameter群:~STRUCTURED-FIELDS#sf-parameters
~sf~parameter:~STRUCTURED-FIELDS#sf-parameter

cite.~HTTP2越しの~WebTransport:https://ietf-wg-webtrans.github.io/draft-ietf-webtrans-http2/draft-ietf-webtrans-http2.html

●●words_table1

WEBTRANSPORT:webtransport-ja.html
WT-OVERVIEW:webtrans-overview-ja.html
HTTPdatagram:http-datagram-ja.html
	RELIABLERESET:https://datatracker.ietf.org/doc/html/draft-ietf-quic-reliable-stream-reset-07
RELIABLERESET:https://quicwg.org/reliable-stream-reset/draft-ietf-quic-reliable-stream-reset.html

sf:<sub>sf-</sub>

●●words_table

	●名称
QUIC:
WebTransport:
HTTP3:HTTP/3
HTTP2:HTTP/2
HTTP11:HTTP/1.1
CONNECT:
	~CONNECT~stream:connect stream
	~CONNECT~stream:CONNECT stream
URI:
TLS:
0-RTT:
ALPN:
	ALPN:TLS Application-Layer Protocol Negotiation Extension (ALPN)
QPACK:
	~WG:Working Group
	有構造~field:Structured Field
Huffman:
	`~HTTP意味論^cite:"HTTP Semantics"
WebSockets:

	WebTransport Exporter Context
	WebTransport Session ID
	WebTransport Application-Supplied Exporter Label Length
	WebTransport Application-Supplied Exporter Label
	WebTransport Application-Supplied Exporter Context Length
	WebTransport Application-Supplied Exporter Context

	●transport／network
多重化-:multiplex::~
逆多重化-:demultiplex::~
確立:establishment:~
端点:endpoint::~::エンドポイント
伝送路:wire:~
回送-:forward::~
交換:exchange:~
交換-:exchange:~
到着-:arrive:~
返信-:reply::~
側:side:~
flight:
封入-:enclose:~
handshake::::ハンドシェイク
送信器:sender::~
受信器:receiver::~
運ぶ:carryする:~
不正形:malformed:~
端点間:end-to-end::~
隣点間:hop-by-hop::~
隣点:hop::~
広告-:advertise:~
受領:receipt::~
backend::::バックエンド
不依拠-:unrely:~
	不依拠-可能:unreliable
喪失-:lose:~
	喪失した:lost

	^en:head-of-line~blocking
	伝送し直-:retransmit
	順序どおり:in order

	●stream／frame
可変長:variable length:長さ可変
packet::::パケット
datagram::::データグラム
流入:incoming::~
流出:outgoing::~
一方向:unidirectional::~
双方向:bidirectional::~
payload::::ペイロード
四分:quarter::~

	^i:FIN
	`~capsule~protocol$:the Capsule Protocol
	四分~stream~ID^i:Quarter Stream ID
	~HTTP~datagram:HTTP Datagram
	~datagram^i:Datagram
	~HTTP~datagram~payload^i:HTTP Datagram Payload
	最大~stream数^i:Maximum Streams
	最大~data量^i:Maximum Data
	~stream本体^i:Stream Body
	通達~値^i:Signal Value
	~stream種別^i:Stream Type
	~session~ID^i:Session ID
	応用~error~code^i:Application Error Code
	~error~code^i:Error Code

	●処理
reset:
中途で:abruptに:~
併合-:merge::~
shutdown:
shut-down:shut down
clean:
	~cleanに:cleanly
早期:early:~
輻輳:congestion::~
優先度:priority:~
優先度化:prioritization:優先度付け
優先度化-:prioritize:優先度付け
	優先度化し直:reprioritize:優先度~付け
停滞-:stall:~
open:
close:
credit:
schedule::::スケジュール
	~schedule法:scheduling
pool:
	~pool法:pooling
解凍:decompression::~
圧縮:compression::~
翻訳-:translate:~
調律-:tune::~
繰返し:repeatedly:繰り返し
後回-:starve::後回しに
過度:excessive:~
並替えら:reorderさ::並び替えら

	表出し直す:reexpress

	●保安
枯渇-:exhaust:~
枯渇:exhaustion:~
積極的:aggressive:~
潜在的:potential:~
公平性:fairness:~
出自に:originate::~
共有分:share::~
鍵:key::~
素材:material::~
	鍵~用の素材:keying material
exporter:

	信用-済みでない:untrusted
	信用-済み:trusted

	●仕様
opt-in:
楽観的:optimistic:~
上品:graceful:~
視点:perspective:~
Upgrade:
	~Upgrade:upgrade
恒久的:permanent:~
暫定的:provisional:~
連絡先:contact:~
合格-:pass:~
著作権:copyright:~
告知:notice:~
拡げた:expandした:~
選ぶ:chooseする:~
メモ:memo:~
必要最小限:minimal:~
独立性:independence:~
禁制-:prohibit:~
責務:responsibilty:~
	責務がある:responsible for
	責務を負いたくない:does not want to be responsible for

	課され:impose
	と称される:referred to as
	指す:refer
	悟った:learn
	満たす:satisfy
	してもよい:may
	~port法:porting
	用意がある:willing
	用意はない:not willing
	用意がない:not willing
	およそ:nearly
	図:figure
	最小~化:minimize
	~~追加の:extra
	できる見込みが高い:can likely
	~~任意で~~選べる:opt
	総称される:referred to as
	なし:none
	要約すると:in summary

	●言い換え
	1 以上の:greater than "0"
	1 以上の:greater than 0
	2 以上の:greater than "1"
	複数個の:more than one
	端点:any peer
	相手の端点:peer
	双方の端点:peer
	双方の端点:the peer
	双方の端点:both endopoint
	所有者であること:ownership
	〜能力がある:〜-capable
	順に:correspondingly
	変更~log:changelog
	最善な労:best-effort
	互換でない:incompatible
	変換した上で:within 〜 range
	前項:the previous method
	とは限らない:potentially
	場合もある:could potentially
	~WebTransport~protocol:the protocol
	0:"0"
	知れる:will 〜 know
	何かを意見するものではない:unopinionated
	~byte列:bytestring
	single choice from:選んだ いずれか 1 つ
	未満になる:cannot exceed
	阻まれるようになった時点:at which blocking occurred
	最大~数:max
	~capsule$:HTTP capsule
	それを指定した:the specified
	~WebTransport能力がある:WebTransport-Capable

	●未分類
衝突:collision:~
無符号:unsigned:~
隣接な:adjacentな:隣接する
符号点:codepoint:~
超過-:exceed:~
	超過した:in excess
近過去:recent:~
疑似-:pseudo-:~
	疑似-~code:pseudocode
維持-:retain:~
追従-:follow:~
上限:limit:~
総和:sum:~
内包-:include::~
欠如:lack:~
欠如-:lack:~
数えら:countさ:~
後続-:follow:~
対応-:correspond:~
対応付直さな:remapしな::対応付け直さな
lifecycle:
給-:supply:~
多層化:layering::~
存続期間:lifetime:~
最終-:final:~
伝える:informする:~
累積的:cumulative:~
面して:faceして:~
運ばれ:carryされ:~
合意-:agree:~
遭遇-:encounter:~
限界域:bounds:~
収まる:fitする:~

	量:amount
	量:how much
	上層:on top of
	~sf~list$:List
	~sf~item$:Item
	~sf文字列$:String
	改変されずに:unmodified
	利用し尽くす:using up
	同じく:Just like
	いつでも:at any point
	各種:a variety of
	残り:the rest
	一番最初の:very first
	順序どおりに〜ない:out of order
	占める:takes up
	始め:at the beginning
	同時に:simultaneously
	同時な:simultaneous
	当の:in question
	来ている:coming
	なり得る:potentially
	属する:belonging
	置かれる:~put
	〜以下:inclusive
	含む:include
	含めること:inclusion
	残り:the remainder
	両方^i:Both
	前回:the previous
	一括して:all
	行く:going
	長さは 0:zero-length
	他のもの:anything else
	始まる:begin
	残り:the remainder
	〜 乗<sup>〜</sup>
	表出し直す:reexpress
	それまでに:previously
	以前に:previously
	前回より増やされた:increasing
	非-:non-
	総:total
	時点で:at the time
	を超える:higher
	0 以外の:non-zero
	全体:as a whole
	当の:in question
	〜すべてが:the entirety of
	~~反映:mirror
	有無:presence

●●ref_data
OVERVIEW=副 ~/webtrans-overview-ja.html

●●ref_key_map
FIELDS:RFC9651
HTTP3:RFC9114
WEBSOCKET:RFC6455

●●ref_normative
[FIELDS]
    Nottingham, M. and P. Kamp, "Structured Field Values for HTTP", ~RFC9651, September 2024
[HTTP]
    Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., "HTTP Semantics", STD 97, ~RFC9110, June 2022
[HTTP-DATAGRAM]
    Schinazi, D. and L. Pardue, "HTTP Datagrams and the Capsule Protocol", ~RFC9297, August 2022
[HTTP3]
    Bishop, M., Ed., "HTTP/3", ~RFC9114, June 2022
[OVERVIEW]
    Kinnear, E. and V. Vasiliev, "The WebTransport Protocol Framework", Work in Progress, Internet-Draft
    URL: https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview
[QUIC-DATAGRAM]
    Pauly, T., Kinnear, E., and D. Schinazi, "An Unreliable Datagram Extension to QUIC", ~RFC9221, March 2022
[RESET-STREAM-AT]
    Seemann, M. and K. Oku, "QUIC Stream Resets with Partial Delivery", Work in Progress, Internet-Draft, draft-ietf-quic-reliable-stream-reset-07, 14 June 2025
    URL: https://datatracker.ietf.org/doc/html/draft-ietf-quic-reliable-stream-reset-07
[RFC2119]
    Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, ~RFC2119, March 1997
[RFC3986]
    Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform Resource Identifier (URI): Generic Syntax", STD 66, ~RFC3986, January 2005
[RFC6454]
    Barth, A., "The Web Origin Concept", ~RFC6454, December 2011
[RFC8174]
    Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words", BCP 14, ~RFC8174, May 2017
[RFC8441]
    McManus, P., "Bootstrapping WebSockets with HTTP/2", ~RFC8441, September 2018
[RFC8446]
    Rescorla, E., "The Transport Layer Security (TLS) Protocol Version 1.3", ~RFC8446, August 2018
[RFC9000]
    Iyengar, J., Ed. and M. Thomson, Ed., "QUIC: A UDP-Based Multiplexed and Secure Transport", ~RFC9000, May 2021
[RFC9110]
    Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., "HTTP Semantics", STD 97, ~RFC9110, June 2022
[RFC9114]
    Bishop, M., Ed., "HTTP/3", ~RFC9114, June 2022
[RFC9218]
    Oku, K. and L. Pardue, "Extensible Prioritization Scheme for HTTP", ~RFC9218, June 2022
[RFC9220]
    Hamilton, R., "Bootstrapping WebSockets with HTTP/3", ~RFC9220, June 2022

●●ref_informative
[I-D.ietf-webtrans-http2]
    Frindell, A., Kinnear, E., Pauly, T., Thomson, M., Vasiliev, V., and G. Xie, "WebTransport over HTTP/2", Work in Progress, Internet-Draft,
    URL: https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http2
[RFC6455]
    Fette, I. and A. Melnikov, "The WebSocket Protocol", ~RFC6455, December 2011
[RFC7301]
    Friedl, S., Popov, A., Langley, A., and E. Stephan, "Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension", ~RFC7301, July 2014
[RFC9208]
    Melnikov, A., "IMAP QUOTA Extension", ~RFC9208, March 2022
[RFC9308]
    Kühlewind, M. and B. Trammell, "Applicability of the QUIC Transport Protocol", ~RFC9308, September 2022


●●trans_metadata
<p>
~THIS_PAGEは、
~IETF により Internet-Draft として公開された，
<a href="~SPEC_URL">WebTransport over HTTP/3</a>
を日本語に翻訳したものです。
~PUB
</p>

●●spec_metadata

Workgroup
	WEBTRANS
位置付け
	Internet-Draft
	draft-ietf-webtrans-http3-latest
意図される位置付け
	Standards Track
失効日
	日付から半年後
編集／著作者アドレス
	<a href="mailto:afrind@fb.com">Alan Frindell</a> (Facebook)
	<a href="mailto:ekinnear@apple.com">Eric Kinnear</a> (Apple Inc.)
	<a href="mailto:vasilvv@google.com">Victor Vasiliev</a> (Google)
位置付け情報
	https://datatracker.ietf.org/doc/draft-ietf-webtrans-http3/
commit 履歴
	https://github.com/ietf-wg-webtrans/draft-ietf-webtrans-http3/commits/main
課題追跡
	https://github.com/ietf-wg-webtrans/draft-ietf-webtrans-http3/issues
メーリングリスト
	<a href="mailto:webtransport@ietf.org">mailto:webtransport@ietf.org</a> (<a href="https://mailarchive.ietf.org/arch/browse/webtransport/">archive</a>) (<a href="https://www.ietf.org/mailman/listinfo/webtransport/">subscribe</a>)

</script>

</head>

<body>

<header>
	<hgroup>
<h1>HTTP/3 越しの WebTransport</h1>
<p lang="en">WebTransport over HTTP/3</p>

	</hgroup>
</header>

<div id="MAIN" hidden>
	<section id="abstract">
◎要約

<p>
~WebTransport `OVERVIEW$r は、［
~Web~security~modelにより拘束された`応用~client$が
~secureな多重化された~transportを利用して，~remoteな`応用~server$と通信する
］ことを可能化する，~protocol~frameworkである。
この文書は、
~HTTP3 `HTTP3$r に基づく~WebTransport~protocolを述べるとともに，
同じ`~HTTP3接続$の中ですべて多重化される［
`一方向~stream$,
`双方向~stream$,
~datagram
］用の~supportを供する。
◎
WebTransport [OVERVIEW] is a protocol framework that enables application clients constrained by the Web security model to communicate with a remote application server using a secure multiplexed transport. This document describes a WebTransport protocol that is based on HTTP/3 [HTTP3] and provides support for unidirectional streams, bidirectional streams, and datagrams, all multiplexed within the same HTTP/3 connection.
</p>

	</section>
	<section>
<h2 title="About This Document">この文書について</h2>

<p>
この節は、
~RFCとして公表する前に除去されることになります。
◎
This note is to be removed before publishing as an RFC.
</p>

<p>
この草案の最新な改訂,
この文書の位置付け情報【履歴】,
この文書について論を交わす場,
この草案の~source,
この草案の課題~追跡器
］は、
冒頭の “`この文書についての詳細＠#_spec_metadata$” の中（末尾）から見出せます。
◎
The latest revision of this draft can be found at https://ietf-wg-webtrans.github.io/draft-ietf-webtrans-http3/#go.draft-ietf-webtrans-http3.html. Status information for this document may be found at https://datatracker.ietf.org/doc/draft-ietf-webtrans-http3/.
◎
Discussion of this document takes place on the WebTransport Working Group mailing list (mailto:webtransport@ietf.org), which is archived at https://mailarchive.ietf.org/arch/browse/webtransport/. Subscribe at https://www.ietf.org/mailman/listinfo/webtransport/.
◎
Source for this draft and an issue tracker can be found at https://github.com/ietf-wg-webtrans/draft-ietf-webtrans-http3.
</p>

	</section>
	<section id="status-of-memo">
<h2 title="Status of This Memo">このメモの位置付け</h2>

<p class="trans-note">【
この節の内容は
`~IETF日本語訳 共通~page＠~IETFcommon#status-draft$に移譲。
】</p>

	</section>
	<section id="copyright">
<h2 title="Copyright Notice">著作権の告知</h2>

<p lang="en">
Copyright (c) 2025 IETF Trust and the persons identified as the document authors. All rights reserved.
</p>

<p class="trans-note">【
以下、この節の他の内容は
`~IETF日本語訳 共通~page＠~IETFcommon#copyright-notice$に移譲。
】</p>

	</section>

<main id="MAIN0">

	<section id="introduction">
<h2 title="Introduction">1. 序論</h2>

<p>
~HTTP3 `HTTP3$r は、
~QUIC `RFC9000$r の上層に定義され，
~QUIC接続~越しに~HTTP要請を多重化できる~protocolである。
この文書は、
~WebTransport~protocolの要件と意味論 `OVERVIEW$r に適合する方式
で，非-~HTTP~dataを~HTTP3で多重化するための仕組みを定義する。
ここに述べられる仕組みを利用すれば、
複数の~WebTransport［
~instance／~session
］を同じ`~HTTP3接続$上の定例の~HTTP流通と同時に多重化できる。
◎
HTTP/3 [HTTP3] is a protocol defined on top of QUIC [RFC9000] that can multiplex HTTP requests over a QUIC connection. This document defines a mechanism for multiplexing non-HTTP data with HTTP/3 in a manner that conforms with the WebTransport protocol requirements and semantics [OVERVIEW]. Using the mechanism described here, multiple WebTransport instances, or sessions, can be multiplexed simultaneously with regular HTTP traffic on the same HTTP/3 connection.
</p>

		<section id="terminology">
<h3 title="Terminology">1.1. 各種用語</h3>

<p>
この文書~内の~keyword "MUST" …
【以下、この段落の内容は`~IETF日本語訳~共通~page＠~IETFcommon#requirements-notation$に移譲。】
◎
The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all capitals, as shown here.
</p>

<p>
この文書は、
`OVERVIEW$r `規約と定義＠~WT-OVERVIEW#conventions-and-definitions§
にて定義された各種用語に従う。
この文書は、
`~WebTransport~server$と`~HTTP3~server$を判別することに注意。
~HTTP3~serverが，`~HTTP3接続$を終了する~serverである。
~WebTransport~serverは、
`~WebTransport~session$を受容する応用であり，
~HTTP3~serverを介して~accessされ得るものである。
◎
This document follows terminology defined in Section 1.2 of [OVERVIEW]. Note that this document distinguishes between a WebTransport server and an HTTP/3 server. An HTTP/3 server is the server that terminates HTTP/3 connections; a WebTransport server is an application that accepts WebTransport sessions, which can be accessed via an HTTP/3 server.＼
</p>

<p class="trans-note">【
単に［
~server／~client
］と記される箇所も多々あるが、
多くは［
`~WebTransport~server$／`~WebTransport~client$
］を意味するであろう。
】</p>

<p>
`応用~client@
とは、［
利用者／開発者
］が供した
— 信用-済みでないことが多い —
~codeであって，
`応用~server$と通信するために`~WebTransport~client$により提供された~interfaceを用立てるものである。
`応用~server@
とは、
流入`~WebTransport~session$を受容するために`~WebTransport~server$により提供された~interfaceを利用するものである。
◎
An application client is user or developer-provided code, often untrusted, that utilizes the interface offered by the WebTransport client to communicate with an application server. The application server uses the interface offered by the WebTransport server to accept incoming WebTransport sessions.
</p>

<p class="trans-note">【
単に応用と記される箇所も多々あるが、
多くは，これらの総称を意味するであろう。
［
`~WebTransport~client$／`~WebTransport~server$
］も “応用である” ものと定義されるので、
これらは， “応用の応用” を意味することになる。
】</p>

		</section>
	</section>
	<section id="overview">
<h2 title="Overview">2. 概観</h2>

		<section id="quic-webtransport-and-http3">
<h3 title="QUIC, WebTransport, and HTTP/3">2.1. ~QUIC, ~WebTransport, ~HTTP3</h3>

<p>
~QUIC ~version 1 `RFC9000$r は、［
~flow制御, 輻輳~制御
］を伴う~secureな~transport~protocolである。
~QUICは、
~stream
— 多重化し得る，依拠-可能かつ有順序な~byte~streamたち —
を介した応用~dataの交換を~supportする。
~streamの独立性により、
渋滞（ `head-of-line blocking^en ）は軽減され得る。
~QUICは，~transport~serviceとして~streamを供するが、
その用法については，何かを意見するものではない。
~streamの適用能は、
`RFC9308$r `~streamの利用＠~RFCx/rfc9308#section-4§にて述べられる。
◎
QUIC version 1 [RFC9000] is a secure transport protocol with flow control and congestion control. QUIC supports application data exchange via streams; reliable and ordered byte streams that can be multiplexed. Stream independence can mitigate head-of-line blocking. While QUIC provides streams as a transport service, it is unopinionated about their usage. The applicability of streams is described by section 4 of [RFC9308].
</p>

<div>
<p>
~HTTPは、
`~HTTP意味論^cite `RFC9110$r により定義される応用~層の~protocolである。
~HTTP3は、
~QUIC用の応用への対応付けであり，
`RFC9114$r にて定義される
— それは：
◎
HTTP is an application-layer protocol, defined by "HTTP Semantics" [RFC9110]. HTTP/3 is the application mapping for QUIC, defined in [RFC9114].＼
</p>
<ul>
	<li>
`制御~data$／
~HTTP`要請~message$連列／
~HTTP`応答~message$連列
］を~frameの形で運ぶために~QUIC~streamがどう利用されるかを述べる。
◎
It describes how QUIC streams are used to carry control data or HTTP request and response message sequences in the form of frames and describes details of stream and connection lifecycle management.＼
</li>
	<li>
`~HTTP意味論^cite に加えて，次に挙げる特能を提供する
⇒＃
~QPACK~header圧縮 `RFC9208$r,
`~server~push$ `RFC9114$r
◎
HTTP/3 offers two features in addition to HTTP Semantics: QPACK header compression [RFC9208] and Server Push Section 4.6 of [RFC9114].
</li>
</ul>
</div>

<p>
`~WebTransport~session$の確立は、
~HTTP層において，ある資源とヤリトリすることを孕む。
~Web~UAその他の`~WebTransport~client$用には、
このヤリトリは，~securityの理由から重要になる
— とりわけ、［
当の資源が~WebTransportを利用する用意がある
］ことを確保するために。
◎
WebTransport session establishment involves interacting at the HTTP layer with a resource. For Web user agents and other WebTransport clients, this interaction is important for security reasons, especially to ensure that the resource is willing to use WebTransport.
</p>

<p>
~WebTransportは，その~handshake用に~HTTPを要求するが、
~HTTP3が利用-中にあるときは，［
確立された~sessionに関係する他のもの
］用には~HTTPは利用されない。
代わりに，［
確立された~sessionへ それらを~linkする
］ための［
~header連列を成す~byte列
］を伴う~QUIC~streamで始まる。
~streamを成す残りは、
本体であり，
~WebTransportを利用している応用により給された~payloadを運ぶ。
この処理nは、
~HTTP11越しの~WebSockets `RFC6455$r【！ORIGIN】 に類似する
— そこでは、
下層の~byte~streamへの~accessは，
どちら側も初期~handshakeを完了した後に可能化される。
◎
Although WebTransport requires HTTP for its handshake, when HTTP/3 is in use, HTTP is not used for anything else related to an established session. Instead, QUIC streams begin with a header sequence of bytes that links them to the established session. The remainder of the stream is the body, which carries the payload supplied by the application using WebTransport. This process is similar to WebSockets over HTTP/1.1 [ORIGIN], where access to the underlying byte stream is enabled after both sides have completed an initial handshake.
</p>

<p>
［
~QUIC, ~HTTP3, ~WebTransport
］は、
`図 1＠#fig-webtransport-layers$ にて示されるように層を成す。
`~WebTransport~session$が確立されたなら、
応用は，~QUICへのおよそ直な~accessを有するようになる。
◎
The layering of QUIC, HTTP/3, and WebTransport is shown in Figure 1. Once a WebTransport session is established, applications have nearly direct access to QUIC.
</p>

<figure id="fig-webtransport-layers">
<div style="column-count:2;">
<div class="webtransport-layers">
<div>~WebTransport</div>
<div>~HTTP意味論, ~sessionを設定しておく</div>
<div>~HTTP3</div>
<div>~QUIC</div>
</div>

<div class="webtransport-layers">
<div>~WebTransport（~sessionの確立-後）</div>
<div style="color:var(--dim-color);">↓ およそ直な~access ↓</div>
<div>~QUIC</div>
</div>
</div>

<figcaption>
図 1.
~WebTransportの多層化
◎
Figure 1: WebTransport Layering
</figcaption></figure>

			<section id="minimizing-implementation-complexity">
<h4 title="Minimizing Implementation Complexity">2.1.1. 実装の複階性の最小~化-法</h4>

<p>
~WebTransportと［
~HTTP, ~HTTP3
］とのヤリトリは必要最小限である。
［
~client／~server
］は、［
~HTTP, ~HTTP3
］の特能の利用を［
次に挙げる，~WebTransport~handshakeを完了するために要求されるもの
］に限るよう拘束できる：
◎
WebTransport has minimal interaction with HTTP and HTTP/3. Clients and servers can constrain their use of features to only those required to complete a WebTransport handshake:
</p>
<ul>
	<li>
要請を成す次に挙げるものを［
生成する／構文解析する
］
⇒＃
~method,
~host,
~path,
~protocol,
省略可能な `Origin$h ~header,
たぶん，何らかの~~追加の~header
◎
Generating/parsing the request method, host, path, protocol, optional Origin header field, and perhaps some extra header fields.
</li>
	<li>
応答を成す次に挙げるものを［
生成する／構文解析する
］
⇒＃
状態s~code,
場合によっては，何らかの~~追加の~header
◎
Generating/parsing the response status code and possibly some extra header fields.
</li>
</ul>

<p>
`~WebTransport端点$は、［
~client, ~server
］どちらであれ，［
自身に課される~HTTP~levelの要件
］のうちいくつかを~byte列【！~bytestring】の比較を利用して遂行できる見込みが高い。
◎
A WebTransport endpoint, whether a client or a server, can likely perform several of its HTTP-level requirements using bytestring comparisons.
</p>

<p>
~HTTP3は，~QPACKを利用して~HTTP`~message$を符号化するが、
【~WebTransportにおいては，】この複階性を最小~化できる。
`~WebTransport端点$は、
そのような~messageの：
◎
While HTTP/3 encodes HTTP messages using QPACK, this complexity can be minimized.＼
</p>
<ul>
	<li>
受信-時には、
動的な解凍を まるごと不能化できるが，［
静的な解凍, ~Huffman復号
］を常に~supportしなければならない。
◎
When receiving, a WebTransport endpoint can disable dynamic decompression entirely but must always support static decompression and Huffman decoding. ＼
</li>
	<li>
送信-時には、［
動的な圧縮, 静的な圧縮, ~Huffman符号化法
］それぞれに対し，それを決して利用しないことを~~任意で~~選べる。
◎
When sending, endpoints can opt to never use dynamic compression, static compression, or Huffman encoding.
</li>
</ul>

			</section>
		</section>
		<section id="protocol-overview">
<h3 title="Protocol Overview">2.2. ~protocolの概観</h3>

<p>
`~WebTransport~server$は、
一般に［
`authority$p 値, `path$p 値
］（ `RFC3986$r ）が成す~pairにより識別される。
◎
WebTransport servers in general are identified by a pair of authority value and path value (defined in [RFC3986] Sections 3.2 and 3.3 correspondingly).
</p>

<p>
`~HTTP3接続$が確立されるときには、［
~client, ~server
］どちらも，［
~HTTP3越しの~WebTransport用の~supportを指示する
］ために `SETTINGS_WT_MAX_SESSIONS$sp `設定$を送信する。
この処理nは、［
どちらの端点も`~WebTransport~stream$を~openすること
］を可能化するために［
追加的な~HTTP3拡張の利用
］も折衝する。
◎
When an HTTP/3 connection is established, both the client and the server send a SETTINGS_WT_MAX_SESSIONS setting to indicate support for WebTransport over HTTP/3. This process also negotiates the use of additional HTTP/3 extensions to enable both endpoints to open WebTransport streams.
</p>

<p>
`~WebTransport~session$は、
所与の`~HTTP3接続$の内側で［
拡張d `CONNECT$m 要請 `RFC9220$r を送信する~client
］により起動される。
~serverが当の要請を受容する場合，`~WebTransport~session$が確立される。
結果の~streamは，
`~CONNECT~stream@
と称され、
その`~stream~ID$は
`~session~ID@
と称される。
`~session~ID$は、［
当の接続の中で所与の`~WebTransport~session$を一意に識別する
］ために【他の~streamにより】利用される。
◎
WebTransport sessions are initiated inside a given HTTP/3 connection by the client, who sends an extended CONNECT request [RFC9220]. If the server accepts the request, a WebTransport session is established. The resulting stream will be further referred to as a CONNECT stream, and its stream ID is used to uniquely identify a given WebTransport session within the connection. The ID of the CONNECT stream that established a given WebTransport session will be further referred to as a Session ID.
</p>

<p>
~sessionが確立されたなら、
双方の端点は，次に挙げる仕組みを利用して~dataを交換できるようになる：
◎
After the session is established, the endpoints can exchange data using the following mechanisms:
</p>
<ul>
	<li>
~clientは、
`双方向~stream$を作成でき，
その所有者であることを［
最初の~byte列~内に特別な通達を供する
］ことにより~WebTransportへ転送する。
◎
A client can create a bidirectional stream and transfer its ownership to WebTransport by providing a special signal in the first bytes.
</li>
	<li>
~serverは、
`双方向~stream$を作成でき，
その所有者であることを［
最初の~byte列~内に特別な通達を供する
］ことにより~WebTransportへ転送する。
◎
A server can create a bidirectional stream and transfer its ownership to WebTransport by providing a special signal in the first bytes.
</li>
	<li>
［
~client, ~server
］どちらも、
ある特別な~stream種別を利用して，`一方向~stream$を作成できる。
◎
Both client and server can create a unidirectional stream using a special stream type.
</li>
	<li>
［
~client, ~server
］どちらも、
`~HTTP~datagram$ `HTTP-DATAGRAM$r を利用して~datagramを送信できる。
◎
Both client and server can send datagrams using HTTP Datagrams [HTTP-DATAGRAM].
</li>
</ul>

<p>
`~WebTransport~session$が終了されるのは、
それを作成した`~CONNECT~stream$が~closeされたときである。
◎
A WebTransport session is terminated when the CONNECT stream that created it is closed.
</p>

		</section>
	</section>
	<section id="session-establishment">
<h2 title="Session Establishment">3. ~sessionの確立</h2>

		<section id="establishing">
<h3 title="Establishing a WebTransport-Capable HTTP/3 Connection">3.1. ~WebTransport能力がある~HTTP3接続の確立-法</h3>

<p>
~WebTransport能力がある`~HTTP3接続$は、［
~client, ~server
］両者に対し，［
ある設定を利用して，~HTTP3越しに~WebTransport用に~supportを通達する
］ことを要求する。
◎
A WebTransport-Capable HTTP/3 connection requires the client and server to both signal support for WebTransport over HTTP/3 using a setting.
</p>

<p>
この文書は、
`SETTINGS_ENABLE_CONNECT_PROTOCOL$sp 設定を定義する。
この文書は、
接続が~supportする`~WebTransport~session$の個数を指示するためとして，
`SETTINGS_WT_MAX_SESSIONS$sp 設定を定義する
— この設定~用の既定の値は 0 であり、［
当の端点は，`~WebTransport~session$を受信する用意はない
］ことを意味する。
~HTTP3越しの~WebTransportを~supportしている［
~client, ~server
］は、
どちらも［
1 以上の値を伴う `SETTINGS_WT_MAX_SESSIONS$sp 設定
］を送信しなければ`ナラナイ^2119。
~clientは、
~serverから［
~WebTransport用の~supportを指示している設定
］を受信するまでは，
`~WebTransport~session$を確立するよう試みては`ナラナイ^2119。
◎
This document defines a SETTINGS_WT_MAX_SESSIONS setting for indicating the number of WebTransport sessions a connection supports. The default value for the SETTINGS_WT_MAX_SESSIONS setting is "0", meaning that the endpoint is not willing to receive any WebTransport sessions. Both clients and servers supporting WebTransport over HTTP/3 MUST send the SETTINGS_WT_MAX_SESSIONS setting with a value greater than "0". Clients MUST NOT attempt to establish WebTransport sessions until they have received the setting indicating WebTransport support from the server.
</p>

<p>
~HTTP3越しの~WebTransportは：
◎
↓</p>
<ul>
	<li>
`RFC9220$r にて述べられるとおり，
~HTTP3における拡張d `CONNECT$m を利用する
⇒
それは、
`SETTINGS_ENABLE_CONNECT_PROTOCOL$sp 設定を定義する。
~clientも、［
~sessionを確立するとき，
拡張d `CONNECT$m 要請~内に "`webtransport^c" ~Upgrade~tokenを利用する
］ことにより，~WebTransport用の~supportを通達する
（`~Upgrade~tokenの登録＠#upgrade-token§を見よ）。
◎
WebTransport over HTTP/3 uses extended CONNECT in HTTP/3 as described in [RFC9220], which defines the SETTINGS_ENABLE_CONNECT_PROTOCOL setting. Clients also signal support for WebTransport by using the "webtransport" upgrade token in extended CONNECT requests when establishing sessions (see Section 9.1).
</li>
	<li>
`~HTTP3~datagram$と`~capsule~protocol$ `HTTP-DATAGRAM$r
用の~supportを要求する
⇒
［
~client, ~server
］は，どちらも、
各自の `SETTINGS$ft ~frame内に［
値 1 に設定された `SETTINGS_H3_DATAGRAM$sp 設定 `HTTP-DATAGRAM$r
］を送信することにより，
~HTTP3~datagram用の~supportを指示する。
◎
WebTransport over HTTP/3 requires support for HTTP/3 datagrams and the Capsule Protocol, and both the client and the server indicate support for HTTP/3 datagrams by sending a SETTINGS_H3_DATAGRAM setting value set to 1 in their SETTINGS frame (see Section 2.1.1 of [HTTP-DATAGRAM]).
</li>
	<li>
~QUIC~datagram用の~supportも要求する
⇒
~supportを指示するためには、［
~client, ~server
］どちらも，［
1 以上の値を伴う `max_datagram_frame_size$c ~transport~parameter `QUIC-DATAGRAM$r
］を送信する。
◎
WebTransport over HTTP/3 also requires support for QUIC datagrams. To indicate support, both the client and the server send a max_datagram_frame_size transport parameter with a value greater than 0 (see Section 3 of [QUIC-DATAGRAM]).
</li>
	<li>
`RESET-STREAM-AT$r にて定義される `RESET_STREAM_AT$ft ~frameに依拠する
⇒
~supportを指示するためには、［
~client, ~server
］どちらも，［
`RESET-STREAM-AT$r `拡張~利用の折衝-法＠~RELIABLERESET#section-3§
にて述べられるとおり，
空な `reset_stream_at^c ~transport~parameterを送信する
］ことにより，この拡張を可能化する。
◎
WebTransport over HTTP/3 relies on the RESET_STREAM_AT frame defined in [RESET-STREAM-AT]. To indicate support, both the client and the server enable the extension by sending an empty reset_stream_at transport parameter as described in Section 3 of [RESET-STREAM-AT].
</li>
</ul>

<p>
要約すると、
~HTTP3越しの~WebTransportを：
◎
In summary,＼
</p>
<ul>
	<li>
~supportしている~serverは、
次を送信する
⇒＃
1 以上の値を伴う `SETTINGS_WT_MAX_SESSIONS$sp 設定,
値 1 を伴う `SETTINGS_ENABLE_CONNECT_PROTOCOL$sp 設定,
値 1 を伴う `SETTINGS_H3_DATAGRAM$sp 設定,
1 以上の値を伴う `max_datagram_frame_size$c ~transport~parameter,
空な `reset_stream_at^c ~transport~parameter
◎
servers supporting WebTransport over HTTP/3 send:
• A SETTINGS_WT_MAX_SESSIONS setting with a value greater than "0"
• A SETTINGS_ENABLE_CONNECT_PROTOCOL setting with a value of "1"
• A SETTINGS_H3_DATAGRAM setting with a value of 1
• A max_datagram_frame_size transport parameter with a value greater than 0
• An empty reset_stream_at transport parameter
</li>
	<li>
~supportしている~clientは、
次を送信する
⇒＃
1 以上の値を伴う `SETTINGS_WT_MAX_SESSIONS$sp 設定,
値 1 を伴う `SETTINGS_H3_DATAGRAM$sp 設定,
1 以上の値を伴う `max_datagram_frame_size$c ~transport~parameter,
空な `reset_stream_at^c ~transport~parameter
◎
Clients supporting WebTransport over HTTP/3 send:
• A SETTINGS_WT_MAX_SESSIONS setting with a value greater than "0"
• A SETTINGS_H3_DATAGRAM setting with a value of 1
• A max_datagram_frame_size transport parameter with a value greater than 0
• An empty reset_stream_at transport parameter
</li>
</ul>

<p>
~serverは、
新たな`~WebTransport~session$を確立するための `CONNECT$m 要請が
— 他の~messageに加えて —
~clientから `SETTINGS$ft を受信する前に到着し得ることに注意するべきである
（ `流入~stream／~datagramの~buffer法＠#buffering-incoming§を見よ）。
~serverは、
要求される各種［
設定, ~transport~parameter
］のうち いずれかに不正な値を伴う `SETTINGS$ft を受信した場合には，
すべての［
確立-済みな／新たな
］流入`~WebTransport~session$を
—  `HTTP3$r `不正形な~message＠~HTTPv3#malformed§ にて述べられるとおり —
不正形として扱わなければ`ナラナイ^2119。
◎
Servers should note that CONNECT requests to establish new WebTransport sessions, in addition to other messages, can arrive before the client's SETTINGS are received (see Section 4.6). If the server receives SETTINGS that do not have correct values for every required setting, or transport parameters that do not have correct values for every required transport parameter, the server MUST treat all established and newly incoming WebTransport sessions as malformed, as described in Section 4.1.2 of [HTTP3].
</p>

<p>
~clientは、
~serverの `SETTINGS$ft が要求される各種［
設定, ~transport~parameter
］のうち いずれかに不正な値を伴う場合には，
`~WebTransport~session$を確立しては`ナラナイ^2119。
◎
A client MUST NOT establish WebTransport sessions if the server's SETTINGS do not have correct values for every required setting or if the server's transport parameters do not have correct values for every required transport parameter.
</p>

<p class="note">注記：
次の段落は、
~RFCとして公表する前に除去されることになる。
◎
[[RFC editor: please remove the following paragraph before publication.]]
</p>

<p>
~WebTransportの草案~version用に限り
⇒
~serverは、
~clientから設定~群を受信するまでは，
どの流入~WebTransport要請も処理しては`ナラナイ^2119
— ~clientは、
~WebTransport拡張として［
~serverが利用するものとは異なる~version
］を利用しているかもしれないので。
◎
For draft versions of WebTransport only, the server MUST NOT process any incoming WebTransport requests until the client settings have been received, as the client might be using a version of the WebTransport extension that is different from the one used by the server.
</p>

		</section>
		<section id="creating-a-new-session">
<h3 title="Creating a New Session">3.2. 新たな~sessionの作成-法</h3>

<p>
`~WebTransport~session$は，~HTTP3越しに確立されるので、
`https$c ~URI~scheme `HTTP$r を利用して識別される。
◎
As WebTransport sessions are established over HTTP/3, they are identified using the https URI scheme (Section 4.2.2 of [HTTP]).
</p>

<p>
`~WebTransport~client$は、
新たな`~WebTransport~session$を作成するために，
~HTTP拡張d `CONNECT$m 要請を送信する
— この要請は：
◎
In order to create a new WebTransport session, a WebTransport client sends an HTTP extended CONNECT request. In this request:
</p>
<ul>
	<li>
`protocol^ph 疑似-~header `RFC8441$r を伴い，
その値は `webtransport^c をとる。
◎
The :protocol pseudo-header field([RFC8441]) MUST be set to webtransport.
</li>
	<li>
`scheme$ph 疑似-~headerを伴い，
その値は `https^c をとる。
◎
The :scheme field MUST be https.
</li>
	<li>
［
`authority$ph, `path$ph
］両~疑似-~headerを伴う
— これらは、
欲される`~WebTransport~server$【として動作する】資源を指示する。
◎
Both the :authority and the :path value MUST be set; these fields identify the desired WebTransport server resource.
</li>
	<li>
~clientは~browser~clientである場合、
`Origin$h ~header `RFC6454$r を伴わなければ`ナラナイ^2119
— 他の場合、
この~headerは`任意選択^2119である。
◎
If the WebTransport session is coming from a browser client, an Origin header [RFC6454] MUST be provided within the request. Otherwise, the header is OPTIONAL.
</li>
</ul>

<p>
`~HTTP3~server$は、
`webtransport^c に設定された `protocol^ph ~fieldを伴う拡張d `CONNECT$m 要請を受信した際には，当の要請にて指定された
( `authority$ph 値, `path$ph 値 )
に結付けられた`~WebTransport~server$を有するか否か検査できる。
有さない場合、
状態s~code `404$st `HTTP$r で返信する`ベキ^2119である。
`~WebTransport~server$は：
◎
Upon receiving an extended CONNECT request with a :protocol field set to webtransport, the HTTP/3 server can check if it has a WebTransport server associated with the specified :authority and :path values. If it does not, it SHOULD reply with status code 404 (Section 15.5.5 of [HTTP]).＼
</p>

<ul>
	<li>
当の要請が `Origin$h ~headerを包含するときは、
この~headerを検証yして，［
この~headerに指定された生成元が当の~serverへ~accessすることは許容される
］ことを確保しなければ`ナラナイ^2119
— 検証yに失敗した場合、
状態s~code `403$st `HTTP$r で返信する`ベキ^2119である。
◎
When the request contains the Origin header, the WebTransport server MUST verify the Origin header to ensure that the specified origin is allowed to access the server in question.＼
If the verification fails, the WebTransport server SHOULD reply with status code 403 (Section 15.5.4 of [HTTP]).＼
</li>
	<li>
すべての検査に合格したなら、
状態s~code `2xx$st `HTTP$r を返信することにより，
`~WebTransport~session$を受容しても`ヨイ^2119。
◎
If all checks pass, the WebTransport server MAY accept the session by replying with a 2xx series status code, as defined in Section 15.3 of [HTTP].
</li>
</ul>

<p>
`~WebTransport~session$が確立されたことになる時点は、
［
~client／~server
］の視点からは，自身が `2xx$st 応答を［
受信したとき／送信したとき
］である。
◎
From the client's perspective, a WebTransport session is established when the client receives a 2xx response. From the server's perspective, a session is established once it sends a 2xx response.
</p>

<p>
~serverは、
`3xx$st 応答 `HTTP$r を返信して，~redirectionを指示してもよい。
`~WebTransport~client$は、
そのような~redirectに対し，自動的に追従しては`ナラナイ^2119
— 当の~client【！it】は、
当の`~WebTransport~session$用の~dataをすでに送信した場合もあるので。
当の~client【！it】は、
~redirectについて当の`応用~client$へ通知しても`ヨイ^2119。
◎
The server may reply with a 3xx response, indicating a redirection (Section 15.4 of [HTTP]). The WebTransport client MUST NOT automatically follow such redirects, as it potentially could have already sent data for the WebTransport session in question; it MAY notify the application client about the redirect.
</p>

<p>
`CONNECT$m ~methodは`安全$とは見なされないので、
~clientは，~WebTransportを~0-RTT~packet内では起動し得ない
（ `HTTP3$r `早期~data＠~HTTPv3#early-data§を見よ）。
しかしながら，
~WebTransportに関係する `SETTINGS$ft ~parameterは、
`HTTP3$r `初期化＠~HTTPv3#settings-initialization§にて述べられるとおり，
前回の~sessionから維持してもよい。
~serverは、
~0-RTTを受容する場合には，［
~openな`~WebTransport~session$の最大な個数／
その他の初期~flow制御~値
］に対する上限を［
前回の~sessionの間に折衝した値
］から抑制しては`ナラナイ^2119 
— そのような変更は、
互換でないものと判断され，その結果は
`接続~error$( `H3_SETTINGS_ERROR$er )
にならなければ`ナラナイ^2119。
◎
Clients cannot initiate WebTransport in 0-RTT packets, as the CONNECT method is not considered safe (see Section 10.9 of [HTTP3]). However, WebTransport-related SETTINGS parameters may be retained from the previous session as described in Section 7.2.4.2 of [HTTP3]. If the server accepts 0-RTT, the server MUST NOT reduce the limit of maximum open WebTransport sessions, or other initial flow control values, from the values negotiated during the previous session; such change would be deemed incompatible, and MUST result in a H3_SETTINGS_ERROR connection error.
</p>

<p>
~HTTP~Upgrade~token `webtransport^c は、
`HTTP-DATAGRAM$r にて定義されるとおり，`~capsule~protocol$を利用する。
`~capsule~protocol$は、
~serverが `2xx$st 応答を送信するときに折衝される。
`Capsule-Protocol$h ~header `HTTP-DATAGRAM$r は，
~WebTransportには要求されないので、
`~WebTransport端点$は，それを安全に無視できる。
◎
The webtransport HTTP Upgrade Token uses the Capsule Protocol as defined in [HTTP-DATAGRAM]. The Capsule Protocol is negotiated when the server sends a 2xx response. The capsule-protocol header field Section 3.4 of [HTTP-DATAGRAM] is not required by WebTransport and can safely be ignored by WebTransport endpoints.
</p>

		</section>
		<section id="subprotocol-negotiation">
<h3 title="Application Protocol Negotiation">3.3. 応用~protocolの折衝</h3>

<p>
~HTTP3越しの~WebTransportは、
~ALPN `RFC7301$r に類似な~protocol折衝の仕組みを提供する
— その意図は、
既存の~protocolのうち［
~QUICを利用していて，この機能性に依拠するもの
］の~port法を単純~化することにある。
◎
WebTransport over HTTP/3 offers a protocol negotiation mechanism, similar to TLS Application-Layer Protocol Negotiation Extension (ALPN) [RFC7301]; the intent is to simplify porting existing protocols that use QUIC and rely on this functionality.
</p>

<p>
~clientは、
`CONNECT$m 要請~内に `WT-Available-Protocols$h ~headerを内包しても`ヨイ^2119。
この~fieldは、
アリな~protocolたちを選好~順序で列挙する
— 最も選好されるものが最初に挙げられるよう。
この~headerを受信した~serverは、
対する成功裡な応答（ `2xx$st ）内に `WT-Protocol$h ~fieldを内包しても`ヨイ^2119。
そうする場合、
~serverは，この~fieldに［
~clientからの~listから選んだ いずれか 1 つ
］を内包しなければ`ナラナイ^2119。
~serverは、
~clientが相応しい~protocolを内包しなかった場合には，
当の要請を却下しても`ヨイ^2119。
◎
The client MAY include a WT-Available-Protocols header field in the CONNECT request. The WT-Available-Protocols field enumerates the possible protocols in preference order, with the most preferred protocol listed first. If the server receives such a header, it MAY include a WT-Protocol field in a successful (2xx) response. If it does, the server MUST include a single choice from the client's list in that field. Servers MAY reject the request if the client did not include a suitable protocol.
</p>

<p>
［
`WT-Available-Protocols@h
,
`WT-Protocol@h
］は、
どちらも`有構造~field$ `FIELDS$r である。
`WT-Available-Protocols$h は、
`~sf~list$をとるものと定義され，
それを成す各~itemの値は`~sf文字列$に限り妥当になる。
`WT-Protocol$h は、
`~sf~item$をとるものと定義され，
その値は`~sf文字列$に限り妥当になる。
`~sf文字列$以外の型を成す値は、
~errorとして扱われなければ`ナラナイ^2119
（その結果，当の~field全体が無視される）。
どちらの~fieldにおいても，`~sf~parameter$用の意味論は定義されない
— それらは、
無視されなければ`ナラナイ^2119。
◎
Both WT-Available-Protocols and WT-Protocol are Structured Fields [FIELDS]. WT-Available-Protocols is a List. WT-Protocol is defined as an Item. In both cases, the only valid value type is a String. Any value type other than String MUST be treated as an error that causes the entire field to be ignored. No semantics are defined for parameters on either field; parameters MUST be ignored.
</p>

<p>
`WT-Protocol$h 応答~header内の値は、
それが応対した要請の `WT-Available-Protocols$h 内に挙げられた，
いずれかの値でなければ`ナラナイ^2119
他の場合、
当の `WT-Protocol^h ~fieldは無視されなければ`ナラナイ^2119。
◎
The value in the WT-Protocol response header field MUST be one of the values listed in WT-Available-Protocols of the request. Otherwise, the WT-Protocol field MUST be ignored.
</p>

<p>
［
`WT-Available-Protocols$h ／ `WT-Protocol$h
］内に利用される個々の値の意味論は、
当の~WebTransport資源により決定される
— ~IANAの
`~ALPN~protocol~ID~registry＠~IANA-a/tls-extensiontype-values/tls-extensiontype-values.xhtml#alpn-protocol-ids$cite
に登録することは、
要求されない。
◎
The semantics of individual values used in WT-Available-Protocols and WT-Protocol are determined by the WebTransport resource in question and are not required to be registered in IANA's "ALPN Protocol IDs" registry.
</p>

		</section>
		<section id="prioritization">
<h3 title="Prioritization">3.4. 優先度化</h3>

<p>
各`~WebTransport~session$は、
拡張d `CONNECT$m を利用して起動される。
`RFC9218$r `11＠~HTTPpriority#connect-scheduling§は，［
拡張-可能な優先度が`~CONNECT~stream$上に送信された~dataに どう適用できるか
］を述べるが、
~WebTransportは，［
要請と応答の関係において交換される~dataの種別
］を拡張する
— それには、
追加的な考慮点が要求される。
◎
WebTransport sessions are initiated using extended CONNECT. While Section 11 of [RFC9218] describes how extensible priorities can be applied to data sent on a CONNECT stream, WebTransport extends the types of data that are exchanged in relation to the request and response, which requires additional considerations.
</p>

<p>
~WebTransport `CONNECT$m 要請, それに対する応答は、
`Priority$h ~header `RFC9218$r を包含しても`ヨイ^2119。
~clientは、
`PRIORITY_UPDATE$ft ~frame `RFC9218$r を送信することにより，
優先度化し直しても`ヨイ^2119。
`RFC9218$r に対する拡張においては、［
~client, ~server
］は，
当の封入している【？】`~WebTransport~session$内に自身が送信するすべての~data
— `~capsule$,
`~WebTransport~stream$,
~WebTransport~datagram
を含む —
に［
`RFC9218$r `9＠~HTTPpriority#client-scheduling§,
`RFC9218$r `10＠~HTTPpriority#server-scheduling§
］による~schedule法の指導をどちらも適用することが`推奨される^2119。
~WebTransportは、
`~WebTransport~session$の中の［
~streamたち, ~datagramたち
］用に優先度を通達するための仕組みを何も供さない
— そのような仕組みは、
~WebTransportを利用している応用~protocolが定義し得る。
そのような仕組みは、
ある~sessionの中での~schedule法に限り影響し，
同じ`~HTTP3接続$上の他の~dataの~schedule法には影響しないことが`推奨される^2119。
◎
WebTransport CONNECT requests and responses MAY contain the Priority header field (Section 5 of [RFC9218]); clients MAY reprioritize by sending PRIORITY_UPDATE frames (Section 7 of [RFC9218]). In extension to [RFC9218], it is RECOMMENDED that clients and servers apply the scheduling guidance in both Section 9 of [RFC9218] and Section 10 of [RFC9218] for all data that they send in the enclosing WebTransport session, including Capsules, WebTransport streams and datagrams. WebTransport does not provide any priority signaling mechanism for streams and datagrams within a WebTransport session; such mechanisms can be defined by application protocols using WebTransport. It is RECOMMENDED that such mechanisms only affect scheduling within a session and not scheduling of other data on the same HTTP/3 connection.
</p>

<p>
`RFC9218$r `8＠~HTTPpriority#merging§における［
~clientの優先度, ~serverの優先度
］を併合するための指導は、
`~WebTransport~session$にも適用される。
例えば，ある応答にて `Priority$h ~headerを受信した~clientは、
ある`~WebTransport~session$の優先度に関する自身の~viewを改めることもでき，
その結果として流出~dataの~schedule法を改めることもできる。
◎
The client/server priority merging guidance in Section 8 of [RFC9218] also applies to WebTransport sessions. For example, a client that receives a response Priority header field could alter its view of a WebTransport session priority and alter the scheduling of outgoing data as a result.
</p>

<p>
端点は、
`~WebTransport~session$たちを優先度化する際に，［
それらが同じ`~HTTP3接続$上の他の~sessionや要請と どう相互作用するか
］について考慮する必要がある。
◎
Endpoints that prioritize WebTransport sessions need to consider how they interact with other sessions or requests on the same HTTP/3 connection.
</p>

		</section>
	</section>
	<section id="webtransport-features">
<h2 title="WebTransport Features">4. ~WebTransport特能</h2>

<p>
~HTTP3越しの~WebTransportは、
`OVERVIEW$r にて述べられた特能として［
`一方向~stream$,
`双方向~stream$,
~datagram
］を供する
— どちらの端点も，これらすべてを起動し得る。
［
~HTTP3越しの~WebTransportと伴に利用するよう設計された~protocol
］の特能は、
これらに拘束される。
`~capsule~protocol$は、
~HTTP3越しの~WebTransportの実装の詳細であり，
~WebTransport特能ではない。
◎
WebTransport over HTTP/3 provides the following features described in [OVERVIEW]: unidirectional streams, bidirectional streams, and datagrams, all of which can be initiated by either endpoint. Protocols designed for use with WebTransport over HTTP/3 are constrained to these features. The Capsule Protocol is an implementation detail of WebTransport over HTTP/3 and is not a WebTransport feature.
</p>

<p>
`~session~ID$は、［
~stream, ~datagram
］たちを それらが属する`~WebTransport~session$ごとに逆多重化するために利用される。
伝送路~上では、
`~session~ID$は［
~QUIC `RFC9000$r にて述べられる`可変長な整数$用の~scheme
］を利用して符号化される。
◎
Session IDs are used to demultiplex streams and datagrams belonging to different WebTransport sessions. On the wire, session IDs are encoded using the QUIC variable length integer scheme described in [RFC9000].
</p>

<p>
~clientは、
`CONNECT$m 要請に対する応答を まだ受信してないときでも，楽観的に、
当の要請を送信した~session上に［
`一方向~stream$／`双方向~stream$
］を~openしても，~datagramを送信しても`ヨイ^2119。
~server側は、
`CONNECT$m 要請を受信したなら，［
~streamを~openする／~datagramを送信する
］ことがアリになる。
◎
The client MAY optimistically open unidirectional and bidirectional streams, as well as send datagrams, on a session for which it has sent the CONNECT request, even if it has not yet received the server's response to the request. On the server side, opening streams and sending datagrams is possible as soon as the CONNECT request has been received.
</p>

<p>
受信者は、
いつでも［
~clientが起動した`双方向~stream$用の妥当な~ID
］になり得ない`~session~ID$を受信したときは，
~error~code `H3_ID_ERROR$er で当の接続を~closeしなければ`ナラナイ^2119。
◎
If at any point a session ID is received that cannot be a valid ID for a client-initiated bidirectional stream, the recipient MUST close the connection with an H3_ID_ERROR error code.
</p>

		<section id="transport-properties">
<h3 title="Transport Properties">4.1. ~transport~prop</h3>

<p>
`~WebTransport~framework^cite `OVERVIEW$r は、
~clientが［
各種~特能
— ［
すべての~WebTransport~protocolを介して可用な~propたちが成す共通な集合
］を超えて追加的な最適化を許容するかもしれない特能 —
の有無を決定する
］ために利用できる［
任意選択な`~transport~prop＠~WT-OVERVIEW#transport-properties$たちが成す集合
］を定義する。
◎
The WebTransport framework [OVERVIEW] defines a set of optional transport properties that clients can use to determine the presence of features which might allow additional optimizations beyond the common set of properties available via all WebTransport protocols.
</p>

<p>
以下は、
~HTTP3越しの~WebTransportにおける［
これらの~prop用の~support
］についての詳細である：
◎
Below are details about support in WebTransport over HTTP/3 for the properties defined by the WebTransport framework.
</p>
<dl>
	<dt>
不依拠-可能な送達：
◎
Unreliable Delivery:
</dt>
	<dd>
~HTTP3越しの~WebTransportは、
`不依拠-可能$な送達を~supportする。
喪失した~stream~data内の~stream結果を~resetしても，もはや伝送し直されなくなる。
~HTTP3越しの~WebTransportは、
~datagramも~supportする
— それは、
伝送し直されない。
◎
WebTransport over HTTP/3 supports unreliable delivery. Resetting a stream results in lost stream data no longer being retransmitted. WebTransport over HTTP/3 also supports datagrams, which are not retransmitted.
</dd>

	<dt>
~pool法
◎
Pooling:
</dt>
	<dd>
~HTTP3越しの~WebTransportは、
任意選択な［
~poolするための~support
］を供する。
端点は、
`SETTINGS_WT_MAX_SESSIONS$sp 設定を利用して，
特定0の~HTTP3接続~上で~pool法が~supportされるか否かを指示できる
（`~transport能力がある~HTTP3接続の確立-法＠#establishing§）。
◎
WebTransport over HTTP/3 provides optional support for pooling. Endpoints can use the SETTINGS_WT_MAX_SESSIONS setting to indicate if pooling is supported on a particular HTTP/3 connection (Section 3.1).
</dd>
</dl>

		</section>
		<section id="unidirectional-streams">
<h3 title="Unidirectional streams">4.2. 一方向~stream</h3>

<p>
`~WebTransport端点$は、
`一方向~stream$を起動できる。
~HTTP3の`一方向~stream$の種別は、
`0x54^hex でなければ`ナラナイ^2119【！SHALL】。
~streamの本体は、
順に，次に挙げるものからなっていなければ`ナラナイ^2119【！SHALL】（ `図 2＠#fig-unidi$ ）
⇒＃
`可変長な整数$として符号化された~stream種別,
`可変長な整数$として符号化された`~session~ID$,
【~streamの】利用者が指定した~stream~data
◎
WebTransport endpoints can initiate unidirectional streams. The HTTP/3 unidirectional stream type SHALL be 0x54. The body of the stream SHALL be the stream type, followed by the session ID, encoded as a variable-length integer, followed by the user-specified stream data (Figure 2).
</p>

<figure id="fig-unidi">
<pre class="frame-diagram">
一方向~stream {
  ~stream種別 (i) = `0x54^hex,
  `~session~ID$ (i),
  利用者が指定した~stream~data (..)
}
◎
Unidirectional Stream {
  Stream Type (i) = `0x54^hex,
  Session ID (i),
  User-Specified Stream Data (..)
}
</pre>
<figcaption>
図 2.
一方向~WebTransport~streamの形式
◎
Figure 2: Unidirectional WebTransport stream format
</figcaption></figure>

		</section>
		<section id="bidirectional-streams">
<h3 title="Bidirectional Streams">4.3. 双方向~stream</h3>

<p>
~clientが起動した`双方向~stream$は、
~HTTP3により，すべて要請~streamとして予約される
— それは、
各種~規則を伴う~HTTP3~frameたちが成す連列である
（ `HTTP3$r `~HTTPの~message~frame法＠~HTTPv3#request-response§, `双方向~stream＠~HTTPv3#request-streams§を見よ）。
◎
All client-initiated bidirectional streams are reserved by HTTP/3 as request streams, which are a sequence of HTTP/3 frames with a variety of rules (see Sections 4.1 and 6.1 of [HTTP3]).
</p>

<p>
~WebTransportは、
代替な要請~stream規則を［
宣言する／利用する
］ことを~clientに許容するよう，~HTTP3を拡張する。
~clientは、［
`~WebTransportの~support＠#establishing$を指示している設定群
］を受信したなら，自身が起動した各~双方向~WebTransport~streamに対し
⇒
［
それを成す最初の~byte列
］として［
`可変長な整数$として符号化された特別な通達~値
］を送信して［
当の~stream上の残りの~byte列がどう利用されるか
］を指示しなければ`ナラナイ^2119。
◎
WebTransport extends HTTP/3 to allow clients to declare and to use alternative request stream rules. Once a client receives settings indicating WebTransport support (Section 3.1), it MUST send a special signal value, encoded as a variable-length integer, as the first bytes of each bidirectional WebTransport stream it initiates to indicate how the remaining bytes on the stream are used.
</p>

<p>
~WebTransportは、
~serverが起動したすべての`双方向~stream$用の規則を定義することにより，
~HTTP3を拡張する。
~serverは、
`~WebTransport~session$を`確立して＠#establishing$いる流入 `CONNECT$m 要請を受信したなら，
その~sessionと伴に利用する`双方向~stream$を~openできる。
~serverは、［
この~streamを成す最初の~byte列
］として［
`可変長な整数$として符号化された特別な通達~値
］を送信しなければ`ナラナイ^2119
— それは、［
この~stream上の残りの~byte列がどう利用されるか
］を指示する。
◎
WebTransport extends HTTP/3 by defining rules for all server-initiated bidirectional streams. Once a server receives an incoming CONNECT request establishing a WebTransport session (Section 3.1), it can open a bidirectional stream for use with that session and MUST send a special signal value, encoded as a variable-length integer, as the first bytes of the stream in order to indicate how the remaining bytes on the stream are used.
</p>

<p>
［
~client, ~server
］は、
通達~値 `0x41^hex を利用して，
双方向~WebTransport~streamを~openする。
これには、
それに結付けられる［
`可変長な整数$として符号化された`~session~ID$
］が後続する。
残りは、
当の~streamを成す応用~payloadである
（ `図 3＠#fig-bidi-client$）。
◎
Clients and servers use the signal value 0x41 to open a bidirectional WebTransport stream. Following this is the associated session ID, encoded as a variable-length integer; the rest of the stream is the application payload of the WebTransport stream (Figure 3).
</p>

<figure id="fig-bidi-client">
<pre class="frame-diagram">
双方向~stream {
  通達~値 (i) = 0x41,
  `~session~ID$ (i),
  ~stream本体 (..)
}
◎
Bidirectional Stream {
  Signal Value (i) = 0x41,
  Session ID (i),
  Stream Body (..)
}
</pre>
<figcaption>
図 3.
双方向~WebTransport~streamの形式
◎
Figure 3: Bidirectional WebTransport stream format
</figcaption></figure>

<p>
この文書は、
特別な通達~値 `0x41^hex を~frame種別
`WT_STREAM$ft
として予約する。
それは、
衝突を避けるため，~HTTP3~frame種別として登録されるが、
長さを欠如するので，適正な~HTTP3~frameではない。
`WT_STREAM$ft は，~HTTP3~frame構文の拡張であり、
~WebTransportを折衝している相手の端点は，それを~supportしなければ`ナラナイ^2119。
この拡張を実装する端点は、
追加的な~frame取扱い要件の~subjectにもなる。
端点は、
要請~streamを成す一番最初の~byte列~以外において，
~HTTP3~stream上に~frame種別 `WT_STREAM$ft を送信しては`ナラナイ^2119。
他の状況下で，この~frame種別を受信した場合、
`接続~error$( `H3_FRAME_ERROR$er )
として扱わなければ`ナラナイ^2119。
◎
This document reserves the special signal value 0x41 as a WT_STREAM frame type. While it is registered as an HTTP/3 frame type to avoid collisions, WT_STREAM lacks length and is not a proper HTTP/3 frame; it is an extension of HTTP/3 frame syntax that MUST be supported by any peer negotiating WebTransport. Endpoints that implement this extension are also subject to additional frame handling requirements. Endpoints MUST NOT send WT_STREAM as a frame type on HTTP/3 streams other than the very first bytes of a request stream. Receiving this frame type in any other circumstances MUST be treated as a connection error of type H3_FRAME_ERROR.
</p>

		</section>
		<section id="resetting-data-streams">
<h3 title="Resetting Data Streams">4.4. ~data~streamの~reset法</h3>

<p>
`~WebTransport端点$は、
~WebTransport~data~stream用に［
`RESET_STREAM$ft ／ `STOP_SENDING$ft
］~frameを送信してもよい。
それらの通達は、
当の~WebTransport実装により，応用へ伝播される。
◎
A WebTransport endpoint may send a RESET_STREAM or a STOP_SENDING frame for a WebTransport data stream. Those signals are propagated by the WebTransport implementation to the application.
</p>

<p>
~WebTransport応用は、
自身の演算~用に~error~codeを供さなければ`ナラナイ^2119。
~WebTransportは，~error~code空間を~HTTP3と共有するので、
~stream用の~WebTransport応用~errorは、
無符号な 32 ~bitな整数
— `0x00000000^hex 〜 `0xffffffff^hex —
に制限される。
~WebTransport実装は、
それらの~error~codeを `WT_APPLICATION_ERROR$er 用に予約された~error範囲の中へ対応付直さなければ`ナラナイ^2119
— `0x00000000^hex は `0x52e4a40fa8db^hex に,
`0xffffffff^hex は `0x52e5ac983162^hex に対応するよう。
この範囲の内側には、
`HTTP3$r `~HTTP3~error~code＠~HTTPv3#http-error-codes§により予約-済みな符号点たち
{ `0x1f^hex ~MUL %N ~PLUS `0x21^hex ； %N は負でない整数 }
があることに注意
— これらの符号点は、
~error~codeたちを対応付けるときには，飛ばされる必要がある
（すなわち、
ある予約-済みな符号点を挟んで隣接な 2 個の~HTTP3~error符号点は，
2 個の隣接な~WebTransport応用~error符号点に対応付けられる）。
対応付け用の`疑似-~code例＠#fig-remap-errors$は：
◎
A WebTransport application MUST provide an error code for those operations. Since WebTransport shares the error code space with HTTP/3, WebTransport application errors for streams are limited to an unsigned 32-bit integer, assuming values between 0x00000000 and 0xffffffff. WebTransport implementations MUST remap those error codes into the error range reserved for WT_APPLICATION_ERROR, where 0x00000000 corresponds to 0x52e4a40fa8db, and 0xffffffff corresponds to 0x52e5ac983162. Note that there are codepoints inside that range of form "0x1f * N + 0x21" that are reserved by Section 8.1 of [HTTP3]; those have to be skipped when mapping the error codes (i.e., the two HTTP/3 error codepoints adjacent to a reserved codepoint would map to two adjacent WebTransport application error codepoints). An example pseudocode can be seen in Figure 4.
</p>

<figure id="fig-remap-errors">
<pre>
%first = 0x52e4a40fa8db
%last = 0x52e5ac983162

def webtransport_code_to_http_code(%n):
return %first + %n + floor(%n / 0x1e)

def http_code_to_webtransport_code(%h):
assert(%first &lt;= %h &lt;= %last)
assert((%h - 0x21) % 0x1f != 0)
%shifted = %h - %first
return %shifted - floor(%shifted / 0x1f)
</pre>
<figcaption>
図 4.
~WebTransport応用~errorと~HTTP3~error~codeを相互に変換するための疑似-~code
◎
Figure 4: Pseudocode for converting between WebTransport application errors and HTTP/3 error codes
</figcaption></figure>

<p>
各~WebTransport~data~stream %~stream には、
当の~streamの始めにある~header %~header を通して，ある`~WebTransport~session$ %~session が結付けられる
— %~stream を`~reset$すると、
その~data【`~session~ID$】は， `RESET_STREAM$ft ~frameを利用するときに破棄される結果になるかもしれない。
これを防止するため、
~WebTransport実装は， %~stream を`~reset$するときには `RESET_STREAM_AT$ft ~frame `RESET-STREAM-AT$r を利用しなければナラナイ
— その~frameを成す `依拠-可能な~size^i（ `Reliable Size^en ） ~fieldを %~header の~size以上に設定して。
これは、［
%~stream を %~session へ結付けている~ID~field【`~session~ID$】
］の依拠-可能な送達を確保する。
◎
WebTransport data streams are associated with sessions through a header at the beginning of the stream; resetting a stream might result in that data being discarded when using a RESET_STREAM frame. To prevent this, WebTransport implementations MUST use the RESET_STREAM_AT frame [RESET-STREAM-AT] with a Reliable Size set to at least the size of the WebTransport header when resetting a WebTransport data stream. This ensures reliable delivery of the ID field associating the data stream with a WebTransport session.
</p>

<p>
`~WebTransport端点$は、［
既知な~sessionが結付けられた~stream
］に対しては，それ用の~error~codeを当の~sessionを所有する応用へ回送しなければ`ナラナイ^2119。
類似に，`媒介者$は、
相手の端点から~resetを受信したときは，
対応する~error~codeで そのような~streamを`~reset$しなければ`ナラナイ^2119。
◎
WebTransport endpoints MUST forward the error code for a stream associated with a known session to the application that owns that session; similarly, intermediaries MUST reset such streams with a corresponding error code when receiving a reset from their peer.
</p>

		</section>
		<section id="datagrams">
<h3 title="Datagrams">4.5. ~datagram</h3>

<p>
~datagramは、
`~HTTP~datagram$ `HTTP-DATAGRAM$r を利用して送信できる。
~WebTransport~datagramの~payloadは、
`~HTTP~datagram$を成す `~HTTP~datagram~payload^i ~field内に改変されずに送信される。
それは、
`四分~stream~ID^i ~fieldの直後に後続することに注意
— この~fieldは、
当の~QUIC `DATAGRAM$ft ~frameの~payloadを成す始端にあり，
`~WebTransport~session$を確立した`~CONNECT~stream$を指す。
◎
Datagrams can be sent using HTTP Datagrams. The WebTransport datagram payload is sent unmodified in the "HTTP Datagram Payload" field of an HTTP Datagram (Section 2.1 of [HTTP-DATAGRAM]). Note that the payload field directly follows the Quarter Stream ID field, which is at the start of the QUIC DATAGRAM frame payload and refers to the CONNECT stream that established the WebTransport session.
</p>

		</section>
		<section id="buffering-incoming">
<h3 title="Buffering Incoming Streams and Datagrams">4.6. 流入~stream／~datagramの~buffer法</h3>

<p>
~HTTP3越しの~WebTransportにおいては、
~clientは，`~WebTransport~session$を確立する前に［
~WebTransport用の~Upgrade~tokenを利用している `CONNECT$m 要請
］を送信する
（`~transport能力がある~HTTP3接続の確立-法＠#establishing§を見よ）
ことにより［
~serverから `SETTINGS$ft ~frameが受信される
］のを待機しなければナラナイ。
これは、［
所与の`~HTTP3接続$上で~WebTransportの各~versionのうち，どれが利用できるか
］を~clientが常に知れることを確保する。
◎
In WebTransport over HTTP/3, the client MUST wait for receipt of the server's SETTINGS frame before establishing any WebTransport sessions by sending CONNECT requests using the WebTransport upgrade token (see Section 3.1). This ensures that the client will always know what versions of WebTransport can be used on a given HTTP/3 connection.
</p>

<p>
しかしながら~clientは、
`SETTINGS$ft ~frameに加えて，複数個の［
~WebTransport `CONNECT$m 要請,
~WebTransport~data~stream,
~WebTransport~datagram
］を単独の~flightの中で一括して送信しても`ヨイ^2119。
それらは順序どおりに到着しないこともあるので、
`~WebTransport~server$は，［
~streamや~datagram
］を対応する~sessionを伴わずに受信する状況に置かれることもある。
類似に、
~clientは，~serverが起動した［
~stream／~datagram
］を［
~serverから `CONNECT$m 応答~headerを受信する前
］に受信することもある。
◎
Clients can, however, send a SETTINGS frame, multiple WebTransport CONNECT requests, WebTransport data streams, and WebTransport datagrams all within a single flight. As those can arrive out of order, a WebTransport server could be put into a situation where it receives a stream or a datagram without a corresponding session. Similarly, a client may receive a server-initiated stream or a datagram before receiving the CONNECT response headers from the server.
</p>

<p>
この事例を取扱うため、
`~WebTransport端点$は，［
~stream／~datagram
］を［
ある確立された~sessionに結付けれるようになる
］まで~bufferする`ベキ^2119である。
資源の枯渇を避けるため、
当の端点は，~bufferされる［
~stream／~datagram
］の個数を制限しなければ`ナラナイ^2119。
~bufferされた~streamの個数が それを超過したときは、
ある~streamが，
~error~code `WT_BUFFERED_STREAM_REJECTED$er を伴う［
`RESET_STREAM$ft ／ `STOP_SENDING$ft
］を送信することにより~closeされなければ`ナラナイ^2119【！SHALL】。
~bufferされた~datagramの個数が それを超過したときは、
ある~datagramが落とされなければ`ナラナイ^2119【！SHALL】。
破棄する［
~stream／~datagram
］としてどれを選ぶかは、
実装に委ねられる。
◎
To handle this case, WebTransport endpoints SHOULD buffer streams and datagrams until they can be associated with an established session. To avoid resource exhaustion, endpoints MUST limit the number of buffered streams and datagrams. When the number of buffered streams is exceeded, a stream SHALL be closed by sending a RESET_STREAM and/or STOP_SENDING with the WT_BUFFERED_STREAM_REJECTED error code. When the number of buffered datagrams is exceeded, a datagram SHALL be dropped. It is up to an implementation to choose what stream or datagram to discard.
</p>

		</section>
		<section id="interaction-with-the-http3-goaway-frame">
<h3 title="Interaction with the HTTP/3 GOAWAY frame">4.7. ~HTTP3 `GOAWAY$ft ~frameとの相互作用</h3>

<p>
~HTTP3は、
上品な~shutdownの仕組みを定義する
（ `HTTP3$r `接続の~shutdown＠~HTTPv3#connection-shutdown§）
— それは、
双方の端点に次を許容する
⇒
`GOAWAY$ft ~frameを送信して，もはや新たな流入［
要請／~push
］を受容しないことを指示する
◎
HTTP/3 defines a graceful shutdown mechanism (Section 5.2 of [HTTP3]) that allows a peer to send a GOAWAY frame indicating that it will no longer accept any new incoming requests or pushes.
</p>

<p>
`GOAWAY$ft ~frameを受信した~clientは、
当の`~HTTP3接続$に対し，新たな`~WebTransport~session$用の `CONNECT$m 要請を起動し得ない
— 同じ相手の端点との新たな`~WebTransport~session$を起動するためには、
新たな`~HTTP3接続$を~openしなければならない。
◎
A client receiving GOAWAY cannot initiate CONNECT requests for new WebTransport sessions on that HTTP/3 connection; it must open a new HTTP/3 connection to initiate new WebTransport sessions with the same peer.
</p>

<p>
~HTTP3 `GOAWAY$ft ~frameは、［
すべての`~WebTransport~session$に対し，~shutdownを起動する
］よう応用へ通達するものでもある。
どちらの端点も、
`WT_DRAIN_SESSION$cps
（ `0x78ae^hex ）`~capsule$を送信して，
単独の`~WebTransport~session$を~shut-downできる。
◎
An HTTP/3 GOAWAY frame is also a signal to applications to initiate shutdown for all WebTransport sessions. To shut down a single WebTransport session, either endpoint can send a WT_DRAIN_SESSION (0x78ae) capsule.
</p>

<figure id="fig-wt_drain_session">
<pre class="frame-diagram">
WT_DRAIN_SESSION ~capsule {
  種別 (i) = WT_DRAIN_SESSION,
  長さ (i) = 0
}
◎
WT_DRAIN_SESSION Capsule {
  Type (i) = WT_DRAIN_SESSION,
  Length (i) = 0
}
</pre>
<figcaption>
図 5.
`WT_DRAIN_SESSION^cps ~capsule形式
◎
Figure 5:
WT_DRAIN_SESSION Capsule Format
</figcaption></figure>

<p>
端点は、［
`WT_DRAIN_SESSION$cps `~capsule$／
~HTTP3 `GOAWAY$ft ~frame
］を［
送信した／受信した
］（順不同）後でも，［
当の~sessionの利用を継続しても`ヨイ^2119／
当の~sessionで新たな~WebTransport~streamを~openしても`ヨイ^2119
］（順不同）。
通達は、
~WebTransportを利用している応用~用に意図される
— 応用には、
アリな限り，当の~sessionを上品に終了するよう試みることが期待される。
◎
After sending or receiving either a WT_DRAIN_SESSION capsule or a HTTP/3 GOAWAY frame, an endpoint MAY continue using the session and MAY open new WebTransport streams. The signal is intended for the application using WebTransport, which is expected to attempt to gracefully terminate the session as soon as possible.
</p>

<p>
`WT_DRAIN_SESSION$cps ~capsuleは、
`端点間$な`~WebTransport~session$が`媒介者$を通過するときに有用になる。
例えば，~backendは、
~shut-downするときには，媒介者へ `GOAWAY$ft を送信する。
当の媒介者は、
~clientが面している~session上では，
この通達を `WT_DRAIN_SESSION$cps ~capsuleへ変換できる
— 当の接続~上で運ばれる他の［
要請／~session
］に影響iすることなく。
◎
The WT_DRAIN_SESSION capsule is useful when an end-to-end WebTransport session passes through an intermediary. For example, when the backend shuts down, it sends a GOAWAY to the intermediary. The intermediary can convert this signal to a WT_DRAIN_SESSION capsule on the client-facing session, without impacting other requests or sessions carried on that connection.
</p>

		</section>
		<section id="use-of-keying-material-exporters">
<h3 title="Use of Keying Material Exporters">4.8. 鍵~用~素材~exporterの利用</h3>

<p>
~HTTP3越しの~WebTransportは、
~TLS鍵~用~素材~exporter（ `TLS keying material exporter^en ）の利用を~supportする
`RFC8446$r, `7.5＠~RFCx/rfc8446#section-7.5§。
複数の`~WebTransport~session$が同じ下層の~QUIC接続を共有し得るので、
~WebTransportは、［
異なる~sessionどうしで鍵~用~素材を分離する
］ために［
ある~TLS~exporterを導出するための仕組み
］を定義する。
応用が所与の`~WebTransport~session$用に［
指定された［
~label, 文脈
］を伴う~exporter
］を要請する場合、
結果の~exporterは，
`RFC8446$r `7.5＠~RFCx/rfc8446#section-7.5§ に定義されるとおりの~TLS~exporter
— 当の~labelは "`EXPORTER-WebTransport^c" に設定され,
当の文脈は［
下に定義される `~WebTransport~exporter文脈^i 構造体
］の直列化に設定されたそれ —
でなければ`ナラナイ^2119【！SHALL】。
◎
WebTransport over HTTP/3 supports the use of TLS keying material exporters Section 7.5 of [RFC8446]. Since the underlying QUIC connection may be shared by multiple WebTransport sessions, WebTransport defines a mechanism for deriving a TLS exporter that separates keying material for different sessions. If the application requests an exporter for a given WebTransport session with a specified label and context, the resulting exporter SHALL be a TLS exporter as defined in Section 7.5 of [RFC8446] with the label set to "EXPORTER-WebTransport" and the context set to the serialization of the "WebTransport Exporter Context" struct as defined below.
</p>

<figure id="fig-wt-exporter-context">
<pre class="frame-diagram">
~WebTransport~exporter文脈 {
  ~session~ID (64),
  応用から給された~exporter~labelの長さ (8),
  応用から給された~exporter~label (8..),
  応用から給された~exporter文脈の長さ (8),
  応用から給された~exporter文脈 (..)
}
◎
WebTransport Exporter Context {
  WebTransport Session ID (64),
  WebTransport Application-Supplied Exporter Label Length (8),
  WebTransport Application-Supplied Exporter Label (8..),
  WebTransport Application-Supplied Exporter Context Length (8),
  WebTransport Application-Supplied Exporter Context (..)
}
</pre>
<figcaption>
図 6.
~WebTransport~exporter文脈~構造体
◎
Figure 6:
WebTransport Exporter Context struct
</figcaption></figure>

<p>
~TLS~exporter~APIは、
`文脈^i ~fieldを省略することを許可するかもしれない。
そのような事例では、
~TLS 1.3 と同じく，
`応用から給された~exporter文脈^i が省略された場合，その長さは 0 になる。
◎
A TLS exporter API might permit the context field to be omitted. In this case, as with TLS 1.3, the WebTransport Application-Supplied Exporter Context becomes zero-length if omitted.
</p>

		</section>
	</section>
	<section id="flow-control">
<h2 title="Flow Control">5. ~flow制御</h2>

<p>
~flow制御は、［
消費できる資源／送信できる~data
］の量を統治する。
端点は、
~HTTP3越しの~WebTransportを利用しているときは，
次を制限できる：
◎
Flow control governs the amount of resources that can be consumed or data that can be sent. When using WebTransport over HTTP/3, endpoints can limit＼
</p>

<ul>
	<li>
相手の端点が単独の`~HTTP3接続$上で作成できる~sessionの個数
◎
the number of sessions that a peer can create on a single HTTP/3 connection＼
</li>
	<li>
相手の端点が ある~sessionの中で作成できる~streamの個数
◎
and the number of streams that a peer can create within a session.＼
</li>
	<li>
各~sessionが消費できる~data量
◎
Endpoints can also limit the amount of data that can be consumed by each session＼
</li>
	<li>
ある~sessionの中の各~streamが消費できる~data量
◎
and by each stream within a session.
</li>
</ul>

<p>
~HTTP3越しの~WebTransportは：
◎
WebTransport over HTTP/3＼
</p>
<ul>
	<li>
接続~levelの上限を供する
— それは、
所与の`~HTTP3接続$に対し
⇒
そこで作成できる~sessionの個数を統治する
（`同時な~session数の制限-法＠#flow-control-limit-sessions§を見よ）。
◎
provides a connection-level limit that governs the number of sessions that can be created on an HTTP/3 connection (see Section 5.2).＼
</li>
	<li>
<p>
~session~levelの上限も供する
— それは、
所与の~sessionに対し：
</p>
		<ul>
			<li>
そこで作成できる~streamの個数を統治する
（`~sessionの中の~stream数の制限-法＠#flow-control-limit-streams§を見よ）。
</li>
			<li>
その中のすべての~streamにわたって交換できる総~data量を制限する。
【`~data上限＠#flow-control-limit-data§を見よ】
</li>
		</ul>
◎
It also provides session-level limits that govern the number of streams that can be created in a session and limit the amount of data that can be exchanged across all streams in each session (see Section 5.3).
</li>
</ul>

<p>
下層の~QUIC接続も［
接続~level, ~stream~level
］の~flow制御を供する。
~QUIC接続に対する~data上限は、［
すべての`~WebTransport~session$,
他の非-~WebTransport~stream
］にわたって送信できる~dataの総~量を定義する。
~QUIC~streamに対する~data上限は、
~WebTransport~streamか否かを問わず，
当の~stream上に送信できる~dataの量を制御する
（ `RFC9000$r `~flow制御＠~RFCx/rfc9000#flow-control§ を見よ）。
◎
The underlying QUIC connection provides connection and stream level flow control. The QUIC connection data limit defines the total amount of data that can be sent across all WebTransport sessions and other non-WebTransport streams. A QUIC stream's data limit controls the amount of data that can be sent on that stream, WebTransport or otherwise (see Section 4 of [RFC9000]).
</p>

		<section id="flow-control-negotiate">
<h3 title="Negotiating the Use of Flow Control">5.1. ~flow制御の利用の折衝-法</h3>

<p>
`~WebTransport端点$は、［
複数の`~WebTransport~session$が下層の~transport接続を共有する
］ことを許容するためには，
~flow制御を可能化しなければ`ナラナイ^2119。
これは、
応用が［
単独の~session上で過度な資源を消費する,
他の~session用の流通を後回する
］ことを防止する
（`~securityの考慮点＠#security-considerations§を見よ）。
◎
A WebTransport endpoint that allows a WebTransport session to share an underlying transport connection with other WebTransport sessions MUST enable flow control. This prevents an application from consuming excessive resources on a single session and starving traffic for other sessions (see Section 8).
</p>

<p>
~flow制御は、
どちらの端点も~flow制御を利用する意図を宣言したとき，
可能化される
— `SETTINGS_WT_MAX_SESSIONS$sp が値 1 を伴って送信された場合でも。
各~端点は、
次に挙げるいずれかの動作をとることにより，
~flow制御を利用する意図を宣言する：
◎
Flow control is enabled when both endpoints declare their intent to use flow control, even if SETTINGS_WT_MAX_SESSIONS is sent with a value of "1". Endpoints declare their intent to use flow control by taking any of the following actions:
</p>
<ul>
	<li>
2 以上の値を伴う `SETTINGS_WT_MAX_SESSIONS$sp を送信する。
◎
Sending SETTINGS_WT_MAX_SESSIONS with a value greater than "1".
</li>
	<li>
0 以外の値を伴う `SETTINGS_WT_INITIAL_MAX_STREAMS_UNI$sp を送信する。
◎
Sending SETTINGS_WT_INITIAL_MAX_STREAMS_UNI with any value other than "0".
</li>
	<li>
0 以外の値を伴う `SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI$sp を送信する。
◎
Sending SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI with any value other than "0".
</li>
	<li>
0 以外の値を伴う `SETTINGS_WT_INITIAL_MAX_DATA$sp を送信する。
◎
Sending SETTINGS_WT_INITIAL_MAX_DATA with any value other than "0".
</li>
</ul>

<p>
どちらの端点も，これらの動作のうち一つ以上をとった場合、
~flow制御は可能化され，
`~flow制御＠#flow-control§にて述べられる制限sすべてが適用される。
◎
If both endpoints take at least one of these actions, flow control is enabled, and the limits described in the entirety of Section 5 apply.
</p>

<p>
これらの判定基準に `SETTINGS$ft を成す各種~flow制御~設定を含めることは、
1 個の`~WebTransport~session$しか~supportされない場合でも，［
互いの端点が，~flow制御を明示的に可能化することに合意する
］ことを許容する。
◎
The inclusion of the flow control SETTINGS in these criteria allows endpoints to agree to explicitly enable flow control, even if only a single WebTransport session is supported.
</p>

<p>
~flow制御が可能化されない場合：
◎
If flow control is not enabled,＼
</p>
<ul>
	<li>
~clientは、
複数個の同時な`~WebTransport~session$を確立するよう試みては`ナラナイ^2119。
◎
clients MUST NOT attempt to establish more than one simultaneous WebTransport session.＼
</li>
	<li>
~serverは、［
下層の~transport接続~上で複数個の~sessionを受信した
］ときは，
過度な`~CONNECT~stream$を
`H3_REQUEST_REJECTED$er 状態sで`~reset$しなければ`ナラナイ^2119
（`同時な~session数の制限-法＠#flow-control-limit-sessions§を見よ）。
◎
A server that receives more than one session on an underlying transport connection when flow control is not enabled MUST reset the excessive CONNECT streams with a H3_REQUEST_REJECTED status (see Section 5.2).
</li>
	<li>
端点は、
`~flow制御~capsule$の受領を無視しなければ`ナラナイ^2119
— ［
相手の端点は，それらが送信された時点では `SETTINGS$ft をまだ受信してない／
~packetたちは並替えられた
］かもしれないので。
◎
Also, if flow control is not enabled, an endpoint MUST ignore receipt of any flow control capsules (see Section 5.6), since the peer might not have received SETTINGS at the time they were sent or packets might have been reordered.
</li>
</ul>

		</section>
		<section id="flow-control-limit-sessions">
<h3 title="Limiting the Number of Simultaneous Sessions">5.2. 同時な~session数の制限-法</h3>

<p>
この文書は、
`SETTINGS_WT_MAX_SESSIONS$sp 設定を定義する
— それは、
単独の`~HTTP3接続$上で同時並行な`~WebTransport~session$の最大~個数を制限することを
~serverに許容する。
~clientは、
~serverからの `SETTINGS$ft ~parameter内に指示された個数より多い~sessionを同時に~openしては`ナラナイ^2119。
~serverは、
~clientが この上限を超過して~sessionを~openした場合でも，
当の接続を~closeしては`ナラナイ^2119
— ~WebTransport~protocolの非同期的な資質に因り、
~openな~sessionの個数についての~viewは，~clientと~serverとで整合でない【ときもある】ので。
代わりに，［
`~CONNECT~stream$のうち，自身が処理する用意がないもの
］すべてを `HTTP3$r 【！＠~HTTPv3#http-error-codes】にて定義される `H3_REQUEST_REJECTED$er 状態sで`~reset$しなければ`ナラナイ^2119。
◎
This document defines a SETTINGS_WT_MAX_SESSIONS setting that allows the server to limit the maximum number of concurrent WebTransport sessions on a single HTTP/3 connection. The client MUST NOT open more simultaneous sessions than indicated in the server SETTINGS parameter. The server MUST NOT close the connection if the client opens sessions exceeding this limit, as the client and the server do not have a consistent view of how many sessions are open due to the asynchronous nature of the protocol; instead, it MUST reset all of the CONNECT streams it is not willing to process with the H3_REQUEST_REJECTED status defined in Section 8.1 of [HTTP3].
</p>

		</section>
		<section id="flow-control-limit-streams">
<h3 title="Limiting the Number of Streams Within a Session">5.3. ~sessionの中の~stream数の制限-法</h3>

<p>
`WT_MAX_STREAMS$cps `~capsule$は、
`~WebTransport~session$の中の~streamの個数に対する上限を確立する。
~QUIC `MAX_STREAMS$ft ~frameと同様に、
この~capsuleには 2 つの `種別^i があり，
相手の端点が起動する［
`一方向~stream$, `双方向~stream$
］用に別々な上限を供する。
◎
The WT_MAX_STREAMS capsule (Section 5.6.2) establishes a limit on the number of streams within a WebTransport session. Like the QUIC MAX_STREAMS frame (Section 19.11 of [RFC9000]), this capsule has two types that provide separate limits for unidirectional and bidirectional streams that a peer initiates.
</p>

<p>
~session用の`~CONNECT~stream$は、［
`双方向~stream$, `一方向~stream$
］どちらの上限にも含まれないことに注意
— ~clientが~openできる`~CONNECT~stream$の個数は、［
`SETTINGS_WT_MAX_SESSIONS$sp 設定,
~QUIC~flow制御の~stream上限
］により制限される。
◎
Note that the CONNECT stream for the session is not included in either the bidirectional or the unidirectional stream limits; the number of CONNECT streams a client can open is limited by the SETTINGS_WT_MAX_SESSIONS setting and QUIC flow control's stream limits.
</p>

<p>
~session~levelの~stream上限は、［
接続~levelの~stream上限を供する~QUIC `MAX_STREAMS$ft ~frame
］に加えて適用される。
新たな~streamを作成できるのは、
当の~sessionの中で［
~stream~level, 接続~level
］どちらの上限からも許可される場合に限られる
— ~QUIC~stream上限がどう適用されるかの詳細は、
`RFC9000$r `同時並行性の制御-法＠~RFCx/rfc9000#controlling-concurrency§ を見よ。
◎
The session-level stream limit applies in addition to the QUIC MAX_STREAMS frame, which provides a connection-level stream limit. New streams can only be created within the session if both the stream- and the connection-level limit permit, see Section 4.6 of [RFC9000] for details on how QUIC stream limits are applied.
</p>

<p>
~QUIC `MAX_STREAMS$ft ~frameとは違って、
この~frame内の値と~QUIC `STREAM^ft ~frame内の`~stream~ID$との間には，
単純な関係性は無い。
このことは、
とりわけ，当の接続~上の~streamに他の利用元もある場合に適用される。
◎
Unlike the the QUIC MAX_STREAMS frame, there is no simple relationship between the value in this frame and stream IDs in QUIC STREAM frames. This especially applies if there are other users of streams on the connection.
</p>

<p>
`WT_STREAMS_BLOCKED$cps `~capsule$は、
次を指示するために送信できる
⇒
端点は、
~session~levelの~stream上限に因り，
~streamを作成-可能でなかった。
◎
The WT_STREAMS_BLOCKED capsule (Section 5.6.3) can be sent to indicate that an endpoint was unable to create a stream due to the session-level stream limit.
</p>

<p>
この上限を施行するためには、［
双方の端点が~openな~stream数について合意できる
］よう［
~stream~header用に依拠-可能な`~reset$が要求される
］ことに注意。
◎
Note that enforcing this limit requires reliable resets for stream headers so that both endpoints can agree on the number of streams that are open.
</p>

		</section>
		<section id="flow-control-limit-data">
<h3 title="Data Limits">5.4. ~data上限</h3>

<p>
`WT_MAX_DATA$cps `~capsule$は、
同じ`~WebTransport~session$の中で送信できる~data量に対する上限を確立する。
その `種別^i に対応する各~stream上に送信される すべての~dataは、
この上限へ向けて数えられる。
ただし、
~stream~header
（ `一方向~stream＠#unidirectional-streams§,
`双方向~stream＠#bidirectional-streams§ を見よ）
は，この上限からは除外される
— この上限が［
新たな~streamを特定の`~WebTransport~session$へ~linkするために本質的な情報
］の送信を防止しないようにするため。
◎
The WT_MAX_DATA capsule (Section 5.6.4) establishes a limit on the amount of data that can be sent within a WebTransport session. This limit counts all data that is sent on streams of the corresponding type, excluding the stream header (see Section 4.2 and Section 4.3). The stream header is excluded from this limit so that this limit does not prevent the sending of information that is essential in linking new streams to a specific WebTransport session.
</p>

<p>
`~reset$された~stream用に `WT_MAX_DATA$cps を実装するためには、［
~QUIC~stackが，各~streamの最終-~sizeについての情報を~WebTransport実装に供する
］ことが要求される
— `RFC9000$r `~streamの最終-~size＠~RFCx/rfc9000#final-size§ を見よ。
これは、［
当の~stream上の`送信器$が，`~WebTransport~session$の~flow制御~creditを消費した量
］について，双方の端点が合意することを保証する
, after subtracting the number of bytes used by the stream header.。
◎
For streams that were reset, implementing WT_MAX_DATA requires that the QUIC stack provide the WebTransport implementation with information about the final size of streams; see Section 4.5 of [RFC9000]. This guarantees that both endpoints agree on how much WebTransport session flow control credit was consumed by the sender on that stream.
</p>

<p>
`WT_DATA_BLOCKED$cps `~capsule$は、
次を指示するために送信できる
⇒
端点は、
`WT_MAX_DATA$cps ~capsuleにより設定された上限に因り，
~dataを送信-可能でなかった。
◎
The WT_DATA_BLOCKED capsule (Section 5.6.5) can be sent to indicate that an endpoint was unable to send data due to a limit set by the WT_MAX_DATA capsule.
</p>

<p>
~HTTP3越しの~WebTransportは，
各~WebTransport~stream用に~nativeな~QUIC~streamを利用するので、
~streamごとの~data上限は，~QUICにより~nativeに供される
（ `RFC9000$r `~data~flowの制御＠~RFCx/rfc9000#data-flow-control§を見よ）。
［
`WT_MAX_STREAM_DATA^cps,
`WT_STREAM_DATA_BLOCKED^cps
］`~capsule$†
（ `I-D.ietf-webtrans-http2$r 【~HTTP2越しの~WebTransport】【！`Part XX＠https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http2-11#appendix-Xx§】 ）
は、
利用されない
— それらは、
禁制される。
端点は、
これらの~capsuleの受領を~session~errorとして扱わなければ`ナラナイ^2119。
◎
Because WebTransport over HTTP/3 uses a native QUIC stream for each WebTransport stream, per-stream data limits are provided by QUIC natively (see Section 4.1 of [RFC9000]). The WT_MAX_STREAM_DATA and WT_STREAM_DATA_BLOCKED capsules (Part XX of [I-D.ietf-webtrans-http2]) are not used and so are prohibited. Endpoints MUST treat receipt of a WT_MAX_STREAM_DATA or a WT_STREAM_DATA_BLOCKED capsule as a session error.
</p>

<p class="trans-note">【†
これらの~capsuleは、
`~HTTP2越しの~WebTransport$cite用には定義されているが，
~HTTP3越しの~WebTransport用には定義されていない。
】</p>

		</section>
		<section id="flow-control-settings">
<h3 title="Flow Control SETTINGS">5.5. ~flow制御~用の設定</h3>

<p>
~flow制御~用の初期~時の上限は、
~HTTP3 `SETTINGS$ft を介して，
次に挙げる~parameter
（`~HTTP3設定~parameterの登録＠#http3-settings§を見よ）
に 0 以外の値を供することにより交換される：
◎
Initial flow control limits can be exchanged via HTTP/3 SETTINGS (Section 9.2) by providing non-zero values for
</p>
<ul>
	<li>
`SETTINGS_WT_INITIAL_MAX_STREAMS_UNI$sp
（を介した `WT_MAX_STREAMS$cps 用の値）
◎
↓</li>
	<li>
`SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI$sp
（を介した `WT_MAX_STREAMS$cps 用の値）
◎
WT_MAX_STREAMS via SETTINGS_WT_INITIAL_MAX_STREAMS_UNI and SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI
</li>
	<li>
`SETTINGS_WT_INITIAL_MAX_DATA$sp
（を介した `WT_MAX_DATA$cps 用の値）
◎
WT_MAX_DATA via SETTINGS_WT_INITIAL_MAX_DATA
</li>
</ul>

		</section>
		<section id="flow-control-capsules">
<h3 title="Flow Control Capsules">5.6. ~flow制御~capsule</h3>

<p>
~HTTP3越しの~WebTransportは、
次に挙げる`~capsule$を~flow制御~用に利用する
⇒＃
`WT_MAX_DATA$cps,
`WT_MAX_STREAMS$cps,
`WT_DATA_BLOCKED$cps,
`WT_STREAMS_BLOCKED$cps
◎終
これらの~capsuleは、
`~flow制御~capsule@
と総称され，いずれも
— `HTTP-DATAGRAM$r `~capsule~protocol§1 にて述べられるとおり —
`媒介者$による特別な取扱いを定義する。
◎
WebTransport over HTTP/3 uses several capsules for flow control, and all of these capsules define special intermediary handling as described in Section 3.2 of [HTTP-DATAGRAM]. These capsules, referred to as the "flow control capsules", are WT_MAX_DATA, WT_MAX_STREAMS, WT_DATA_BLOCKED, and WT_STREAMS_BLOCKED.
</p>

			<section id="flow-control-intermediaries">
<h4 title="Flow Control and Intermediaries">5.6.1. ~flow制御と媒介者</h4>

<p>
~WebTransportにおける~flow制御は，`隣点間$であり`端点間$な通達を供さないので、
`媒介者$は，
~flow制御~通達を消費した上で，
次の隣点へ自前の［
~flow制御~用の上限
］を表出しなければ`ナラナイ^2119。
`媒介者$は、
これらの通達を［
~HTTP3~flow制御~message,
~HTTP2~flow制御~message,
~WebTransport`~flow制御~capsule$
］のうち適切になる いずれかを介して送信できる。
`媒介者$は、
~dataを次の隣点へ即時に回送できない場合には，
自身が広告する~flow制御~creditまでは格納する責務がある。
◎
Because flow control in WebTransport is hop-by-hop and does not provide an end-to-end signal, intermediaries MUST consume flow control signals and express their own flow control limits to the next hop. The intermediary can send these signals via HTTP/3 flow control messages, HTTP/2 flow control messages, or as WebTransport flow control capsules, where appropriate. Intermediaries are responsible for storing any data for which they advertise flow control credit if that data cannot be immediately forwarded to the next hop.
</p>

<p>
実施においては、
類似な~WebTransport~protocol
（例： 2 つの`~HTTP3接続$）
どうしの間で~flow制御~通達を翻訳している`媒介者$は，
単純に［
一方の接続で受信した上限と同じ上限を他方の接続へ直に表出し直せる
］ことが多い。
◎
In practice, an intermediary that translates flow control signals between similar WebTransport protocols, such as between two HTTP/3 connections, can often simply reexpress the same limits received on one connection directly on the other connection.
</p>

<p>
`媒介者$は、
翻訳-先の接続へ即時に送信できなかった~dataを格納する責務を負いたくないならば，
他方の接続に対しては［
対応する［
翻訳-先の接続~上の上限
］を超える~flow制御~用の上限
］を広告しないこと【により負わないこと？】を確保できる。
◎
An intermediary that does not want to be responsible for storing data that cannot be immediately sent on its translated connection can ensure that it does not advertise a higher flow control limit on one connection than the corresponding limit on the translated connection.
</p>

			</section>
			<section id="WT_MAX_STREAMS">
<h4 title="WT_MAX_STREAMS Capsule">5.6.2. `WT_MAX_STREAMS^cps ~capsule</h4>

<p>
`WT_MAX_STREAMS^cps `~capsule$ `HTTP-DATAGRAM$r は、［
その `種別^i に対応する~stream【すなわち，双方向か一方向か】として~openすることが許可される累積的な個数
］を相手の端点へ伝えるために導入された。
`WT_MAX_STREAMS^cps ~capsuleのうち［
`種別^i `0x190B4D3F^hex を伴うものは，`双方向~stream$／
`種別^i `0x190B4D40^hex を伴うものは，`一方向~stream$
］に適用される。
◎
An HTTP capsule [HTTP-DATAGRAM] called WT_MAX_STREAMS is introduced to inform the peer of the cumulative number of streams of a given type it is permitted to open. A WT_MAX_STREAMS capsule with a type of 0x190B4D3F applies to bidirectional streams, and a WT_MAX_STREAMS capsule with a type of 0x190B4D40 applies to unidirectional streams.
</p>

<p>
`最大~stream数^i は、
許容される総~stream数
— それまでに~closeされた~streamも含めた数 —
を表現している累積的な値なので、
端点は、
各~streamが~openされるに伴い，
新たな `WT_MAX_STREAMS^cps ~capsuleを
— `最大~stream数^i に前回より増やされた値を伴わせて —
繰返し送信することに注意。
◎
Note that, because Maximum Streams is a cumulative value representing the total allowed number of streams, including previously closed streams, endpoints repeatedly send new WT_MAX_STREAMS capsules with increasing Maximum Streams values as streams are opened.
</p>

<figure id="fig-wt_max_streams">
<pre class="frame-diagram">
WT_MAX_STREAMS ~capsule {
  種別 (i) = 0x190B4D3F..0x190B4D40,
  長さ (i),
  最大~stream数 (i),
}
◎
WT_MAX_STREAMS Capsule {
  Type (i) = 0x190B4D3F..0x190B4D40,
  Length (i),
  Maximum Streams (i),
}
</pre>
<figcaption>
図 7.
`WT_MAX_STREAMS^cps ~capsule形式
◎
Figure 7:
WT_MAX_STREAMS Capsule Format
</figcaption></figure>

<p>
各 `WT_MAX_STREAMS^cps ~capsuleは、
次に挙げる~fieldを包含する：
◎
WT_MAX_STREAMS capsules contain the following field:
</p>
<dl>
	<dt>
`最大~stream数^i
◎
Maximum Streams:
</dt>
	<dd>
当の~sessionの存続期間にわたって~openできる［
その `種別^i に対応する~stream
］の累積的な個数
◎
A count of the cumulative number of streams of the corresponding type that can be opened over the lifetime of the session.＼
</dd>
	<dd>
この値は、
2 の 60 乗~未満になる
— 2 の 62 乗~以上の`~stream~ID$を符号化することはアリでないので。
◎
This value cannot exceed 260, as it is not possible to encode stream IDs larger than 262-1.
</dd>
</dl>

<p>
端点は、［
相手の端点により設定された現在の~stream上限により許可される個数
］より多い~streamを~openしては`ナラナイ^2119。
一例として，
`一方向~stream$数の上限として 3 を受信した~serverには、
~stream 3, 7, 11 を~openすることは許可されるが，
~stream 15 は許可されない。
【 3, 7, 11, 15 は`~stream~ID$。】
◎
An endpoint MUST NOT open more streams than permitted by the current stream limit set by its peer. For instance, a server that receives a unidirectional stream limit of 3 is permitted to open streams 3, 7, and 11, but not stream 15.
</p>

<p>
この上限は、
~openな~streamのみならず，~closeされた~streamも含むことに注意。
◎
Note that this limit includes streams that have been closed as well as those that are open.
</p>

<p>
端点は、［
ある~session用に受信した流入~streamが，
広告された `最大~stream数^i の値を超過する場合
］には，
~error~code `WT_FLOW_CONTROL_ERROR$er で当の`~WebTransport~session$を~closeしなければ`ナラナイ^2119。
◎
If an endpoint receives an incoming stream for a session that would exceed the advertised Maximum Streams value, it MUST close the WebTransport session with a WT_FLOW_CONTROL_ERROR error code.
</p>

<p>
~QUICにおける `MAX_STREAMS$ft ~frameたちは，
どの順序でも送達され得るが、
それとは違って、
`~WebTransport~session$の`~CONNECT~stream$上に送信される `WT_MAX_STREAMS$cps ~capsuleたちは，
順序どおりに送達される。
端点は、
受信した `WT_MAX_STREAMS$cps ~capsuleの `最大~stream数^i の値が以前に受信した値~未満である場合には，
~error~code `WT_FLOW_CONTROL_ERROR$er で当の`~WebTransport~session$を~closeしなければ`ナラナイ^2119。
◎
Unlike in QUIC, where MAX_STREAMS frames can be delivered in any order, WT_MAX_STREAMS capsules are sent on the WebTransport session's connect stream and are delivered in order. If an endpoint receives a WT_MAX_STREAMS capsule with a Maximum Streams value less than a previously received value, it MUST close the WebTransport session with a WT_FLOW_CONTROL_ERROR error code.
</p>

<p>
`WT_MAX_STREAMS^cps ~capsuleは、
`HTTP-DATAGRAM$r `~capsule~protocol§1にて述べられるとおり，
`媒介者$による特別な取扱いを定義する。
`媒介者$は、
`WT_MAX_STREAMS^cps ~capsuleを~flow制御~目的~用に消費した上で，
自身の上限~用に適切な~flow制御~通達を生成して送信しなければ`ナラナイ^2119。
◎
The WT_MAX_STREAMS capsule defines special intermediary handling, as described in Section 3.2 of [HTTP-DATAGRAM]. Intermediaries MUST consume WT_MAX_STREAMS capsules for flow control purposes and MUST generate and send appropriate flow control signals for their limits.
</p>

<p>
これらの上限~用の初期~値は、［
【一方向~stream用には】 `SETTINGS_WT_INITIAL_MAX_STREAMS_UNI$sp ／
【双方向~stream用には】 `SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI$sp
］用に 0 以外の値を送信することにより，通信しても`ヨイ^2119。
◎
Initial values for these limits MAY be communicated by sending non-zero values for SETTINGS_WT_INITIAL_MAX_STREAMS_UNI and SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI.
</p>

			</section>
			<section id="WT_STREAMS_BLOCKED">
<h4 title="WT_STREAMS_BLOCKED Capsule">5.6.3. `WT_STREAMS_BLOCKED^cps ~capsule</h4>

<p>
`送信器$は、［
~streamを~openするよう望むが，
相手の端点により設定された最大~stream数の上限に因り可能でない
］ときは，
`WT_STREAMS_BLOCKED^cps `~capsule$を送信する`ベキ^2119である。
それ【！STREAMS_BLOCKED】は、
その `種別^i に応じて，［
`0x190B4D43^hex ならば`双方向~stream$／
`0x190B4D44^hex ならば`一方向~stream$
］の個数が上限に達したことを指示する。
◎
A sender SHOULD send a WT_STREAMS_BLOCKED capsule (type=0x190B4D43 or 0x190B4D44) when it wishes to open a stream but is unable to do so due to the maximum stream limit set by its peer. A WT_STREAMS_BLOCKED capsule of type 0x190B4D43 is used to indicate reaching the bidirectional stream limit, and a STREAMS_BLOCKED capsule of type 0x190B4D44 is used to indicate reaching the unidirectional stream limit.
</p>

<p>
`WT_STREAMS_BLOCKED^cps ~capsuleは、
~streamを~openしないが，［
新たな~streamが必要になったが，
~stream上限により~streamの作成が防止された
］ことを相手の端点へ伝える。
◎
A WT_STREAMS_BLOCKED capsule does not open the stream, but informs the peer that a new stream was needed and the stream limit prevented the creation of the stream.
</p>

<figure id="fig-wt_streams_blocked">
<pre class="frame-diagram">
WT_STREAMS_BLOCKED ~capsule {
  種別 (i) = 0x190B4D43..0x190B4D44,
  長さ (i),
  最大~stream数 (i),
}
◎
WT_STREAMS_BLOCKED Capsule {
  Type (i) = 0x190B4D43..0x190B4D44,
  Length (i),
  Maximum Streams (i),
}
</pre>
<figcaption>
図 8.
`WT_STREAMS_BLOCKED^cps ~capsule形式
◎
Figure 8:
WT_STREAMS_BLOCKED Capsule Format
</figcaption></figure>

<p>
各 `WT_STREAMS_BLOCKED^cps ~capsuleは、
次に挙げる~fieldを包含する：
◎
WT_STREAMS_BLOCKED capsules contain the following field:
</p>
<dl>
	<dt>
`最大~stream数^i
◎
Maximum Streams:
</dt>
	<dd>
次を指示する`可変長な整数$
⇒
この~capsuleを送信した時点で許容されていた最大な~stream数。
◎
A variable-length integer indicating the maximum number of streams allowed at the time the capsule was sent.＼
</dd>
	<dd>
この値は、
2 の 60 乗~未満になる
— 2 の 62 乗~以上の`~stream~ID$を符号化することはアリでないので。
◎
This value cannot exceed 260, as it is not possible to encode stream IDs larger than 262-1.
</dd>
</dl>

<p>
`WT_STREAMS_BLOCKED^cps ~capsuleは、
`HTTP-DATAGRAM$r `~capsule~protocol§1にて述べられるとおり，
`媒介者$による特別な取扱いを定義する。
`媒介者$は、
`WT_STREAMS_BLOCKED^cps ~capsuleを~flow制御~目的~用に消費した上で，
自身の上限~用に適切な~flow制御~通達を生成して送信しなければ`ナラナイ^2119。
◎
The WT_STREAMS_BLOCKED capsule defines special intermediary handling, as described in Section 3.2 of [HTTP-DATAGRAM]. Intermediaries MUST consume WT_STREAMS_BLOCKED capsules for flow control purposes and MUST generate and send appropriate flow control signals for their limits.
</p>

			</section>
			<section id="WT_MAX_DATA">
<h4 title="WT_MAX_DATA Capsule">5.6.4. `WT_MAX_DATA^cps ~capsule</h4>

<p>
`WT_MAX_DATA^cps（ `種別^i `0x190B4D3D^hex ）`~capsule$ `HTTP-DATAGRAM$r は、
`~WebTransport~session$全体に送信できる最大な~data量を相手の端点へ伝えるために導入された。
◎
An HTTP capsule [HTTP-DATAGRAM] called WT_MAX_DATA (type=0x190B4D3D) is introduced to inform the peer of the maximum amount of data that can be sent on the WebTransport session as a whole.
</p>

<p>
その `種別^i に対応する各~stream上に送信される すべての~dataは、
この上限へ向けて数えられる
— ただし、
~stream~header
（ `一方向~stream＠#unidirectional-streams§,
`双方向~stream＠#bidirectional-streams§ を見よ）
は，この上限からは除外される。
◎
This limit counts all data that is sent on streams of the corresponding type, excluding the stream header (see Section 4.2 and Section 4.3).＼
</p>

<p>
`~reset$された~stream用に `WT_MAX_DATA^cps を実装するためには、［
~QUIC~stackが，各~streamの最終-~sizeについての情報を~WebTransport実装に供する
］ことが要求される
（ `RFC9000$r `~streamの最終-~size＠~RFCx/rfc9000#final-size§ を見よ）。
◎
For streams that were reset, implementing WT_MAX_DATA requires that the QUIC stack provide the WebTransport implementation with information about the final size of streams (see Section 4.5 of [RFC9000]).
</p>

<figure id="fig-wt_max_data">
<pre class="frame-diagram">
WT_MAX_DATA ~capsule {
  種別 (i) = 0x190B4D3D,
  長さ (i),
  最大~data量 (i),
}
◎
WT_MAX_DATA Capsule {
  Type (i) = 0x190B4D3D,
  Length (i),
  Maximum Data (i),
}
</pre>
<figcaption>
図 9.
`WT_MAX_DATA^cps ~capsule形式
◎
Figure 9:
WT_MAX_DATA Capsule Format
</figcaption></figure>

<p>
各 `WT_MAX_DATA^cps ~capsuleは、
次に挙げる~fieldを包含する：
◎
WT_MAX_DATA capsules contain the following field:
</p>
<dl>
	<dt>
`最大~data量^i
◎
Maximum Data:
</dt>
	<dd>
次を~byte単位で指示する`可変長な整数$
⇒
当の~session全体に対し送信できる最大な~data量
◎
A variable-length integer indicating the maximum amount of data that can be sent on the entire session, in units of bytes.
</dd>
</dl>

<p>
この~sessionに結付けられた すべての~stream上に送信された `~stream本体^i ~dataの長さの総和は、
受信器により広告された `最大~data量^i の値を超過しては`ナラナイ^2119。
`CONNECT$m ~stream上に送信された`~capsule$, および［
`通達~値^i,
`~stream種別^i,
`~session~ID^i
］~fieldは、
この上限には含まれないことに注意。
端点は、
この上限を超過する `~stream本体^i ~dataを受信した場合には，
~error~code `WT_FLOW_CONTROL_ERROR$er で当の`~WebTransport~session$を~closeしなければ`ナラナイ^2119。
◎
The sum of the lengths of Stream Body data sent on all streams associated with this session MUST NOT exceed the Maximum Data value advertised by a receiver. Note that capsules sent on the CONNECT stream, and the Signal Value, Stream Type, and Session ID fields, are not included in this limit. If an endpoint receives Stream Body data in excess of this limit, it MUST close the WebTransport session with a WT_FLOW_CONTROL_ERROR error code.
</p>

<p>
~QUICにおける `MAX_DATA$ft ~frameたちは，
どの順序でも送達され得るが、
それとは違って、
`~WebTransport~session$の`~CONNECT~stream$上に送信される `WT_MAX_DATA$cps ~capsuleたちは，
順序どおりに送達される。
端点は、
受信した `WT_MAX_DATA$cps ~capsuleの `最大~data量^i の値が以前に受信した値~未満である場合には，
~error~code `WT_FLOW_CONTROL_ERROR$er で当の`~WebTransport~session$を~closeしなければ`ナラナイ^2119。
◎
Unlike in QUIC, where MAX_DATA frames can be delivered in any order, WT_MAX_DATA capsules are sent on the WebTransport session's connect stream and are delivered in order. If an endpoint receives a WT_MAX_DATA capsule with a Maximum Data value less than a previously received value, it MUST close the WebTransport session with a WT_FLOW_CONTROL_ERROR error code.
</p>

<p>
`WT_STREAM^cps ~capsule内に送信されたすべての~dataは、
この上限へ向けて数えられる。
`WT_STREAM^cps ~capsule内の `~stream~data^i ~fieldの長さの総和は、
`受信器$により広告された値を超過しては`ナラナイ^2119。
◎
All data sent in WT_STREAM capsules counts toward this limit. The sum of the lengths of Stream Data fields in WT_STREAM capsules MUST NOT exceed the value advertised by a receiver.
</p>

<p class="trans-note">【
`WT_STREAM^cps ~capsuleは、
`~HTTP2越しの~WebTransport$cite用には定義されているが，
~HTTP3越しの~WebTransport用には定義されていない
（将来には定義されると思われる）。
】</p>

<p>
`WT_MAX_DATA^cps ~capsuleは、
`HTTP-DATAGRAM$r `~capsule~protocol§1にて述べられるとおり，
`媒介者$による特別な取扱いを定義する。
`媒介者$は、
`WT_MAX_DATA^cps ~capsuleを~flow制御~目的~用に消費した上で，
自身の上限~用に適切な~flow制御~通達を生成して送信しなければ`ナラナイ^2119
（`~flow制御と媒介者＠#flow-control-intermediaries§を見よ）。
◎
The WT_MAX_DATA capsule defines special intermediary handling, as described in Section 3.2 of [HTTP-DATAGRAM]. Intermediaries MUST consume WT_MAX_DATA capsules for flow control purposes and MUST generate and send appropriate flow control signals for their limits (see Section 5.6.1).
</p>

<p>
この上限~用の初期~値は、
`SETTINGS_WT_INITIAL_MAX_DATA$sp 用に 0 以外の値を送信することにより，
通信しても`ヨイ^2119。
◎
The initial value for this limit MAY be communicated by sending a non-zero value for SETTINGS_WT_INITIAL_MAX_DATA.
</p>

			</section>
			<section id="WT_DATA_BLOCKED">
<h4 title="WT_DATA_BLOCKED Capsule">5.6.5. `WT_DATA_BLOCKED^cps ~capsule</h4>

<p>
`送信器$は、［
~dataを送信するよう望むが，
`~WebTransport~session$~levelの~flow制御に因り可能でない
］ときには，
`WT_DATA_BLOCKED^cps `~capsule$（ `種別^i`0x190B4D41^hex ）を送信する`ベキ^2119である
— それは、
~flow制御~algoを調律するための入力として利用され得る。
◎
A sender SHOULD send a WT_DATA_BLOCKED capsule (type=0x190B4D41) when it wishes to send data but is unable to do so due to WebTransport session-level flow control. WT_DATA_BLOCKED capsules can be used as input to tuning of flow control algorithms.
</p>

<figure id="fig-wt_data_blocked">
<pre class="frame-diagram">
WT_DATA_BLOCKED ~capsule {
  種別 (i) = 0x190B4D41,
  長さ (i),
  最大~data量 (i),
}
◎
WT_DATA_BLOCKED Capsule {
  Type (i) = 0x190B4D41,
  Length (i),
  Maximum Data (i),
}
</pre>
<figcaption>
図 10.
`WT_DATA_BLOCKED^cps ~capsule形式
◎
Figure 10:
WT_DATA_BLOCKED Capsule Format
</figcaption></figure>

<p>
各 `WT_DATA_BLOCKED^cps ~capsuleは、
次に挙げる~fieldを包含する：
◎
WT_DATA_BLOCKED capsules contain the following field:
</p>
<dl>
	<dt>
`最大~data量^i
◎
Maximum Data:
</dt>
	<dd>
次を指示する`可変長な整数$
⇒
阻まれるようになった時点における~session~levelの上限
◎
A variable-length integer indicating the session-level limit at which blocking occurred.
</dd>
</dl>

<p>
`WT_DATA_BLOCKED^cps ~capsuleは、
`HTTP-DATAGRAM$r `~capsule~protocol§1にて述べられるとおり，
`媒介者$による特別な取扱いを定義する。
`媒介者$は、
`WT_DATA_BLOCKED^cps ~capsuleを~flow制御~目的~用に消費した上で，
自身の上限~用に適切な~flow制御~通達を生成して送信しなければ`ナラナイ^2119
（`~flow制御と媒介者＠#flow-control-intermediaries§を見よ）。
◎
The WT_DATA_BLOCKED capsule defines special intermediary handling, as described in Section 3.2 of [HTTP-DATAGRAM]. Intermediaries MUST consume WT_DATA_BLOCKED capsules for flow control purposes and MUST generate and send appropriate flow control signals for their limits; see Section 5.4.
</p>

			</section>
		</section>
	</section>
	<section id="session-termination">
<h2 title="Session Termination">6. ~sessionの終了n</h2>

<p>
~HTTP3越しの`~WebTransport~session$は、
次に挙げるいずれかが生じたとき，終了されたものと見なされる：
◎
A WebTransport session over HTTP/3 is considered terminated when either of the following conditions is met:
</p>
<ul>
	<li>
`~CONNECT~stream$が，どちらかの側で［
~cleanに／中途で
］~closeされた。
◎
the CONNECT stream is closed, either cleanly or abruptly, on either side; or
</li>
	<li>
`WT_CLOSE_SESSION$cps `~capsule$が［
送信された／受信された
］。
◎
a WT_CLOSE_SESSION capsule is either sent or received.
</li>
</ul>

<p>
端点は、
ある~sessionが終了したことを悟った際には，
次に従わなければ`ナラナイ^2119：
◎
Upon learning that the session has been terminated,＼
</p>
<ul>
	<li>
<p>
当の~sessionに結付けられたすべての［
`一方向~stream$, `双方向~stream$
］に対し：
</p>
		<ul>
			<li>
その送信-側を`~reset$する
— ~error~codeには `WT_SESSION_GONE$er を利用する。
</li>
			<li>
その受信-側の読取りを中止する。
</li>
		</ul>
<p>
（ `RFC9000$r `~streamに対する演算＠~RFCx/rfc9000#stream-operations§を見よ。）
</p>
◎
the endpoint MUST reset the send side and abort reading on the receive side of all unidirectional and bidirectional streams associated with the session (see Section 2.4 of [RFC9000]) using the WT_SESSION_GONE error code;＼
</li>
	<li>
<p>
当の~sessionに対し：
</p>
		<ul>
			<li>
新たな~datagramを送信しない。
</li>
			<li>
新たな~streamを~openしない。
</li>
		</ul>
◎
it MUST NOT send any new datagrams or open any new streams.
</li>
</ul>

<p>
応用は、［
~sessionを終了する際に詳細な~error~messageを伴わせるため
］として，［
当の`~WebTransport端点$用に そのような~message
］を供するよう［
種別 `WT_CLOSE_SESSION$cps （ `0x2843^hex ）の`~capsule$ `HTTP-DATAGRAM$r
］を送信しても`ヨイ^2119。
この~capsuleの形式は、
次に従わなければ`ナラナイ^2119【！SHALL】：
◎
To terminate a session with a detailed error message, an application MAY provide such a message for the WebTransport endpoint to send in an HTTP capsule [HTTP-DATAGRAM] of type WT_CLOSE_SESSION (0x2843). The format of the capsule SHALL be as follows:
</p>

<figure id="fig-wt_close_session">
<pre class="frame-diagram">
WT_CLOSE_SESSION ~capsule {
  種別 (i) = WT_CLOSE_SESSION,
  長さ (i),
  応用~error~code (32),
  応用~error~message (..8192【1024？】),
}
◎
WT_CLOSE_SESSION Capsule {
  Type (i) = WT_CLOSE_SESSION,
  Length (i),
  Application Error Code (32),
  Application Error Message (..8192),
}
</pre>
<figcaption>
図 11.
`WT_CLOSE_SESSION^cps ~capsule形式
◎
Figure 11: WT_CLOSE_SESSION Capsule Format
</figcaption></figure>

<p>
`WT_CLOSE_SESSION$cps は、
次に挙げる~fieldを有する
— いずれも、
その値は，当の~sessionを~closeしている応用により供される：
◎
WT_CLOSE_SESSION has the following fields:
</p>
<ul>
	<li>
`応用~error~code^i
⇒
~error~codeを与える 32 ~bitな整数
◎
Application Error Code:
• A 32-bit error code provided by the application closing the session.
</li>
	<li>
`応用~error~message^i
⇒
~error~messageを与える~UTF-8に符号化された文字列。
この~messageは、
当の`~capsule$を成す残りを占める
— その長さは、
1024 ~byteを超過しては`ナラナイ^2119。
◎
Application Error Message:
• A UTF-8 encoded error message string provided by the application closing the session. The message takes up the remainder of the capsule, and its length MUST NOT exceed 1024 bytes.
</li>
</ul>

<p>
`応用~error~code^i ~fieldは、
~QUICの `CONNECTION_CLOSE$ft ~frame内の `~error~code^i ~fieldを~~反映しないことに注意
— ~WebTransport応用~errorは、
`~HTTP3~error~code空間＠~HTTPv3#http-error-codes$の下位集合を利用し，その限界域の中に収まる必要があるので
— `~data~streamの~reset法＠#resetting-data-streams§を見よ。
◎
Note that the Application Error Code field does not mirror the Error Code field in QUIC's CONNECTION_CLOSE frame (Section 19.19 of [RFC9000]) because WebTransport application errors use a subset of the HTTP/3 Error Code space and need to fit within those bounds, see Section 4.4.
</p>

<p>
端点は、
`WT_CLOSE_SESSION$cps `~capsule$を送信したときは，
即時に当の`~CONNECT~stream$上に `FIN^i を送信しなければ`ナラナイ^2119。
端点は、［
当の`~CONNECT~stream$からは もはや読取らない
］ことを指示する［
~error~code `WT_SESSION_GONE$er を伴う `STOP_SENDING$ft
］も送信しても`ヨイ^2119。
受信者は、
それらに呼応して，当の~streamを~closeするか`~reset$しなければ`ナラナイ^2119。
`WT_CLOSE_SESSION$cps ~capsuleを受信した後に`~CONNECT~stream$上に追加的な~stream~dataを受信した場合、
当の~streamは，~code `H3_MESSAGE_ERROR$er で`~reset$されなければ`ナラナイ^2119。
◎
An endpoint that sends a WT_CLOSE_SESSION capsule MUST immediately send a FIN on the CONNECT Stream. The endpoint MAY also send a STOP_SENDING with error code WT_SESSION_GONE to indicate it is no longer reading from the CONNECT stream. The recipient MUST either close or reset the stream in response. If any additional stream data is received on the CONNECT stream after receiving a WT_CLOSE_SESSION capsule, the stream MUST be reset with code H3_MESSAGE_ERROR.
</p>

<p>
ある`~CONNECT~stream$を~cleanに
— `WT_CLOSE_SESSION$cps `~capsule$を伴わずに —
終了することは、
それを［
~error~code 0, 空な~error文字列
］を伴う `WT_CLOSE_SESSION$cps `~capsule$で終了することと，
意味論的に等価でならなければ`ナラナイ^2119【！SHALL】。
◎
Cleanly terminating a CONNECT stream without a WT_CLOSE_SESSION capsule SHALL be semantically equivalent to terminating it with a WT_CLOSE_SESSION capsule that has an error code of 0 and an empty error string.
</p>

<p>
端点は，一部の局面では、
詳細な~close情報を伴う `WT_CLOSE_SESSION$cps を送信してから，
下層の~QUIC接続を即時に~closeするよう求めるかもしれない。
端点が両方を同時に行った場合、
相手の端点は `WT_CLOSE_SESSION$cps を受信する前に `CONNECTION_CLOSE$ft を受信することにもなり得る
— その場合、
前者に包含された応用~error~dataを決して受信しないことになる。
これを避けるため、
端点は，［
すべての`~CONNECT~stream$が相手の端点により~closeされる
］まで待機してから `CONNECTION_CLOSE$ft を送信する`ベキ^2119である
— これは、
応用~close~metadataを送達する最善な労に基づく仕組みとして，
~QUIC `CONNECTION_CLOSE$ft の仕組みのそれに類似な `WT_CLOSE_SESSION$cps ~propを与える。
◎
In some scenarios, an endpoint might want to send a WT_CLOSE_SESSION with detailed close information and then immediately close the underlying QUIC connection. If the endpoint were to do both of those simultaneously, the peer could potentially receive the CONNECTION_CLOSE before receiving the WT_CLOSE_SESSION, thus never receiving the application error data contained in the latter. To avoid this, the endpoint SHOULD wait until all CONNECT streams have been closed by the peer before sending the CONNECTION_CLOSE; this gives WT_CLOSE_SESSION properties similar to that of the QUIC CONNECTION_CLOSE mechanism as a best-effort mechanism of delivering application close metadata.
</p>

	</section>
	<section id="considerations-for-future-versions">
<h2 title="Considerations for Future Versions">7. 将来~version用の考慮点</h2>

<p>
~WebTransportの将来~versionは、［
`~WebTransport~session$を確立するために利用される `CONNECT$m 要請
］の構文を変更する場合には，
~WebTransportを識別するために利用される~Upgrade~tokenを改変する必要がある
— ［
~serverが同時に複数の~versionを提供する
］ことを許容するよう
（ `~Upgrade~tokenの登録＠#upgrade-token§を見よ）。
◎
Future versions of WebTransport that change the syntax of the CONNECT requests used to establish WebTransport sessions will need to modify the upgrade token used to identify WebTransport, allowing servers to offer multiple versions simultaneously (see Section 9.1).
</p>

<p>
~WebTransportの互換でない将来~versionを~supportする~serverは、
`SETTINGS_WT_MAX_SESSIONS$sp 設定~用に利用される符号点を変更することにより，その~supportを通達する
（ `~HTTP3設定~parameterの登録＠#http3-settings§を見よ）。
~clientは、
適用-可能な場合には，［
新たな~sessionを確立するときに利用する
］ためとして［
それに結付けられた~Upgrade~token
］を選定できる
— ~serverが［
各~流入~要請ごとに，それ用に利用-中にある構文
］を常に知れることを確保するよう。
◎
Servers that support future incompatible versions of WebTransport signal that support by changing the codepoint used for the SETTINGS_WT_MAX_SESSIONS setting (see Section 9.2). Clients can select the associated upgrade token, if applicable, to use when establishing a new session, ensuring that servers will always know the syntax in use for every incoming request.
</p>

<p>
将来の~stream形式に対する変更は、［
`一方向~stream$の種別
（ `一方向~stream＠#unidirectional-streams§を見よ）,
`双方向~stream$の通達~値
（ `双方向~stream＠#bidirectional-streams§を見よ）
］に対する変更を要求する
— 流入~frameの受信者が，［
当の~WebTransport~version
］および, それに対応する［
当の~streamに結付けられた~session用に利用される伝送路~形式
］を決定することを許容するため。
◎
Changes to future stream formats require changes to the Unidirectional Stream type (see Section 4.2) and Bidirectional Stream signal value (see Section 4.3) to allow recipients of incoming frames to determine the WebTransport version, and corresponding wire format, used for the session associated with that stream.
</p>

		<section id="negotiating-the-draft-version">
<h3 title="Negotiating the Draft Version">7.1. 草案~versionの折衝-法</h3>

<p class="note">注記：
この節は、
~RFCとして公表する前に除去されることになる。
◎
[[RFC editor: please remove this section before publication.]]
</p>

<p>
~WebTransport~protocolを成す伝送路~形式の側面は、［
`SETTINGS_WT_MAX_SESSIONS$sp 設定~用に利用される符号点
］を変更することにより折衝される。
そのことから、
`~WebTransport端点$は，~WebTransport流通を［
送信する／処理する
］前に相手の端点からの `SETTINGS$ft ~frameを待機しなければ`ナラナイ^2119。
双方の端点が複数の~versionを~supportするときは、
両者が~supportする最も近過去な~versionが選定される。
◎
The wire format aspects of the protocol are negotiated by changing the codepoint used for the SETTINGS_WT_MAX_SESSIONS setting. Because of that, any WebTransport endpoint MUST wait for the peer's SETTINGS frame before sending or processing any WebTransport traffic. When multiple versions are supported by both of the peers, the most recent version supported by both is selected.
</p>

		</section>
	</section>
	<section id="security-considerations">
<h2 title="Security Considerations">8. ~securityの考慮点</h2>

<p>
~HTTP3越しの~WebTransportは、
`OVERVIEW$r により~WebTransport~protocolに対し課される~security要件をすべて満たす。
したがって、
当の応用が信用-済みとは限らない事例でも，
~client↔~server通信~用に~secureな~frameworkを供する。
◎
WebTransport over HTTP/3 satisfies all of the security requirements imposed by [OVERVIEW] on WebTransport protocols, thus providing a secure framework for client-server communication in cases when the application is potentially untrusted.
</p>

<p>
~HTTP3越しの~WebTransportには、
~HTTP3`設定$の利用を通した明示的な~opt-inが要求される
— これは、［
`~HTTP3~server$が それを明示的に~supportする
］こと確保することにより，潜在的な~protocol混同~攻撃を避ける。
加えて、
~browserによる流通~用には，
`Origin$h ~headerの利用も要求される
— それは、［
~Webに基づく応用が出自にする生成元が信用-済みでない場合に，~accessを否認する能
］を~serverに供する。
◎
WebTransport over HTTP/3 requires explicit opt-in through the use of an HTTP/3 setting; this avoids potential protocol confusion attacks by ensuring the HTTP/3 server explicitly supports it. It also requires the use of the Origin header for browser traffic, providing the server with the ability to deny access to Web-based applications that do not originate from a trusted origin.
</p>

<p>
~HTTP3越しに行く~HTTP流通と同じく、
~WebTransportは，流通を単独の接続の中で異なる生成元たちに~poolする。
異なる生成元は，異なる信用-~domainを含意するので、
実装は，［
同じ接続~上の異なる生成元に属する~transportどうしを敵対的になり得るものとして扱う
］必要がある。
潜在的な攻撃の一つとして、
資源~枯渇~攻撃がある
— すべての`~WebTransport~session$が同じ［
輻輳~制御~文脈, ~flow制御~文脈
］どちらも共有するので、
単独の応用が それらの資源を積極的に利用し尽くすと，他の~sessionを停滞させ得る。
したがって，`~WebTransport端点$は：
◎
Just like HTTP traffic going over HTTP/3, WebTransport pools traffic to different origins within a single connection. Different origins imply different trust domains, meaning that the implementations have to treat each transport as potentially hostile towards others on the same connection. One potential attack is a resource exhaustion attack: since all of the WebTransport sessions share both congestion control and flow control context, a single application aggressively using up those resources can cause other sessions to stall.＼
</p>
<ul>
	<li>
［
複数の`~WebTransport~session$が同じ~transport接続を共有すること
］を許容する場合には、
~flow制御の仕組みを実装しなければ`ナラナイ^2119。
◎
A WebTransport endpoint MUST implement flow control mechanisms if it allows a WebTransport session to share the transport connection with other WebTransport sessions.＼
</li>
	<li>
［
同じ~transport接続を共有する各~sessionが、
制御される下で，資源を成す適理な共有分を取得すること
］を確保するための公平性~schemeを実装する`ベキ^2119である
— これは、［
~dataを送信するとき,
新たな~streamを~openするとき
］どちらにも適用される。
◎
WebTransport endpoints SHOULD implement a fairness scheme that ensures that each session that shares a transport connection gets a reasonable share of controlled resources; this applies both to sending data and to opening new streams.
</li>
</ul>

<p>
応用は、
いっときに多過ぎる`~WebTransport~session$を~openすることにより，
資源を枯渇させるよう試みることもできる。
当の応用が信用-済みでない事例では、
`~WebTransport~client$は，自身が~openできる流出~sessionの個数を制限する`ベキ^2119である。
◎
An application could attempt to exhaust resources by opening too many WebTransport sessions at once. In cases when the application is untrusted, the WebTransport client SHOULD limit the number of outgoing sessions it will open.
</p>

	</section>
	<section id="iana-considerations">
<h2 title="IANA Considerations">9. ~IANA考慮点</h2>

		<section id="upgrade-token">
<h3 title="Upgrade Token Registration">9.1. ~Upgrade~tokenの登録</h3>

<p>
`HTTP$r `~Upgrade~token~registry＠~HTTPinfra#upgrade.token.registry§により確立された
`~HTTP~Upgrade~token~registry＠~IANA-a/http-upgrade-tokens$cite
には、
以下に挙げる~entryが追加される。
◎
The following entry is added to the "Hypertext Transfer Protocol (HTTP) Upgrade Token Registry" registry established by Section 16.7 of [HTTP].
</p>

<p>
~label "`webtransport^c" は、
~WebTransport用の~protocolとして~HTTP3が利用されたことを識別する：
◎
The "webtransport" label identifies HTTP/3 used as a protocol for WebTransport:
</p>
<ul>
	<li>
値
⇒
`webtransport^c
◎
Value:
• webtransport
</li>
	<li>
記述
⇒
~HTTP3越しの~WebTransport
◎
Description:
• WebTransport over HTTP/3
</li>
	<li>
参照
⇒
この文書,
`I-D.ietf-webtrans-http2$r
◎
Reference:
• This document and [I-D.ietf-webtrans-http2]
</li>
</ul>

		</section>
		<section id="http3-settings">
<h3 title="HTTP/3 SETTINGS Parameter Registration">9.2. ~HTTP3設定~parameterの登録</h3>

<p>
`HTTP3$r により確立された
`~HTTP3設定~registry＠~IANA-a/http3-parameters/http3-parameters.xhtml#http3-parameters-settings$cite
には、
以下に挙げる~entryが追加される。
◎
The following entry is added to the "HTTP/3 Settings" registry established by [HTTP3]:
</p>

<div>
<p>
`SETTINGS_WT_MAX_SESSIONS@sp
設定は、
次を指示する：
</p>
<ul>
	<li>
0 以外ならば
⇒
［
それを指定した~HTTP3端点には~WebTransport能力があること
］および［
受信する用意がある同時並行な~sessionの個数
］。
</li>
	<li>
0 ならば
⇒
当の端点には、
`~WebTransport~session$を受信する用意はない。
</li>
</ul>
<p>
この設定~用の既定の値は 0 とする。
</p>
◎
The SETTINGS_WT_MAX_SESSIONS setting indicates that the specified HTTP/3 endpoint is WebTransport-capable and the number of concurrent sessions it is willing to receive. The default value for the SETTINGS_WT_MAX_SESSIONS setting is "0", meaning that the endpoint is not willing to receive any WebTransport sessions.
</div>

<ul>
	<li>
設定~名
⇒
`SETTINGS_WT_MAX_SESSIONS$sp
【！WT_MAX_SESSIONS】
◎
Setting Name:
• WT_MAX_SESSIONS
</li>
	<li>
値
⇒
`0x14e9cd29^hex
◎
Value:
• 0x14e9cd29
</li>
	<li>
既定
⇒
0
◎
Default:
• 0
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
</ul>

<div>
<p>
`SETTINGS_WT_INITIAL_MAX_STREAMS_UNI@sp
設定は、
次を指示する：
</p>
<ul>
	<li>
<p>
0 以外ならば
⇒
一方向~streamの最大~数を与える上限~用の初期~値。
</p>

<p>
この上限は、
この `SETTINGS$ft が送信された`~HTTP3接続$を利用している`~WebTransport~session$すべてに適用されることに注意。
</p>
	</li>
	<li>
0 ならば
⇒
上限は `WT_MAX_STREAMS$cps ~capsuleにより通信される
— 当の端点は、
各`~WebTransport~session$に対し，［
その中で一方向~streamを作成することが相手の端点に許容される前
］に `WT_MAX_STREAMS$cps `~capsule$を送信する必要がある。
</li>
</ul>

<p>
この設定~用の既定の値は 0 とする。
</p>
◎
The SETTINGS_WT_INITIAL_MAX_STREAMS_UNI setting indicates the initial value for the unidirectional max stream limit, otherwise communicated by the WT_MAX_STREAMS capsule (see Section 5.6.2). The default value for the SETTINGS_WT_INITIAL_MAX_STREAMS_UNI setting is "0", indicating that the endpoint needs to send WT_MAX_STREAMS capsules on each individual WebTransport session before its peer is allowed to create any unidirectional streams within that session.
◎
Note that this limit applies to all WebTransport sessions that use the HTTP/3 connection on which this SETTING is sent.
</div>

<ul>
	<li>
設定~名
⇒
`SETTINGS_WT_INITIAL_MAX_STREAMS_UNI$sp
【！WT_MAX_SESSIONS】
◎
Setting Name:
• SETTINGS_WT_INITIAL_MAX_STREAMS_UNI
</li>
	<li>
値
⇒
`0x2b64^hex
◎
Value:
• 0x2b64
</li>
	<li>
既定
⇒
0
◎
Default:
• 0
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
</ul>

<div>
<p>
`SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI@sp
設定は、
次を指示する：
</p>
<ul>
	<li>
<p>
0 以外ならば
⇒
双方向~streamの最大~数を与える上限~用の初期~値
</p>

<p>
この上限は、
この `SETTINGS$ft が送信された`~HTTP3接続$を利用している`~WebTransport~session$すべてに適用されることに注意。
</p>
	</li>
	<li>
0 ならば
⇒
`WT_MAX_STREAMS$cps ~capsuleにより通信される
— 当の端点は、
各`~WebTransport~session$に対し，［
その中で双方向~streamを作成することが相手の端点に許容される前
］に `WT_MAX_STREAMS$cps `~capsule$を送信する必要がある。
</li>
</ul>

<p>
この設定~用の既定の値は 0 とする。
</p>
◎
The SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI setting indicates the initial value for the bidirectional max stream limit, otherwise communicated by the WT_MAX_STREAMS capsule (see Section 5.6.2). The default value for the SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI setting is "0", indicating that the endpoint needs to send WT_MAX_STREAMS capsules on each individual WebTransport session before its peer is allowed to create any bidirectional streams within that session.
◎
Note that this limit applies to all WebTransport sessions that use the HTTP/3 connection on which this SETTING is sent.
</div>

<ul>
	<li>
設定~名
⇒
`SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI$sp
【！WT_MAX_SESSIONS】
◎
Setting Name:
• SETTINGS_WT_INITIAL_MAX_STREAMS_BIDI
</li>
	<li>
値
⇒
`0x2b65^hex
◎
Value:
• 0x2b65
</li>
	<li>
既定
⇒
0
◎
Default:
• 0
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
</ul>

<div>
<p>
`SETTINGS_WT_INITIAL_MAX_DATA@sp
設定は、
次を指示する：
</p>
<ul>
	<li>
<p>
0 以外ならば
⇒
~session~data量の上限~用の初期~値。
</p>

<p>
この上限は、
この `SETTINGS$ft が送信された`~HTTP3接続$を利用している`~WebTransport~session$すべてに適用されることに注意。
</p>
	</li>
	<li>
0 ならば
⇒
上限は `WT_MAX_DATA$cps ~capsuleにより通信される
— 当の端点は、
各~sessionに対し，［
その中で~stream~dataを送信することが相手の端点に許容される前
］に `WT_MAX_DATA$cps `~capsule$を送信する必要がある。
</li>
</ul>

<p>
この設定~用の既定の値は 0 とする。
</p>
◎
The SETTINGS_WT_INITIAL_MAX_DATA setting indicates the initial value for the session data limit, otherwise communicated by the WT_MAX_DATA capsule (see Section 5.6.4). The default value for the SETTINGS_WT_INITIAL_MAX_DATA setting is "0", indicating that the endpoint needs to send a WT_MAX_DATA capsule within each session before its peer is allowed to send any stream data within that session.
◎
Note that this limit applies to all WebTransport sessions that use the HTTP/3 connection on which this SETTING is sent.
</div>

<ul>
	<li>
設定~名
⇒
`SETTINGS_WT_INITIAL_MAX_DATA$sp
【！WT_MAX_SESSIONS】
◎
Setting Name:
• SETTINGS_WT_INITIAL_MAX_DATA
</li>
	<li>
値
⇒
`0x2b61^hex
◎
Value:
• 0x2b61
</li>
	<li>
既定
⇒
0
◎
Default:
• 0
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
</ul>

		</section>
		<section id="frame-type-registration">
<h3 title="Frame Type Registration">9.3. ~frame種別の登録</h3>

<p>
`HTTP3$r により確立された
`~HTTP3~frame種別~registry＠~IANA-a/http3-parameters/http3-parameters.xhtml#http3-parameters-frame-types$cite
には、
以下に挙げる~entryが追加される。
◎
The following entry is added to the "HTTP/3 Frame Type" registry established by [HTTP3]:
</p>

<p>
`WT_STREAM@ft
~frameは、
~WebTransport~HTTP3拡張との衝突を避ける目的で，予約される：
◎
The WT_STREAM frame is reserved for the purpose of avoiding collision with WebTransport HTTP/3 extensions:
</p>
<ul>
	<li>
~code
⇒
`0x41^hex
◎
Code:
• 0x41
</li>
	<li>
~frame種別
⇒
`WT_STREAM$ft
◎
Frame Type:
• WT_STREAM
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
</ul>

		</section>
		<section id="stream-type-registration">
<h3 title="Stream Type Registration">9.4. ~stream種別の登録</h3>

<p>
`HTTP3$r により確立された
`~HTTP3~stream種別~registry＠~IANA-a/http3-parameters/http3-parameters.xhtml#http3-parameters-stream-types$cite
には、
以下に挙げる~entryが追加される。
◎
The following entry is added to the "HTTP/3 Stream Type" registry established by [HTTP3]:
</p>

<p>
種別
`~WebTransport~stream@
は、［
`一方向~stream$が~WebTransportにより利用される
］ことを許容する：
◎
The "WebTransport stream" type allows unidirectional streams to be used by WebTransport:
</p>
<ul>
	<li>
~code
⇒
`0x54^hex
◎
Code:
• 0x54
</li>
	<li>
~stream種別
⇒
~WebTransport~stream
◎
Stream Type:
• WebTransport stream
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
送信器
⇒
`両方^i
◎
Sender:
• Both
</li>
</ul>

		</section>
		<section id="http3-error-code-registration">
<h3 title="HTTP/3 Error Code Registration">9.5. ~HTTP3~error~codeの登録</h3>

<p>
`HTTP3$r により確立された
`~HTTP3~error~code~registry＠~IANA-a/http3-parameters/http3-parameters.xhtml#http3-parameters-error-codes$cite
には、
以下に挙げる~entryが追加される。
◎
The following entries are added to the "HTTP/3 Error Code" registry established by [HTTP3]:
</p>

<ul>
	<li>
名前
⇒
`WT_BUFFERED_STREAM_REJECTED@er
◎
Name:
• WT_BUFFERED_STREAM_REJECTED
</li>
	<li>
値
⇒
`0x3994bd84^hex
◎
Value:
• 0x3994bd84
</li>
	<li>
記述
⇒
~WebTransport~data~streamは、
それに結付けられた~sessionの欠如に因り，却下された
◎
Description:
• WebTransport data stream rejected due to lack of associated session.
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document.
</li>
</ul>

<ul>
	<li>
名前
⇒
`WT_SESSION_GONE@er
◎
Name:
• WT_SESSION_GONE
</li>
	<li>
値
⇒
`0x170d7b68^hex
◎
Value:
• 0x170d7b68
</li>
	<li>
記述
⇒
~WebTransport~data~streamは、
それに結付けられた`~WebTransport~session$が~closeされたため，中止された。
［
当の端点は、
当の`~CONNECT~stream$からは もはや読取らない
］ことを指示するためにも利用される。
◎
Description:
• WebTransport data stream aborted because the associated WebTransport session has been closed. Also used to indicate that the endpoint is no longer reading from the CONNECT stream.
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document.
</li>
</ul>

<ul>
	<li>
名前
⇒
`WT_FLOW_CONTROL_ERROR@er
◎
Name:
• WT_FLOW_CONTROL_ERROR
</li>
	<li>
値
⇒
`0x045d4487^hex
◎
Value:
• 0x045d4487
</li>
	<li>
記述
⇒
`~WebTransport~session$は、
~flow制御~errorに遭遇したため，中止された。
◎
Description:
• WebTransport session aborted because a flow control error was encountered.
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document.
</li>
</ul>

<p>
加えて，次に与える範囲の~entryが登録される：
◎
In addition, the following range of entries is registered:
</p>
<ul>
	<li>
名前
⇒
`WT_APPLICATION_ERROR@er
◎
Name:
• WT_APPLICATION_ERROR
</li>
	<li>
値
⇒
次を満たす整数 %符号点
⇒
［
%符号点 ~GTE `0x52e4a40fa8db^hex
］~AND［
%符号点 ~LTE `0x52e5ac983162^hex
］~AND［
%符号点 ~NIN { `0x1f^hex ~MUL %N ~PLUS `0x21^hex ； %N は負でない整数 }
］
◎
Value:
• 0x52e4a40fa8db to 0x52e5ac983162 inclusive, with the exception of the codepoints of form 0x1f * N + 0x21.
</li>
	<li>
記述
⇒
~WebTransport応用~error~code
◎
Description:
• WebTransport application error codes.
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document.
</li>
</ul>

		</section>
		<section id="capsule-types">
<h3 title="Capsule Types">9.6. ~capsule種別</h3>

<p>
`HTTP-DATAGRAM$r により確立された
`~HTTP~capsule種別~registry^cite
には、
以下に挙げる~entryが追加される。
◎
The following entries are added to the "HTTP Capsule Types" registry established by [HTTP-DATAGRAM]:
</p>

<p>
`WT_CLOSE_SESSION@cps
`~capsule$
◎
The WT_CLOSE_SESSION capsule
</p>
<ul>
	<li>
値
⇒
`0x2843^hex
◎
Value:
• 0x2843
</li>
	<li>
~capsule種別
⇒
`WT_CLOSE_SESSION$cps
◎
Capsule Type:
• WT_CLOSE_SESSION
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

<p>
`WT_DRAIN_SESSION@cps
`~capsule$
◎:
• The WT_DRAIN_SESSION capsule.
</p>
<ul>
	<li>
値
⇒
`0x78ae^hex
◎
Value:
• 0x78ae
</li>
	<li>
~capsule種別
⇒
`WT_DRAIN_SESSION$cps
◎
Capsule Type:
• WT_DRAIN_SESSION
</li>
	<li>
位置付け
⇒
`暫定的^i
（この文書が認可されたなら、
`恒久的^i になる)
◎
Status:
• provisional (when this document is approved this will become permanent)
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

<p>
`WT_MAX_STREAMS@cps
`~capsule$
◎
The WT_MAX_STREAMS capsule:
</p>
<ul>
	<li>
値
⇒
`0x190B4D3F..0x190B4D40^hex
◎
Value:
• 0x190B4D3F..0x190B4D40
</li>
	<li>
~capsule種別
⇒
`WT_MAX_STREAMS$cps
◎
Capsule Type:
• WT_MAX_STREAMS
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

<p>
`WT_STREAMS_BLOCKED@cps
`~capsule$
◎
The WT_STREAMS_BLOCKED capsule:
</p>
<ul>
	<li>
値
⇒
`0x190B4D43..0x190B4D44^hex
◎
Value:
• 0x190B4D43..0x190B4D44
</li>
	<li>
~capsule種別
⇒
`WT_STREAMS_BLOCKED$cps
◎
Capsule Type:
• WT_STREAMS_BLOCKED
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

<p>
`WT_MAX_DATA@cps
`~capsule$
◎
The WT_MAX_DATA capsule:
</p>
<ul>
	<li>
値
⇒
`0x190B4D3D^hex
◎
Value:
• 0x190B4D3D
</li>
	<li>
~capsule種別
⇒
`WT_MAX_DATA$cps
◎
Capsule Type:
• WT_MAX_DATA
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

<p>
`WT_DATA_BLOCKED@cps
`~capsule$
◎
The WT_DATA_BLOCKED capsule:
</p>
<ul>
	<li>
値
⇒
`0x190B4D41^hex
◎
Value:
• 0x190B4D41
</li>
	<li>
~capsule種別
⇒
`WT_DATA_BLOCKED$cps
◎
Capsule Type:
• WT_DATA_BLOCKED
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
仕様
⇒
この文書
◎
Specification:
• This document
</li>
	<li>
変更~制御者
⇒
~IETF
◎
Change Controller:
• IETF
</li>
	<li>
連絡先
⇒
~WebTransport~WG
<a href="mailto:webtransport@ietf.org">webtransport@ietf.org</a>
◎
Contact:
• WebTransport Working Group webtransport@ietf.org
</li>
	<li>
注記
⇒
なし
◎
Notes:
• None
</li>
</ul>

		</section>
		<section id="iana-http">
<h3 title="Protocol Negotiation HTTP Header Fields">9.7. ~protocol折衝~HTTP~header</h3>

<p>
以下に挙げる~HTTP~headerが，~protocolを折衝するために利用される
（ `応用~protocolの折衝＠#protocol-negotiation§ ）。
これらは、
`HTTP$r `18.4＠~HTTPinfra#field.name.registration§により確立された
`~HTTP~field名~registry＠~IANA-a/http-fields$cite
に追加される：
◎
The following HTTP header fields are used for negotiating a protocol (Section 3.3. These are added to the "HTTP Field Name" registry established in Section 18.4 of [HTTP]:
</p>

<p>
`WT-Available-Protocols$h ~field：
◎
The WT-Available-Protocols field:
</p>
<ul>
	<li>
~field名
⇒
`WT-Available-Protocols^h
◎
Field Name:
• WT-Available-Protocols
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
有構造~型
⇒
`~sf~list$
◎
Structured Type:
• List
</li>
	<li>
参照
⇒
`応用~protocolの折衝＠#protocol-negotiation§
◎
Reference:
• Section 3.3
</li>
	<li>
~comment
⇒
なし
◎
Comments:
• None
</li>
</ul>

<p>
`WT-Protocol$h ~field：
◎
The WT-Protocol field:
</p>
<ul>
	<li>
~field名
⇒
`WT-Protocol^h
◎
Field Name:
• WT-Protocol
</li>
	<li>
位置付け
⇒
`恒久的^i
◎
Status:
• permanent
</li>
	<li>
有構造~型
⇒
`~sf~item$
◎
Structured Type:
• Item
</li>
	<li>
参照
⇒
`応用~protocolの折衝＠#protocol-negotiation§
◎
Reference:
• Section 3.3
</li>
	<li>
~comment
⇒
なし
◎
Comments:
• None
</li>
</ul>

		</section>
	</section>
	<section id="changelog">
<h2 title="Appendix A. Changelog">付録 A. 変更~log</h2>

		<section id="changes-between-draft-versions-02-and-07">
<h3 title="A.1. Changes between draft versions 02 and 07">A.1. 草案~version 02 から 07 までの変更点</h3>

<p>
この~protocolを成す草案~version 02 から草案~version 07 までの互換でない変更点は：
◎
The following changes make the draft-02 and draft-07 versions of this protocol incompatible:
</p>
<ul>
	<li>
`SETTINGS_WT_MAX_SESSIONS$sp が要求される
（ `86$pull ）
— それは~version折衝~用に利用される。
（ `129$pull ）
◎
draft-07 requires SETTINGS_WT_MAX_SESSIONS (#86) and uses it for version negotiation (#129)
</li>
	<li>
`SETTINGS_ENABLE_CONNECT_PROTOCOL$sp を可能化することが明示的に要求される。
（ `93$pull ）
◎
draft-07 explicitly requires SETTINGS_ENABLE_CONNECT_PROTOCOL to be enabled (#93)
</li>
	<li>
`SETTINGS_H3_DATAGRAM$sp を可能化することが明示的に要求される。
（ `106$pull ）
◎
draft-07 explicitly requires SETTINGS_H3_DATAGRAM to be enabled (#106)
</li>
	<li>
`WT_STREAM$ft は~streamの始めに限り許容される。
◎
draft-07 only allows WT_STREAM at the beginning of the stream
</li>
</ul>

<p>
草案~version 07 には、
次に挙げる変更点も在り，
草案~version 02 実装にも安全に実装できる：
◎
The following changes that are present in draft-07 can be also implemented by a draft-02 implementation safely:
</p>
<ul>
	<li>
~stream~reset~error~code空間を 8 ~bitから 32 ~bitへ拡げた
（ `115$pull ）
◎
Expanding stream reset error code space from 8 to 32 bits (#115)
</li>
	<li>
`WT_SESSION_GONE$er ~error~code
（ `75$pull ）
◎
WT_SESSION_GONE error code (#75)
</li>
	<li>
~HTTP `GOAWAY$ft 用の取扱い
（ `76$pull ）
◎
Handling for HTTP GOAWAY (#76)
</li>
	<li>
`WT_DRAIN_SESSION$cps `~capsule$
（ `79$pull ）
◎
WT_DRAIN_SESSION capsule (#79)
</li>
	<li>
~redirectに自動的に追従することを許容しないようにした
（ `113$pull ）
◎
Disallowing following redirects automatically (#113)
</li>
</ul>

		</section>
	</section>
</main></div>
