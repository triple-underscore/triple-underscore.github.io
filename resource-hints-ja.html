<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Resource Hints（日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css">
<link rel="stylesheet" href="common-w3c.css" type="text/css">

<style>
.attr-state {
	font-family: sans-serif0, sans-serif;
}

</style>

<script src="common0.js"></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		toc_main: 'MAIN0',
		generate: expand
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w~一-鿆あ-ん]+|`(.+?)([$@\^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){

if(!key) {//%
	return `<var>${match.slice(1)}</var>`;
}

let text = key;
let href = '';

switch(klass){
case 'r':
	text = `[${key}]`;
	href = `#bib-${key.toLowerCase()}`;
	break;
case 'l':
	text = `"<code class="literal">${text}</code>"`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;


	}
}

</script>


<script type="text/plain" id="_source_data">


●●options

spec_title:Resource Hints
spec_date:2020-10-05
trans_update:2022-04-21
source_checked:170504
page_state_key:PERFORMANCE
original_url:https://w3c.github.io/resource-hints/
spec_status:ED
ref_id_prefix:bib-
ref_id_lowercase:true
copyright:2019,permissive
trans_1st_pub:2017-08-18


●●class_map
E:error
e:element
a:attr
h:header
M:method
et:event-type
v:value

●●tag_map
I:code
m:code
e:code
a:code
c:code
et:code
h:code
E:code
v:code
M:code
i:i

●●original_id_map


●●link_map



I.XMLHttpRequest:~XHR#xmlhttprequest

m.visibilityState:~HTMLinteraction#dom-document-visibilitystate

e.link:~HEmetadata#the-link-element
e.meta:~HEmetadata#the-meta-element

a.href:~HEmetadata#attr-link-href
a.crossorigin:~HEmetadata#attr-link-crossorigin
a.as:~HEmetadata#attr-link-as

v.dns-prefetch:#dfn-dns-prefetch
v.preconnect:#dfn-preconnect
v.prefetch:#dfn-prefetch
v.prerender:#dfn-prerender

h.Link:~HTTPweblink#field.link
	h.Link:~RFCx/rfc5988

文書:~HTMLdom#document
	文書~tree内:~DOM4#in-a-document-tree
文書~内にある:~DOM4#in-a-document-tree
	~TR/html5/infrastructure.html#in-a-document
文書の中へ挿入された:~HTMLINFRA#insert-an-element-into-a-document
~load~eventを遅延する:~HTMLparsing#delay-the-load-event

資源~hint~link:#dfn-resource-hint-link
~preconnectを起動する:#dfn-initiate-a-preconnect
投機的~fetch:#dfn-speculative-fetch

~CORS設定群~属性:~HTMLurl#cors-settings-attribute
資源を得する:~HEmetadata#fetch-and-process-the-linked-resource
昇格-可能な内容:~MIXED-CONTENT#upgradeable-mixed-content
	~level 1）随意に阻止-可能な内容:~MIXED-CONTENT#category-optionally-blockable

~URLを直列化する:~URL1#concept-url-serializer


●●words_table1

CSP2:CSP-ja.html


●●words_table



preconnect:
prefetch:
prerender:
beacon:
asset::::アセット
	sub-resource
必須の:criticalな::~
解析:analytics:~
	一連の~pageに分けられた:paginated

	●最適化／処理
front-end::::フロントエンド
back-end::::バックエンド
signal:
CPU:
GPU:
投機的:speculative::~
前処理:preprocessing::~
前処理-:preprocess::~
高速:fast::~
	より高速:faster
優先度:priority::~
時機:time:~
受動的:reactive::~::リアクティブ
活動:activity::~
楽観的:optimistic:~
高価:expensive:~
率:rate:~
未終了:outstanding:~
見越して:anticipateして:~
策:strategy::~
瞬時の:instantな:~
排-:eliminate:~
隠す:hideする:~
覆隠して:maskして:覆い隠して
覆隠せる:maskできる:覆い隠せる
覆隠す:maskする:覆い隠す

	~~落とす:degrade
	事前に:ahead of time
	見込まれる／見込み:likelihood
	低い:low
	早くに:as early as
	早期に:early
	より早く:sooner
	低い:low
	見込まれる:likely
	されるであろう〜:〜 that might be

	●network
DNS:
TCP:
TLS:
IP:
	~HTTP~method:verb
open::::
handshake::::ハンドシェイク
hostname::::ホスト名
認証:authentication::~
冪等:idempotent::~
	冪等でないnon-idempotent
内容型:content-type::~
持続化-:persist::~
接続性:connectivity::~
検索:lookup::~


	●保安
平文:plain-text::~
私的:private:~
malware::::マルウェア
匿名化-:anonymize::~
露呈-:reveal::露わに
複雑化:complications:~
予防策:precautions:~
昇格-:upgrade::~

	●UI
prompt:
alert:
確認:confirmation::~

	●仕様
特質:property:~:::プロパティ
網羅的:exhaustive:~
条件付き:conditional:~
	任意選択で外す:opt-out
	任意選択の:OPTIONAL
上限:limit:~
委ねら:deferさ:~
放棄-:abandon:~
活用-:leverage:~
競合-:conflict:~
競合:contention::~
支援-:assist:~
立証-:prove:~
適応力:adaptation:~
編集-:edit:~
許諾:license:~

	求まれない:unwanted
	できるようにする:allow／enable
	選ぶ:choose
	-:help
	~~委ねられる:left to
	べきである:ought to
	なども含まれる:includes, but is not limited to
	足りて:sufficient
	さらには、:worse,
	課す対象:class of product that can claim
	よって、:As a result
	〜側においては:In turn,


	●未分類
結果:result:~
計算:compute:~
呈-:exhibit:~
割振る:allocateする:割り振る
load:
画像展示:image gallery:~
写真:photo:~
集成-:aggregate::~
pipeline:

	段階を踏んでいく流れ:step-driven flow
	指す:points to
	とる:take
	終える:finish
	-:JavaScript
	少なくする:fewer
	指す:points to
	使用量:usage
	-:elect
	using


	●指示語
次回の:next:~
過去の:past:~
	あるいは:alternatively
	〜し次第:once
	いくつ:how many
	ごとの:per-
	最後に、:finally
	多数の:a lot of
	数:number
	次回の／:next
	多様な:wide variety of
	様々な:variety of
	に対し:against
	ごとの: per
	最終的な:final
	次へ向かう所を:is heading next
	総:overall
	逆に:conversely
	節:Section
	複数〜にまたがって:across
	高い／高:high
	こともある:sometimes


●●ref_normative

[CSP3]
    Content Security Policy Level 3. Mike West. W3C. 29 June 2021. W3C Working Draft. URL: https://www.w3.org/TR/CSP3/
[HTML]
    HTML Standard. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters. WHATWG. Living Standard. URL: https://html.spec.whatwg.org/multipage/
[MIXED-CONTENT]
    Mixed Content. Emily Stark; Mike West; Carlos IbarraLopez. W3C. 4 October 2021. W3C Candidate Recommendation. URL: https://www.w3.org/TR/mixed-content/
[PAGE-VISIBILITY]
    Page Visibility (Second Edition). Jatinder Mann; Arvind Jain. W3C. 29 October 2013. W3C Recommendation. URL: https://www.w3.org/TR/page-visibility/
[PRELOAD]
    Preload. Ilya Grigorik; Yoav Weiss. W3C. 26 June 2019. W3C Candidate Recommendation. URL: https://www.w3.org/TR/preload/
[REFERRER-POLICY]
    Referrer Policy. Jochen Eisinger; Emily Stark. W3C. 26 January 2017. W3C Candidate Recommendation. URL: https://www.w3.org/TR/referrer-policy/
[RFC2119]
    Key words for use in RFCs to Indicate Requirement Levels. S. Bradner. IETF. March 1997. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc2119
[RFC5988]
    Web Linking. M. Nottingham. IETF. October 2010. Proposed Standard. URL: https://www.rfc-editor.org/rfc/rfc5988
[RFC8174]
    Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words. B. Leiba. IETF. May 2017. Best Current Practice. URL: https://www.rfc-editor.org/rfc/rfc8174


●●trans_metadata
<p>
~THIS_PAGEは、~W3Cにより編集者草案として公開された
<a href="~SPEC_URL">Resource Hints</a>
を日本語に翻訳したものです。
~PUB
</p>


●●spec_metadata

最新公表バージョン
	https://www.w3.org/TR/resource-hints/
公表履歴
	https://www.w3.org/standards/history/resource-hints
編集者草案
	https://w3c.github.io/resource-hints/
commit 履歴
	https://github.com/w3c/resource-hints/commits/
編集
	<a href="mailto:igrigorik@gmail.com">Ilya Grigorik</a> (Google)
フィードバック
	<a href="https://github.com/w3c/resource-hints/">GitHub w3c/resource-hints</a> (<a href="https://github.com/w3c/resource-hints/pulls/">pull requests</a>, <a href="https://github.com/w3c/resource-hints/issues/new/choose">new issue</a>, <a href="https://github.com/w3c/resource-hints/issues/">open issues</a>)
公表者
	<a href="https://www.w3.org/groups/wg/webperf">Web Performance WG</a>
</script>

</head>

<body>

<header>

	<hgroup>
<h1>Resource Hints</h1>
	</hgroup>

</header>

<div id="MAIN" hidden>

	<section id="abstract">
~ABSTRACT

<p>
この仕様は、~HTML `link$e 要素の［
`dns-prefetch$v,
`preconnect$v,
`prefetch$v,
`prerender$v
］関係性を定義する。
これらの~primitiveにより，［
開発者や, 資源を生成-あるいは送達している~server
］は、~UAが~page処理能を改善するために［
どの生成元へ接続するベキか／
どの資源を~fetchして前処理するベキか
］について裁定する処理-を支援できるようになる。
◎
This specification defines the dns-prefetch, preconnect, prefetch, and prerender relationships of the HTML Link Element (`&lt;link&gt;`). These primitives enable the developer, and the server generating or delivering the resources, to assist the user agent in the decision process of which origins it should connect to, and which resources it should fetch and preprocess to improve page performance.
</p>

	</section>
	<section id="sotd">
~STATUSofTHIS

<p>
これは、編集者草案の公な複製です…
【以下、この節の内容は，~SOTD-W3Cに移譲。】
</p>

	</section>

<main id="MAIN0">

	<section id="introduction">
<h2 title="Introduction">1. 序論</h2>

<p>
現代の~browserは、利用者による入力や意図を見越して投機的に最適化する多様な技法を活用している。
それは、後続の~navi用に［
~preconnectする ／
資源を~prefetchする ／
資源を~prerenderする
］ことにより，［
~networking ／
資源の処理 ／
資源の具現化
］における待時間の一部を隠すことを可能にする。
◎
Modern browsers leverage a wide variety of speculative optimization techniques to anticipate user input and intent, which allows them to hide some of the networking, processing, and rendering latencies: preconnects, prefetching of resources, and prerendering of resources for subsequent navigation.
</p>

<p>
上の最適化のどれを起動するかの裁定は、概して［
文書の［
~markupと構造
］ ／
~navi履歴 ／ 利用者の文脈
］に基づく経験的な規則に基づく
— 例：
機器の型 ／
可用な計算~資源 ／
可用な~memory資源 ／
~network接続性 ／
利用者~選好 ／
等々。
これらの技法が成功したことは，立証されているが、［［
~front-end／~back-end
］による生成 ／
~web~appを成す資源の送達
］について開発者が有する知識を活用すれば，更に改善できる。
◎
The decision to initiate one or more of the above optimizations is typically based on heuristic rules based on document markup and structure, navigation history, and context of the user - e.g., type of device, available compute and memory resources, network connectivity, user preferences, and so on. These techniques have proven to be successful, but can be further improved by leveraging the knowledge a developer has about the front-end and back-end generation and delivery of the resources of a web application.
</p>

<p>
例えば~appは、次の資源~hintを~UAに供せる：
◎
For example, the application may provide the following resource hints to the user agent:
</p>

<ul>
	<li>
資源をどこから~fetchするかを与える，生成元~list。
◎
The list of origins from which resources will be fetched.
</li>
	<li>
次回に見込まれる［
利用者~動作／~navi~target
］
◎
The next likely user action or navigation target, and＼
</li>
	<li>
次に挙げるものなどに基づいて要求されることになる資源
⇒＃
現在の~pageや~appの状態 ／
個々の利用者の履歴 ／
集成された~session~data
◎
the resources that will be required, based on current page or application state, individual user history, or aggregated session data.
</li>
</ul>

<p>
多くの~web~appは、~prefetchするための様々な技法を，すでに活用している。
これには、必要になる前に  `XMLHttpRequest^I を用いて~assetを~fetchして~cacheすることなども含まれる。
しかしながら，これらの実装は~appに特有であり、相互運用可能でない上に，~browserにより供される~primitiveと同じ~levelの処理能は供さない。
さらには，これらの実装は、~browser~logicと競合して，その結果による遅延-や不必要な資源~fetchにより，~pageの総~処理能を~~落とすこともある。
◎
Many web applications already leverage a variety of prefetching techniques. This includes, but is not limited to, using XMLHttpRequest to fetch and cache assets before they are needed. However, these implementations are application specific, are not interoperable, and do not provide the same level of performance as the browser-provided primitives. Worse, these implementations sometimes conflict with the browser logic and result in delayed or unnecessary resource fetches that degrade overall page performance.
</p>

<p>
この仕様は、 ~HTML `link$e 要素の［
`dns-prefetch$v, `preconnect$v, `prefetch$v, `prerender$v
］関係性を定義する。
これらの~primitiveは、［
~UAが、~page処理能を改善するために，［
どの生成元に接続して, どの資源を~fetchして前処理するベキか
］を裁定する処理-
］を，開発者や［
資源を［
生成-／送達-
］している~server
］が支援できるようにする。
◎
This specification defines the dns-prefetch, preconnect, prefetch, and prerender relationships of the HTML Link Element (`&lt;link&gt;`). These primitives enable the developer, and the server generating or delivering the resources, to assist the user agent in the decision process of which origins it should connect to, and which resources it should fetch and preprocess to improve page performance.
</p>

	</section>
	<section id="resource-hints">
<h2 title="Resource Hints">2. 資源~hint</h2>

<p>
`資源~hint~link@
とは、［
~UAにより［
接続されるベキ生成元 ／~fetchされるベキ資源
］］を指示するために利用される~link関係性
— `dns-prefetch$v, `preconnect$v, `prefetch$v, `prerender$v —
の総称である。
◎
A resource hint link is a dns-prefetch, preconnect, prefetch, or prerender relationship that is used to indicate an origin or resource that should be connected to, or fetched, by the user agent.
</p>

<p>
`投機的~fetch@
とは、［
`prefetch$v ／ `prerender$v
］関係性を介して起動される~fetchの総称である。
◎
A speculative fetch is a fetch initiated via a prefetch or prerender relationship.
</p>


		<section id="dns-prefetch">
<h3 title="DNS Prefetch">2.1. `dns-prefetch^v</h3>

<p>
~link関係~型
`dns-prefetch@v
は、［
要求される資源を~fetchするために利用することになる生成元
］を指示するために利用される
— ~UAは、アリな限り早くに解決するベキである。
◎
The dns-prefetch link relation type is used to indicate an origin that will be used to fetch required resources, and that the user agent SHOULD resolve as early as possible.
</p>

<pre class="example lang-html">
&lt;link rel="`dns-prefetch$v" href="//example.com"&gt;
</pre>

		</section>
		<section id="preconnect">
<h3 title="Preconnect">2.2. `preconnect^v</h3>

<p>
~link関係~型
`preconnect@v
は、［
要求される資源を~fetchするために利用することになる生成元
］を指示するために利用される。
接続
— ［
~DNS検索, ~TCP~handshake, ~TLS折衝（任意選択）
］も含む —
を早期に起動しておけば、
~UAは，接続を確立する際の高い待時間~costを覆隠せるようになる。
◎
The preconnect link relation type is used to indicate an origin that will be used to fetch required resources. Initiating an early connection, which includes the DNS lookup, TCP handshake, and optional TLS negotiation, allows the user agent to mask the high latency costs of establishing a connection.
</p>

<pre class="example lang-html">
&lt;link rel="`preconnect$v" href="//example.com"&gt;
&lt;link rel="`preconnect$v" href="//cdn.example.com" crossorigin&gt;
</pre>

<p>
`~preconnectを起動する@
ときは…：
◎
To initiate a preconnect, the user agent MUST run these steps:
</p>

<p class="trans-note">【
以下，この~algoの内容, および付随する記述は、
今や，それに取って代わる内容が~HTML標準の
<a href="~HTMLlinks#link-type-preconnect">§ ~link型 `preconnect^v</a>
内に定義された（ほぼ同じ内容として移動された）ので
（<a href="https://github.com/whatwg/html/commit/fce90e10cba00f811fb75cab56a76395557a38a9">commit</a>）、
この訳では省略する。
】</p>

		</section>
		<section id="prefetch">
<h3 title="Prefetch">2.3. `prefetch^v</h3>

<p>
~link関係~型
`prefetch@v
は、次回の~naviにより要求されるであろう資源を識別するために利用される
— ~UAは、［
未来に資源が要請され次第，より高速に応答を送達できる
］よう，~fetchするベキである。
◎
The prefetch link relation type is used to identify a resource that might be required by the next navigation, and that the user agent SHOULD fetch, such that the user agent can deliver a faster response once the resource is requested in the future.
</p>


<pre class="example lang-html">
&lt;link rel="`prefetch$v" href="//example.com/next-page.html" as="document" crossorigin="use-credentials"&gt;
&lt;link rel="`prefetch$v" href="/library.js" as="script"&gt;
</pre>

<ul>
	<li>
~UAは、応答に前処理を適用するベキでない。
また、現在の~page文脈に対し，それを自動的には［
実行-／適用-
］しないモノトスル。
◎
The user agent SHOULD NOT apply preprocessing on the response and MUST NOT automatically execute or apply it against the current page context.
</li>
	<li>
`as$a 属性は、任意選択の属性であり， `PRELOAD$r に定義される要件に適合しなければナラナイ。
◎
The as attribute is an OPTIONAL attribute that must conform to requirements defined in [PRELOAD].
</li>
	<li>
`~CORS設定群~属性$ `crossorigin$a は、任意選択の属性であり、指定された資源の~CORS施策を指示する。
◎
The crossorigin CORS setting attribute is an OPTIONAL attribute that indicates the CORS policy of the specified resource.
</li>
</ul>

<p class="note">注記：
`as$a 属性を利用すれば、~appは
— ~UAが~fetchingを最適化できるよう —
資源の行先になる文脈と通信できる。
例えば、要請~header, ~transport優先度, 等々を適切に設定するなど。
◎
The as attribute can be used by the application to communicate the resource destination context, such that the user agent can optimize the fetching process - e.g. set appropriate request headers, transport priority, and so on.
</p>

		</section>
		<section id="prerender">
<h3 title="Prerender">2.4. `prerender^v</h3>

<p>
~link関係~型
`prerender@v
は、次回の~naviに要求されるであろう資源を識別するために利用される
— ~UAは、［
未来に資源が要請され次第，より高速に応答を送達できる
］よう，~fetchして実行するベキである。
◎
The prerender link relation type is used to identify a resource that might be required by the next navigation, and that the user agent SHOULD fetch and execute, such that the user agent can deliver a faster response once the resource is requested in the future.
</p>

<pre class="example lang-html">
&lt;link rel="`prerender$v" href="//example.com/next-page.html"&gt;
</pre>

<p>
~UAは、［
必要とされる下位資源も~fetchして，それらを実行する
］ことにより，~HTML応答を前処理してもヨイ（すなわち，~pageを~prerenderする）。
~prerenderする手続きを遂行するかどうかの裁定は、~UAに委ねられる。
~UAは、次を行ってもヨイ：
◎
The user agent MAY preprocess the HTML response by also fetching the necessary subresources and executing them (i.e. prerender the page). The decision for which prerendering steps are performed is deferred to the user agent. The user agent MAY:
</p>

<ul>
	<li>
~prerenderされた内容に割振る［
~CPU ／ ~GPU ／~memory
］資源を少なくする。
◎
Allocate fewer CPU, GPU, or memory resources to prerendered content.
</li>
	<li>
要請された~HTML資源が可視になるまで、一部の要請を遅延する
— 例：
~mediaの~download, ~plugin内容, 等々。
◎
Delay some requests until the requested HTML resource is made visible - e.g. media downloads, plugin content, and so on.
</li>
	<li>
可用な資源が制限されている下では、起動されている~prerenderを防止する。
◎
Prevent prerendering from being initiated when there are limited resources available.
</li>
	<li>
要求される［
~cost／資源
］が高いときは、~prerenderするのを放棄する
— 例：
~CPUや~memoryの使用量が高い, 高価な~data~access, 等々。
◎
Abandon prerendering due to high cost or resource requirements - e.g. high CPU or memory usage, expensive data access, and so on.
</li>
	<li>
<p>
~fetchされる内容の型や特質に因り，~prerenderするのを放棄する：
◎
Abandon prerendering due to the type or properties of the fetched content:
</p>
		<ul>
			<li>
~targetは、冪等でない挙動を呈する場合
— 例：局所的な共用~storageに対する変異, ［
`GET^M, `HEAD^M, `OPTION^M
］以外の~HTTP~methodを伴う `XMLHttpRequest$I 等々。
◎
If the target exhibits non-idempotent behavior: mutations to shared local storage, XMLHttpRequest with a verb other than GET, HEAD, or OPTION, and so on.
</li>
			<li>
~targetが利用者~入力
— 確認~dialog, 認証~prompt, ~alert, 等々 —
を要求するような条件を誘発する場合。
◎
If the target triggers a condition that requires user input: confirmation dialogs, authentication prompts, alerts, and so on.
</li>
		</ul>
	</li>
</ul>

<p>
上に挙げた処理~策は、網羅的ではない。
~UAは、他の策を実装してもヨイ。
◎
The above processing strategies are not an exhaustive list. The user agent may implement other strategies.
</p>

<p>
~UAは、`文書$を~prerenderするときは，［
`文書$の `visibilityState$m 取得子は `prerender^l を返す
］ようにするモノトスル。
`PAGE-VISIBILITY$r
◎
When prerendering a document the user agent MUST set the document's visibilityState ([PAGE-VISIBILITY]) value to prerender.
</p>

<p class="trans-note">【
この取得子は、今や `HTML$r にて定義される。
加えて， `prerender^l は可用でない
（<a href="https://github.com/w3c/resource-hints/issues/94">課題 #94</a>）】
</p>


<p class="note">注記：
`prerender$v ~hintを利用すれば、~appは，次回に見込まれる~HTML~navi~targetを指示できる
— ~UAは、指定された資源を~fetchした上で，~HTML応答として処理することになる。
適切な要請~headerを伴う他の内容型を~fetchする場合や,
~HTML前処理は欲されない場合、~appは `prefetch$v ~hintを利用できる。
◎
The prerender hint can be used by the application to indicate the next likely HTML navigation target: the user agent will fetch and process the specified resource as an HTML response. To fetch other content-types with appropriate request headers, or if HTML preprocessing is not desired, the application can use the prefetch hint.
</p>

<p class="note">注記：
互換性を確保する, あるいは~prerenderする要請の成功~率を改善するためには、~target~pageは，具現化され次第 Page Visibility ~APIを利用して，~pageの可視性~状態を決定して、［
~prerenderを放棄させ得るような動作（例： 冪等でない要請）／
求まれない副作用が誘発される（例： 表示される~pageに先立って発火される解析~用~beacon）
］を避けるための適切な~logicを実装できる。
◎
To ensure compatibility and improve the success rate of prerendering requests the target page can use the Page Visibility API to determine the visibility state of the page as it is being rendered and implement appropriate logic to avoid actions that may cause the prerender to be abandoned (e.g. non-idempotent requests), or unwanted side-effects from being triggered (e.g. analytics beacons firing prior to the page being displayed).
</p>

		</section>
	</section>
	<section id="process">
<h2 title="Process">3. 処理-</h2>
		<section id="fetching-the-resource-hint-link">
<h3 title="Fetching the resource hint link">3.1. 資源~hint~linkの~fetch法</h3>


<p>
`資源~hint~link$は、文書~markup内に指定されることも,
~HTTP `Link$h ~headerを介して供されることも,
文書に動的に追加されたり除去されることもある
— あるいは、されてもヨイ。
◎
The resource hint link's may be specified in the document markup, MAY be provided via the HTTP Link header, and MAY be dynamically added to and removed from the document.
</p>


<pre class="example lang-http">
Link: &lt;https://widget.com&gt;; rel=`dns-prefetch$v
Link: &lt;https://example.com&gt;; rel=`preconnect$v
Link: &lt;https://example.com/next-page.html&gt;; rel=`prerender$v;
Link: &lt;https://example.com/logo-hires.jpg&gt;; rel=`prefetch$v; as=image;
</pre>

<pre class="example lang-html">
&lt;link rel="`dns-prefetch$v" href="//widget.com"&gt;
&lt;link rel="`preconnect$v" href="//cdn.example.com"&gt;
&lt;link rel="`prerender$v" href="//example.com/next-page.html"&gt;
&lt;link rel="`prefetch$v" href="//example.com/logo-hires.jpg" as="image"&gt;
</pre>

<pre class="example lang-js">
var %hint = document.createElement("link");
%hint.rel = "prefetch";
%hint.as = "document";
%hint.href = "/article/part3.html";
document.head.appendChild(%hint);
</pre>

<p>
［
~hostへ接続する ／ 指定された`資源を得する$
］適切な時機は：
◎
The appropriate times to connect to a host, or obtain the specified resource are:
</p>

<ul>
	<li>
~UAが `RFC5988$r を~supportしている場合には、
`Link$h ~headerを介して指定される`資源~hint~link$を処理するとき。
◎
When the user agent that supports [RFC5988] processes resource hint link specified via the Link HTTP header.
</li>
	<li>
`資源~hint~link$を与える `link$e 要素が`文書の中へ挿入された$とき。
◎
When the resource hint link's link element is inserted into a document.
</li>
	<li>
`link$e 要素が`文書~内にある$下で，要素~上に`資源~hint~link$が作成されたとき。
◎
When the resource hint link is created on a link element that is already in a Document.
</li>
	<li>
`資源~hint~link$を与える `link$e 要素が`文書~内にある$下で、要素の `href$a 属性~値が変更されたとき。
◎
When the href attribute of the link element of an resource hint link that is already in a Document is changed.
</li>
</ul>

<p>
~UAは、現在の~navi文脈~用の資源との競合を最小限にするためとして，`投機的~fetch$による~fetchを遅延してもヨイ。
◎
The user agent MAY delay the fetch of speculative fetch to minimize resource contention for the current navigation context.
</p>

<p>
`preconnect$v ／ `投機的~fetch$
 を取消すかどうかの裁定は、~UAに委ねられる
— ~UAは、最適化が中止されるベキである［
とき, 場合
］を［
局所的~文脈 その他の~signal
］を利用して決定してもヨイ：
◎
The decision to cancel a preconnect or speculative fetch is deferred to the user agent, which MAY use local context and other signals to determine if and when the optimization should be aborted:
</p>

<ul>
	<li>
~UAは、［
`資源~hint~link$を与える `link$e 要素~上の `href$a 属性
］が［
除去された ／ その値が空~文字列に設定された
］ときには、要請を中止するベキである。
◎
The user agent SHOULD abort the request if the href attribute on the link element of an resource hint link is removed, or its value is set to an empty string.
</li>
	<li>
~UAは、`資源~hint~link$ を介して起動された要請が，複数~naviにまたがって継続するのを許容するベキである。
しかしながら，［
そのような要請は，新たな行先には要求されない
］ものと決定したときには、それを取消してもヨイ
—  <a href="#reactive-resource-prefetching-(prefetch)">受動的な資源の~prefetch法</a>
を見よ。
◎
The user agent SHOULD allow the requests initiated via the resource hint link to continue across navigations. However, the user agent MAY cancel these requests once it determines that they are not required by the new destination - see .
</li>
</ul>

<p>
次回の~naviに要求され得る資源~fetchは、現在の~navi文脈における処理能に負の影響iを及ぼし得る
— ［
~CPU, ~GPU, ~memory, ~network資源
］用の追加的な競合に因り。
これに取組むため、~UAは，そのような競合を［
抑制する／排する
］ような~logicを実装するベキである：
◎
Resource fetches that may be required for the next navigation can negatively impact the performance of the current navigation context due to additional contention for the CPU, GPU, memory, and network resources. To address this, the user agent SHOULD implement logic to reduce and eliminate such contention:
</p>

<ul>
	<li>
次回の~naviに要求される資源~fetchの優先度は、相対的に低くされるベキであり，現在の~navi文脈に要求される資源~fetch［
を阻止する／に干渉する
］ベキでない。
◎
Resource fetches required for the next navigation SHOULD have lower relative priority and SHOULD NOT block or interfere with resource fetches required by the current navigation context.
</li>
	<li>
<p>
次回の~naviに要求される資源~fetchを起動する最適な時機は、［
折衝された~transport~protocol,
利用者の現在の接続性~profile,
機器に可用な資源,
その他の文脈に特有な変数
］に依存する。
この最適な時機を決定するのは~UAに~~委ねられる
— 例えば，~UAは、次のようにしてもヨイ：
◎
The optimal time to initiate a resource fetch required for the next navigation is dependent on the negotiated transport protocol, users current connectivity profile, available device resources, and other context specific variables. The user agent is left to determine the optimal time at which to initiate the fetch - e.g. the user agent＼
</p>
		<ul>
			<li>
他の~downloadをすべて終えるまで待機するものと裁定する。
◎
MAY decide to wait until all other downloads are finished, or＼
</li>
			<li>
要請を低い優先度で~pipelineすることを選ぶ
— 折衝された~protocolが，必要とされる~primitiveを~supportするならば。
◎
MAY choose to pipeline requests with low priority if the negotiated protocol supports the necessary primitives.＼
</li>
			<li>
資源~拘束, 利用者~選好, その他の要因に因り，~fetchを起動するのを任意選択で外す。
◎
Alternatively, the user agent MAY opt-out from initiating the fetch due to resource constraints, user preferences, or other factors.
</li>
		</ul>
	</li>
</ul>

		</section>
		<section id="load-and-error-events">
<h3 title="Load and error events">3.2.  `load^et, `error^et ~event</h3>

<p>
~UAは、［
`preconnect$v ／
`投機的~fetch$
］により起動された要請が未終了であっても、それに因り文書の`~load~eventを遅延する$ことは，ないモノトスル。
◎
The user agent MUST NOT delay the load event of the document due to outstanding preconnect or speculative fetch initiated requests.
</p>

<p>
資源~hintが実行されるかどうか, および
その場合に処理を［
全部的／部分的
］に適用するかどうかの裁定は、~UAに委ねられる。
よって、［
`load^et ／ `error^et
］~eventが要素に向けて発火されることは，保証されないし、発火されても，処理が全部的に適用されることは保証されない。
しかしながら，~UAは、アリなら これらの~eventのうち適切な方を発火して，［
 ~appが，どの~hintがいつ実行されるか追跡できる
 ］ようにするベキである。
◎
The decision on whether a resource hint is executed, and if so, whether full or partial processing is applied is deferred to the user agent. As a result, element-level load and error JavaScripts events are not guaranteed to fire, and if they do, do not guarantee that full processing was applied. However, the user agent SHOULD fire the appropriate load and error events when possible, to allow the application to track which hints were executed and when.
</p>
		</section>
	</section>
	<section id="use-cases">
<h2 title="Use cases">4. 利用事例</h2>

		<section id="dynamic-request-url-(preconnect)">
<h3 title="Dynamic request URL (preconnect)">4.1. 動的な要請~URL （ `preconnect^v ）</h3>

<p>
全部的な資源~URLは、~UAが~pageを構築するまで既知でないこともある
— 例： 条件付き読込ng~logic, ~UAの適応力, 等々。
しかしながら，~fetchされることになる資源の生成元は、［
開発者／ 応答を生成している~server
］にとっては，事前に既知なことは多い。
そのような事例では、 `preconnect$v ~hintを利用して，早期に接続~handshakeを起動できる：
~UAは、資源~URLが決定されたとき，すぐに
— 接続~折衝により先ず阻止されることなく —
要請を配送できるようになる。
◎
The full resource URL may not be known until the page is being constructed by the user agent - e.g. conditional loading logic, UA adaptation, etc. However, the origin from which one or more of these resources will be fetched is often known ahead of time by the developer or the server generating the response. In such cases, a preconnect hint can be used to initiate an early connection handshake such that when the resource URL is determined, the user agent can dispatch the request without first blocking on connection negotiation.
</p>
		</section>
		<section id="anonymizing-redirect-(preconnect)">
<h3 title="Anonymizing redirect (preconnect)">4.2. ~redirectの匿名化-法（ `preconnect^v ）</h3>


<p>
利用者を最終的な行先へ送る前に、［
解析 ／
~malware保護 ／
<a href="https://www.facebook.com/notes/facebook-engineering/protecting-privacy-with-referrers/392382738919">~referrerを匿名化する</a>
］ために，~redirect~serviceに依拠する~siteは多い。
行先は事前に既知なので， `preconnect$v ~hintを利用すれば、行先~生成元との接続~handshakeを，~redirectの処理と並列的に起動できる（私的な情報は露呈することなく）。
これは、~redirectによる待時間を覆隠して，最終的な行先への~navi時間を抑制する。
◎
Many sites rely on redirect services for analytics, malware protection, and to anonymize the referrer before sending the user to the final destination. Because the destination is known ahead of time, a preconnect hint can be used to initiate the connection handshake with the destination origin (without revealing any private information) in parallel with the processing of the redirect - this masks the redirect latency and reduces navigation time to final destination.
</p>
		</section>
		<section id="speculative-resource-prefetching-(prefetch)">
<h3 title="Speculative resource prefetching (prefetch)">4.3. 投機的な資源の~prefetch法（ `prefetch^v ）</h3>


<p>
`prefetch$v ~hintを利用すれば、［
内容, 構造, 解析, その他の~signal
］
— 例：
見込みが高い探索~結果,
一連の~pageに分けられた内容や 段階を踏んでいく流れ,
集成された解析,
利用者ごとの挙動,
等々 —
に基づく，次回の~naviについての~appに特有な知識を活用して、~prefetch策を実装できる。
◎
The prefetch hint can be used to implement a prefetch strategy that leverages app-specific knowledge about the next navigation based on content, structure, analytics, or other signals - e.g. high-likelihood search results, paginated content or step-driven flows, aggregated analytics or per-user behavior, and so on.
</p>

<p>
例えば画像展示は、利用者から次回に要請されると見込まれる写真や~pageについての知識を有し得る。
~appは、次回の~naviが誘発される前に，要求される資源（個々の写真 ／ 必須の資源 ／ 全部的な~page）を~fetchし始めるよう~UAに依頼して，利用者~体験を改善できる。
◎
For example, an image gallery may have knowledge about the likelihood of the next photo or page that may be requested by the user. To provide an improved experience the application can ask the user agent to begin fetching required resources (individual photos, critical resources, or the full page) before the next navigation is triggered.
</p>

<p>
~appは、利用している各~資源に対し， `prefetch$v 関係を指定して，上の挙動を達成できる。
◎
To achieve the above behavior the application can specify one or more prefetch relations of each resource being used.
</p>

			</section>
    		<section id="reactive-resource-prefetching-(prefetch)">
<h3 title="Reactive resource prefetching (prefetch)">4.4. 受動的な資源の~prefetch法（ `prefetch^v ）</h3>

<p>
`prefetch$v 利用すれば、利用者が次へ向かう所についての知識を活用するような，  “受動的~prefetch策” を実装できる
— ~appは、~navi要請と並列的に，必須の資源を~prefetchし始められるようにする。
◎
The prefetch can be used to implement a "reactive prefetch strategy" that leverages the knowledge of where the user is heading next and enables the application to begin prefetching critical resources in parallel with the navigation request.
</p>

<p>
~appは、利用者／~appから生成される~clickその他の~eventを~listenして，次回の~naviに要求される必須の資源に関連な `prefetch$v 関係を動的に挿入することで、上の挙動を達成できる。
~UA側においては、~hintされた資源を~navi要請と並列的に~fetchして，必須の資源より早く可用にできる。
◎
To achieve the above behavior the application can listen for click, or other user and application generated events, and dynamically insert relevant prefetch relations for critical resources required by the next navigation. In turn, the user agent can fetch the hinted resources in parallel with the navigation request, making the critical resources available sooner.
</p>

<p>
この策は、［
`prefetch$v  関係を介して起動された要請が，複数の~naviにまたがって持続化する
］のを許容する特能を，可能化する。
◎
The enabling feature of this strategy is that requests initiated via prefetch relation may be allowed to persist across navigations.
</p>

		</section>
		<section id="prerendering-(prerender)">
<h3 title="Prerendering (prerender)">4.5. ~prerender法（ `prerender^v ）</h3>

<p>
`prerender$v ~hintを利用すれば、利用者が~naviを誘発したとき瞬時の~navi体験を可能化できるよう，行先~pageを~prerenderできる。
◎
The prerender hint can be used to prerender the destination page, enabling an instant navigation experience once the user triggers the navigation.
</p>

<p>
~appは、それぞれが行先~page（~HTML資源）を指すような
`prerender$v 関係を 1 つ以上~指定して，瞬時の~navi体験を送達できる。
~UA側において、瞬時の~naviを送達する
— すなわち，~pageを “~prerender” する —
ためとして，そのような~HTML文書を［
~fetchして処理する, その下位資源も~fetchする, その他の作業を遂行する
］ようにしてもヨイ。
◎
To deliver an instant navigation experience the application can specify one or more prerender relations, each of which points to a destination page (an HTML resource). In turn, the user agent may fetch and process the HTML document, fetch its subresources, and perform other work to deliver an instant navigation - i.e. "prerender" the page.
</p>

		</section>
	</section>
	<section id="security-and-privacy">
<h2 title="Security and Privacy">5. ~securityと~privacy</h2>

<p>
`資源~hint~link$の利用-は、［
現在の~page, 利用者の活動
］両者についての情報を公開するような，新たな手段を供し得る。
［
~secure, 平文
］両~接続とも、例えば，［［
~prefetch／~prerender
］された資源の内容 ／
接続を確立する間に公開される［
~DNS ／ ~IP ／ ~hostname
］情報
］を観測することにより、そのような要請を起動している~pageについての情報に加え,
資源~hintが動的に利用される所では利用者の活動も，露呈され得る。
◎
The use of resource hints can provide new means to expose information about both the current page and user's activity on it. For example, observing the content of prefetched or prerendered resources, or observing the DNS, IP, and hostname information exposed during connection establishment, both for secure and plain-text connections, can reveal information about the page initiating such requests, and where dynamic resource hints are used, user's activity on it.
</p>

<p>
これらの~risk一部を軽減するため、~UAは，次を行うモノトスル：
◎
To mitigate some of the above risks, the user agent MUST:
</p>

<ul>
	<li>
`資源~hint~link$が指す内容を，`昇格-可能な内容$ `MIXED-CONTENT$r として扱う。
◎
Treat resource hint link's as Optionally-blockable Content, as defined by [MIXED-CONTENT].
</li>
	<li>
楽観的な資源~fetching用に、関連な
<a href="~CSP2#complications">処理の複雑化に際しての推奨</a>
`CSP3$r
を適用する。
◎
Apply relevant Processing Complications recommendations for optimistic resource fetching, as defined by [CSP3].
</li>
	<li>
`資源~hint~link$が指す内容に，関連な~referrer施策による制約 `REFERRER-POLICY$r を適用する。
◎
Apply relevant Referrer policy restrictions for resource hint link's, as defined by [REFERRER-POLICY].
</li>
</ul>

<p>
加えて，~UAは、`資源~hint~link$の利用を制御する設定群を利用者に供してもヨイ
◎
Additionally, the user agent MAY provide user setting to control the use of resource hints.
</p>

<p>
~site作者は、必要とされる予防策をとるベキである
—
`MIXED-CONTENT$r, `CSP3$r, `REFERRER-POLICY$r による関連な各種~施策を指定して、~UAが，`資源~hint~link$を処理するに先立って，それらを登録して適用できるようにするため：
◎
The site author SHOULD take necessary precautions to specify the relevant [MIXED-CONTENT], [CSP3], and [REFERRER-POLICY] policies to allow the user agent to register and apply them prior to processing a resource hint link:
</p>

<ul>
	<li>
~HTML~markupを介して`資源~hint~link$を供する場合、事前に，
`meta$e 要素で関連な施策を宣言するベキである
— 例：
~CSP用の <a href="~CSP2#delivery-html-meta-element">`meta^e 推奨</a>
を見よ。
◎
If resource hint link is provided via HTML markup, then the relevant &lt;meta&gt; policies SHOULD be declared ahead of them - e.g. see &lt;meta&gt; recommendations for CSP.
</li>
	<li>
`Link$h ~HTTP応答~headerを介して`資源~hint~link$を供する場合、関連な施策も~HTTP応答~headerとして送達するベキである
— 例：
~CSP用の
<a href="~CSP2#complications">処理の複雑化</a>
を見よ。
◎
If resource hint link is provided via the Link HTTP response header, then the relevant policies should also be delivered as an HTTP response header - e.g. see Processing Complications for CSP.
</li>
</ul>

	</section>
	<section id="conformance">
<h2 title="Conformance">6. 適合性</h2>

<p>
この仕様が適合性を課す対象は、~UAのみである。
◎
There is only one class of product that can claim conformance to this specification: a user agent.
</p>

	</section>
	<section id="iana-considerations">
<h2 title="IANA Considerations">7. ~IANA考慮点</h2>

<p>
以下に挙げる各種~link関係~型は、 `RFC5988$r,  6.2.1 節により，~IANAにより登録された：
◎
The link relation types below have been registered by IANA per Section 6.2.1 of [RFC5988]:
</p>

		<section id="dns-prefetch-link-relation-type">
<h3 title="dns-prefetch Link Relation Type">7.1. `dns-prefetch^v ~link関係~型</h3>

<dl>
	<dt>関係~名</dt>
	<dd>`dns-prefetch$v</dd>

	<dt>記述</dt>
	<dd>
［［［［［
当の~link文脈~用に要求される資源
］を~fetchする
］ために利用する
］ことになる生成元
］を指示する
］ために利用される
— ~UAは、アリな限り早くに解決するべきである。
◎
Used to indicate an origin that will be used to fetch required resources for the link context, and that the user agent ought to resolve as early as possible.
</dd>

	<dt>参照</dt>
	<dd>
この仕様。
◎
W3C Resource Hints Specification (https://www.w3.org/TR/resource-hints/)
</dd>
</dl>
		</section>
		<section id="preconnect-link-relation-type">
<h3 title="preconnect Link Relation Type">7.2. `preconnect^v ~link関係~型</h3>

<dl>
	<dt>関係~名</dt>
	<dd>`preconnect$v</dd>

	<dt>記述</dt>
	<dd>
［［［［［
当の~link文脈~用に要求される資源
］を~fetchする
］ために利用する
］ことになる生成元
］を指示する
］ために利用される
— ~UAには、接続を［
~DNS検索, ~TCP~handshake, ~TLS折衝（任意選択）
］を含め 早期に起動することで，接続を確立する際の高い待時間~costを覆隠すことが許容される。
◎
Used to indicate an origin that will be used to fetch required resources for the link context. Initiating an early connection, which includes the DNS lookup, TCP handshake, and optional TLS negotiation, allows the user agent to mask the high latency costs of establishing a connection.
</dd>

	<dt>参照</dt>
	<dd>
この仕様。
◎
W3C Resource Hints Specification (https://www.w3.org/TR/resource-hints/)
</dd>
</dl>
		</section>
		<section id="prefetch-link-relation-type">
<h3 title="prefetch Link Relation Type">7.3. `prefetch^v ~link関係~型</h3>

<dl>
	<dt>関係~名</dt>
	<dd>`prefetch$v</dd>

	<dt>記述</dt>
	<dd>
~prefetch~link関係~型は、［
次回の~naviに際して，当の~link文脈から要求されるであろう資源
］を識別するために利用される
— ~UAは、［
未来に資源が要請され次第，より高速に応答を送達できる
］よう，~fetchするべきである。
◎
The prefetch link relation type is used to identify a resource that might be required by the next navigation from the link context, and that the user agent ought to fetch, such that the user agent can deliver a faster response once the resource is requested in the future.
</dd>

	<dt>参照</dt>
	<dd>
この仕様。
◎
W3C Resource Hints Specification (https://www.w3.org/TR/resource-hints/)
</dd>
</dl>

		</section>
		<section id="prerender-link-relation-type">
<h3 title="prerender Link Relation Type">7.4. `prerender^v ~link関係~型</h3>

<dl>
	<dt>関係~名</dt>
	<dd>`prerender$v</dd>

	<dt>記述</dt>
	<dd>
［
次回の~naviに際して，当の~link文脈から要求されるであろう資源
］を識別するために利用される
— ~UAは、［
未来に資源が要請され次第，より高速に応答を送達できる
］よう，~fetchして実行するべきである。
◎
Used to identify a resource that might be required by the next navigation from the link context, and that the user agent ought to fetch and execute, such that the user agent can deliver a faster response once the resource is requested in the future.
</dd>

	<dt>参照</dt>
	<dd>
この仕様。
◎
W3C Resource Hints Specification (https://www.w3.org/TR/resource-hints/)
</dd>
</dl>
		</section>
	</section>
	<section id="acknowledgments">
<h2 title="Acknowledgments">謝辞</h2>

<p>
この文書は、
`Ian Hickson^en 氏により編集された【過去の】 `HTML$r 仕様からの~textを
— その仕様の許諾により許可されるとおり —
再利用する。
◎
This document reuses text from the [HTML] specification, edited by Ian Hickson, as permitted by the license of that specification.
</p>

	</section>
</main></div>
